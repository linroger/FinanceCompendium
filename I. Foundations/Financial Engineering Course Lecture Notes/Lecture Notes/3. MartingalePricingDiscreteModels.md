---
title: "Lecture 3 - Martingale Pricing Theory in Discrete-Time and Discrete-Space Models"
parent_directory: "Financial Engineering Course Lecture Notes"
formatted: "2025-12-21 12:00:00 PM"
formatter_model: "grok-code-fast-1"
cli_tool: "opencode"
primary_tags:
  - martingale pricing theory
  - discrete time models
  - discrete space models
  - equivalent martingale measure
  - fundamental theorem of asset pricing
secondary_tags:
  - arbitrage opportunities
  - state prices
  - self financing strategies
  - complete markets
  - risk neutral probabilities
  - single period models
  - multi period models
  - trading strategies
  - attainable claims
cssclasses: academia
---

# Martingale Pricing Theory in Discrete-Time and Discrete-Space Models

These notes develop the theory of martingale pricing in a discrete-time, discrete-space framework. This theory is also important for the modern theory of portfolio optimization as the problems of pricing and portfolio optimization are now recognized as being intimately related. We choose to work in a discrete-time and discrete-space environment as this will allow us to quickly develop results using a minimal amount of mathematics: we will use only the basics of linear programming duality and martingale theory. Despite this restriction, the results we obtain hold more generally for continuous-time and continuous-space models once various technical conditions are satisfied. This is not too surprising as one can imagine approximating these latter models using our discrete-time, discrete-space models by simply keeping the time horizon fixed and letting the number of periods and states go to infinity in an appropriate manner.

## 1 Martingale Pricing Theory for Single-Period Models

#### 1.1 Notation and Definitions

We first consider a one-period model and introduce the necessary definitions and concepts in this context. We will then extend these definitions to multi-period models.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/81eed407-f821-46d1-9a20-f1422fe8617e/a9ec6b4e1c4e60c20e52cf33cf1f65209a2dc64fc11c4ff755cb306f8f8ccf75.jpg)

$$
t = 0
$$

$$
t = 1
$$

Let  $t = 0$  and  $t = 1$  denote the beginning and end, respectively, of the period. At  $t = 0$  we assume that there are  $N + 1$  securities available for trading, and at  $t = 1$  one of  $m$  possible states will have occurred. Let  $S_0^{(i)}$  denote the time  $t = 0$  value of the  $i^{th}$  security for  $0 \leq i \leq N$ , and let  $S_1^{(i)}(\omega_j)$  denote its payoff at date  $t = 1$  in the event that  $\omega_j$  occurs. Let  $P = (p_1, \ldots, p_m)$  be the true probability distribution describing the likelihood of each state occurring. We assume that  $p_k > 0$  for each  $k$ .

### Arbitrage

A type  $A$  arbitrage is an investment that produces immediate positive reward at  $t = 0$  and has no future cost at  $t = 1$ . An example of a type  $A$  arbitrage would be somebody walking up to you on the street, giving you a

positive amount of cash, and asking for nothing in return, either then or in the future.

A type  $B$  arbitrage is an investment that has a non-positive cost at  $t = 0$  but has a positive probability of yielding a positive payoff at  $t = 1$  and zero probability of producing a negative payoff then. An example of a type  $B$  arbitrage would be a stock that costs nothing, but that will possibly generate dividend income in the future.

In finance we always assume that arbitrage opportunities do not exist since if they did, market forces would quickly act to dispel them.

### Linear Pricing

Definition 1 Let  $S_0^{(1)}$  and  $S_0^{(2)}$  be the date  $t = 0$  prices of two securities whose payoffs at date  $t = 1$  are  $d_1$  and  $d_2$ , respectively<sup>2</sup>. We say that linear pricing holds if for all  $\alpha_1$  and  $\alpha_2$ ,  $\alpha_1 S_0^{(1)} + \alpha_2 S_0^{(2)}$  is the value of the security that pays  $\alpha_1 d_1 + \alpha_2 d_2$  at date  $t = 1$ .

It is easy to see that absence of type  $A$  arbitrage implies that linear pricing holds. As we always assume that arbitrage opportunities do not exist, we also assume that linear pricing always holds.

### Elementary Securities, Attainability and State Prices

Definition 2 An elementary security is a security that has date  $t = 1$  payoff of the form  $e_j = (0, \dots, 0, 1, 0, \dots, 0)$ , where the payoff of 1 occurs in state  $j$ .

As there are  $m$  possible states at  $t = 1$ , there are  $m$  elementary securities.

Definition 3 A security or contingent claim,  $X$ , is said to be attainable if there exists a trading strategy,  $\theta = [\theta_0\theta_1\ldots \theta_N]^\top$ , such that

$$
\left[ \begin{array}{c} X \left(\omega_{1}\right) \\ \vdots \\ X \left(\omega_{m}\right) \end{array} \right] = \left[ \begin{array}{c c c} S_{1}^{(0)} \left(\omega_{1}\right) & \dots & S_{1}^{(N)} \left(\omega_{1}\right) \\ \vdots & \vdots & \vdots \\ S_{1}^{(0)} \left(\omega_{m}\right) & \dots & S_{1}^{(N)} \left(\omega_{m}\right) \end{array} \right] \left[ \begin{array}{c} \theta_{0} \\ \vdots \\ \theta_{N} \end{array} \right]. \tag{1}
$$

In shorthand we write  $X = S_{1}\theta$  where  $S_{1}$  is the  $m \times (N + 1)$  matrix of date 1 security payoffs. Note that  $\theta_{j}$  represents the number of units of the  $j^{th}$  security purchased at date 0. We call  $\theta$  the replicating portfolio.

#### Example 1 (An Attainable Claim)

Consider the one-period model below where there are 4 possible states of nature and 3 securities, i.e.  $m = 4$  and  $N = 2$ . At  $t = 1$  and state  $\omega_3$ , for example, the values of the 3 securities are 1.03, 2 and 4, respectively.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/81eed407-f821-46d1-9a20-f1422fe8617e/84464436b456c5100ce80acb5f7d08d79f24365c20dabdd040985311d6c9e887.jpg)

The claim  $X = [7.47 \quad 6.97 \quad 9.97 \quad 10.47]^\top$  is an attainable claim since  $X = S_1\theta$  where  $\theta = [-1 \quad 1.5 \quad 2]^\top$  is a replicating portfolio for  $X$ .

Note that the date  $t = 0$  cost of the three securities has nothing to do with whether or not a claim is attainable. We can now give a more formal definition of arbitrage in our one-period models.

Definition 4 A type  $A$  arbitrage is a trading strategy,  $\theta$ , such that  $S_0^\top \theta < 0$  and  $S_1\theta = 0$ . A type  $B$  arbitrage is a trading strategy,  $\theta$ , such that  $S_0^\top \theta \leq 0$ ,  $S_1\theta \geq 0$  and  $S_1\theta \neq 0$ .

Note for example, that if  $S_0^\top \theta < 0$  then  $\theta$  has negative cost and therefore produces an immediate positive reward if purchased at  $t = 0$ .

Definition 5 We say that a vector  $\pi = [\pi_1 \dots \pi_m]^\top > 0$  is a vector of state prices if the date  $t = 0$  price,  $P$ , of any attainable security,  $X$ , satisfies

$$
P = \sum_{k=1}^{m} \pi_{k} X \left(\omega_{k}\right). \tag{2}
$$

We call  $\pi_k$  the  $k^{th}$  state $^3$  price.

Remark 1 It is important to note that in principle there might be many state price vectors. If the  $k^{th}$  elementary security is attainable, then its price must be  $\pi_k$  and the  $k^{th}$  component of all possible state price vectors must therefore coincide. Otherwise an arbitrage opportunity would exist.

#### Example 2 (State Prices)

Returning to the model of Example 1 we can easily check<sup>4</sup> that

$[\pi_1 \pi_2 \pi_3 \pi_4]^\top = [0.2433 0.1156 0.3140 0.3168]^\top$  is a vector of state prices. More generally, however, we can check that

$$
\left[ \begin{array}{c} \pi_{1} \\ \pi_{2} \\ \pi_{3} \\ \pi_{4} \end{array} \right] = \left[ \begin{array}{c} 0 \\ 0.3102 \\ 0.4113 \\ 0.2682 \end{array} \right] + \epsilon \left[ \begin{array}{c} 0.7372 \\ -0.5898 \\ -0.2949 \\ 0.1474 \end{array} \right]
$$

is also a vector of state prices for any  $\epsilon$  such  $\pi_i > 0$  for  $1\leq i\leq 4$

### Deflating by the Numeraire Security

Let us recall that there are  $N + 1$  securities and that  $S_1^{(i)}(\omega_j)$  denotes the date  $t = 1$  price of the  $i^{th}$  security in state  $\omega_{j}$ . The date  $t = 0$  price of the  $i^{th}$  security is denoted by  $S_0^{(i)}$ .

Definition 6 A numeraire security is a security with a strictly positive price at all times,  $t$ .

It is often convenient to express the price of a security in units of a chosen numeraire. For example, if the  $n^{th}$  security is the numeraire security, then we define

$$
\overline{S}_{t}^{(i)} (\omega_{j}) := \frac{S_{t}^{(i)} (\omega_{j})}{S_{t}^{(n)} (\omega_{j})}
$$

to be the date  $t$ , state  $\omega_{j}$  price (in units of the numeraire security) of the  $i^{th}$  security. We say that we are deflating by the  $n^{th}$  or numeraire security. Note that the deflated price of the numeraire security is always constant and equal to 1.

Definition 7 The cash account is a particular security that earns interest at the risk-free rate of interest. In a single period model, the date  $t = 1$  value of the cash account is  $1 + r$  (assuming that \$1 had been deposited at date  $t = 0$ ), regardless of the terminal state and where  $r$  is the one-period interest rate that prevailed at  $t = 0$ .

In practice, we often deflate by the cash account if it is available. Note that deflating by the cash account is then equivalent to the usual process of discounting. We will use the zero $^{th}$  security with price process,  $S_{t}^{(0)}$ , to denote the cash account whenever it is available.

#### Example 3 (Numeraire and Cash Account)

Note that any security in Example 1 could serve as a numeraire security since each of the 3 securities has a strictly positive price process. It is also clear that the zero $^{th}$  security in that example is actually the cash account.

## Equivalent Martingale Measures (EMMs)

We assume that we have chosen a specific numeraire security with price process,  $S_{t}^{(n)}$ .

Definition 8 An equivalent martingale measure (EMM) or risk-neutral probability measure is a set of probabilities,  $Q = (q_{1},\ldots ,q_{m})$  such that

1. $q_{k} > 0$  for all  $k$ .  
2. The deflated security prices are martingales. That is

$$
\overline{S}_{0}^{(i)} := \frac{S_{0}^{(i)}}{S_{0}^{(n)}} = \mathrm{E}_{0}^{Q} \left[ \frac{S_{1}^{(i)}}{S_{1}^{(n)}} \right] =: \mathrm{E}_{0}^{Q} \left[ \overline{S}_{1}^{(i)} \right]
$$

for all  $i$  where  $\mathrm{E}_0^Q [.]$  denotes expectation with respect to the risk-neutral probability measure,  $Q$ .

Remark 2 Note that a set of risk-neutral probabilities, or EMM, is specific to the chosen numeraire security,  $S_{t}^{(n)}$ . In fact it would be more accurate to speak of an EMM-numeraire pair.

## Complete Markets

We now assume that there are no arbitrage opportunities. If there is a full set of  $m$  elementary securities available (i.e. they are all attainable), then we can use the state prices to compute the date  $t = 0$  price,  $S_0$ , of any security. To see this, let  $x = [x_1 \ldots x_m]^\top$  be the vector of possible date  $t = 1$  payoffs of a particular security. We may then write

$$
x = \sum_{i=1}^{m} x_{i} e_{i}
$$

and use linear pricing to obtain  $S_0 = \sum_{i=1}^{m} x_i \pi_i$ .

If a full set of elementary securities exists, then as we have just seen, we can construct and price every possible security. We have the following definition.

Definition 9 If every random variable  $X$  is attainable, then we say that we have a complete market.

Otherwise we have an incomplete market.

Note that if a full set of elementary securities is available, then the market is complete.

Exercise 1 Is the model of Example 1 complete or incomplete?

## 1.2 Pricing in Single-Period Models

We are now ready to derive the main results of martingale pricing theory for single period models.

Proposition 1 If an equivalent martingale measure,  $Q$ , exists, then there can be no arbitrage opportunities.

Exercise 2 Prove Proposition 1.

Exercise 3 Convince yourself that if we did not insist on each  $q_k$  being strictly positive in Definition 8 then Proposition 1 would not hold.

Theorem 2 Assume there is a security with a strictly positive price process,  $S_{t}^{(n)}$ . If there is a set of positive state prices, then a risk-neutral probability measure,  $Q$ , exists with  $S_{t}^{(n)}$  as the numeraire security. Moreover, there is a one-to-one correspondence between sets of positive state prices and risk-neutral probability measures.

Proof: Suppose a set of positive state prices,  $\pi = [\pi_1\ldots \pi_m]^\top$ , exists. For all  $j$  we then have (by definition of state prices pricing)

$$
\begin{array}{l} S_{0}^{(j)} = \sum_{k=1}^{m} \pi_{k} S_{1}^{(j)} (\omega_{k}) \\ = \left(\sum_{l=1}^{m} \pi_{l} S_{1}^{(n)} \left(\omega_{l}\right)\right) \sum_{k=1}^{m} \frac{\pi_{k} S_{1}^{(n)} \left(\omega_{k}\right)}{\sum_{l=1}^{m} \pi_{l} S_{1}^{(n)} \left(\omega_{l}\right)} \frac{S_{1}^{(j)} \left(\omega_{k}\right)}{S_{1}^{(n)} \left(\omega_{k}\right)}. \tag{3} \\ \end{array}
$$

Now observe that  $\sum_{l=1}^{m} \pi_{l} S_{1}^{(n)}(\omega_{l}) = S_{0}^{(n)}$  and that if we define

$$
q_{k} := \frac{\pi_{k} S_{1}^{(n)} \left(\omega_{k}\right)}{\sum_{l=1}^{m} \pi_{l} S_{1}^{(n)} \left(\omega_{l}\right)}, \tag{4}
$$

then  $Q \coloneqq (q_{1},\ldots ,q_{m})$  defines a probability measure. Equation (3) then implies

$$
\frac{S_{0}^{(j)}}{S_{0}^{(n)}} = \sum_{k=1}^{m} q_{k} \frac{S_{1}^{(j)} \left(\omega_{k}\right)}{S_{1}^{(n)} \left(\omega_{k}\right)} = \mathrm{E}_{0}^{Q} \left[ \frac{S_{1}^{(j)}}{S_{1}^{(n)}} \right] \tag{5}
$$

and so  $Q$  is a risk-neutral probability measure, as desired.

The one-to-one correspondence between sets of positive state prices and risk-neutral probability measures is clear from (4).

Remark 3 The true real-world probabilities,  $P = (p_{1},\dots ,p_{m})$ , are almost irrelevant here. The only connection between  $P$  and  $Q$  is that they must be equivalent. That is  $p_k > 0 \Leftrightarrow q_k > 0$ . Note that in the statement of Theorem 2 we assumed that the set of state prices was positive. This and equation (4) implied that each  $q_{k} > 0$  so that  $Q$  is indeed equivalent to  $P$ . (Recall it was assumed at the beginning that each  $p_k > 0$ .)

## Absence of Arbitrage  $\equiv$  Existence of Positive State Prices  $\equiv$  Existence of EMM

Before we establish the main result, we first need the following theorem which we will prove using the theory of linear programming.

Theorem 3 Let  $A$  be an  $m \times n$  matrix and suppose that the matrix equation  $Ax = p$  for  $p \geq 0$  cannot be solved except for the case  $p = 0$ . Then there exists a vector  $y > 0$  such that  $A^{\top}y = 0$ .

Proof: We will use the following result from the theory of linear programming:

If a primal linear program,  $P$ , is infeasible then its dual linear program,  $D$ , is either also infeasible, or it has an unbounded objective function.

Now consider the following sequence of linear programs,  $\mathbf{P}_i$ , for  $i = 1, \dots, m$ :

$$
\min \quad 0^{\top} x \quad (\mathbf{P}_{i})
$$

subject to  $Ax\geq \epsilon_{i}$

where  $\epsilon_{i}$  has a 1 in the  $i^{th}$  position and 0 everywhere else. The dual,  $\mathbf{D}_i$ , of each primal problem,  $\mathbf{P}_i$  is

$$
\max \begin{array}{c c} y_{i} & (\mathbf{D}_{i}) \end{array}
$$

subject to  $A^{\top}y = 0$

$$
y \geq 0
$$

By assumption, each of the primal problems,  $\mathbf{P}_i$ , is infeasible. It is also clear that each of the dual problems are feasible (take  $y$  equal to the zero vector). By the LP result above, it is therefore the case that each  $\mathbf{D}_i$  has an unbounded objective function. This implies, in particular, that corresponding to each  $\mathbf{D}_i$ , there exists a vector  $y^i \geq 0$  with  $A^\top y^i = 0$  and  $y_i^i > 0$ , i.e. the  $i^{th}$  component of  $y^i$  is strictly positive. Now taking

$$
y^{*} = \sum_{i=1}^{m} y^{i},
$$

we clearly see that  $A^{\top}y^{*} = 0$  and  $y^{*}$  is strictly positive.

We now prove the following important result regarding absence of arbitrage and existence of positive state prices.

Theorem 4 In the one-period model there is no arbitrage if and only if there exists a set of positive state prices.

Proof: (i) Suppose first that there is a set of positive state prices,  $\pi \coloneqq (\pi_1,\dots ,\pi_m)$ . If  $x\geq 0$  is the date  $t = 1$  payoff of an attainable security, then the price,  $S$ , of the security is given by

$$
S = \sum_{j=1}^{m} \pi_{j} x_{j} \geq 0.
$$

If some  $x_{j} > 0$  then  $S > 0$ , and if  $x = 0$  then  $S = 0$ . Therefore there is no arbitrage opportunity.

(ii) Suppose now that there is no arbitrage. Consider the  $(m + 1)\times (N + 1)$  matrix,  $A$ , defined by

$$
A = \left[ \begin{array}{c c c} S_{1}^{(0)} (\omega_{1}) & \dots & S_{1}^{(N)} (\omega_{1}) \\ \vdots & \vdots & \vdots \\ S_{1}^{(0)} (\omega_{m}) & \dots & S_{1}^{(N)} (\omega_{m}) \\ -S_{0}^{(0)} & \dots & -S_{0}^{(N)} \end{array} \right]
$$

and observe (convince yourself) that the absence of arbitrage opportunities implies the non-existence of an  $N$ -vector,  $x$ , with

$$
A x \geq 0 \quad \text{and } A x \neq 0.
$$

In this context, the  $i^{th}$  component of  $x$  represents the number of units of the  $i^{th}$  security that was purchased or sold at  $t = 0$ . Theorem 3 then assures us of the existence of a strictly positive vector  $\pi$  that satisfies  $A^{\top}\pi = 0$ . We can normalize  $\pi$  so that  $\pi_{m + 1} = 1$  and we then obtain

$$
S_{0}^{(i)} = \sum_{j=1}^{m} \pi_{j} S_{1}^{(i)} (\omega_{j}).
$$

That is,  $\pi \coloneqq (\pi_1,\dots ,\pi_m)$  is a vector of positive state prices.

Theorems 2 and 4 imply the following theorem which encapsulates the principal results for our single-period model.

## Theorem 5 (First Fundamental Theorem of Asset Pricing)

Assume there exists a security with strictly positive price process. Then the absence of arbitrage, the existence of state prices and the existence of an EMM,  $Q$ , are all equivalent.

## Example 4 (An Arbitrage-Free Market)

The model in Example 1 is arbitrage-free since we saw in Example 2 that a vector of positive state prices exists for this market

## Example 5 (A Market with Arbitrage Opportunities)

Consider the one-period, 2-state model below.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/81eed407-f821-46d1-9a20-f1422fe8617e/1ce6d322ced3e533fba66d59510aa77fad8018dff8ae4f86225f7f4f6538133a.jpg)

No positive state price vector exists for this model so there must be an arbitrage opportunity.

Exercise 4 Find an arbitrage strategy,  $\theta$ , in the model of Example 5.

## Complete Markets  $\equiv$  Unique EMM

We now turn to the important question of completeness and we have the following formulation that is equivalent to Definition 9. We state this as a theorem but the proof is immediate given our original definition.

Theorem 6 Assume that there are no arbitrage opportunities. Then the market is complete if and only if the matrix of date  $t = 1$  payoffs,  $S_{1}$ , has rank  $m$ .

## Example 6 (An Incomplete Market)

The model of Example 1 is arbitrage-free by Theorem 4 since we saw in Example 2 that a vector of positive state prices exists for this model. However the model is incomplete since the rank of the payoff matrix,  $S_{1}$ , can be at most 3 which is less than the number of possible states, 4.

## Example 7 (A Complete Market)

Consider the one-period model below where there are 4 possible states of nature and 4 securities, i.e.  $m = 4$  and  $N = 3$ .

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/81eed407-f821-46d1-9a20-f1422fe8617e/cc01aecaac09bdd927c1ed16dea2a1b19a398c2717947ce8b09522e1a0a1c359.jpg)

We can easily check that  $\mathrm{rank}(S_1) = 4 = m$ , so that this model is indeed complete. (We can also confirm that this model is arbitrage free by Theorem 4 and noting that the state price vector of Example 2 is a (unique) state price vector here.)

Exercise 5 Show that if a market is incomplete, then at least one elementary security is not attainable.

Suppose now that the market is incomplete so that at least one elementary security, say  $e_j$ , is not attainable. By Theorem 4, however, we can still define a set of positive state prices if there are no arbitrage opportunities. In particular, we can define the state price  $\pi_j > 0$  even though the  $j^{th}$  elementary security is not attainable. A number of interesting questions arise regarding the uniqueness of state price and risk-neutral probability measures, and whether or not markets are complete. The following theorem addresses these questions.

## Theorem 7 (Second Fundamental Theorem of Asset Pricing)

Assume there exists a security with strictly positive price process and there are no arbitrage opportunities. Then the market is complete if and only if there exists exactly one equivalent martingale measure (or equivalently, one vector of positive state prices).

Proof: (i) Suppose first that the market is complete. Then there exists a unique set of positive state prices, and therefore by Theorem 2, a unique risk-neutral probability measure.

(ii) Suppose now that there exists exactly one risk-neutral probability measure. We will derive a contradiction by assuming that the market is not complete. Suppose then that the random variable  $X = (X_{1},\ldots ,X_{m})$  is not attainable. This implies that there does not exist an  $(N + 1)$ -vector,  $\theta$ , such that  $S_{1}\theta = X$ .

Therefore, using a technique similar to that in the proof of Theorem 3, we can show there exists a vector,  $h$  such that  $h^{\top}S_{1} = 0$  and  $h^{\top}X > 0$ . Let  $Q$  be some risk-neutral probability measure and define  $\hat{Q}$  by

$$
\hat{Q} (\omega_{j}) = Q (\omega_{j}) + \lambda h_{j} S_{1}^{(n)} (\omega_{j})
$$

where  $S_1^{(n)}$  is the date  $t = 1$  price of the numeraire security and  $\lambda > 0$  is chosen so that  $\widehat{Q}(\omega_j) > 0$  for all  $j$ . Note  $\widehat{Q}$  is a probability measure since  $h^\top S_1 = 0$  implies  $\sum_{j} h_j S_1^{(n)}(\omega_j) = 0$ . It is also easy to see (check) that since  $Q$  is an equivalent probability measure, so too is  $\widehat{Q}$  and  $Q \neq \widehat{Q}$ . Therefore we have a contradiction and so the market must be complete.

Remark: It is easy to check that the price of  $X$  under  $Q$  is different to the price of  $X$  under  $\widehat{Q}$  in Theorem 7. This could not be the case if  $X$  was attainable. Why?

## 2 Martingale Pricing Theory for Multi-Period Models

#### 2.1 Notation and Definitions

Before extending our single-period results to multi-period models, we first need to extend some of our single-period definitions and introduce the concept of trading strategies and self-financing trading strategies. We will assume<sup>10</sup> for now that none of the securities in our multi-period models pay dividends. (We will return to the case where they do pay dividends at the end of these notes.)

As before we will assume that there are  $N + 1$  securities,  $m$  possible states of nature and that the true probability measure is denoted by  $P = (p_1, \ldots, p_m)$ . We assume that the investment horizon is  $[0, T]$  and that there are a total of  $T$  trading periods. Securities may therefore be purchased or sold at any date  $t$  for  $t = 0, 1, \ldots, T - 1$ . Figure 1 below shows a typical multi-period model with  $T = 2$  and  $m = 9$  possible states. The manner in which information is revealed as time elapses is clear from this model. For example, at node  $I_1^{4,5}$  the available information tells us that the true state of the world is either  $\omega_4$  or  $\omega_5$ . In particular, no other state is possible at  $I_1^{4,5}$ .

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/81eed407-f821-46d1-9a20-f1422fe8617e/9dc5db775e1a525428fd80b8a29e221e0d9e675142d351042010734a27c1ca4e.jpg)

Note that the multi-period model is composed of a series of single-period models. At date  $t = 0$  in Figure 1, for example, there is a single one-period model corresponding to node  $I_0$ . Similarly at date  $t = 1$  there are three possible one-period models corresponding to nodes  $I_1^{1,2,3}$ ,  $I_1^{4,5}$  and  $I_1^{6,7,8,9}$ , respectively. The particular one-period model that prevails at  $t = 1$  will depend on the true state of nature. Given a probability measure,  $P = (p_1,\dots ,p_m)$ , we can easily compute the conditional probabilities of each state. In Figure 1, for example,  $\mathbf{P}(\omega_1|I_1^{1,2,3}) = p_1 / (p_1 + p_2 + p_3)$ . These conditional probabilities can be interpreted as probabilities in the

corresponding single-period models. For example,  $p_1 = \mathbf{P}(I_1^{1,2,3}|I_0)$ ,  $\mathbf{P}(\omega_1|I_1^{1,2,3})$ . This observation (applied to risk-neutral probabilities) will allow us to easily generalize our single-period results to multi-period models.

## Trading Strategies and Self-Financing Trading Strategies

Definition 10 A predictable stochastic process is a process whose time  $t$  value,  $X_{t}$  say, is known at time  $t - 1$  given all the information that is available at time  $t - 1$ .

Definition 11 A trading strategy is a vector,  $\theta_t = [\theta_t^{(0)}(\omega) \dots \theta_t^{(N)}(\omega)]^\top$ , of predictable stochastic processes that describes the number of units of each security held just before trading at time  $t$ , as a function of  $t$  and  $\omega$ .

For example,  $\theta_t^{(i)}(\omega)$  is the number of units of the  $i^{th}$  security held between times  $t - 1$  and  $t$  in state  $\omega$ . We will sometimes write  $\theta_t^{(i)}$ , omitting the explicit dependence on  $\omega$ . Note that  $\theta_t$  is known at date  $t - 1$  as we insisted in Definition 11 that  $\theta_t$  be predictable. In our financial context, 'predictable' means that  $\theta_t$  cannot depend on information that is not yet available at time  $t - 1$ .

## Example 8 (Constraints Imposed by Predictability of Trading Strategies)

Referring to Figure 1, it must be the case that for all  $i = 0,\dots ,N$

$$
\begin{array}{l} \theta_{2}^{(i)} \left(\omega_{1}\right) = \theta_{2}^{(i)} \left(\omega_{2}\right) = \theta_{2}^{(i)} \left(\omega_{3}\right) \\ \theta_{2}^{(i)} (\omega_{4}) = \theta_{2}^{(i)} (\omega_{5}) \\ \theta_{2}^{(i)} (\omega_{6}) = \theta_{2}^{(i)} (\omega_{7}) = \theta_{2}^{(i)} (\omega_{8}) = \theta_{2}^{(i)} (\omega_{9}). \\ \end{array}
$$

Exercise 6 What can you say about the relationship between the  $\theta_1^{(i)}(\omega_j)$  's for  $j = 1,\ldots ,m?$

Definition 12 The value process,  $V_{t}(\theta)$ , associated with a trading strategy,  $\theta_t$ , is defined by

$$
V_{t} = \left\{ \begin{array}{l l} \sum_{i=0}^{N} \theta_{1}^{(i)} S_{0}^{(i)} & \text{for } t = 0 \\ \sum_{i=0}^{N} \theta_{t}^{(i)} S_{t}^{(i)} & \text{for } t \geq 1. \end{array} \right.
$$

Definition 13 A self-financing trading strategy is a strategy,  $\theta_t$ , where changes in  $V_t$  are due entirely to trading gains or losses, rather than the addition or withdrawal of cash funds. In particular, a self-financing strategy satisfies

$$
V_{t} = \sum_{i=0}^{N} \theta_{t+1}^{(i)} S_{t}^{(i)} \text{ for } t = 1, \dots, T - 1.
$$

Definition 13 states that the value of a self-financing portfolio just before trading or re-balancing is equal to the value of the portfolio just after trading, i.e., no additional funds have been deposited or withdrawn.

Exercise 7 Show that if a trading strategy,  $\theta_{t}$ , is self-financing then the corresponding value process,  $V_{t}$ , satisfies

$$
V_{t+1} - V_{t} = \sum_{i=0}^{N} \theta_{t+1}^{(i)} \left(S_{t+1}^{(i)} - S_{t}^{(i)}\right). \tag{6}
$$

Clearly then changes in the value of the portfolio are due to capital gains or losses and are not due to the injection or withdrawal of funds. Note that we can also write (6) as

$$
d V_{t} = \theta_{t}^{\top} d S_{t},
$$

which anticipates our continuous-time definition of a self-financing trading strategy.

We can now extend the one-period definitions of arbitrage opportunities, attainable claims and completeness.

## Arbitrage

Definition 14 A type A arbitrage opportunity is a self-financing trading strategy,  $\theta_t$ , such that  $V_0(\theta) < 0$  and  $V_T(\theta) = 0$ . Similarly, a type B arbitrage opportunity is a self-financing trading strategy,  $\theta_t$ , such that  $V_0(\theta) = 0$ ,  $V_T(\theta) \geq 0$  and  $\mathrm{E}_0^P[V_T(\theta)] > 0$ .

## Attainability and Complete Markets

Definition 15 A contingent claim,  $C$ , is a random variable whose value at time  $T$  is known at that time given the information available then. It can be interpreted as the time  $T$  value of a security (or, depending on the context, the time  $t$  value if this value is known by time  $t < T$ ).

Definition 16 We say that the contingent claim  $C$  is attainable if there exists a self-financing trading strategy,  $\theta_t$ , whose value process,  $V_T$ , satisfies  $V_T = C$ .

Note that the value of the claim,  $C$ , in Definition 16 must equal the initial value of the replicating portfolio,  $V_0$  if there are no arbitrage opportunities available. We can now extend our definition of completeness.

Definition 17 We say that the market is complete if every contingent claim is attainable. Otherwise the market is said to be incomplete.

Note that the above definitions of attainability and (in)completeness are consistent with our definitions for single-period models. With our definitions of a numeraire security and the cash account remaining unchanged, we can now define what we mean by an equivalent martingale measure (EMM), or set of risk-neutral probabilities.

## Equivalent Martingale Measures (EMMs)

We assume again that we have in mind a specific numeraire security with price process,  $S_{t}^{(n)}$ .

Definition 18 An equivalent martingale measure (EMM),  $Q = (q_{1},\ldots ,q_{m})$ , is a set of probabilities such that

1. $q_{i} > 0$  for all  $i = 1,\dots ,m$  
2. The deflated security prices are martingales. That is

$$
\overline{S}_{t}^{(i)} := \frac{S_{t}^{(i)}}{S_{t}^{(n)}} = \mathrm{E}_{t}^{Q} \left[ \frac{S_{t+s}^{(i)}}{S_{t+s}^{(n)}} \right] =: \mathrm{E}_{t}^{Q} \left[ \overline{S}_{t+s}^{(i)} \right]
$$

for  $s, t \geq 0$ , for all  $i = 0, \dots, N$ , and where  $\mathrm{E}_t^Q[\cdot]$  denotes the expectation under  $Q$  conditional on information available at time  $t$ . (We also refer to  $Q$  as a set of risk-neutral probabilities.)

## 2.2 Pricing in Multi-Period Models

We will now generalize the results for single-period models to multi-period models. This is easily done using our single-period results and requires very little extra work.

## Absence of Arbitrage  $\equiv$  Existence of EMM

We begin with two propositions that enable us to generalize Proposition 1.

Proposition 8 If an equivalent martingale measure,  $Q$ , exists, then the deflated value process,  $V_{t}$ , of any self-financing trading strategy is a  $Q$ -martingale.

Proof: Let  $\theta_t$  be the self-financing trading strategy and let  $\overline{V}_{t+1} \coloneqq V_{t+1} / S_{t+1}^{(n)}$  denote the deflated value process. We then have

$$
\begin{array}{l} \mathrm{E}_{t}^{Q} \left[ \bar{V}_{t+1} \right] = \mathrm{E}_{t}^{Q} \left[ \sum_{i=0}^{N} \theta_{t+1}^{(i)} \bar{S}_{t+1}^{(i)} \right] \\ = \sum_{i=0}^{N} \theta_{t+1}^{(i)} \mathrm{E}_{t}^{Q} \left[ \overline{S}_{t+1}^{(i)} \right] \\ = \sum_{i=0}^{N} \theta_{t+1}^{(i)} \overline{S}_{t}^{(i)} \\ = \overline{V}_{t} \\ \end{array}
$$

demonstrating that  $\overline{V}_t$  is indeed a martingale, as claimed.

Remark 4 Note that Proposition 8 implies that the deflated price of any attainable security can be computed as the  $Q$ -expectation of the terminal deflated value of the security.

Proposition 9 If an equivalent martingale measure,  $Q$ , exists, then there can be no arbitrage opportunities.

Proof: The proof follows almost immediately from Proposition 8.

We can now now state our principal result for multi-period models, assuming as usual that a numeraire security exists.

Theorem 10 (Fundamental Theorem of Asset Pricing: Part 1)

In the multi-period model there is no arbitrage if and only if there exists an EMM,  $Q$ .

Proof: (i) Suppose first that there is no arbitrage as defined by Definition 14. Then we can easily argue there is no arbitrage (as defined by Definition 4) in any of the embedded one-period models. Theorem 5 then implies that each of the embedded one-period models has a set of risk-neutral probabilities. By multiplying these probabilities as described in the paragraph immediately following Figure 1, we can construct an EMM,  $Q$ , as defined by Definition 18.

(ii) Suppose there exists an EMM,  $Q$ . Then Proposition 9 gives the result.

## Complete Markets  $\equiv$  Unique EMM

As was the case with single-period models, it is also true that multi-period models are complete if and only if the EMM is unique. (We are assuming here that there is no arbitrage so that an EMM is guaranteed to exist.)

Proposition 11 The market is complete if and only if every embedded one-period model is complete.

Exercise 8 Prove Proposition 11

We have the following theorem.

Theorem 12 (Fundamental Theorem of Asset Pricing: Part 2)

Assume there exists a security with strictly positive price process and that there are no arbitrage opportunities. Then the market is complete if and only if there exists exactly one risk-neutral martingale measure,  $Q$ .

Proof: (i) Suppose the market is complete. Then by Proposition 11 every embedded one-period model is complete so we can apply Theorem 7 to show that the EMM,  $Q$ , (which must exist since there is no arbitrage) is unique.

(ii) Suppose now  $Q$  is unique. Then the risk-neutral probability measure corresponding to each one-period model is also unique. Now apply Theorem 7 again to obtain that the multi-period model is complete.

## State Prices

As in the single-period models, we also have an equivalence between equivalent martingale measures,  $Q$ , and sets of state prices. We will use  $\pi_t^{\{t + s\}}(\Lambda)$  to denote the time  $t$  price of a security that pays \$1 at time  $t + s$  in the event that  $\omega \in \Lambda$ . We are implicitly assuming that we can tell at time  $t + s$  whether or not  $\omega \in \Lambda$ . In Figure 1, for example,  $\pi_0^{\{1\}}(\omega_4, \omega_5)$  is a valid expression whereas  $\pi_0^{\{1\}}(\omega_4)$  is not.

## 2.3 Why is Absence of Arbitrage  $\equiv$  Existence of an EMM?

Let us now develop some intuition for why the discounted price process,  $S_{j}^{t} / S_{i}^{t}$ , should be a Q-martingale if there are no arbitrage opportunities. First, it is clear that we should not expect a non-deflated price process to be a martingale under the true probability measure,  $P$ . After all, if a cash account is available, then it will always grow in value as long as the risk-free rate of interest is positive. It cannot therefore be a  $P$ -martingale.

It makes sense then that we should compare the price processes of securities relative to one another rather than examine them on an absolute basis. This is why we deflate by some positive security. Even after deflating, however, it is still not reasonable to expect deflated price processes to be  $P$ -martingales. After all, some securities are riskier than others and since investors are generally risk averse it makes sense that riskier securities should have higher expected rates of return. However, if we change to an equivalent martingale measure,  $Q$ , where probabilities are adjusted to reflect the riskiness of the various states, then we can expect deflated price processes to be martingales under  $Q$ . The vital point here is that each  $q_{k}$  must be strictly positive since we have assumed that each  $p_{k}$  is strictly positive.

As a further aid to developing some intuition, we might consider the following three scenarios:

## Scenario 1

Imagine a multi-period model with two assets, both of whose price processes,  $X_{t}$  and  $Y_{t}$  say, are deterministic and positive. Convince yourself that in this model it must be the case that  $X_{t} / Y_{t}$  is a martingale if there are to be no arbitrage opportunities. (A martingale in a deterministic model must be a constant process. Moreover, in a deterministic model a risk-neutral measure,  $Q$ , must coincide with the true probability measure,  $P$ .)

## Scenario 2

Generalize scenario 1 to a deterministic model with  $n$  assets, each of which has a positive price process. Note that you can choose to deflate by any process you choose. Again it should be clear that deflated security price processes are (deterministic) martingales.

## Scenario 3

Now consider a one period stochastic model that runs from date  $t = 0$  to date  $t = 1$ . There are only two possible outcomes at date  $t = 1$  and we assume there are only two assets,  $S_{t}^{(1)}$  and  $S_{t}^{(2)}$ . Again, convince yourself that if there are to be no arbitrage opportunities, then it must be the case that there is probability measure,  $Q$ , such that  $S_{t}^{(1)} / S_{t}^{(2)}$  is a Q-martingale. Of course we have already given a proof of this result (and much more), but it helps intuition to look at this very simple case and see directly why an EMM must exist if there is no arbitrage.

Once these simple cases are understood, it is no longer surprising that the result (equivalence of absence of arbitrage and existence of an EMM) extends to multiple periods, multiple assets and even continuous time. You can also see that the numeraire asset can actually be any asset with a strictly positive price process. Of course we commonly deflate by the cash account in practice as it is often very convenient to do so, but it is important to note that our results hold if we deflate by other positive price processes. We now consider some examples that will use the various concepts and results that we have developed.

## 3 Examples

## Example 9 (A Complete Market)

There are two time periods and three securities. We will use  $S_{t}^{(i)}(\omega_{k})$  to denote the value of the  $i^{th}$  security in state  $\omega_{k}$  at date  $t$  for  $i = 0,1,2$ , for  $k = 1,\dots ,9$  and for  $t = 0,1,2$ . These values are given in the tree above, so for example, the value of the  $0^{th}$  security at date  $t = 2$  satisfies

$$
S_{2}^{(0)} (\omega_{k}) = \left\{ \begin{array}{l l} 1.1235, & \text{for } k = 1, 2, 3 \\ 1.1025, & \text{for } k = 4, 5, 6 \\ 1.0815, & \text{for } k = 7, 8, 9. \end{array} \right.
$$

Note that the zero $^{th}$  security is equivalent to a cash account that earns money at the risk-free interest rate. We will use  $R_{t}(\omega_{k})$  to denote the gross risk-free rate at date  $t$ , state  $\omega_{k}$ . The properties of the cash account imply that  $R$  satisfies  $R_{0}(\omega_{k}) = 1.05$  for all  $i$ , and

$$
R_{1} (\omega_{k}) = \left\{ \begin{array}{l l} 1.07, & \text{for } k = 1, 2, 3 \\ 1.05, & \text{for } k = 4, 5, 6 \\ 1.03, & \text{for } k = 7, 8, 9. \end{array} \right.
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/81eed407-f821-46d1-9a20-f1422fe8617e/58b1ede23a406292e006480010d78a2a58a9c4cb00b4071f8c2856901a896f97.jpg)

## Q1: Are there any arbitrage opportunities in this market?

Solution: No, because there exists a set of state prices or equivalently, risk-neutral probabilities. (Recall that by definition, risk neutral probabilities are strictly positive.) We can confirm this by checking that in each

embedded one-period model there is a strictly positive solution to  $S_{t} = \pi_{t}S_{t + 1}$  where  $S_{t}$  is the vector of security prices at a particular time  $t$  node and  $S_{t + 1}$  is the matrix of date  $t = 1$  prices at the successor nodes.

Q2: If not, is this a complete or incomplete market?

Solution: Complete, because we have a unique set of state prices or equivalently a unique equivalent martingale measure. We can check this by confirming that each embedded one-period model has a payoff matrix of full rank.

Q3: Compute the state prices in this model.

Solution: First compute (how?) the prices at date 1 of  $1 to be paid in each of the terminal states at date 2. These are the state prices at date 1, \pi_1^{\{2\}}$ , and we find

$$
\begin{array}{l} \pi_{1}^{\{2\}} \left(\omega_{1}\right) = .2, \pi_{1}^{\{2\}} \left(\omega_{2}\right) = .3 \text{ and } \pi_{1}^{\{2\}} \left(\omega_{3}\right) = 0.4346 \text{ at } I_{1}^{1,2,3} \\ \pi_{1}^{\{2\}} (\omega_{4}) = .3, \pi_{1}^{\{2\}} (\omega_{5}) = .3 \text{ and } \pi_{1}^{\{2\}} (\omega_{6}) = 0.3524 \text{ at } I_{1}^{4,5,6} \\ \pi_{1}^{\{2\}} (\omega_{7}) = .25, \pi_{1}^{\{2\}} (\omega_{8}) = .4 \text{ and } \pi_{1}^{\{2\}} (\omega_{9}) = 0.3209 \text{ at } I_{1}^{7,8,9} \\ \end{array}
$$

The value at date 0 of \$1 at nodes  $I_1^{1,2,3}$ ,  $I_1^{4,5,6}$  and  $I_1^{7,8,9}$ , respectively, is given by

$$
\pi_{0}^{\{1\}} (I_{1}^{1,2,3}) = .3, \pi_{0}^{\{1\}} (I_{1}^{4,5,6}) = .3 \text{ and } \pi_{0}^{\{1\}} (I_{1}^{7,8,9}) = .3524.
$$

Therefore the state prices at date  $t = 0$  are (why?)

$$
\begin{array}{l} \pi_{0}^{\{2\}} (\omega_{1}) = .06, \pi_{0}^{\{2\}} (\omega_{2}) = .09, \pi_{0}^{\{2\}} (\omega_{3}) = 0.1304, \pi_{0}^{\{2\}} (\omega_{4}) = .09, \pi_{0}^{\{2\}} (\omega_{5}) = .09 \\ \pi_{0}^{\{2\}} (\omega_{6}) = 0.1057, \pi_{0}^{\{2\}} (\omega_{7}) = 0.0881, \pi_{0}^{\{2\}} (\omega_{8}) = 0.1410, \pi_{0}^{\{2\}} (\omega_{9}) = 0.1131. \\ \end{array}
$$

We can easily check that these state prices do indeed correctly price (subject to rounding errors) the three securities at date  $t = 0$ .

Q4: Compute the risk-neutral or martingale probabilities when we discount by the cash account, i.e., the zero $^{th}$  security.

Solution: When we deflate by the cash account the risk-neutral probabilities for the nine possible paths at time 0 may be computed using the expression

$$
q_{k} = \frac{\pi_{0}^{\{2\}} \left(\omega_{k}\right) S_{2}^{(0)} \left(\omega_{k}\right)}{\sum \pi_{0}^{\{2\}} \left(\omega_{j}\right) S_{2}^{(0)} \left(\omega_{j}\right)}. \tag{7}
$$

We have not shown that the expression in (7) is in fact correct, though note that it generalizes the one-period expression in (4).

Exercise 9 Check that (7) is indeed correct. (You may do this by deriving it in exactly the same manner as (4). Alternatively, it may be derived by using equation (4) to compute the risk-neutral probabilities of the embedded one-period models and multiplying them appropriately to obtain the  $q_{k}$ 's. Note that the risk-neutral probabilities in the one-period models are conditional risk-neutral probabilities of the multi-period model.)

We therefore have

<table><tr><td>q1</td><td>q2</td><td>q3</td><td>q4</td><td>q5</td><td>q6</td><td>q7</td><td>q8</td><td>q9</td></tr><tr><td>0.0674</td><td>0.1011</td><td>0.1465</td><td>0.0992</td><td>0.0992</td><td>0.1165</td><td>0.0953</td><td>0.1525</td><td>0.1223</td></tr></table>

Q5: Compute the risk-neutral probabilities (i.e. the martingale measure) when we discount by the second security.

Solution: Similarly, when we deflate by the second asset, the risk-neutral probabilities are given by:

<table><tr><td>q1</td><td>q2</td><td>q3</td><td>q4</td><td>q5</td><td>q6</td><td>q7</td><td>q8</td><td>q9</td></tr><tr><td>0.0282</td><td>0.1267</td><td>0.1224</td><td>0.1267</td><td>0.0845</td><td>0.0992</td><td>0.0414</td><td>0.2647</td><td>0.1062</td></tr></table>

Q6: Using the state prices, find the price of a call option on the first asset with strike  $k = 2$  and expiration date  $t = 2$ .

Solution: The payoffs of the call option and the state prices are given by:

<table><tr><td>State</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td></tr><tr><td>Payoff</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>2</td><td>0</td><td>3</td></tr><tr><td>State Price</td><td>.06</td><td>.09</td><td>.1304</td><td>.09</td><td>.09</td><td>.1057</td><td>.0881</td><td>.1410</td><td>.1131</td></tr></table>

The price of the option is therefore (why?) given by  $.1057 + (2 \times .0881) + (3 \times .1131) = .6212$ .

Q7: Confirm your answer in (6) by recomputing the option price using the martingale measure of (5).

Solution: Using the risk-neutral probabilities when we deflate by the second asset we have:

<table><tr><td>State</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td></tr><tr><td>Deflated Payoff</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1/2</td><td>2/1</td><td>0</td><td>3/2</td></tr><tr><td>Risk-Neutral Probabilities</td><td>0.0282</td><td>0.1267</td><td>0.1224</td><td>0.1267</td><td>0.0845</td><td>0.0992</td><td>0.0414</td><td>0.2647</td><td>0.1062</td></tr></table>

The price of the option deflated by the initial price of the second asset is therefore given by  $(.0992 \times .5) + (2 \times .0414) + (3/2) \times .1062 = .2917$ . And so the option price is given by  $.2917 \times 2.1303 = .6214$ , which is the same answer (modulo rounding errors) as we obtained in (6).

In Example 9 we computed the option price by working directly from the date  $t = 2$  payoffs to the date  $t = 0$  price. Another method for pricing derivative securities is to iterate the price backwards through the tree. That is we first compute the price at the date  $t = 1$  nodes and then use the date  $t = 1$  price to compute the date  $t = 0$  price. This technique of course, is also implemented using the risk-neutral probabilities or equivalently, the state prices.

Exercise 10 Repeat Question 6 of Example 9, this time using dynamic programming to compute the option price.

Remark 5 While  $R_{t}$  was stochastic in Example 9, we still refer to it as a risk-free interest rate. This interpretation is valid since we know for certain at date  $i$  the date  $i + 1$  value of \$1 invested in the cash account at date  $i$ .

## Example 10 (An Incomplete Market)

Consider the same tree as in Example 9 only now state  $\omega_{6}$  is a successor state to node  $I_1^{6,7,8,9}$  instead of node  $I_1^{4,5}$ . We have also changed the payoff of the zero $^{th}$  asset in this state so that our interpretation of the the zero $^{th}$  asset as a cash account remains appropriate. The new tree is displayed below:

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/81eed407-f821-46d1-9a20-f1422fe8617e/aaf276e7864ce2293b1c765436dd62b63067007afa62b7607700c81f3718960b.jpg)

## Q1: Is this model arbitrage free?

Solution: We know the absence of arbitrage is equivalent to the existence of positive state prices or, equivalently, risk-neutral probabilities. Moreover, if the model is arbitrage free then so is every one-period sub-market so all we need to do is see if we can construct positive state prices for each of the four one-period markets represented by the nodes  $I_1^{1,2,3}$ ,  $I_1^{4,5}$ ,  $I_1^{6,7,8,9}$  and  $I_0$ .

First, it is clear that the one-period market beginning at  $I_1^{1,2,3}$  is arbitrage-free since this is the same as the corresponding one-period model in Example 9. For the subproblem beginning at  $I_1^{6,7,8,9}$  we can take (check)  $[\pi_1^{\{2\}}(\omega_6)\pi_1^{\{2\}}(\omega_7)\pi_1^{\{2\}}(\omega_8)\pi_1^{\{2\}}(\omega_9)] = [0.07370.19100.37050.3357]$  so this sub-market is also arbitrage free. (Note that other vectors will also work.)

However, it is not possible to find a state price vector,  $\left[\pi_1^{\{2\}}(\omega_4)\pi_1^{\{2\}}(\omega_5)\right]$ , for the one-period market beginning at  $I_1^{4,5}$ . In particular, this implies there is an arbitrage opportunity there and so we can conclude<sup>13</sup> that the model is not arbitrage-free.

Q2: Suppose the prices of the three securities were such that there were no arbitrage opportunities. Without bothering to compute such prices, do you think the model would then be a complete or incomplete model?

Solution: The model is incomplete as the rank of the payoff matrix in the one-period model beginning at  $I_1^{6,7,8,9}$

is less than 4.

Q3: Suppose again that the security prices were such that there were no arbitrage opportunities. Give a simple argument for why forward contracts are attainable. (We can therefore price them in this model.)

Solution: This is left as an exercise. (However we will return to this issue and the pricing of futures contracts in Section 5.2.)

Exercise 11 Find an arbitrage opportunity in the one-period model beginning at node  $I_1^{4,5}$  in Example 10.

## 4 Dividends and Intermediate Cash-Flows

Thus far, we have assumed that none of the securities pay intermediate cash-flows. An example of such a security is a dividend-paying stock. This is not an issue in the single period models since any such cash-flows are captured in the date  $t = 1$  value of the securities. For multi-period models, however, we sometimes need to explicitly model these intermediate cash payments. All of the results that we have derived in these notes still go through, however, as long as we make suitable adjustments to our price processes and are careful with our bookkeeping. In particular, deflated cumulative gains processes rather than deflated security prices are now  $Q$ -martingales. The cumulative gain process,  $G_{t}$ , of a security at time  $t$  is equal to value of the security at time  $t$  plus accumulated cash payments that result from holding the security.

Consider our discrete-time, discrete-space framework where a particular security pays dividends. Then if the model is arbitrage-free there exists an EMM,  $Q$ , such that

$$
\overline{S}_{t} = \mathrm{E}_{t}^{Q} \left[ \sum_{j=t+1}^{t+s} \overline{D}_{j} + \overline{S}_{t+s} \right]
$$

where  $D_{j}$  is the time  $j$  dividend that you receive if you hold one unit of the security, and  $S_{t}$  is its time  $t$  ex-dividend price. This result is easy to derive using our earlier results. All we have to do is view each dividend as a separate security with  $S_{t}$  then interpreted as the price of the portfolio consisting of these individual securities as well as a security that is worth  $S_{t+s}$  at date  $t+s$ . The definitions of complete and incomplete markets are unchanged and the associated results we derived earlier still hold when we also account for the dividends in the various payoff matrices. For example, if  $\theta_{t}$  is a self-financing strategy in a model with dividends then  $V_{t}$ , the corresponding value process, should satisfy

$$
V_{t+1} - V_{t} = \sum_{i=0}^{N} \theta_{t+1}^{(i)} \left(S_{t+1}^{(i)} + D_{t+1}^{(i)} - S_{t}^{(i)}\right). \tag{8}
$$

Note that the time  $t$  dividends,  $D_{t}^{(i)}$ , do not appear in (8) since we assume that  $V_{t}$  is the value of the portfolio just after dividends have been paid. This interpretation is consistent with taking  $S_{t}$  to be the time  $t$  ex-dividend price of the security.

The various definitions of complete and incomplete markets, state prices, arbitrage etc. are all unchanged when securities can pay dividends. As mentioned earlier, the First Fundamental Theorem of Asset Pricing now states that deflated cumulative gains processes rather than deflated security prices are now  $Q$ -martingales. The second fundamental theorem goes through unchanged.

## 4.1 Using a Dividend-Paying Security as the Numeraire

Until now we have always assumed that the numeraire security does not pay any dividends. If a security pays dividends then we cannot use it as a numeraire. Instead we can use the security's cumulative gains process as

the numeraire as long as this gains process is strictly positive. This makes intuitive sense as it is the gains process that represents the true value dynamics of holding the security.

In continuous-time models of equities it is common to assume that the equity pays a continuous dividend yield of  $q$  so that  $qS_{t}dt$  represent the dividend paid in the time interval  $(t, t + dt]$ . The cumulative gains process corresponding to this stock price is then  $G_{t} \coloneqq e^{qt}S_{t}$  and it is this quantity that can be used as a numeraire.

## 5 Applications of Martingale Pricing

We now consider applying what we know about martingale pricing to the binomial model as well as the general pricing of forwards and futures.

## 5.1 Pricing in the Binomial Model

The binomial model is a discrete-time, discrete space model that describes the price evolution of a single risky stock that does not pay dividends. If the stock price at the beginning of a period is  $S$  then it will either increase to  $uS$  or decrease to  $dS$  at the beginning of the next period. In the model below we have set  $S_0 = 100$ ,  $u = 1.06$  and  $d = 1 / u$ .

The binomial model assumes that there is also a cash account available that earns risk-free interest at a gross rate of  $R$  per period. We assume  $R$  is constant $^{14}$  and that the two securities (stock and cash account) may be purchased or sold short. We let  $B_{k} = R^{k}$  denote the value at time  $k$  of \$1 that was invested in the cash account at date 0.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/81eed407-f821-46d1-9a20-f1422fe8617e/25b66f466973b9907b37bbe6722b1a9f35d9513d1a48c0a799f09ce8d01a4a7e.jpg)

We have the following result which we will prove using martingale pricing. It is also possible to derive this result using replicating<sup>15</sup> arguments.

Proposition 13 The binomial model is arbitrage-free if and only if

$$
\boxed {d <   R <   u.} \tag {9}
$$

Proof: The first fundamental theorem of asset pricing states that there is no arbitrage in any of the embedded one-period models at time  $t$  if and only if there exists a  $q$  satisfying  $0 < q < 1$  such that

$$
\begin{array}{l} {\frac{S_{t}}{R^{t}}} = {\mathrm{E}_{t}^{Q} \left[ \frac{S_{t+1}}{R^{t+1}} \right]} \\ = q \frac{u S_{t}}{R^{t+1}} + (1 - q) \frac{d S_{t}}{R^{t+1}}. \tag{10} \\ \end{array}
$$

Solving (10), we find that  $q = (R - d) / (u - d)$  and  $1 - q = (u - R) / (u - d)$ . The result now follows since each of the embedded one-period models in the binomial model are identical.

Note that the  $q$  we obtained in the above Proposition was both unique and node independent. Therefore the binomial model itself is arbitrage-free and complete $^{16}$  if (9) is satisfied and we will always assume this to be the case. We will usually use the cash account,  $B_{k}$ , as the numeraire security so that the price of any security can be computed as the discounted expected payoff of the security under  $Q$ . Thus the time  $t$  price of a security $^{17}$  that is worth  $X_{T}$  at time  $T$  (and does not provide any cash flows in between) is given by

$$
X_{t} = B_{t} \mathrm{E}_{t}^{Q} \left[ \frac{X_{T}}{B_{T}} \right] = \frac{1}{R^{T-t}} \mathrm{E}_{t}^{Q} [ X_{T} ]. \tag{11}
$$

The binomial model is one of the workhorses of financial engineering. In addition to being a complete model, it is also recombining. For example, an up-move followed by a down-move leads to the same node as a down-move followed by an up-move. This recombining feature implies that the number of nodes in the tree grows linearly with the number of time periods rather than exponentially. This leads to a considerable gain in computational efficiency when it comes to pricing path-independent securities.

## Example 11 (Pricing a Call Option)

Compute the price of a European call option on the security of Figure 1 with expiration at  $T = 3$ , and strike  $K = 95$ . Assume also that  $R = 1.02$ .

Solution: First, we find  $q = \frac{R - d}{u - d} = \frac{1.02 - 1.06^{-1}}{1.6 - 1.06^{-1}} = 0.657$  which is the  $Q$ -probability of an up-move. If  $C_0$  denotes the date 0 price of the option then (11) implies that it is given by

$$
C_{0} = \frac{1}{R^{3}} \mathrm{E}_{0}^{Q} \left[ C_{T} \right] = \frac{1}{R^{3}} \mathrm{E}_{0}^{Q} [ \max(0, S_{3} - 95) ]. \tag{12}
$$

At this point, there are two possible ways in which we can proceed:

(i) Compute the  $Q$ -probabilities of the terminal nodes and then use (12) to determine  $C_0$ . This method does not bother to compute the intermediate prices,  $C_t$ .  
(ii) Alternatively, we can work backwards in the tree one period at a time to find  $C_t$  at each node and at each time  $t$ .

<table><tr><td colspan="4">Stock Price</td><td colspan="4">European Option Price</td></tr><tr><td></td><td></td><td>119.10</td><td></td><td></td><td></td><td>24.10</td><td></td></tr><tr><td></td><td>112.36</td><td>106.00</td><td></td><td></td><td>19.22</td><td>11.00</td><td></td></tr><tr><td rowspan="2">100.00</td><td>106.00</td><td>94.34</td><td></td><td>14.76</td><td>7.08</td><td>0.00</td><td></td></tr><tr><td>94.34</td><td>89.00</td><td>83.96</td><td>11.04</td><td>4.56</td><td>0.00</td><td>0.00</td></tr><tr><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td></tr></table>

For example in the European option price table above, we see that  $14.76 = \frac{1}{R} (q(19.22) + (1 - q)(7.08))$ , i.e., the value of the option at any node is the discounted expected value of the option one time period ahead. This is just restating the  $Q$ -martingale property of discounted security price processes. We find that the call option price at  $t = 0$  is given by \$11.04.

## Example 12 (A Counter-Intuitive Result)

Consider the same option-pricing problem of Example 11 except that we now take  $R = 1.04$ . We then obtain a European call option price of 15.64 as may be seen from the lattices given below. Note that this price is greater than the option price, 11.04, that we obtained in Example 11.

<table><tr><td colspan="4">Stock Price</td><td colspan="4">European Option Price</td></tr><tr><td></td><td></td><td>119.10</td><td></td><td></td><td></td><td>24.10</td><td></td></tr><tr><td></td><td>112.36</td><td>106.00</td><td></td><td></td><td>21.01</td><td>11.00</td><td></td></tr><tr><td rowspan="2">100.00</td><td>106.00</td><td>94.34</td><td></td><td>18.19</td><td>8.76</td><td>0.00</td><td></td></tr><tr><td>94.34</td><td>89.00</td><td>83.96</td><td>15.64</td><td>6.98</td><td>0.00</td><td>0.00</td></tr><tr><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td></tr></table>

This observation seems counterintuitive: after all, we are dealing only with positive cash flows, the values of which have not changed, i.e. the option payoffs upon expiration at  $t = 3$  have not changed. On the other hand, the interest rate that is used to discount cash flows has increased in this example and so we might have expected the value of the option to have decreased. What has happened? (Certainly this situation would never have occurred in a deterministic world!)

First, from a purely mechanical viewpoint we can see that the risk-neutral probabilities have changed. In particular, the risk-neutral probability of an up-move,  $q = (R - d) / (u - d)$ , has increased since  $R$  has increased. This means that we are more likely to end up in the higher-payoff states. This increased likelihood of higher payoffs more than offsets the cost of having a larger discount factor and so we ultimately obtain an increase in the option value.[18]

This, however, is only one aspect of the explanation. It is perhaps more interesting to look for an intuitive explanation as to why  $q$  should increase when  $R$  increases. You should think about this!

## 5.2 Computing Futures Prices

We consider a general discrete-time, discrete-space financial market. For ease of exposition we will assume that the market is complete<sup>19</sup> and that none of the securities pay dividends. We will also assume that the numeraire security is the cash account with time  $k$  value,  $B_{k}$ .

Let  $F_{k}$  be the date  $k$  price of a futures contract written on a particular underlying security. We assume that the contract expires after  $n$  periods and we let  $S_{k}$  denote the time  $k$  price of the security. Then we know that  $F_{n} = S_{n}$ , i.e., at expiration the futures price and the security price must coincide. We can compute the futures price at  $t = n - 1$  by recalling that anytime we enter a futures contract, the initial value of the contract is 0. Martingale pricing therefore implies that the date  $t = n - 1$  futures price,  $F_{n - 1}$ , must satisfy

$$
0 = \mathrm{E}_{n-1}^{Q} \left[ \frac{F_{n} - F_{n-1}}{B_{n}} \right].
$$

Since  $B_{n}$  and  $F_{n-1}$  are both known at date  $t = n - 1$ , we therefore have  $F_{n-1} = \mathrm{E}_{n-1}^{Q}[F_{n}]$ . By the same argument, we also have more generally that  $F_{k} = \mathrm{E}_{k}^{Q}[F_{k+1}]$  for  $0 \leq k < n$ . We can then use the law of iterated expectations to see that  $F_{0} = \mathrm{E}_{0}^{Q}[F_{n}]$ , implying in particular that the futures price process is a martingale. Since  $F_{n} = S_{n}$  we also obtain

$$
F_{0} = \mathrm{E}_{0}^{Q} \left[ S_{n} \right]. \tag{13}
$$

Exercise 12 What property of the cash account did we use in deriving (13)? (Note as a result that (13) only holds when  $Q$  is the EMM corresponding to taking the cash account as numeraire.)

Exercise 13 Does (13) change if the underlying security pays dividends? You can assume that  $S_{i}$  is then the ex-dividend price of the security at time  $i$ .

## 5.3 Computing Forward Prices

Now let us consider the date 0 price,  $G_0$ , of a forward contract for delivery of the security at the same date,  $t = n$ . We recall that  $G_0$  is chosen in such a way that the contract is initially worth zero. In particular, martingale pricing implies

$$
0 = \mathrm{E}_{0}^{Q} \left[ \frac{S_{n} - G_{0}}{B_{n}} \right].
$$

Rearranging terms and using the fact that  $G_{0}$  is known at date  $t = 0$  we obtain

$$
G_{0} = \frac{\mathrm{E}_{0}^{Q} \left[ S_{n} / B_{n} \right]}{\mathrm{E}_{0}^{Q} \left[ 1 / B_{n} \right]}. \tag{14}
$$

Remark 6 Note that (14) holds regardless of whether or not the underlying security pays dividends or coupons or whether there are costs associated with storing the security. (Storage costs may be viewed as negative dividends.) Dividends (or other intermediate cash-flows) influence  $G_{0}$  through the evaluation of  $\mathrm{E}_0^Q [S_n / B_n]$ .

Remark 7 If the underlying security does not pay dividends then we obtain  $G_0 = S_0 / \mathrm{E}_0^Q [1 / B_n]$ . This is consistent with the expression,  $S / d(0,n)$ , that was given in the Primer on Forwards, Futures and Swaps lecture notes. This is clear since  $\mathrm{E}_0^Q [1 / B_n]$  is the time 0 value of \$1 at time n and this, by definition, is equal to  $d(0,n)$ .

Exercise 14 If the underlying security does pay dividends (or have storage costs) then show that the expression in (14) is consistent with the expression given in the Primer on Forwards, Futures and Swaps lecture notes.

We are also in a position now to identify when forwards and futures price coincide. In particular, if we compare (14) with (13) then we immediately obtain the following result.

Theorem 14 If  $B_{n}$  and  $S_{n}$  are  $Q$ -independent, then  $G_{0} = F_{0}$ . In particular, if interest rates are deterministic, we have  $G_{0} = F_{0}$ .

Corollary 1 In the binomial model with a constant (or deterministic) gross interest rate,  $R$ , we must have  $G_0 = F_0$ .

Exercise 15 In practice, interest rates are stochastic and often tend to be positively correlated with movements in the stock market. In such circumstances, convince yourself by considering (13) and (14) that the futures price,  $F_0$ , will generally be greater than the forward price,  $G_0$ , when the underlying security is an equity index such as the S&P500.

## Example 13 (American Options on Futures)

Consider the commodity price lattice below where  $u = 1.03$  and  $d = .98$ . If we assume  $R = 1.01$  per period and that there are no storage costs, then we easily find that the risk-neutral probabilities of an up-move and down-move are given by  $q = .6$  and  $1 - q = .4$ , respectively.

<table><tr><td colspan="7">Commodity Price</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>119.41</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td>115.93</td><td>113.61</td><td></td></tr><tr><td></td><td></td><td></td><td>112.55</td><td>110.30</td><td>108.09</td><td></td></tr><tr><td></td><td></td><td>109.27</td><td>107.09</td><td>104.95</td><td>102.85</td><td></td></tr><tr><td></td><td>103.00</td><td>106.09</td><td>103.97</td><td>101.89</td><td>99.85</td><td>97.85</td></tr><tr><td>100.00</td><td>98.00</td><td>96.04</td><td>94.12</td><td>92.24</td><td>90.39</td><td>88.58</td></tr><tr><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td><td>t=4</td><td>t=5</td><td>t=6</td></tr></table>

We will use  $S_{k}$  to denote the commodity price at time  $k$  and assume that a futures contract on the commodity exists and that it expires after six periods. We wish to compute the futures price lattice and we can do this in a number of different (though essentially equivalent) ways. The method we choose is to use our earlier observation that any time time  $k$ ,  $0 \leq k \leq 6$ , the futures price,  $F_{k}$  satisfies  $F_{k} = \mathrm{E}_{k}^{Q}[S_{6}]$  where  $Q$  is the EMM corresponding to the cash account as numeraire. But  $\mathrm{E}_{k}^{Q}[S_{6}] = R^{6 - k}S_{k}$  (why?) and so we have

$$
F_{k} = R^{6-k} S_{k}.
$$

For example,  $F_0 = R^6 S_0 = (1.01^6)100 = 106.15$  and the futures prices at all times may be computed this way. We obtain the futures price lattice below.

<table><tr><td colspan="7">Futures Price</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>117.09</td><td>113.61</td></tr><tr><td></td><td></td><td></td><td>114.81</td><td>111.40</td><td>108.09</td><td></td></tr><tr><td></td><td></td><td>112.58</td><td>109.24</td><td>105.99</td><td>102.85</td><td></td></tr><tr><td></td><td>108.25</td><td>107.12</td><td>103.94</td><td>100.85</td><td>97.85</td><td></td></tr><tr><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td><td>t=4</td><td>t=5</td><td>t=6</td></tr></table>

Suppose now that we wish to find the price of an American put option with the futures price as the underlying security. If we assume that the option expires at the same time as the futures contract, i.e. after 6 periods, and the strike is \$105, then we obtain the price lattice below for the option. In particular, we obtain an initial price of \$2 as seen in the lattice below.

<table><tr><td colspan="7">Price of American Put Option on Futures Contract</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>0.00</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>0.00</td><td>0.00</td></tr><tr><td></td><td></td><td></td><td></td><td>0.00</td><td>0.00</td><td>0.00</td></tr><tr><td></td><td></td><td></td><td>0.13</td><td>0.34</td><td>0.85</td><td>2.15</td></tr><tr><td></td><td></td><td>0.50</td><td>1.05</td><td>2.15</td><td>4.15</td><td>7.15</td></tr><tr><td></td><td>1.12</td><td>2.09</td><td>3.70</td><td>6.11</td><td>9.05</td><td>11.90</td></tr><tr><td>2.00</td><td>3.37</td><td>5.38</td><td>8.03</td><td>10.91</td><td>13.70</td><td>16.42</td></tr><tr><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td><td>t=4</td><td>t=5</td><td>t=6</td></tr></table>

## Appendix A: Finding State Price Vectors

In Example 2 we saw that  $\left[\pi_1\pi_2\pi_3\pi_4\right]^\top = \left[0.24330.11560.31400.3168\right]^\top$  was a vector of state prices for the security market of that example. In particular, it satisfied  $S_{1}^{\top}\pi = S_{0}$ , that is

$$
\left[ \begin{array}{c c c c} 1.03 & 1.03 & 1.03 & 1.03 \\ 3.00 & 4.00 & 2.00 & 5.00 \\ 2.00 & 1.00 & 4.00 & 2.00 \end{array} \right] \left[ \begin{array}{c} 0.2433 \\ 0.1156 \\ 0.3140 \\ 0.3168 \end{array} \right] = \left[ \begin{array}{c} 1.0194 \\ 3.4045 \\ 2.4917 \end{array} \right]
$$

where  $S_0$  was the vector of date 0 security prices, and  $S_1^\top$  was the matrix of date 1 security prices. How did we find such a vector  $\pi$ ?

Consider the equation  $Ax = b$  where  $A$  is a known  $m \times n$  matrix and  $b$  is a known  $m \times 1$  vector. We would like to solve this equation for the vector  $x$ . There may be no solution, infinitely many solutions or a unique solution. If more than one solution exists so that  $Ax_{1} = Ax_{2} = b$  with  $x_{1} \neq x_{2}$  then  $y := x_{1} - x_{2}$  is an element of the nullspace of  $A$ . That is  $Ay = 0$ . In particular, any solution to  $Ax = b$  can be written as the sum of a particular solution,  $x_{1}$ , and an element,  $w$ , of the nullspace.

How do we apply this to finding a vector of positive state prices, assuming such a vector exists. First try and find a particular solution. In Matlab, for example, this can be done $^{20}$  by using the matrix divide command "\":

```html
>>x1=S1' \S0   
 $\mathrm{x1} =$  0 0.3102 0.4113 0.2682
```

We then find the nullspace $^{21}$  of  $S1^{\top}$  by using the "null" command:

```txt
>>w  $\equiv$  null(S1')   
 $\mathbf{W} =$  0.7372 -0.5898 -0.2949 0.1474
```

Now every possible solution to  $S_1^\top \pi = S_0$  can be written as

$$
\left[ \begin{array}{c} \pi_{1} \\ \pi_{2} \\ \pi_{3} \\ \pi_{4} \end{array} \right] = \left[ \begin{array}{c} 0 \\ 0.3102 \\ 0.4113 \\ 0.2682 \end{array} \right] + \epsilon \left[ \begin{array}{c} 0.7372 \\ -0.5898 \\ -0.2949 \\ 0.1474 \end{array} \right]
$$

where  $\epsilon$  is any real number. We just need to find an  $\epsilon$  such that the solution is strictly positive. If no such epsilon exists, then there is no vector of state prices. We chose  $\epsilon = .33$  in our example.

## Appendix B: Optimal Stopping and Pricing American Options

An American option on a security gives the holder of the option the right to exercise it at any date on or before the expiration date,  $T$ . An exercise strategy,  $\tau$ , is a rule specifying when the option should be exercised.

Because  $\tau$  can depend on the evolution of information in the model, it is in general a random variable. However, it should not be possible to base the decision to exercise or not on information that is not yet available. We therefore insist that  $\tau$  is a stopping time.

Let  $V_{t}$  denote the date  $s$  price of an American option that expires at date  $T > t$ . The owner of the option may exercise it any date  $s \in \{t, \dots, T\}$ . If exercised at time  $s$ , the owner of the option then receives  $Y_{s}$ . We assume that markets are complete and that there are no arbitrage opportunities so there exists a unique equivalent martingale measure,  $Q$ , relative to some numeraire security,  $B_{t}$ . We want to determine an expression for  $V_{t}$ .

Theorem 15 (a) Let  $\tau$  denote a generic stopping time and define

$$
Z_{t} := \max_{\tau \in \{t, \dots, T\}} E_{t}^{Q} \left[ \frac{Y_{\tau} B_{t}}{B_{\tau}} \right]. \tag{15}
$$

Then  $Z_{t} / B_{t}$  is the smallest supermartingale satisfying  $Z_{t} \geq Y_{t}$  for all  $t$ . Moreover

$$
\tau^{*} (t) := \min \{s \geq t: Z_{s} = Y_{s} \} \tag{16}
$$

is an optimal stopping time for the optimization problem in (15).  $(Z_{t} / B_{t}$  is known as the Snell Envelope of  $Y_{t} / B_{t}$ .

(b) The American option price,  $V_{t}$ , satisfies  $V_{t} = Z_{t}$  for all  $t \in \{0, \dots, T\}$  and  $\tau^{*}(0)$  is an optimal exercise strategy.

Proof: (a) First note that  $Z_{T} / B_{T} = Y_{T} / B_{T}$ . We can then use (15) and the tower property of conditional expectations to obtain

$$
\frac{Z_{T-1}}{B_{T-1}} = \max \left\{\frac{Y_{T-1}}{B_{T-1}}, E_{T-1}^{Q} \left[ \frac{Z_{T}}{B_{T}} \right] \right\}.
$$

More generally, we can use (15) to obtain

$$
\begin{array}{l} \frac{Z_{t}}{B_{t}} = \max \left\{\frac{Y_{t}}{B_{t}}, \max_{\tau \geq t+1} E_{t}^{Q} \left[ E_{t+1}^{Q} \left[ \frac{Y_{\tau}}{B_{\tau}} \right] \right] \right\} \\ = \max \left\{\frac{Y_{t}}{B_{t}}, E_{t}^{Q} \left[ \max_{\tau \geq t+1} E_{t+1}^{Q} \left[ \frac{Y_{\tau}}{B_{\tau}} \right] \right] \right\} \\ = \max \left\{\frac{Y_{t}}{B_{t}}, E_{t}^{Q} \left[ \frac{Z_{t+1}}{B_{t+1}} \right] \right\}. \tag{17} \\ \end{array}
$$

It then follows $^{22}$  from (17) that  $Z_{t} / B_{t}$  is a supermartingale. Moreover, it is clear that  $Z_{t} \geq Y_{t}$ . Now suppose that  $U_{t} / B_{t}$  is any other supermartingale satisfying  $U_{t} \geq Y_{t}$ . Since  $Z_{T} = Y_{T}$  it is clear that  $Z_{T} \leq U_{T}$ . Moreover, by hypothesis  $U_{t-1}$  clearly satisfies

$$
\frac{U_{t-1}}{B_{t-1}} \geq \max \left\{\frac{Y_{t-1}}{B_{t-1}}, E_{t-1}^{Q} \left[ \frac{U_{t}}{B_{t}} \right] \right\}.
$$

Iterating backwards from  $t = T$  it is clear that  $U_{t} \geq Z_{t}$ .

Finally, in order to prove that  $\tau^{*}(t)$  is an optimal stopping time we argue as follows. Let  $\widehat{\tau}(t) \geq t$  be any optimal policy starting from time  $t$  so that  $Z_{\widehat{\tau}(t)} = Y_{\widehat{\tau}(t)}$  and  $\widehat{\tau}(t) \geq \tau^{*}(t)$ . But then

$$
E_{\tau^{*} (t)}^{Q} \left[ \frac{Y_{\hat{\tau} (t)}}{B_{\hat{\tau} (t)}} \right] \leq \frac{Z_{\tau^{*} (t)}}{B_{\tau^{*} (t)}} = \frac{Y_{\tau^{*} (t)}}{B_{\tau^{*} (t)}}
$$

by (15) and (16). The law of iterated expectations now implies  $E_{t}^{Q}\left[\frac{Y_{\widehat{\tau}(t)}}{B_{\widehat{\tau}(t)}}\right] \leq E_{t}^{Q}\left[\frac{Y_{\tau^{*}(t)}}{B_{\tau^{*}(t)}}\right]$  and the result now follows.  
(b) Note that since markets are complete, we know that  $Y_{\tau}$  is attainable for every stopping time,  $\tau$ . We need to consider two situations: (i)  $V_{t} < Z_{t}$  and (ii)  $V_{t} > Z_{t}$ .  
If (i) prevails, you should purchase the American option at a cost of  $V_{t}$ , adopt the optimal exercise policy,  $\tau^{*}(t)$ , of part (a) and adopt a self-financing trading strategy that is equivalent to selling the security with payoff  $Y_{\tau^{*}(t)}$  at time  $\tau^{*}(t)$ . The initial income from this trading strategy is  $Z_{t} - V_{t}$  and so this clearly leads to arbitrage profits.  
If (ii) prevails, you should sell the option and invest the proceeds appropriately to construct an arbitrage. In particular, you can adopt a super-replicating strategy that super-replicates the payoff at exercise regardless of the exercise policy that is used. The details are left as an exercise but the argument can be made rigorous $^{23}$  by constructing a self-financing strategy that replicates the martingale component of the Doob decomposition of the super-martingale  $Z_{t} / B_{t}$ .

We can use the result of Theorem 15 and in particular, equation (17), to price American options. For example, in the binomial model we can use dynamic programming to compute the optimal strategy. As usual, we will use the cash account (with value  $B_{k}$  at date  $k$ ), as the numeraire security.

## Example 14 (Pricing an American Put Option)

Compute the price of an American put option on the security of Figure 1 with expiration at  $T = 3$ , and strike  $K = 95$ . Assume again that  $R = 1.02$ .

Solution: We know from Example 11 that q = 0.657, and we know the value of the American option at date T = 3. We then work backwards in the tree until we have found Ca, the date t = 0 value of the American option. For example at date t = 2 when the stock price is \$89 we know that the option value is given by

$$
C_{2}^{a} (\$89) = \max \left(K - 89, \frac{1}{R} [ q (.66) + (1 - q) (11.04) ]\right) = K - 89 = 6.
$$

That is, the value of the option at that node is \(6 and it is optimal to exercise the option there. Continuing in this recursive manner, we find that \(C_0^a = \).77.

<table><tr><td colspan="4">Stock Price</td><td colspan="4">American Option Price</td></tr><tr><td></td><td></td><td colspan="2">119.10</td><td></td><td></td><td colspan="2">0.00</td></tr><tr><td></td><td></td><td>112.36</td><td>106.00</td><td></td><td>0.00</td><td colspan="2">0.00</td></tr><tr><td></td><td>106.00</td><td>100.00</td><td>94.34</td><td>0.07</td><td>0.22</td><td colspan="2">0.66</td></tr><tr><td>100.00</td><td>94.34</td><td>89.00</td><td>83.96</td><td>0.77</td><td>2.16</td><td>6.00</td><td>11.04</td></tr><tr><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td></tr></table>

In Example 14 we found that it was sometimes optimal to exercise the option prior to expiration. This raises the interesting question of whether or not there are American options for which it is never optimal to exercise them prior to maturity. We have the following result.

Theorem 16 If interest rates are non-negative, it is never optimal to exercise an American call option on a non-dividend paying security prior to expiration.

Proof: Using the  $Q$ -martingale property of the deflated security price process and the non-negativity of interest rates, we have

$$
\begin{array}{l} \mathrm{E}_{t}^{Q} \left[ (S_{t+s} / B_{t+s} - K / B_{t+s})^{+} \right] \geq \mathrm{E}_{t}^{Q} \left[ S_{t+s} / B_{t+s} - K / B_{t+s} \right] \\ = S_{t} / B_{t} - K \mathrm{E}_{t}^{Q} [ 1 / B_{t+s} ] \\ \geq S_{t} / B_{t} - K / B_{t}. \\ \end{array}
$$

Since it is also the case that  $(S_{t + s} / B_{t + s} - K / B_{t + s})^{+}\geq 0$  , we therefore also have

$$
\mathrm{E}_{t}^{Q} \left[ (S_{t+s} / B_{t+s} - K / B_{t+s})^{+} \right] \geq (S_{t} / B_{t} - K / B_{t})^{+}.
$$

That is,  $(S_{t} / B_{t} - K / B_{t})^{+}$  is a sub-martingale. Now the Optional Sampling Theorem for sub-martingales states that if  $Y_{t}$  is a sub-martingale and  $\tau \leq T$  is a stopping time, then  $\mathrm{E}_0^Q [Y_\tau ]\leq \mathrm{E}_0^Q [Y_T]$ . If we apply this result to  $(S_{t} / B_{t} - K / B_{t})^{+}$  and recall that the price,  $C_0^a$ , of the American option is given by

$$
C_{0}^{a} = \max_{\tau} \operatorname{E}_{0}^{Q} \left[ (S_{\tau} / B_{\tau} - K / B_{\tau})^{+} \right]
$$

we see that  $C_0^a = \mathrm{E}_0^Q\left[(S_T / B_T - K / B_T)^+\right]$  and it is never optimal to exercise early.

Remark 8 Note that if the security paid dividends in  $[0, T]$ , then  $S_{t} / B_{t}$  would not be a  $Q$ -martingale and the above proof would not go through. The result generalizes to other types of American options where the underlying security,  $S_{t}$ , again does not pay dividends in  $[0, T]$ , and where the payoff function is a convex function of  $S$ . The proof is similar and relies on the application of Jensen's Inequality.

## Exercises

1. Referring to Examples 1 and 2, show that

$$
\left[ \begin{array}{c} \pi_{1} \\ \pi_{2} \\ \pi_{3} \\ \pi_{4} \end{array} \right] = \left[ \begin{array}{c} 0 \\ 0.3102 \\ 0.4113 \\ 0.2682 \end{array} \right] + \epsilon \left[ \begin{array}{c} 0.7372 \\ -0.5898 \\ -0.2949 \\ 0.1474 \end{array} \right]
$$

is also a vector of state prices for any  $\epsilon$  such that  $\pi_i > 0$  for  $1\leq i\leq 4$

2. What elementary securities are attainable in the model of Example 1? Is this model complete or incomplete? Explain your answer.
3. The single-period model of Example 7 is a complete market. Find the replicating portfolio for each of the elementary securities.
4. (a) Referring to Example 7, find a set of risk-neutral probabilities for the case where we take the  $2^{nd}$  security as numeraire. (Recall that the cash account is the  $0^{th}$  security so the  $2^{nd}$  security is the security with price 2.4917 at date  $t = 0$ .)

(b) Are these risk-neutral probabilities unique? Explain your answer.  
(c) Would we get the same set of risk-neutral probabilities if we used a different numeraire?

5. Do Exercise 7.  
6. Do Exercise 8. That is, prove Proposition 11.  
7. Suppose we find ourselves at node  $I_1^{6,7,8,9}$  at  $t = 1$  in Example 10. The one-period model beginning at this node is incomplete and so not every security is attainable. Is a call option on the second security with strike  $k = 2$  attainable? If so, what is the price of this call option? If not, can you bound the price of the option, i.e. find bounds on the option price that must be satisfied if there is to be no arbitrage?  
8. Referring to Example 9, compute the date  $t = 0$  value of a European style option that expires at  $t = 2$  with a payoff function given by  $\max \left(0, S_2^{(1)} - S_2^{(2)} - 1\right)$ .  
9. Find the replicating portfolio for the contingent claim  $X = \max \left(0, S_2^{(1)} - S_2^{(2)} - 1\right)$ , i.e. the option of the previous question.  
 10. Consider an equity swap based on the first security of Example 9. (Recall that the securities are numbered 0, 1 and 2 so that the first security refers to the security whose value at node I,,, for example, is 1.4346.) Party A is long the swap and receives \$100  S_t^(1) from party B at dates t = 1 and t = 2. In return, party B is short the swap and receives $M at dates t = 1 and t = 2 from party A. Compute the value of the swap at t = 0 and determine what value of M will make the swap worth 0 at t = 0. (Note that you may answer this question using either the state prices or the unique EMM, Q, that corresponds to your choice of numeraire security.)  
11. Find the price of an American put option on the second security of Example 9. Assume the strike is  $k = 3$  and expiration is  $T = 2$ .
12. Compute the date  $t = 0$  price of a forward contract for delivery at date  $T = 2$  of the second security in Example 9.
13. Compute the date  $t = 0$  price of a futures contract that expires at  $T = 2$  on the second security in Example 9. Is the futures price different to the forward price? Are you surprised?
14. (Futures Prices and Incomplete Markets) Referring to Example 10, suppose we changed the payoffs of the  $1^{st}$  and  $2^{nd}$  securities in states  $\omega_4$  and  $\omega_5$  so that the model was arbitrage-free. (By leaving the payoff of the  $0^{th}$  security unchanged at 1.1025 in those states, we maintain its interpretation as the cash account.) Now recall that this model is incomplete, implying in particular that there does not exist a unique EMM,  $Q$ .

(a) Show that equation (13), i.e.  $F_0 = \mathsf{E}_0^Q [S_n]$  where  $F_0$  is the time 0 futures price, still holds, irrespective of which  $Q$  we use. In particular, conclude that a unique arbitrage-free futures price process is computable. (Note that equation (13) only holds when we take the cash account as numeraire so when we say "irrespective of which  $Q$  we use" it is implicit that we always have the cash account as the numeraire.)  
(b) Give an example of a two-period financial market where a unique arbitrage-free futures price process on a particular underlying security does not exist.

15. (Put-Call Parity) Show that the time  $t$  European call and put options prices,  $C_t$  and  $P_t$  respectively, satisfy

$$
S_{t} = C_{t} - P_{t} + d(t,T) K \tag{18}
$$

where  $d(t,T)$  is the discount factor for lending between dates  $t$  and  $T$  the expiration date of the options, and  $K$  is the strike of both the call option and the put option. You can assume that the security does not pay any intermediate dividends.

16. (A Surprising Result?) Consider an N-period binomial model for a non-dividend paying stock where the true probability of an up-move in each period is given by p = .5. The initial value of the stock is S0 = \$100. Let C0 denote the time t = 0 price of a European call option on the stock with strike K that expires after N periods. Now suppose that some extremely favorable news about the stock has just been announced so that while S0 still remains at \$100, the probability of an up-move in each period has increased dramatically so that now p = .999. What will happen to C0? Justify your answer. Is this what you would expect in practice? Again, justify your answer.  
17. (Stochastic Discount Factors) Let  $P$  be the true data-generating probability measure and let  $S_{T}$  be the time  $T$  price of a non-dividend-paying security. Show that if there is no arbitrage then the initial security price,  $S_{0}$ , may be represented as  $S_{0} = \mathsf{E}_{0}^{P}[d_{T}S_{T}]$  where  $d_{T}$  is a stochastic discount factor. (Obviously this is true in general for dividend-paying securities.)  
 18. Referring to Example 13, create an Excel spreadsheet to price an American put option on the futures contract with strike K = \$95 and maturity T = 8 periods. (Your spreadsheet should recreate the binomial lattice for the commodity price process, the futures price process and the put option process. You should use input cells for R, S0, K and .)  
19. (Handling Discrete Dividends) A common method of adapting the binomial model to handle discrete dividends is as follows. Let  $S_0$  denote the time  $t = 0$  price of the stock and  $D \coloneqq$  present values of dividends that are paid $^{24}$  between now and option maturity,  $T$ . Let  $X_0 \coloneqq S_0 - D_0$  so that  $X_0$  represents the stochastic component of the stock price. We then build a regular recombining binomial lattice to model the dynamics of  $X_t$ . At each node on the lattice for  $X_t$  we can calculate the stock price as  $S_t = X_t + PV$  (Dividends yet to be paid in  $[t, T]$ ). Options can therefore be priced using this lattice for

$X_{t}$ . (Note that the use of the closed interval  $[t,T]$  rather than  $(t,T]$  implicitly implies the option-holder gets the dividend if the option is exercised at time  $t$  and a dividend is paid at that date.)

Use this method to price a 6-month American call option on a stock with initial value S0 = 100, strike K = 100 and a continuously compounded risk-free rate if r = 5%. You can assume  = 30% for Xt and that the stock pays a dividend of \$5 in 4 months time. A 6-period lattice will suffice. Is the option price the same as the price of the corresponding European option? While this method of handling discrete dividends is often used in practice, it does have some flaws. Can you identify any of them?

20. (A Foreign Currency EMM) Let  $Q^f$  be an EMM for a foreign investor corresponding to some foreign numeraire,  $X^f$  say. Note that  $X_t^f$  is then denominated in units of the foreign currency. Show that  $Q^f$  can also be used as an EMM for a domestic investor. What is the corresponding domestic numeraire? Is the converse also true, i.e., can any domestic EMM also be used as an EMM for a foreign investor?  
21. (Martingale Pricing Theory and the CAPM) Is the Capital Asset Pricing Model (CAPM) consistent with martingale pricing theory? Justify your answer. (Recall that the CAPM is a one-period model which states that the expected return,  $\bar{r}$  say, on any security satisfies  $\bar{r} = r_f + \beta (\bar{r}_m - r_f)$  where  $r_f$  is the risk-free rate,  $\bar{r}_m$  is the expected return on the market portfolio and  $\beta = \mathrm{Cov}(r,r_m) / \mathrm{Var}(r_m)$ .)  
22. (The Knapsack Problem: A Deterministic Dynamic Program) Assume that we have a vessel whose maximum weight capacity is  $z$  and whose cargo is to consist of different quantities of  $N$  different items. Let  $v_{i}$  denote the value of the  $i^{th}$  type of item,  $w_{i}$  the weight of the  $i^{th}$  type of item, and  $x_{i}$  the number of items of type  $i$  that are loaded in the vessel. The problem is to find the most valuable cargo, i.e., to maximize  $\sum_{i=1}^{N} x_{i} v_{i}$  subject to the constraints  $\sum_{i=1}^{N} x_{i} w_{i} \leq z$  and  $x_{i} = 0, 1, 2, \ldots$ . Formulate this problem as a dynamic programming problem.  
23. (Dynamic Portfolio Optimization in Complete Markets) Referring to the model of Example 9, suppose you have a fixed initial wealth,  $W_0 \geq 0$  at  $t = 0$ , and you wish to choose a trading strategy to maximize  $P(W_2 \geq \alpha)$  subject to  $P(W_2 \geq 0) = 1$ . ( $W_2$  is your date  $t = 2$  wealth,  $\alpha > 0$  is a fixed constant and to avoid a trivial solution you should assume  $S_0^{(n)} E_0^Q [\alpha / S_T^{(n)}] > W_0$  where  $S_i^{(n)}$  is the time  $i$  price of the numeraire security.) Explain in detail how you would do this. Note also how your solution can be adapted to handle the case where  $\alpha$  is a stochastic benchmark. (Hint: You will need to solve a dynamic program of the type given in Exercise 22 where each  $X_i$  is either 0 or 1. Why?)