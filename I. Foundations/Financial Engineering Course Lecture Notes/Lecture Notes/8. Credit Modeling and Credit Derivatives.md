---
title: Lecture 8 - Credit Modeling and Credit Derivatives
parent_directory: Financial Engineering Course Lecture Notes
formatted: 2025-12-21 08:40:00 AM
formatter_model: claude-sonnet-4-5-thinking
cli_tool: claude-code
primary_tags:
- credit modeling approaches
- structural credit models
- credit default swaps
- reduced form models
secondary_tags:
- merton model framework
- black cox extension
- kmv methodology
- ratings transition matrices
- cox process models
- intensity based pricing
- default probability estimation
- credit spread calculation
cssclasses: academia
---

# Credit Modeling and Credit Derivatives

In these lecture notes we introduce the main approaches to credit modeling and we will largely follow the excellent development in Chapter 17 of the  $2^{nd}$  edition of Luenberger's Investment Science. In recent years credit modeling has become an extremely important component in the derivatives industry and risk management in general. Indeed the development of credit-default-swaps (CDSs) and other more complex credit derivatives are widely considered to have been one of the contributing factors to the global financial crisis of 2008 and beyond. These notes will also prove useful for studying certain aspects of corporate finance – a topic we will turn to at the end of the course.

## 1 Structural Models

The structural approach to credit modeling began with Merton in 1974 and was based on the fundamental accounting equation

$$

\text{Assets} = \text{Debt} + \text{Equity} \tag{1}
$$


which applies to all firms (in the absence of taxes). This equation simply states the obvious, namely that the asset-value of a firm must equal the value of the firm's debt and the firm's equity. This follows because all of the profits generated by a firm's assets will ultimately accrue to the debt and equity-holders. While more complicated than presented here, the capital structure of a firm is such that debt-holders are more senior than equity holders. That means that in the event of bankruptcy debt-holders must be paid off in full before the equity-holders can receive anything. This insight allowed Merton<sup>1</sup> to write the value of the equity at time  $T$ ,  $E_{T}$ , as a call option on the value of the firm,  $V_{T}$  with strike equal to the face value of the debt,  $D_{T}$ . Merton's model therefore implies

$$

E_{T} = \max\left(0, V_{T} - D_{T}\right) \tag{2}
$$


with default occurring if  $V_{T} < D_{T}$ . Note that (2) implicitly assumes that the firm is wound up at time  $T$  and that default can only occur at that time. These assumptions are not very realistic and have been relaxed in many directions since Merton's original work. Nonetheless, we can gain many insights from working with (2). First of all, we can take  $V_{t}$  to be the value of a traded asset (why?) so that risk-neutral pricing applies. If the firm does not pay dividends then we could assume, for example, that  $V_{t} \sim \mathrm{GBM}(r,\sigma)$  so that  $E_{t}$  is the corresponding Black-Scholes price of a call option with maturity  $T$ , strike  $D_{T}$  and underlying security value  $V_{t}$ . From this we can compute other interesting quantities such as the (risk-neutral) probability of default.

### 1.1 Structural Lattice Models

While closed-form solutions can be obtained for the equity and debt values in Merton's model (as well as the Black-Cox extension we discuss below) it will be convenient to do much of our work in lattice models as they will allow us to concentrate on the financial rather than mathematical aspects of the modeling.

### The Merton Model

We assume the following parameters:  $V_{0} = 1,000$ ,  $T = 7$  years,  $\mu = 15\%$ ,  $\sigma = 25\%$ ,  $r = 5\%$  and the # of time periods  $= 7$ . The face value of the debt is 800 and the coupon on the debt is zero. The first task is to construct the lattice model for  $V_{t}$  and we do this following our usual approach to lattice construction. That is, we take

$\nu = \left(\mu - \frac{\sigma^2}{2}\right)$, $\ln u = \sqrt{\sigma^2 \Delta t + (\nu \Delta t)^2}$, $d = 1/u$ and risk-neutral probability of an up-move $q = (e^{r \Delta t} - d)/(u - d)$  . The resulting lattice of firm values is displayed below with values at time  $T$  corresponding to firm default marked with an asterisk.

Firm Value Lattice  

<table><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>6940.6</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>5262.6</td><td>3990.2</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td>3990.2</td><td>3025.5</td><td>2294.0</td><td></td></tr><tr><td></td><td></td><td></td><td>3025.5</td><td>2294.0</td><td>1739.4</td><td>1318.9</td><td></td></tr><tr><td></td><td></td><td>2294.0</td><td>1739.4</td><td>1318.9</td><td>1000.0</td><td>758.2*</td><td></td></tr><tr><td></td><td>1318.9</td><td>1318.9</td><td>1000.0</td><td>758.2</td><td>574.9</td><td>435.9</td><td>435.9*</td></tr><tr><td>1000.0</td><td>758.2</td><td>574.9</td><td>435.9</td><td>330.5</td><td>250.6</td><td>190.0</td><td>144.1*</td></tr><tr><td>t = 0</td><td>t = 1</td><td>t = 2</td><td>t = 3</td><td>t = 4</td><td>t = 5</td><td>t = 6</td><td>t = 7</td></tr></table>

Now we are ready to price the equity and debt, i.e. corporate bonds, of the firm. We price the equity first by simply viewing it as a regular call option on  $V_{T}$  with strike  $K = 800$  and using the usual risk-neutral backward evaluation approach. The bond or debt price can then be computed similarly or by simply observing that it must equal the difference between the firm-value and equity value at each time and state.

Equity Lattice  

<table><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>6140.6</td></tr><tr><td></td><td></td><td></td><td></td><td>3266.4</td><td></td><td>4501.6</td><td>3190.2</td></tr><tr><td></td><td></td><td></td><td>2336.9</td><td>1570.2</td><td></td><td>2264.5</td><td>1494.0</td></tr><tr><td></td><td></td><td>1640.8</td><td>1054.7</td><td>603.6</td><td></td><td>258.0</td><td>518.9</td></tr><tr><td></td><td rowspan="2">758.6</td><td>1127.8</td><td>687.1</td><td>358.4</td><td>128.3</td><td>0.0</td><td>0.0</td></tr><tr><td></td><td>435.7</td><td>207.1</td><td>63.8</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>499.7</td><td>269.9</td><td>117.4</td><td>31.7</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>t = 0</td><td>t = 1</td><td>t = 2</td><td>t = 3</td><td>t = 4</td><td>t = 5</td><td>t = 6</td><td>t = 7</td></tr></table>

Debt Lattice  

<table><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>800.0</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>761.0</td><td>800.0</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td>723.9</td><td>761.0</td><td>800.0</td><td></td></tr><tr><td></td><td></td><td></td><td>688.6</td><td>723.9</td><td>761.0</td><td>800.0</td><td></td></tr><tr><td></td><td></td><td>653.2</td><td>684.7</td><td>715.3</td><td>742.0</td><td>758.2*</td><td></td></tr><tr><td></td><td rowspan="2">560.3</td><td>611.6</td><td>631.7</td><td>641.6</td><td>630.0</td><td>574.9</td><td>435.9*</td></tr><tr><td></td><td>564.3</td><td>551.1</td><td>511.1</td><td>435.9</td><td>330.5</td><td>250.6*</td></tr><tr><td>500.3</td><td>488.3</td><td>457.5</td><td>404.2</td><td>330.5</td><td>250.6</td><td>190.0</td><td>144.1*</td></tr><tr><td>t = 0</td><td>t = 1</td><td>t = 2</td><td>t = 3</td><td>t = 4</td><td>t = 5</td><td>t = 6</td><td>t = 7</td></tr></table>

We see the initial values of the equity and debt are 499.7 and 500.3, respectively. The credit spread can also be computed as follows. The yield-to-maturity,  $y$ , of the bond satisfies  $500.3 = e^{-yT} \times 800$  which implies

$y = 6.7\%$  . The credit spread2 is then given by  $c = y - r = 1.7\%$  or 170 basis points.

Note that we could also easily compute the true or risk-neutral probability of default by constructing an appropriate lattice. Note that it is also easy to handle coupons. If the debt pays a coupon of  $C$  per period, then we write  $E_{T} = \max (0,V_{T} - D_{T} - C)$  and then in any earlier period we have
$$
E_{t} = \max\left(0, \left[ q E^{u} + (1 - q) E^{d} \right] / R - C\right)
$$


where  $R = e^{r\Delta t}$  and  $E^u$  and  $E^d$  are the two possible successor nodes in the lattice corresponding to up and down-moves, respectively. As before, the debt value at a given node will be given by the difference between the firm and equity values at that node.

### The Black-Cox Model

The Black-Cox model generalizes the Merton model by allowing default to also occur before time  $T$ . In our example we can assume default occurs the first time the firm value falls below the face value of the debt. In that case we can compute the value of the equity by placing 0 in those cells where default occurs and updating other cells using the usual backwards evaluation approach. As before the debt value at a given cell in the lattice is given by the difference between the firm and equity values in that cell. This results in the following equity and debt lattices:

Equity Lattice (Black-Cox)  

<table><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>6140.6</td></tr><tr><td></td><td></td><td></td><td></td><td>3266.4</td><td>4501.6</td><td>3190.2</td><td></td></tr><tr><td></td><td></td><td></td><td>2336.9</td><td>1570.2</td><td>2264.5</td><td>1494.0</td><td></td></tr><tr><td></td><td></td><td>1640.8</td><td>1054.7</td><td>603.6</td><td>258.0</td><td>518.9</td><td></td></tr><tr><td></td><td>703.9</td><td>328.5</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td></td></tr><tr><td>350.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td></td></tr><tr><td>t = 0</td><td>t = 1</td><td>t = 2</td><td>t = 3</td><td>t = 4</td><td>t = 5</td><td>t = 6</td><td>t = 7</td></tr></table>

Debt Lattice (Black-Cox)  

<table><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>800.0</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>761.0</td><td>800.0</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td>688.6</td><td>723.9</td><td>761.0</td><td>800.0</td></tr><tr><td></td><td></td><td></td><td>653.2</td><td>684.7</td><td>715.3</td><td>742.0</td><td>800.0</td></tr><tr><td></td><td></td><td>623.6</td><td>658.2</td><td>699.9</td><td>758.2*</td><td>574.9*</td><td>435.9*</td></tr><tr><td></td><td>614.9</td><td>671.5</td><td>758.2*</td><td>574.9*</td><td>435.9*</td><td>330.5*</td><td>250.6*</td></tr><tr><td>650.0</td><td>758.2*</td><td>574.9*</td><td>435.9*</td><td>330.5*</td><td>250.6*</td><td>190.0*</td><td>144.1*</td></tr><tr><td>t = 0</td><td>t = 1</td><td>t = 2</td><td>t = 3</td><td>t = 4</td><td>t = 5</td><td>t = 6</td><td>t = 7</td></tr></table>

We see that the debt-holders have benefitted from this new default regime with their value increasing from 500.3 to 650. Of course this increase has come at the expense of the equity holders whose value has fallen from 499.7 to 350. In this case the credit spread on the bond is -200 basis points! Negative credit spreads are generally not found in practice but have occurred in this case because the debt holders essentially own a down-and-in call option on the value of the firm with zero strike and barrier equal to the face value of the debt.

The unreasonable value of the credit spread in this case is evidence against the realism of the specific default assumption made here. While it is true that a firm can default at any time, the barrier would generally be much lower than the face value of the long-term debt of 800. Note that we could easily use a different and time-dependent default barrier to obtain a more realistic value of the credit spread.

### Other Structural Models

Structural models are very important in finance both for security pricing<sup>3</sup> purposes as well as for more theoretical purposes where the goal is to answer corporate finance questions such as determining the (optimal) capital structure of the firm. In determining the optimal capital structure of the firm it is important to include other important features such as bankruptcy costs as well as the tax benefits of issuing debt. We may discuss some of these corporate finance questions later in the course. For now we simply note that there have been many refinements and generalizations of the Merton / Black-Cox approach to valuing corporate securities.

### 1.2 The KMV Approach

A particularly successful implementation of structural credit modeling was developed by  $\mathrm{KMV}^4$  and we will now give an overview of their approach. The main difficulty in applying structural models is in identifying the firm value,  $V_{t}$ . In principle, one can observe  $V_{t}$  from the firm's balance sheet data but this process is noisy and very sensitive to assumptions. Instead, KMV inferred  $V_{t}$  from the value of the debt – which is indeed taken from the balance sheet – and the market value of the equity,  $E_{t}$ . Ideally we would infer  $V_{t}$  as the implicit solution to
$$
E_{t} = \mathsf{BS}_{\text{call}}\left(V_{t}, T - t, r, \sigma, K\right) \tag{3}
$$


where  $T$  is taken to be some weighted average, e.g. the duration, of the time-to-maturity of the firm's debt, and the strike,  $K$ , was chosen to be some value between the face value of the short-term debt and the face value of the total debt. But what value of  $\sigma$  should we use in (3)? KMV tackled this problem by taking a time-series of recent equity-value observations,  $E_1, \ldots, E_n$ , and inverting (3) to obtain a time-series of firm valuations,  $V_1 = g(E_1, \sigma), \ldots, V_n = g(E_n, \sigma)$ , where  $g(\cdot)$  is the inverse of  $\mathrm{BS}_{\mathrm{call}}(\cdot)$ . Note that  $V_1, \ldots, V_n$  are functions of the unknown parameter,  $\sigma$ . Assuming  $V_t$  follows a  $\mathrm{GBM}(\mu, \sigma)$  process under the true distribution,  $P$ , we can now use maximum likelihood estimation (MLE) methods to estimate  $(\mu, \sigma)$  (and therefore the time series of firm values,  $V_1, \ldots, V_n$ ).

Once the model had been fitted, we can compute the distance-to-default,  $DD_{t}$ , which is the number of yearly standard deviations, i.e.  $\sigma$ , by which  $\log V_t$  exceeds  $\log K$ . That is
$$
DD_{t} := \frac{\log\left(V_{t} / K\right)}{\sigma}.
$$


One could use the fitted GBM model to compute the so-called expected default frequency (EDF) which is defined to be the probability of the firm defaulting within one year. Instead, however, KMV used their historical database of all firm default events to estimate the function  $f(\cdot)$  for which EDF ≈  $f(DD)$ . Note the same  $f(\cdot)$  is used for all firms.

## 2 Ratings Models

An alternative approach to modeling default events is via ratings transitions. The main ratings agencies – Moody's, Standard & Poors and Fitch – produce and publish ratings of financial instruments issued by firms and governments. These ratings are intended to signify the credit-worthiness of these instruments with safer

securities having higher ratings. For example, a security rated AAA is believed to be very secure and have almost no risk of default. These ratings are updated periodically as the prospects of the firms (or governments!) change. One way to model these periodic updates is via a Markov chain. For example, we could use historical ratings transitions to estimate the transition matrix,  $\mathbf{P}$ , which applies to Standard & Poors ratings. An example of such a matrix is given below.

<table><tr><td rowspan="2" colspan="2"></td><td colspan="8">End State</td></tr><tr><td>AAA</td><td>AA</td><td>A</td><td>BBB</td><td>BB</td><td>B</td><td>CCC</td><td>Default</td></tr><tr><td rowspan="7">Initial State</td><td>AAA</td><td>90.81</td><td>8.33</td><td>0.68</td><td>0.06</td><td>0.12</td><td>-</td><td>-</td><td>-</td></tr><tr><td>AA</td><td>0.70</td><td>90.65</td><td>7.79</td><td>0.64</td><td>0.06</td><td>0.14</td><td>0.02</td><td>-</td></tr><tr><td>A</td><td>0.09</td><td>2.27</td><td>91.05</td><td>5.52</td><td>0.74</td><td>0.26</td><td>0.01</td><td>0.06</td></tr><tr><td>BBB</td><td>0.02</td><td>0.33</td><td>5.95</td><td>85.93</td><td>5.30</td><td>1.17</td><td>1.12</td><td>0.18</td></tr><tr><td>BB</td><td>0.03</td><td>0.14</td><td>0.67</td><td>7.73</td><td>80.53</td><td>8.84</td><td>1.00</td><td>1.06</td></tr><tr><td>B</td><td>-</td><td>0.11</td><td>0.24</td><td>0.43</td><td>6.48</td><td>83.47</td><td>4.07</td><td>5.20</td></tr><tr><td>CCC</td><td>0.22</td><td>-</td><td>0.22</td><td>1.30</td><td>2.38</td><td>11.24</td><td>64.85</td><td>19.79</td></tr></table>

$\mathbf{P}_{i,j}$  is then the probability that a firm with rating  $i$  will be rated  $j$  one year or one quarter from now. Note that we have omitted the final row of the matrix since once a firm is in default it is assumed<sup>5</sup> to stay in default.

These ratings transition models were popularized by CreditMetrics and J.P. Morgan in the late 1990's. Their approach to credit risk was to assume that the credit rating of a company was well-modeled by a Markov chain with transition matrix  $\mathbf{P}$  as above. It was then easy to compute the probability of default (or indeed losses / gains due to a deterioration / improvement in credit quality) over any period of time. For example, it is easily seen that the matrix  $\mathbf{P}^k$  coincides with the transition matrix corresponding to  $k$ -time periods. More generally, we could use a database of ratings transitions to estimate a continuous-time Markov model so that ratings transitions could occur at any time instant. This of course is more realistic.

In order to compute risk measures such as Value-at-Risk (VaR) for credit portfolios consisting of the securities of different firms, it is necessary to model the joint ratings transition of many companies. This can be achieved using copula methods. Monte-Carlo methods can then be used to estimate various quantities of interest.

## 3 Credit-Default Swaps

Credit default swaps (CDS's) are a very important class of derivative instrument that was developed in the late 1990's and is now ubiquitous in the financial markets. They allow investors (or speculators) to hedge (or take on) the risk of default of a firm or government.

A CDS is structured like an insurance policy between two parties. Party A agrees to pay party B a fixed amount every period (typically every quarter), in return for protection against the default of a third party, C. These payments constitute the premium leg and the size of the payments are proportional to the notional amount,  $N$ . When a default occurs, party B must pay party A the difference between  $N$  and the market value of the reference bond (with notional  $N$ ) issued by party C.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-29/d7a2e983-03b5-4270-9368-0e04d5b9a80e/86975784285e6168916bbfab0395e743ca6de06624e087a1c1fa3193327b7031.jpg)

(It is also possible to have physical settlement whereby upon default the protection buyer delivers the reference bond to the protection seller and receives the face value of the bond in return.) This payment constitutes the default leg of the CDS. The three parties (A, B and C) are referred to as the protection buyer, the protection

seller and the reference entity, respectively. The CDS has a maturity date,  $T$ , and all payments cease at  $\min(\tau, T)$  where  $\tau$  is the default time of the reference entity, party C.

### 3.1 Pricing a CDS in General

We price a CDS by equating the risk-neutral value of the premium and default legs and from this we can determine the fair annual spread that the protection buyer must pay to the protection seller.

#### The Premium Leg

Suppose the premium leg of the CDS has  $n$  payment times,  $t_1, \ldots, t_n = T$  and let us assume that default can only occur at one of these times. Then the fair value,  $P_0$ , of the premium leg at time  $t = 0$  is given by

$$

P_{0} = s_{0}^{T} N \sum_{i = 1}^{n} Z_{0}^{t_{i}} \alpha_{i} P (\tau > t_{i}) \tag{4}
$$


where  $Z_0^{t_i}$  is the discount factor, i.e. the price of a riskless zero-coupon bond with face value 1 that matures at time  $t_i$ ,  $N$  is the notional and  $\alpha_i = t_i - t_{i-1}$  is the accrual period (in years) between the  $(i-1)^{th}$  and  $i^{th}$  payments. The annualized CDS spread is  $s_0^T$ .

#### The Default Leg

The fair value,  $D_0$ , at time  $t = 0$  of the default leg satisfies

$$

D_{0} = (1 - R) N \sum_{i = 1}^{n} Z_{0}^{t_{i}} P (\tau = t_{i}) \tag{5}
$$


where  $R$  is the so-called recovery rate, i.e. the percentage of the face value of the reference bond that is recovered by a bond-holder upon default of the reference entity. It is common (though not necessarily advisable) to assume that  $R$  is a fixed constant, e.g.  $40\%$ .

#### Obtaining the Fair CDS Spread

The spread,  $s_0^T$ , is obtained by equating  $P_0$  with  $D_0$  so that the CDS has zero value for both parties at the beginning of the contract. This implies

$$

s_{0}^{T} = \frac{\left(1 - R\right) \sum_{i = 1}^{n} Z_{0}^{t_{i}} P (\tau = t_{i})}{\sum_{i = 1}^{n} Z_{0}^{t_{i}} \alpha_{i} P (\tau > t_{i})}. \tag{6}
$$


A plot of  $s_0^T$  against  $T$  then shows the term-structure of CDS spreads. Just like the term structure of interest rates moves in response to general economic conditions, the term structure of credit spreads will move in response to general economic conditions as well as changes in the general outlook for the reference entity.

### 3.2 Some Specific Models

In order to compute a specific value for  $s_0^T$  we must have a (risk-neutral) default model in order to compute the various probabilities in (6). We now consider a few possible approaches before considering more general stochastic intensity models in Section 4.

#### Structural Models

We can certainly compute  $s_0^T$  using structural models as described in Section 1. Indeed one can use the lattice models there to compute the fair value of  $s_0^T$  assuming default is possible at every time period and premia are also paid in every period. This is left as an exercise!

One of the main weaknesses of the structural approach to pricing CDS's is that the default event is said to be predictable. In particular, consider for example the Black-Cox model. Default is impossible in the next time period in that model unless the firm value is very close to the default boundary. And if the firm value is far from the default boundary then default in the next several periods will also be impossible. In contrast, if we let the length of a time period,  $\Delta t$ , go to zero and the firm value process is extremely close to the default boundary then default will happen for sure<sup>8</sup> very soon. This is what we mean when we say default is predictable. In the real-world, however, default is not predictable. The default of many firms can come as a complete surprise to the market. This is true for firms such as Enron and Parmalat where default was caused by the discovery of huge accounting frauds. Even when the market sees that a firm, e.g. Lehman Brothers, is in financial difficulty so that the CDS spreads of that firm have widened, the actual default event itself is still a surprise and (in a mathematical sense) unpredictable.

Intensity models are commonly used to circumvent this problem. These models do not model the economic value of the firm and hence are often termed reduced-form models. The (inhomogeneous) Poisson process intensity models that we discuss next are examples of deterministic intensity models.

#### Using a Poisson Process to Model Default

We now assume the arrival of default follows a Poisson process with parameter  $\lambda$  so that  $P(\tau \leq t) = 1 - e^{-\lambda t}$  we can clearly compute  $s_0^T$  using (6) but with the term  $P(\tau = t_i)$  in the numerator now replaced by

$P(t_{i - 1} < \tau \leq t_i)$. We can also compute the time  $t = 0$  value,  $V_0$ , of a zero-coupon bond with face value  $F$  and maturity  $T$ . If the recovery-rate upon default is a known value,  $R$ , that is paid at the time of default,  $\tau$ , then we have

$$

\begin{array}{l} V_{0} = \mathrm{E}_{0}^{Q} \left[ e^{- r T} F 1_{\{\tau > T \}} + \int_{0}^{T} e^{- r t} R F 1_{\{\tau = t \}} \right] \\ = e^{- (r + \lambda) T} F + R F \int_{0}^{T} \lambda e^{- (r + \lambda) t} d t \\ = e^{- (r + \lambda) T} F + R F \frac{\lambda}{r + \lambda} \left(1 - e^{- (r + \lambda) T}\right) \tag{7} \\ \end{array}
$$


where we have used the fact that time to default is exponentially distributed with parameter  $\lambda$ .

#### Using an Inhomogeneous Poisson Process to Model Default

A clear weakness with the Poisson model is that there is just a single parameter,  $\lambda$ , that we are free to choose. In practice, however, there are typically liquid CDS spreads  $s_0^T$ , for several values of  $T$ . Typical values are  $T = 1,3,5,7$  and 10 years. Unless the term structure of credit spreads is constant (which is almost never the case) then it will be impossible to choose  $\lambda$  so that the model values of  $s_0^T$  coincide with the corresponding market values for all values of  $T$ .

We can resolve this problem using an inhomogeneous Poisson process where the arrival rate,  $\lambda_{t}$ , is a deterministic function of time,  $t$ . For such a process, the probability of zero arrivals in the interval  $(t,t + \Delta t)$  is then approximately  $e^{-\lambda_t\Delta t}$ . Using this we obtain the survival probability

$$

P (\tau > t) = e^{- \int_{0}^{t} \lambda_{s} d s}. \tag{8}
$$


We can now use (8) to compute CDS spreads according to (6) but with the term  $P(\tau = t_i)$  in the numerator of (6) now replaced by  $P(t_{i - 1} < \tau \leq t_i)$ . We can also calibrate the inhomogeneous Poisson process model to the CDS spreads observed in the market. In particular, we can assume  $\lambda_t$  is piecewise constant on the intervals  $(0,T_1],[T_1,T_2],\dots ,(T_{n - 1},T_n]$  where  $T_{1} < T_{2} < \dots < T_{n}$  are the maturities of CDS spreads observed in the market. We can then use (6) to first calibrate  $\lambda_{0,T_1}$  and to then calibrate each of  $\lambda_{T_1,T_2},\ldots ,\lambda_{T_{n - 1},T_n}$  in turn.

## 4 Stochastic Intensity Models

While the inhomogeneous Poisson model can be calibrated to the CDS spreads seen in the market, it does have a glaring weakness: the credit spreads at all future times are known today at time  $t = 0$ . This is because the intensity,  $\lambda_{t}$ , is deterministic. In practice, however, credit spreads are stochastic and so we would like to consider models where the default intensity is stochastic. We will consider here one important and tractable class of stochastic intensity models, namely the doubly-stochastic or Cox process.

### Cox Processes

A Cox process is in fact an entire class of (point) processes. Before defining such a process we let  $N_{t}$  be the number of arrivals up to time  $t$ . When  $N_{t}$  follows a Poisson (inhomogeneous Poisson) process we know  $N_{t}$  has a Poisson distribution with parameter  $\lambda t \left( \int_{0}^{t} \lambda_{u} du \right)$ . A cox process generalizes this by allowing the intensity  $\lambda_{u}$  to be stochastic. However, conditional on knowing  $\{ \lambda_{u} \}_{0 \leq u \leq T}$  then the number of arrivals in the interval  $[s, t]$  where  $0 \leq s < t \leq T$  has an inhomogeneous Poisson distribution with parameter  $\int_{s}^{t} \lambda_{u} du$ .

Such a process remains very tractable. For example, if  $\tau$  is the first arrival of a Cox process then we can compute the survival probability  $P(\tau > t)$  as

$$

\begin{array}{l} P (\tau > t) = \mathrm{E} \left[ 1_{\{\tau > t \}} \right] \\ = \mathrm{E} \left[ \mathrm{E} \left[ 1_{\{\tau > t \}} \mid \left\{\lambda_{u} \right\}_{0 \leq u \leq t} \right] \right] \\ = \mathrm{E} \left[ e^{- \int_{0}^{t} \lambda_{u} d u} \right] \tag{9} \\ \end{array}
$$


where (9) follows from the fact that the point process is an inhomogeneous Poisson process on  $[0,t]$  (and so  $\tau$  has an exponential distribution) conditional on  $\{\lambda_u\}_{0\leq u\leq t}$ .

We can now generalize (7) to obtain the fair value of a defaultable zero-coupon bond with face value  $F$  and recovery rate,  $R$ , that is payable upon default. In particular, under a (risk-neutral) Cox process model, we easily see that the time  $t = 0$  value,  $V_{0}$ , of such a bond satisfies

$$

\begin{array}{l} V_{0} = \mathrm{E}_{0}^{Q} \left[ e^{- r T} F 1_{\{\tau > T \}} + \int_{0}^{T} e^{- r t} R F 1_{\{\tau = t \}} \right] \\ = \mathrm{E}_{0}^{Q} \left[ e^{- \int_{0}^{T} (r + \lambda_{u}) d u} F \right] + R F \mathrm{E}_{0}^{Q} \left[ \int_{0}^{T} \lambda_{t} e^{- \int_{0}^{t} (r + \lambda_{s}) d s} d t \right] \\ = \mathrm{E}_{0}^{Q} \left[ e^{- \int_{0}^{T} (r + \lambda_{u}) d u} F \right] + R F \int_{0}^{T} \mathrm{E}_{0}^{Q} \left[ \lambda_{t} e^{- \int_{0}^{t} (r + \lambda_{s}) d s} \right] d t. \tag{10} \\ \end{array}
$$


A Cox process is only fully specified once we specify dynamics for  $\lambda_{t}$ . We will consider a lattice model for  $\lambda_{t}$  below but we also note that there are continuous-time models, e.g. the CIR model, for which (10) can be computed analytically. (The parameters of these models would then be chosen so that the model CDS spreads,  $s_0^T$ , match those observed in the market for different maturities,  $T$ .)

### 4.1 Intensity-Based Lattice Models

We now build a lattice model for the intensity process. Following earlier interest rate models such as Ho-Lee or Black-Derman-Toy, we let  $\lambda_{k,s}$  denote the intensity at time  $k$  and state  $s$ . We will assume that

$$

\lambda_{k, s} = a_{k} + b s
$$


for some constants  $a_k$  and  $b$ . (These constants can be used later to calibrate the model to CDS spreads and possibly other single-name credit derivatives such as CDS options.) At each node in the lattice there are actually 3 possible successor nodes corresponding to an up-move (in  $\lambda$ ), a default (which is a "terminal" state) or a down-move. We only need to show the up and down-moves when we actually draw the lattice. At any node, the (risk-neutral) probability of default,  $q_{\mathrm{def}}$ , is given by
$$
q_{\mathrm{def}} = 1 - e^{- \lambda \Delta t}
$$


where  $\Delta t$  is the length of a period and where  $\lambda$  depends on the particular node. In order to include a degree of mean-reversion in the lattice we allow the probabilities of up and down-moves to depend on  $\lambda$ . In particular, we will assume
$$
q_{\mathrm{up}} = \frac{\lambda_{0}}{\lambda + \lambda_{0}} - \frac{1}{2} q_{\mathrm{def}}
$$


$$

q_{\text{down}} = 1 - \frac{\lambda_{0}}{\lambda + \lambda_{0}} - \frac{1}{2} q_{\text{def}}
$$

where  $\lambda_0$  is the intensity level about<sup>10</sup> which the intensity mean-reverts. Note that  $q_{\mathrm{up}} + q_{\mathrm{down}} + q_{\mathrm{def}} = 1$ . The intensity lattice (with  $b$  chosen equal to .002) as well as the lattice of  $q_{\mathrm{up}}$  (with  $\lambda_0$  chosen equal to  $2\%$ ) are shown below.

### Pricing a Coupon-Paying Bond

Suppose now that we wish to price a 10-year bond with face value  $100\mathrm{m}$ , a  $6\%$  coupon paid annually and a recovery-rate of  $R = 0$ . We assume that each period corresponds to 1 year and that the first coupon is paid 1 year from now. The risk-free rate is  $5\%$ . The valuation lattice for this bond can be seen below.

We construct the bond lattice beginning at time  $t = 10$  by noting that the bond value at a node is given by the sum of two quantities: (i) the survival probability for that node times the face value plus the coupon and (ii) the default probability for that node times the face value times the recovery rate. Earlier nodes are computed via backwards evaluation and accounting for both the coupon and the possibility of default at each node. In particular, the value at any earlier node comes from two sources:

(i) if there is a default at that node then the value is simply the face value times the recovery rate.  
(ii) if there is not a default at that node then the value is the coupon at that node plus the expected discounted value of the bond one period ahead.

We find<sup>11</sup> an initial value of 82.64m.

### Computing the Fair Spread of a CDS

Once the lattice model has been constructed it is easy to compute the fair spread of a CDS on this bond (assuming payments for the premium leg are paid in every period, i.e. in every year). Buying a CDS essentially changes the recovery rate to  $100\%$  at the cost of a reduced coupon. The size of the reduction in the coupon can be interpreted as the CDS spread. Therefore to find the fair CDS spread,  $s_0^{10}$ , we can set  $R = 100\%$  and reduce the coupon  $C$  until the fair value equals the original fair value of the bond, 82.64m. This leads to a fair CDS spread of  $3.39\%$  or 339 basis points.

Figure 1: Intensity Process,  $q_{up}$  Process and Bond Values in Reduced Form Model  

<table><tr><td colspan="2">Lambda Lattice</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0.043</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0.042</td><td>0.041</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>0.041</td><td>0.04</td><td>0.039</td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>0.04</td><td>0.039</td><td>0.038</td><td>0.037</td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td>0.039</td><td>0.038</td><td>0.036</td><td>0.035</td><td>0.034</td><td>0.033</td><td></td></tr><tr><td></td><td></td><td></td><td>0.039</td><td>0.037</td><td>0.036</td><td>0.034</td><td>0.033</td><td>0.032</td><td>0.031</td><td></td></tr><tr><td></td><td></td><td>0.037</td><td>0.037</td><td>0.035</td><td>0.034</td><td>0.032</td><td>0.031</td><td>0.03</td><td>0.029</td><td></td></tr><tr><td></td><td>0.034</td><td>0.035</td><td>0.035</td><td>0.033</td><td>0.032</td><td>0.03</td><td>0.029</td><td>0.028</td><td>0.027</td><td></td></tr><tr><td>t=0</td><td>0.026</td><td>0.032</td><td>0.033</td><td>0.033</td><td>0.031</td><td>0.03</td><td>0.028</td><td>0.027</td><td>0.026</td><td>0.025</td></tr><tr><td>0.01</td><td>0.024</td><td>0.03</td><td>0.031</td><td>0.031</td><td>0.029</td><td>0.028</td><td>0.026</td><td>0.025</td><td>0.024</td><td>0.023</td></tr><tr><td>t=0</td><td>t=1</td><td>t=2</td><td>t=3</td><td>t=4</td><td>t=5</td><td>t=6</td><td>t=7</td><td>t=8</td><td>t=9</td><td>t=10</td></tr></table>

<table><tr><td>q_up Lattice</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0.296</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0.308</td><td>0.308</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>0.314</td><td>0.320</td><td>0.326</td><td>0.333</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>0.314</td><td>0.326</td><td>0.333</td><td>0.339</td><td>0.346</td></tr><tr><td></td><td></td><td></td><td></td><td>0.320</td><td>0.326</td><td>0.339</td><td>0.346</td><td>0.354</td><td>0.361</td></tr><tr><td></td><td></td><td></td><td>0.320</td><td>0.333</td><td>0.339</td><td>0.354</td><td>0.361</td><td>0.369</td><td>0.377</td></tr><tr><td></td><td></td><td>0.333</td><td>0.333</td><td>0.346</td><td>0.354</td><td>0.369</td><td>0.377</td><td>0.385</td><td>0.394</td></tr><tr><td></td><td>0.354</td><td>0.346</td><td>0.346</td><td>0.361</td><td>0.369</td><td>0.385</td><td>0.394</td><td>0.403</td><td>0.412</td></tr><tr><td>0.422</td><td>0.369</td><td>0.361</td><td>0.361</td><td>0.377</td><td>0.385</td><td>0.403</td><td>0.412</td><td>0.422</td><td>0.432</td></tr><tr><td>0.662</td><td>0.385</td><td>0.377</td><td>0.377</td><td>0.394</td><td>0.403</td><td>0.422</td><td>0.432</td><td>0.443</td><td>0.454</td></tr><tr><td>t = 0</td><td>t = 1</td><td>t = 2</td><td>t = 3</td><td>t = 4</td><td>t = 5</td><td>t = 6</td><td>t = 7</td><td>t = 8</td><td>t = 9</td></tr></table>

<table><tr><td colspan="2">Bond Lattice</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>101.54</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>98.49</td><td>101.74</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>95.92</td><td>98.88</td><td>101.95</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>93.76</td><td>96.46</td><td>99.26</td><td>102.15</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td>91.87</td><td>94.44</td><td>97.00</td><td>99.64</td><td>102.35</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td>90.31</td><td>92.67</td><td>95.12</td><td>97.54</td><td>100.03</td><td>102.56</td><td></td></tr><tr><td></td><td></td><td></td><td>88.94</td><td>91.21</td><td>93.47</td><td>95.80</td><td>98.09</td><td>100.41</td><td>102.76</td><td></td></tr><tr><td></td><td></td><td>87.91</td><td>89.94</td><td>92.13</td><td>94.28</td><td>96.49</td><td>98.64</td><td>100.80</td><td>102.97</td><td></td></tr><tr><td></td><td>87.27</td><td>89.00</td><td>90.96</td><td>93.05</td><td>95.10</td><td>97.18</td><td>99.19</td><td>101.19</td><td>103.18</td><td></td></tr><tr><td rowspan="2">82.64</td><td>87.34</td><td>88.44</td><td>90.11</td><td>91.98</td><td>93.98</td><td>95.92</td><td>97.88</td><td>99.74</td><td>103.38</td><td></td></tr><tr><td>88.59</td><td>89.62</td><td>91.22</td><td>93.01</td><td>94.92</td><td>96.75</td><td>98.58</td><td>100.29</td><td>103.59</td><td></td></tr><tr><td>t = 0</td><td>t = 1</td><td>t = 2</td><td>t = 3</td><td>t = 4</td><td>t = 5</td><td>t = 6</td><td>t = 7</td><td>t = 8</td><td>t = 9</td><td>t = 10</td></tr></table>