---
parent_directory: Lecture Notes
title: "Teaching Notes 1: Introduction to Fixed Income Securities"
tags:
aliases:
  - Introduction to Fixed Income Securities
  - Teaching Notes 1
parent_folder: Lecture Notes
subfolder:
key_concepts:
cssclasses: academia
linter-yaml-title-alias: "Teaching Notes 1: Introduction to Fixed Income Securities"
---

# Teaching Notes 1

Introduction to Fixed Income Securities<sup>1</sup>

# John Heaton

The University of Chicago

Booth School of Business

NBER

# Introduction

- Several changes to fixed-income markets took place in the aftermath of the crisis

1. Many countries increased debt to "stimulate" the economy.

- Lower tax revenues due to the economic downturn and higher government spending  $\Rightarrow$  large increase in government debt.

2. The huge mortgage-backed securities market had several changes

— Fannie Mae and Freddie Mac went into conservatorship. Many mortgage companies disappeared. New regulation has been enacted.

3. Aggressive monetary policy has had large impact on Treasury bonds

Federal Reserve slashed Fed Funds rate to zero  
— Federal Reserve moved to "unconventional monetary policy"

4. Massive regulatory changes in derivative markets

- Central counterparties (CCP)  
- Impact on pricing of derivatives.

5. Dramatic change in behavior of Treasury bonds

- From positive beta to negative beta securities  
- Negative rates in many

# The Outstanding Amount U.S. Debt

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/0be5d131b366059eb745d6142ce69fbfddf1933d119fd0e86a80023b5ebf90d8.jpg)  
Panel A. Billions of US Dollars

Panel B. Percentage of US GDP  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/7604e39114d0bca5772e0475270168501e61725e9a7fea3d2ed5b805d4164494.jpg)  
(Source: SIFMA and FRED at Federal Reserve of St. Louis.)

# Federal Funds and U.S. Treasury Yields

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/fe84919bfa2d478760b5aaa45bcba978b19bd8e4e7856e30c81b73b3941b5f3c.jpg)  
Panel A. Federal Funds Effective Rate

Panel B. Zero-Coupon Bond Yields  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/95caf220c47de8d568f687f2420b681dfcb2f2a783dfabea3881d436c7702763.jpg)  
(Data: Yields up to 5 years are from CRSP. Yields from 10 to 30 are from Gürkaynak, Sack, and Wright (2007), updated series.)

# The Notional Amount of Over-the-Counter Derivatives

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/86f676bbc7dc161e6613239c259ff18a639875781d9655b0b24acfacd06809af.jpg)  
Panel A. Millions of US Dollars

Panel B. Multiple of Global GDP  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/078f26e800247c48ee41222cc298aec8bf951f8cc3435b2391a6d2f2d87c6d35.jpg)  
(Data Source: OTC derivatives data are from the Bank for International Settlements, while global GDP data are from the World Bank.)

# The Changing Beta of U.S. Treasury Bonds

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/262dae3cd32b24f1ba843a346930378401743f60dbcf465639ee47f498f8055e.jpg)  
Stock Bond Covariance

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/cc04c27787c43caee5d3b6d8a8a5c1b7ed385456d7d848f91358841e2ad9a972.jpg)  
Bond Beta

(Stock data are from CRSP. 5-year zero-coupon bond data are from Gurkaynak, Sack, and Wright (2007, updated series)

The Yields of German Treasury Bonds  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c2dad9518ed317312bce4f4eb884e971292bcefb5a580eaddd96352090e50558.jpg)  
(Body: Bloomberg)

# U.S. Treasury Bills, Notes, and Bonds

U.S. Government issues various kinds of debt securities

1. Treasury Bills: Zero coupon securities with maturity up to one year  
2. Treasury Notes: Fixed coupon bonds with maturity up to 10 years  
3. Treasury Bonds: Fixed coupon bonds with maturity of 30 years  
4. Treasury Inflation-Protected Securities (TIPS): Floating coupon bonds indexed to inflation  
5. Floating Rate Notes (FRNs): Floating coupon bonds, with coupon indexed to T-Bill rates

Marketable U.S. Treasury Securities (million of dollars) December 31, 2021  

<table><tr><td></td><td colspan="2">Debt Held
by the Public</td><td colspan="2">Intragovernmental 
Holdings</td><td></td></tr><tr><td></td><td>Dollar</td><td>Percent</td><td>Dollar</td><td>Percent</td><td>Total</td></tr><tr><td>Bills</td><td>3,767,964</td><td>16.68</td><td>2,102</td><td>0.01</td><td>3,770,066</td></tr><tr><td>Notes</td><td>12,992,160</td><td>57.51</td><td>8,346</td><td>0.04</td><td>13,000,507</td></tr><tr><td>Bonds</td><td>3,474,153</td><td>15.38</td><td>7,358</td><td>0.03</td><td>3,481,511</td></tr><tr><td>Inflation-Protected Securities</td><td>1,727,968</td><td>7.65</td><td>627</td><td>0.00</td><td>1,728,595</td></tr><tr><td>Floating Rate Notes</td><td>603,302</td><td>2.67</td><td>58</td><td>0.00</td><td>603,360</td></tr><tr><td>Federal Financing Bank</td><td>0</td><td>0.00</td><td>6,053</td><td>0.03</td><td>6,053</td></tr><tr><td>Total</td><td>22,565,547</td><td></td><td>24,544</td><td></td><td>22,590,092</td></tr></table>

Source: U.S. Treasury web site. https://www.treasurydirect.gov

# Interest Rates and Compounding Frequency

- The concept of interest rates is ubiquitous to fixed income securities.  
- Problem: An interest rate is not well defined without a compounding frequency. 
  - Example: A \$100 investment at 10% interest rate over 10 years has payoffs:

$$
\text {A n n u a l c o m p o u n d i n g :} \quad \\( 1 0 0 \times (1. 1) ^ {1 0} \quad = \\) 2 5 9. 3 7
$$

$$
\text {S e m i - a n n u a l c o m p o u n d i n g :} \quad \$ 1 0 0 \times (1. 0 5) ^ {2 0} = \$ 2 6 5. 3 3
$$

$$
\text {Q u a r t e r l y c o m p o u n d i n g :} \quad \$ 1 0 0 \times (1. 0 2 5) ^ {4 0} = \$ 2 6 8. 5 1
$$

$$
\text {D a l l y c o m p o u n d i n g}: \mathbb {S} 1 0 0 \times \left(1 + \frac {0 . 1}{3 6 5}\right) ^ {1 0 \times 3 6 5} = \mathbb {S} 2 7 1. 7 9
$$

$$
\text {C o n t i n u o u s c o m p o u n d i n g :} \quad \$ 1 0 0 \times e ^ {0. 1 \times 1 0} = \$ 2 7 1. 8 2
$$

- The general formula to compound  $n$  times over the horizon  $T$  is

$$
V = \left(1 + \frac {r}{n}\right) ^ {n \times T}
$$

- For  $n$  large, we converge to continuous compounding

$$
V = \left(1 + \frac {r}{n}\right) ^ {n \times T} \longrightarrow e ^ {r \times T}
$$

# Discounting

- Discounting is opposite process from the previous one.  
 - The question is: "what is the amount we have to invest today to have \$1 dollar in the future, given a rate r compounded n times per year?"  
- Inverting the relation above, we obtain

$$
Z (T) = \frac {1}{\left(1 + \frac {r}{n}\right) ^ {n \times T}}
$$

- In the limit as  $n \to \infty$  we obtain the usual continuous compounding formula

$$
Z (T) = \frac {1}{\left(1 + \frac {r}{n}\right) ^ {n \times T}} \longrightarrow Z (T) = e ^ {- r T}
$$

# Discounts and Rates

- Note that the compounding frequency is mostly a convention.  
- The key question is:

"How much are investors willing to pay today to have \$1 at T".

- Such price,  $Z(T)$ , is always well defined.  
- Given  $Z(T)$ , we can derive the rate  $r_n$  for any given compounding frequency  $n$ :

$$
r _ {n} = n \times \left(\frac {1}{Z (T) ^ {\frac {1}{n T}}} - 1\right)
$$

- The continuously compounded rate is instead

$$
r = - \frac {1}{T} \log (Z (T))
$$

# The Term Structure of Interest Rates

- When we discount future cash flows to the present, different discount rates apply for different maturities.  
- We denote the discount factor at  $t$  for a dollar to be received at time  $T$  by

$$
Z (t, T) = e ^ {- r (t, T) (T - t)}
$$

- $r(t, T) =$  continuously compounded yield at  $t$  for an investment up to  $T$ .  
- We put two "time" indices:

1. $t =$  calendar time when the discounting is made (e.g. 1/31/2007,etc.)  
2. $T =$  maturity date.  $\Rightarrow T - t =$  time to maturity

- Panel A of next figure shows  $Z(t,T)$  for  $t = 1/31/2007, 1/31/2008, \ldots, 3/20/2020$ , and for  $T - t$  ranging from 0 to 30 years  
- Panel B of next figure shows the corresponding yields  $r(t, T)$

Panel A. Zero Coupon Bonds  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/456f80360425aa3210565b7b10894e931815dc656978fae77c4c400f069b5c4f.jpg)  
(Data are from Gürkaynak, Sack, and Wright (2007), updated series.)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/6b186c3d9b23553fcffc851f693a81e02c1cc7cb442d0c7388d7ee530af10d1a.jpg)  
Panel B. Yield Curves

(Data are from Gürkaynak, Sack, and Wright (2007), updated series.)

# Yield Curves

- Yield curves change a lot over time.  
- They also have many shapes:
- Inverted hump (slightly, 1/31/2007)
- Flat (e.g. 1/31/2007)  
- Increasing (e.g. 1/30/2015)  
Hump (e.g. 1/31/2009)

* What generates the shape of the term structure of interest rates?  
* What does it imply for derivative pricing etc?

- Indeed, there is much variation not only in level but in slope of the yield curve
- What do these variations tell us about investors' beliefs about future rates?  
- What do they tell us about risk premia required to hold bonds?

Zero-Coupon Bond Yields  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/6d7e32d485d241d74263dea6da8cd655b4c5f388ccf60966733d45d791d58340.jpg)  
(Data: Yields up to 5 years are from CRSP. Yields from 10 to 30 are from Gurkaynak, Sack, and Wright (2007), updated series.)

# Coupon Bonds

- What is the price of coupon bond?  
- A coupon bond is just a sequence of cash payments  $\frac{c}{2}$  (coupons) for dates  $T_{1}, T_{2}, \ldots, T_{n}$  and one big payment of  $100 + \frac{c}{2}$  (principal) at  $T_{n}$  (= maturity of the bond).  
- If we know the time value of money for each maturity, that is, the discount function  $Z\left( {t,{T}_{i}}\right)$  for all maturities  ${T}_{i}$  's,a simple no arbitrage argument implies

$$
\begin{array}{l} P (t, T _ {n}) = c / 2 \times Z (t, T _ {1}) + c / 2 \times Z (t, T _ {2}) + \ldots + (1 0 0 + c / 2) Z (t, T _ {n}) \\ = \sum_ {i = 1} ^ {n} \frac {c / 2}{\left(1 + r _ {2} (t , T _ {i}) / 2\right) ^ {2 \times (T _ {i} - t)}} + \frac {1 0 0}{\left(1 + r _ {2} (t , T _ {n}) / 2\right) ^ {2 \times (T _ {n} - t)}} \\ \end{array}
$$

- What is the arbitrage argument?

# Coupon Bonds

- Suppose that the price of the bond is trading at par (100) but the right-hand side is 105.

– Then an arbitrageur can buy the bond (pay 100) and sell the strips (each cash payments) for a total of 105, thereby making \$5 (million). Since there is perfect matching of cash flows in the future, the trade is an arbitrage.

- Incidentally, notice that if  $t = 0$  and  $T_{i}$  are exact semi-annual maturities, that is  $T_{1} = .5$ ,  $T_{2} = 1$ ,  $T_{3} = 1.5$  etc., then we have  $2 \times T_{i} = i$  for every  $i = 1,..,n$ , and thus the formula reduces to

$$
P (0, T _ {n}) = \sum_ {i = 1} ^ {n} \frac {c / 2}{(1 + r _ {2} (0 , T _ {i}) / 2) ^ {i}} + \frac {1 0 0}{(1 + r _ {2} (0 , T _ {n}) / 2) ^ {n}}
$$

# Conventions and Terminology

- It is important to spend a few words on some market conventions and terminology.  
Accrued Interest:

- The market prices of bonds quoted in newspapers are clean prices. That is, they are quoted without any accrued interest.  
- The accrued interest is the amount of interest that has built up since the last coupon payment.

Accrued Interest = Interest Due in the Full Period ×

Number of Days Since Last Coupon Date × Number of Days between Coupon Payments

- The actual payment is called invoice price (or dirty price).

# Day Count Conventions

- How do we count days? Three main ways

1. Actual/Actual: Simply Count the number of calendar days;  
2. 30/360: Assume there are 30 days in a month and 360 in a year;  
3. Actual/360: Each month has the right number of days, but there are only 360 days in a year.

- Which convention it is used depend on the security considered.  
- Treasuries use Actual/Actual.

# Discount yield and Bond Equivalent Yield

- T-bills are quoted on a discount yield  $d$  basis. That is, the quote reports a yield.  
- If  $n$  is the number of days to maturity, the price of the T-bill is

$$
P = 1 0 0 \times \left[ 1 - \frac {n}{3 6 0} \times d \right]
$$

- In other words

$$
d = \frac {1 0 0 - P}{1 0 0} \times \frac {3 6 0}{n}
$$

- Instead, it should be

$$
B E Y = \frac {1 0 0 - P}{P} \times \frac {3 6 5}{n}
$$

- BEY = Bond Equivalent Yield  
- Of course, we obtain

$$
B E Y = \frac {3 6 5 \times d}{3 6 0 - d \times n}
$$

# Yield-to-Maturity (or internal rate of return)

- Given price  $P(t,T)$  and cash flows  $c / 2$  at  $T_{i}$ 's for  $i = 1,..,n$ , and  $1 + c / 2$  at  $T_{n}$ , the (semi-annually compounded) yield-to-maturity YTM is defined as that rate  $y$  such that

$$
P \left(t, T _ {n}\right) = \sum_ {i = 1} ^ {n} \frac {c / 2}{\left(1 + \frac {y}{2}\right) ^ {2 \times \left(T _ {i} - t\right)}} + \frac {1 0 0}{\left(1 + \frac {y}{2}\right) ^ {2 \times \left(T _ {n} - t\right)}} \tag {1}
$$

- Recall that given the spot curve  $r_2(t, T_i)$ , we also had

$$
P \left(t, T _ {n}\right) = \sum_ {i = 1} ^ {n} \frac {c / 2}{\left(1 + r _ {2} \left(t , T _ {i}\right) / 2\right) ^ {2 \times (T _ {i} - t)}} + \frac {1 0 0}{\left(1 + r _ {2} \left(t , T _ {n}\right) / 2\right) ^ {2 \times (T _ {n} - t)}}
$$

What's the difference?

- The yield to maturity  $y$  is a sort of average discount rate that characterizes one particular bond, and it is used to discount the cash flows of that particular bond.  
- Notice that two different bonds with same maturity, will have different yield to maturities if they have different coupons.

# Yield-to-Maturity

- We will almost never use YTM  
- It is blatantly wrong as a measure of yield, as it assumes that all the coupons can be reinvested at the constant  $y$  throughout the life of the bond.
- That is: not only it assumes a flat yield curve, but also one that does not move over time.
- Example: consider the following data:

<table><tr><td>Bond</td><td>Maturity (Years)</td><td>Coupon</td><td>Price</td><td>Yield-to-Maturity</td></tr><tr><td>1</td><td>2</td><td>9%</td><td>98.57</td><td>9.82%</td></tr><tr><td>2</td><td>2</td><td>10%</td><td>100.34</td><td>9.80%</td></tr><tr><td>3</td><td>2</td><td>3%</td><td>88.00</td><td>9.91%</td></tr></table>

What is the most attractive bond?

# Yield-to-Maturity

- Judging from the Yield-to-Maturity, bond 3 looks great.  
- However, it is dominated by a combination of 1 and 2, as we can mimic exactly its cash flows and find a (slightly) lower price.
- Let  $N_{1}$  and  $N_{2}$ , be the number of the first and the second coupon bonds  
- Then

$$
N _ {1} \times 9 + N _ {2} \times 1 0 = 3
$$

$$
N _ {1} \times 1 0 9 + N _ {2} \times 1 1 0 = 1 0 3
$$

- Solving the system  $\Longrightarrow$  the portfolio long  $N_{1} = 7$  units in bond 1 and short of  $N_{2} = -6$  units bond 2 mimics exactly the cash flows of bond 3.  
- The value of this portfolio is  $N_{1} \times 98.57 + N_{2} \times 100.34 = 87.95 < 88$ .  
- The YTM of the portfolio is even bigger: YTM=9.94%.

# Yield to Maturity

- Why is this happening?  
- The YTM measures the average return on the bond under the assumption that all coupons are reinvested at the same rate  $y$ .  
- With a non-flat term structure, this is simply not going to happen and using YTM for relative pricing yields bad results.  
- The low coupon in bond 3 together with the fact that we cannot re-invest at the high rate of  $9.91\%$  for the whole life of the bond yields the implication that the third bond is "no better" than a portfolio of the other two (which have lower YTMs).

# Floating Rate Notes

- Floating rate notes are securities whose coupon is not fixed, but it depends on realized short-term rates  $r_t$ .
  - If  $r_t$  increases  $\Rightarrow$  coupon increases. And vice versa.  
- The U.S. Treasury started issuing floating rate notes (FRN) in January 2014.  
- They pay quarterly coupons using the 13-week U.S. T-bill rate as a reference rate, plus a spread determined at the auction of the FRN.  
- Let  $T_{1}, T_{2}, \ldots, T_{n}$  denote the coupon payment dates, with  $T_{i+1} = T_{i} + 0.25$ .  
- Then the (annualized) coupon rate at time  $T_{i}$  is given by

$$
c (T _ {i}) = r (T _ {i - 1}) + \mathsf {s p r e a d}
$$

- where  $r(T_{i - 1})$  is the quarterly compounded, (annualized) three-month rate.

# Floating Rate Notes: Pricing

- How do we price a security with unknown future coupons?  
- We can use a recursive argument. Let's start with a spread  $= 0$  
- Let  $T_{n} =$  maturity date, where  $n$  is the total number of coupon payments.  
- Suppose that today is actually  $T_{n - 1}$ .
- $\Rightarrow$  Today we know the reference rate  $r\left(T_{n - 1}\right)$  and hence

$$
\mathrm {C a s h f l o w a t} T _ {n} = 1 + \frac {1}{4} c (T _ {n}) = 1 + \frac {1}{4} r (T _ {n - 1})
$$

- The value of FRN at  $T_{n - 1}$  is

$$
P ^ {F R N} (T _ {n - 1}) = \frac {\mathrm {C a s h f l o w a t} T _ {n}}{1 + \frac {1}{4} r (T _ {n - 1})} = \frac {1 + \frac {1}{4} c (T _ {n})}{1 + \frac {1}{4} r (T _ {n - 1})} = \frac {1 + \frac {1}{4} r (T _ {n - 1})}{1 + \frac {1}{4} r (T _ {n - 1})} = 1
$$

# Floating Rate Notes: Pricing (cntd.)

- Consider now the value of the FRN at  $T_{n - 2}$ .
- At this time, the investor knows that the FRN will  $c(T_{n - 1}) = r(T_{n - 2})$  at  $T_{n - 1}$ , and that its price will revert to  $P^{FRN}(T_{n - 1}) = 1$ .
- The FRN value at  $T_{n - 2}$  is then

$$
P ^ {F R N} (T _ {n - 2}) = \frac {P ^ {F R N} (T _ {n - 1}) + \frac {1}{4} c (T _ {n - 1})}{1 + \frac {1}{4} r (T _ {n - 2})} = \frac {1 + \frac {1}{4} r (T _ {n - 2})}{1 + \frac {1}{4} r (T _ {n - 2})} = 1
$$

Using the same logic for every reset time  $T_{i}$ :  $P^{FRN}(T_{i}) = 1$  

- Outside reset times, the price of FRN is different from 1 .  
- Let  $t$  be such that  $T_{i - 1} < t < T_i$ . Then, the value at  $t$  of FRN is

$$
P ^ {F R N} (t) = Z (t, T _ {i}) (1 + r (T _ {i - 1}) / 4)
$$

- Adding a spread to the coupon payments is simple because the spread is constant.  $\Rightarrow$  use discounts  $Z(t,T)$  to compute its value.

# Repurchase Agreements

- Repurchase Agreements (Repo): Agreement to sell some securities to another party and buy them back at a fixed date and for a fixed amount.
- The price at which the security is bought back is greater than the selling price and the difference implies an interest rate called Repo Rate.  
- A Reverse Repo is the borrowing of a security for a short period at an agreed interest rate.
- The Repo Market is the single most important source of financing for government dealers.
- Since government securities are liquid and default free, they are excellent collateral.  
- Dealers can borrow money on a collateralized basis, so that they can take huge positions even with limited capital.  
- The Repo Market grew very large. Next table shows the average daily amount outstanding

# Financing by U.S. Government Securities Dealers

# Average Daily Amount Outstanding (\$ Billions)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/769c2febfa21f2e0ca49cd7a2f77505c29a7c3eda58e240fa8ccbdcf56dd25c1.jpg)  
(Source: SIFMA http://www.sifma.org/research/statistics.aspx)

# Bilateral Repurchase Agreements

- A Repo transaction is as follows: Consider a trader and a repo-dealer. The trader at time  $t$  wants to take a long position until time  $T$  (typically, overnight!) Then

# Schematic Repo Transaction
![[Lecture Note 1 Introduction To Fixed Income Securities-20240415223856802.png]]

# Repurchase Agreements

1. At time  $t$ , the trader buys the bond at market price  $P_{t}$  and enters into a Repo with the Repo Dealer. Hence, the trader delivers the bond as collateral to the repo-dealer and gets the cash to purchase the bond.

- The Repo Dealer typically gives something less than the market price of the bond. The difference is called hair cut.  
- The term  $T$  is decided at time  $t$ : Most Repurchase agreements are for a very short term (overnight). Some longer term agreements reach 30 days or more.  
- The Repo rate is decided at time  $t$ .

2. At time  $T$ , the trader gets back the bond from the Repo Dealer, sells the bond in the market to get  $P_T$  and pays  $P_t$  plus the repo rate to the dealer.

- The profit is then  $P_{T} - P_{t}$ -repo rate  $\times \frac{n}{360} \times (P_{t} - \text{haircut})$ .  
Hence, the return on capital to the trader is

$$
\text {R e t u r n} = \frac {P _ {T} - P _ {t} - \text {r e p o r a t e} \times \frac {n}{3 6 0} \times \left(P _ {t} - \text {h a i r c u t}\right)}{\text {h a i r c u t}}
$$

# Repurchase Agreements

- Between  $t$  and  $T$  the trader earns the accrued interest on the bond
- Positive Carry: If accrued interest  $>$  repo rate  
- Negative Carry: If accrued interest  $<$  repo rate.
- Other important definitions/characteristics of Repo markets:

1. General Collateral Rate (GCF): This is the Repo Rate on most Treasury securities. Hence, using one or another of these as collateral makes little difference in terms of costs.  
2. - In a reverse repo, the trader (A) borrows the security from the repo dealer; (B) sells it; and (C) posts cash collateral with the dealer.  
- The trader is lending money to the dealer against the bond collateral  $\Longrightarrow$  the trader would be entitled to the repo rate.  
- However, the trader is happy to forgo part (all) of the repo rate in order to get hold of the bond (to sell)

# Reverse Repo Transaction
![[Lecture Note 1 Introduction To Fixed Income Securities-20240415224136376.png]]

# Tri-Party Repo

- Based on clearing and settlement infrastructure supported by Bank of New York Mellon and JPMorgan Chase  
- Banks provide collateral valuation, margining, and management services to facilitate trading.  
- Collateral allocation: automatically selects securities from cash borrower's inventory.  
- General Collateral Finance (GCF): cleared through the Fixed Income Clearing Corporation (FICC) GCF repo service. Mostly inter-dealer.  
- Ex-GCF: Not cleared through FICC. Institutional investors such as money market funds lending to broker-dealers.

# Forward Rates

- A forward rate determined at time  $t$  is the rate implicit in the current spot rate function for an investment in T-bills made at date  $T_{1}$  with maturity date  $T_{2}$  ( $> T_{1}$ ).
- There are three "dates" in the forward rate:

1. Today  $(t)$ ;  
2. The first maturity at which the investment is made  $(T_{1})$ ;  
3. The final maturity of the investment  $\left(T_{2}\right)$

- With semiannual compounding, we denote it  $f_{2}\left(t,T_{1},T_{2}\right)$  
- With continuous compounding, we denote it  $f\left( {t,{T}_{1},{T}_{2}}\right)$
- How do we determine the forward rates?
- By no arbitrage.  
 – Suppose today is t = 0 and that I have \$10 million to invest for 1 year.

# Forward Rates

- We have the following two strategies

1. Invest in a 1-year zero coupon bond, obtaining at maturity

$$
\$ 10 million \times (1 + r _ {2} (0, 1) / 2) ^ {2}
$$

2. Invest in a 6-months zero coupon bond and enter (today) into a forward contract to invest the proceeds at  $T_{1} = 0.5$  until  $T_{2} = 1$  for a rate  $f_{2}(0,0.5,1)$ . At maturity we have

$$
\$ 10 m \times (1 + r _ {2} (0, 0. 5) / 2) \times (1 + f _ {2} (0, 0. 5, 1) / 2)
$$

- By no arbitrage (and if credit risk is negligible) we must have

$$
\$ 10 m \times \left(1 + \frac {r _ {2} (0 , 1)}{2}\right) ^ {2} = \$ 10 m \times \left(1 + \frac {r _ {2} (0 , 0 . 5)}{2}\right) \times \left(1 + \frac {f _ {2} (0 , 0 . 5 , 1)}{2}\right)
$$

# Forward Rates

or

$$
1 + \frac {f _ {2} (0 , 0 . 5 , 1)}{2} = \frac {(1 + r _ {2} (0 , 1) / 2) ^ {2}}{(1 + r _ {2} (0 , 0 . 5) / 2)}
$$

- by using the price of bonds we have

$$
1 + \frac {f _ {2} (0 , 0 . 5 , 1)}{2} = \frac {Z (0 , 0 . 5)}{Z (0 , 1)}
$$

# Forward Rates

- More generally, for every  $T_{1}$  and  $T_{2}$ , consider the following strategies:

1. Invest in a  $T_{2}$ -zero coupon bond, obtaining at maturity

$$
\frac {\mathbb {S} 1 0 \mathrm {m}}{Z (0 , T _ {2})}
$$

2. Invest in a  $T_{1}$ -zero coupon bond and enter (today) into a forward contract to invest the proceeds at  $T_{1}$  until  $T_{2}$  at the  $n$ -times compounded forward rate  $f_{n}(0, T_{1}, T_{2})$ . At maturity we have

$$
\frac {\mathbb {S} 1 0 \mathrm {m}}{Z (0 , T _ {1})} \times \left(1 + \frac {f _ {n} \left(0 , T _ {1} , T _ {2}\right)}{n}\right) ^ {n \left(T _ {2} - T _ {1}\right)}
$$

- We then obtain

$$
\left(1 + \frac {f _ {n} (0 , T _ {1} , T _ {2})}{n}\right) ^ {n (T _ {2} - T _ {1})} = \frac {Z (0 , T _ {1})}{Z (0 , T _ {2})}
$$

# Continuously Compounded Forward Rates

- Taking the limit as  $n \to \infty$  the continuously compounded forward rates is

$$
\begin{array}{l} f (0, T _ {1}, T _ {2}) = \frac {\ln (Z (0 , T _ {1})) - \ln (Z (0 , T _ {2}))}{T _ {2} - T _ {1}} \\ = \frac {r (0 , T _ {2}) T _ {2} - r (0 , T _ {1}) T _ {1}}{T _ {2} - T _ {1}} \tag {2} \\ \end{array}
$$

- Another concept, that we will use later, is that of instantaneous forward rate. 
— We can rewrite (2) as (exercise: do it!)

$$
f (0, T _ {1}, T _ {2}) = r (0, T _ {1}) + T _ {2} \times \frac {r (0 , T _ {2}) - r (0 , T _ {1})}{T _ {2} - T _ {1}} \tag {3}
$$

- If we take the limit  $T_{2} \longrightarrow T_{1}$  (that is, the horizon of the forward contract shrinks to zero) we obtain

$$
f (0, T _ {1}, T _ {1}) = r (0, T _ {1}) + T _ {1} \times \frac {d r (0 , T _ {1})}{d T _ {1}} \tag {4}
$$

# The Relation between Forward Curve and Spot Curve

- The equation for the instantaneous forward curve (4) is revealing of an interesting (important) property of the forward-spot relationship.  
- We can rewrite

$$
f (0, T _ {1}, T _ {1}) - r (0, T _ {1}) = T _ {1} \times \frac {d r (0 , T _ {1})}{d T _ {1}}
$$

This implies:

If  $\frac{dr(0, T_1)}{dT_1} > 0 \Rightarrow$  forward curve is above the spot curve  
If  $\frac{dr(0, T_1)}{dT_1} < 0 \Rightarrow$  forward curve is below the spot curve  
If  $\frac{dr(0, T_1)}{dT_1} = 0 \Rightarrow$  forward curve intersects the spot curve

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/28932ce3082866229a9d390d387918dc012f865b5bee851dee3e1d4b0d9443b5.jpg)  
Spot Curve and Forward Curve

- To obtain the forward curve we need a smooth yield curve.

# Estimating the Zero-Coupon Discount Function

- There are several methods to extract the zero-coupon discount curve  $Z(0,T)$  from bond data.  
- Why do we want to do that?

1. The discount function  $Z(0, T)$  determines the time value of money. We need it as a basis to discount future (riskless) cash flows.  
2. We cannot observe it: it is implicitly embedded in traded Treasury coupon bonds.  
3. You need it to compute forward prices, for instance, as well as Swaps (see later).  
4. It will be the basis of all future term structure models: it is typically the first step to then calibrate term structure models. The latter are what traders use to

(a) Price new securities by no arbitrage (we will see many).  
(b) Spot out arbitrage opportunities.

- The most "famous" is the bootstrapping methodology.

# Bootstrap

- Suppose we have  $n$  coupon bonds. Each bond  $i$  has a coupon equal to  $c^i$ .  
- Recall the pricing equation for coupon bonds with maturity  $T_{i}$  is equal to

$$
P ^ {i} (t, T _ {i}) = \frac {c ^ {i}}{2} \sum_ {j = 1} ^ {i} Z (t, T _ {j}) + 1 \times Z (t, T _ {i}) \qquad \qquad (5)
$$

- Today is  $t = 0$  and that we have data on maturities  $T_{j} = .5, 1, 1.5, \ldots, T_{n}$ .  
- Inverting (5), we obtain

$$
Z \left(0, 0. 5\right) = \frac {P ^ {1} \left(0 , 0 . 5\right)}{1 + c ^ {1} / 2}
$$

$$
Z (0, 1) = \frac {P ^ {2} (0 , 1) - c ^ {2} / 2 \times Z (0 , . 5)}{1 + c ^ {2} / 2}
$$

$$
Z (0, 1. 5) = \frac {P ^ {3} (0 , 1 . 5) - c ^ {3} / 2 \times (Z (0 , . 5) + Z (0 , 1))}{1 + c ^ {3} / 2}
$$

In general, for every  $i$ :

$$
Z \left(0, T _ {i}\right) = \frac {P ^ {i} \left(0 , T _ {i}\right) - c ^ {i} / 2 \times \left(\Sigma_ {j = 1} ^ {i - 1} Z \left(0 , T _ {j}\right)\right)}{1 + c ^ {i} / 2}
$$

- Example: suppose we have the following data:

<table><tr><td>Maturity</td><td>Period i</td><td>Coupon</td><td>YTM</td><td>Price</td></tr><tr><td>0.5</td><td>1</td><td>0.000</td><td>0.080</td><td>96.15</td></tr><tr><td>1</td><td>2</td><td>0.000</td><td>0.083</td><td>92.19</td></tr><tr><td>1.5</td><td>3</td><td>0.085</td><td>0.089</td><td>99.45</td></tr><tr><td>2</td><td>4</td><td>0.090</td><td>0.092</td><td>99.64</td></tr><tr><td>2.5</td><td>5</td><td>0.110</td><td>0.094</td><td>103.49</td></tr><tr><td>3</td><td>6</td><td>0.095</td><td>0.097</td><td>99.49</td></tr><tr><td>3.5</td><td>7</td><td>0.100</td><td>0.100</td><td>100.00</td></tr></table>

We find:

$$
Z \left(0, . 5\right) = 9 6. 1 5; Z \left(0, 1\right) = 9 2. 1 9;
$$

$$
Z (0, 1. 5) = \frac {9 9 . 4 5 - . 0 4 2 5 \times (9 6 . 1 5 + 9 2 . 1 9)}{1 . 0 4 2 5} = 8 7. 7 2; \dots
$$

- Since

$$
Z (0, T _ {i}) = \frac {1 0 0}{\left(1 + \frac {r _ {2} (0 , T _ {i})}{2}\right) ^ {i}} \Longleftrightarrow r _ {2} (0, T _ {i}) = 2 \times \left(\left(\frac {1 0 0}{Z (0 , T _ {i})}\right) ^ {\frac {1}{i}} - 1\right)
$$

we obtain

<table><tr><td>Maturity</td><td>Period i</td><td>YTM</td><td>Spot Yield</td></tr><tr><td>0.5</td><td>1</td><td>0.080</td><td>0.080</td></tr><tr><td>1</td><td>2</td><td>0.083</td><td>0.083</td></tr><tr><td>1.5</td><td>3</td><td>0.089</td><td>0.0893</td></tr><tr><td>2</td><td>4</td><td>0.092</td><td>0.09247</td></tr><tr><td>2.5</td><td>5</td><td>0.094</td><td>0.09468</td></tr><tr><td>3</td><td>6</td><td>0.097</td><td>0.09787</td></tr><tr><td>3.5</td><td>7</td><td>0.100</td><td>0.10129</td></tr></table>

# Curve Fitting

- The above methodologies require that we have all the maturities available.  
Unfortunately, this is never the case.  
- To avoid this problem, the profession moved to "curve fitting" in the following sense:

1. Assume a flexible functional form for  $Z(0,T)$ , such as (Nelson Siegel Model):

$$
Z (0, T _ {j}) = 1 0 0 \times e ^ {- r (0, T _ {j}) \times T _ {j}}
$$

$$
r (0, T _ {j}) = \theta_ {0} + (\theta_ {1} + \theta_ {2}) \frac {1 - e ^ {- \frac {T _ {j}}{\lambda}}}{\frac {T _ {j}}{\lambda}} - \theta_ {2} e ^ {- \frac {T _ {j}}{\lambda}}
$$

2. We can compute the "theoretical price" given  $Z(0, T)$

$$
\widehat {P} (0, T _ {j}) = \sum_ {i = 1} ^ {j} c (T _ {i}) \times Z (0, T _ {i})
$$

3. We estimate the parameters  $\theta_0, \theta_1, \theta_2, \lambda$  by non-linear least squares. That is, by minimizing

$$
\min _ {\theta_ {0}, \theta_ {1}, \theta_ {2}, \lambda} \sum_ {j = 1} ^ {n} \left(P (0, T _ {j}) - \widehat {P} (0, T _ {j})\right) ^ {2}
$$

- There is a large literature on the functional forms for the discount function  $Z(0, T)$ , many of them relying on spline functions.  
- Next figure shows the difference between using bootstrapping technique and the curve fitting technique

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/7db3af7db211ffe2c6bf654dfb72d56b3072465c14a52f990aac71e76de73b6e.jpg)  
Zero-Coupon Yield Curves

- Clearly, the fitted curve is much smoother (by construction).  
- An important difference arises when we look at forward rates

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/ce9cd6efdbcf41dfaa6ab8ae5b2abcd65bd3c28ce5607204795af12e95dc7d38.jpg)  
Forward Curves

# Interest Rate Risk Management and Factors

John Heaton

The University of Chicago

Booth School of Business

NBER

# Interest Rate Risk Management

- Interest rates vary quite dramatically over time.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/8cb789969433e64662e5d7f6b5df3cdfe30d8300152ff17b31157fec217c6229.jpg)  
(Data: Yields up to 5 years are from CRSP. Yields from 10 to 30 are from Gürkaynak, Sack, and Wright (2007), updated series.)

# Interest Rate Risk Management

- … and so do bond prices.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/5eba00e8887385f2ea7260169d213f6ec5f2369323c27dcd5e72cc8f0a4040fd.jpg)  
The Life Cycle of a 30-year Bond

Source: CRSP

# Interest Rate Risk Management: Duration

- The duration of a security is defined as the sensitivity of the security's price to small, uniform changes in the yield curve.  
- Traditionally, the duration is defined with respect to changes in yield-to-maturity.  
- However, it is convenient to introduce it using the continuously compounded yield  $r(t,T)$ , as formulas are easier and the interpretation is also easier.  
- The duration of an asset is its sensitivity to small, uniform changes in  $r(t,T)$ .
- That is, the change in the security's price when we apply a uniform increment "dr" to the yield curve  $r(t,T)$ , to get  $r(t,T) + dr$

Hence, we define the duration of a security with price  $P$  by

$$
D _ {P} = - \frac {1}{P} \frac {d P}{d r}
$$

- This definition is all you need to remember, as everything follows from here.

# Example: Duration of a Zero Coupon Bond

- Consider a zero coupon bond with time to maturity  $T$  and price  $Z(t, T)$ . By applying the definition we have:

$$
\begin{array}{l} D _ {Z, T} = - \frac {1}{Z (t , T)} \frac {d Z (t , T)}{d r} \\ = - \frac {1}{Z (t , T)} \times \left[ - (T - t) \times e ^ {- r (t, T) \times (T - t)} \right] \\ = - \frac {1}{Z (t , T)} \times [ - (T - t) \times Z (t, T) ] \\ = T - t \\ \end{array}
$$

- The duration of a zero coupon bond is simply equal to its time to maturity  $T - t$ .

# Duration of a Portfolio of Securities

- We now show that the duration of a portfolio of securities is just the weighted average of the durations of the singles securities (where the weights are the relative holdings).  
- Suppose we have  $N_{1}$  units of security 1 and  $N_{2}$  of security 2. Let  $P_{1}$  and  $P_{2}$  be the prices of the two securities and  $D_{1}$  and  $D_{2}$  their durations, respectively.  
- Let  $\Pi$  be the value of the portfolio

$$
\Pi = N _ {1} P _ {1} + N _ {2} P _ {2}
$$

- We can then compute:

$$
\begin{array}{l} D _ {\Pi} = - \frac {1}{\Pi} \frac {d \Pi}{d r} \\ = \frac {1}{\Pi} \left(- N _ {1} \times \frac {d P _ {1}}{d r} - N _ {2} \times \frac {d P _ {2}}{d r}\right) \\ = \frac {1}{\Pi} \left(N _ {1} P _ {1} \times (- 1) \frac {1}{P _ {1}} \frac {d P _ {1}}{d r} + N _ {2} P _ {2} \times (- 1) \frac {1}{P _ {2}} \frac {d P _ {2}}{d r}\right) \\ \end{array}
$$

# Duration of a Portfolio of Securities

Obtaining

$$
D _ {\Pi} = w _ {1} D _ {1} + w _ {2} D _ {2} \tag {1}
$$

where

$$
w _ {i} = \frac {N _ {i} P _ {i}}{\Pi} \tag {2}
$$

- Clearly, the same derivation can be applied for any number of assets.

# Example: Duration of a Coupon Bond

- We know a bond is equivalent to a portfolio of zero-coupon bonds

$$
P (0, T) = \sum_ {i = 1} ^ {n} c (T _ {i}) Z (0, T _ {i})
$$

where  $c(T_i) = c / 2$  for  $i < n$  and  $c(T_n) = c / 2 + 100$ .  

- Step 1: Apply (2) to have

$$
w _ {i} = \frac {c (T _ {i}) Z (0 , T _ {i})}{P (0 , T)}
$$

# Example: Duration of a Coupon Bond

- Step 2: Use (1)

$$
D = - \frac {1}{P (0 , T)} \frac {d P (0 , T)}{d r} = \sum_ {i = 1} ^ {n} w _ {i} D _ {Z, T _ {i}} = \sum_ {i = 1} ^ {n} w _ {i} \times T _ {i} \tag {3}
$$

- The duration of a Coupon Bond is a weighted average of times to maturity  
- From (3), we can compute the percentage change in the bond due to a small parallel shift in the yield function  $r(t, \tau)$  as

$$
\frac {d P}{P} \approx - D \times d r
$$

Hence, if we hold a portfolio of 10-year at-par coupon bonds with duration equal to 5, we know that a one-basis point increase in the yield function  $(dr = .01\%)$  is going to change the value of the bond approximately by  $-5 \times .01 / 100 \times \$100$  million (par amount)  $= -\$50,000$ .

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/4f7677922cb4e092560dac30097694c7c31e6da7d6b7562f974b15cece57160c.jpg)  
Bond Price Approximation with Duration

# Duration Definitions

- We defined the duration as

$$
D = - \frac {1}{P} \frac {d P}{d r}
$$

- where  $r$  is the continuously compounded interest rate.  
- This definition entails also the interpretation of duration as the discounted time-weighted cash flows (equation (3)).  
- With discrete compounding the two things are not exactly the same and take different names:

# Macaulay Duration

- Consider a security with yield to maturity  $y$ .  
- Its price is

$$
P = \sum_ {j = 1} ^ {n} \frac {c / 2}{\left(1 + \frac {y}{2}\right) ^ {j}} + \frac {1 0 0}{\left(1 + \frac {y}{2}\right) ^ {n}} \tag {4}
$$

- The Macaulay duration is defined as

$$
D ^ {M c} = - \frac {(1 + y / 2)}{P} \frac {d P}{d y}
$$

- Some algebra shows

$$
D ^ {M c} = \frac {1}{2} \sum_ {j = 1} ^ {n} w _ {j} \times j
$$

where

$$
w _ {j} = \frac {1}{P} \left(\frac {c / 2}{\left(1 + \frac {y}{2}\right) ^ {j}}\right), w _ {n} = \frac {1}{P} \left(\frac {c / 2 + 1 0 0}{\left(1 + \frac {y}{2}\right) ^ {n}}\right)
$$

# Modified Duration

- The modified duration is instead defined as

$$
M D = - \frac {1}{P} \frac {d P}{d y}
$$

where  $P$  is given in (4).

It is easy to see that

$$
M D = \frac {D ^ {M c}}{\left(1 + \frac {y}{2}\right)}
$$

# The Price Value of a Basis Point (PVBP)

- In the industry traders often use a related measure of risk, called the PVBP.  
- This is simply defined as

$$
P V B P = - \frac {d P}{d y} \times 0. 0 0 0 1 = M D \times P \times 0. 0 0 0 1
$$

- This is also called the dollar value of .01, or DV01.  
- Sometimes expressed per \$1 million of face value.

# Example: Spread Trades

- A trader is evaluating the shape of the yield curve.  
- The spread between the 30 year T-Bond and the 2 year T-Note is 266 bps.

<table><tr><td colspan="4">Time t</td><td colspan="2">Accrued</td></tr><tr><td></td><td>Bid</td><td>Ask</td><td>Yield y</td><td>Interest</td><td>PVBP</td></tr><tr><td>30 year T-Bond</td><td>108.8405</td><td>108.903</td><td>7.96%</td><td>.408654</td><td>1200.643</td></tr><tr><td>2-year T-Note</td><td>100.3735</td><td>100.4360</td><td>5.30%</td><td>.03022</td><td>187.3602</td></tr></table>

- The trader has a view: The spread will increase in the next few days.  
- How can the trader devise a trading strategy to bet on his/her view, without taking (part of) interest rate risk?
- First, if spread increases, it must be the case that the price of 30-year bond goes down more than the price of the 2-year bond (or up less!).  
Hence, to profit from the movement, we need a short position in the long-term bond and a long position in the short-term bond.

- Let  $n_2$  and  $n_{30}$  be the units of 2-year notes and 30 year bonds involved in the trading strategy.  
- Then, the trader can hedge the interest rate risk by setting

$$
n _ {2} \times P V B P _ {2} = n _ {3 0} \times P V B P _ {3 0}
$$

- Suppose  $n_{30} = 100$  million (par amount), we can compute the amount of two year notes necessary to hedge the position:

$$
n _ {2} = 1 0 0 \times \frac {1 2 0 0 . 6 4 3}{1 8 7 . 3 6 0 2} = 6 4 1
$$

- The trader will go long 641 million (par amount) of the two year bond, and go short 100 million par amount of the 30-year T-Bond.  
- How is this done in practice?
- Through the Repo Market.  
- The trader can enter into a repo at  $5 \%$  and a reverse repo at  $4.9 \%$ .  
- The spread between repos is the profit for the Repo Dealer, who borrows money at  $4.9\%$  and lends it at  $5\%$ .  
- Finally, suppose hair cut  $= 0$ .
- We have the following transactions at Date  $t$

<table><tr><td>Date</td><td>Transaction</td><td>Cash Flows</td></tr><tr><td rowspan="2">Date t</td><td rowspan="2">1. Borrow Cash and pay for 2-year Note 
Post 2-year Note as Collateral
(100.4360 + .03022) × 10,000 × 641 = 2. Borrow 30-year T-Bond and sell
Post Cash as collateral
(108.8405 + .408) × 10,000 × 100 =</td><td>(643,988,470)</td></tr><tr><td>109,249,154</td></tr></table>

- These cash flows are just the nominal amount paid or received in the market. The trader is borrowing/lending money with zero hair cut, it has a zero-net position!  
- Suppose that at time  $t + 2$  the new market data are

<table><tr><td colspan="4">Time t</td><td colspan="2">Accrued</td></tr><tr><td></td><td>Bid</td><td>Ask</td><td>Yield</td><td>Interest</td><td>PVBP</td></tr><tr><td>30 year T-Bond</td><td>109.8076</td><td>109.8701</td><td>7.88%</td><td>.456731</td><td>1218.246</td></tr><tr><td>2-year T-Note</td><td>100.5967</td><td>100.6592</td><td>5.18%</td><td>.06044</td><td>187.4086</td></tr></table>

- The new spread is 270 basis points, hence the view was right. Did the trader make any money?

<table><tr><td>Date</td><td>Transaction</td><td>Cash Flow</td></tr><tr><td>Date t+2</td><td rowspan="2">1. Sell 2-year note
This becomes
(100.5967 + .0604) × 10,000 × 641 = 2. Repay the amount borrowed plus Repo interest. This is</td><td rowspan="2">645,212,011</td></tr><tr><td>(A)</td></tr><tr><td>(B)</td><td>643,988,470 × (1 + 2 × .05/360) = 3. Collect the cash plus interest</td><td>(644,167,356)</td></tr><tr><td>(C)</td><td>109,249,154 × (1 + 2 × .049/360) = 4. Buy the 30-year T-bond to cover the short position</td><td>109,278,894</td></tr><tr><td>(D)</td><td>(109.8701 + .4567) × 10,000 × 100 = (110,326,800)</td><td></td></tr></table>

Profits?

$$
\operatorname {P r o f i t} (\text {L o s s e s}) = (\mathrm {A}) + (\mathrm {B}) + (\mathrm {C}) + (\mathrm {D}) = (3, 2 5 1)
$$

- The trader lost money, even if the spread did increase.  
- The reason, of course, are the transaction costs, such as bid-ask spreads in the Treasury market and in the Repo market.

# Interest Rate Risk Management: Convexity

- Convexity measures the curvature of a security with respect to interest rates

$$
C = \frac {1}{P} \frac {d ^ {2} P}{d r ^ {2}}
$$

- Example 1. From the definition of a zero coupon bond:

$$
Z (t, T) = e ^ {- r (t, T) (T - t)} \Longrightarrow C _ {Z} = \frac {1}{Z (t , T)} \frac {d ^ {2} Z (t , T)}{d r ^ {2}} = (T - t) ^ {2}
$$

- Example 2. From the definition of a coupon bond:

$$
P _ {c} (t, T) = \frac {c}{2} \sum_ {i = 1} ^ {n} Z (t, T _ {i}) + Z (t, T _ {n}) \Longrightarrow C = \frac {1}{P _ {c}} \frac {d ^ {2} P _ {c}}{d r ^ {2}} = \sum_ {i = 1} ^ {n} w _ {i} (T _ {i} - t) ^ {2}
$$

where  $w_{i}$  are the same as in previous slide.

- Given  $D$  and  $C$ , a better approximation of the return of a security is

$$
\frac {d P}{P} \approx - D d r + \frac {1}{2} C d r ^ {2} \tag {5}
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/4686de72ec527fe5fe1e8b307258137be96701d3df17c08e1ed6384ae6979844.jpg)  
Duration plus Convexity Approximation

# Positive Convexity: Good News for Average Returns

- Suppose we have invested \$100 million in a 20-year zero coupon bond.  
Using Equation (5) and given  $D = 20$  and  $C = 20^2 = 400$ , we find

$$
E \left[ \frac {d P}{P} \right] \approx - 2 0 \times E [ d r ] + \frac {1}{2} \times 4 0 0 \times E [ d r ^ {2} ] (6)
$$

- Predicting variation in interest rates over a short period (daily) is very hard. So,  $E[dr] = 0$  is a good approximation. However, note that  $E[dr^2] = Var(dr) > 0$ .

Daily Changes in the Level of Interest Rates  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/47d480627ae597174b4efc0cb5c3836004a7c434bf89830e37c1fc4f0fa16aa1.jpg)  
Data Source: CRSP.

# Positive Convexity: Good News for Average Returns

- From data, we can estimate the daily variance of interest rates of about  $E[dr^2] = 5.5351 \times 10^{-007}$ , implying

$$
E \left[ \frac {d P}{P} \right] = - 2 0 \times 0 + \frac {1}{2} \times 4 0 0 \times E [ d r ^ {2} ] = 1. 1 1 \times 1 0 ^ {- 0 4} > 0 \tag {7}
$$

- Although this number seems extremely small, it is a daily expected return.

Annualized expected return from convexity  $= 1.11 \times 10^{-04} \times 252 = 2.79\%$

- Similarly, considering the  \$100 million investment, convexity yields a daily dollar return of$ 11,070 = 1.11 ×  $10^{-04} \times 100\$  million.  
- Is this positive average return stemming from the fluctuation of the level of interest rates a "free lunch"?
- No: As we shall see more formally later on, this positive average return on the investment is counterbalanced by a lower yield to maturity of the bond, everything else equal.

# Duration and Convexity Approximation: Example

- A pension fund buys \$100 million (par value) of a 10-year, 5% coupon bond.  
- Let the yield curve be flat at the continuously compounded rate of  $4.5\%$ .

$$
- \Longrightarrow P _ {c} (t, T) = \$ 1 0 3. 5 8, D = 8. 0 3, a n d C = 7 3. 8 7.
$$

- The approximate losses from an increase in  $r$  of  $1\%$  are

$$
\frac {d P}{P} \approx - D \times 0.01 = - 0.0803 = - 8 \% \tag{8}
$$

$$
\frac {d P}{P} \approx - D \times 0.01 + \frac {1}{2} \times C \times (0.01) ^ {2} = - 0.07662 = - 7.66 \% \tag{9}
$$

- To check accuracy, we can compute the exact loss from an increase of the term structure by  $1\%$ .
- Using the pricing formula with r = 4.5% and r = 5.5%, we obtain that price declines to \$95.63 from \$103.58:

$$
\frac {d P}{P} = \frac {\mathrm {\\(95.63 - \\)103.58}}{\mathrm {\\(103.58}} = - 7.67 \%
$$

- The "convexity" measure is quite accurate

# Interest Rate Risk Management: Duration Hedging

- The pension fund is worried about potential losses from an increase in rates.  
- The fund decides to hedge by buying  $k$  10-year zero-coupon bond  $Z(0, T)$ .  
We have \(Z(0,T) = \\)63.76\(, and \(D_z = 10\).  
- Denoting again by \(P\) the value of the bond (\(P = \\)103.58\)), what is the position \(k\) in the zero coupon bond such that the portfolio \(V = P + k \times P_z(0, T)\) is insensitive to a parallel shift in the yield curve?  
- Condition  $dV = 0$  implies

$$
k = - \frac {D \times P}{D _ {z} \times P _ {z} (0 , T)} = \frac {8 . 0 3 \times 1 0 3 . 5 8}{1 0 \times 6 3 . 7 6} = - 1. 3 0 4 5 \tag {10}
$$

- Assume for simplicity that fund achieves this short position through the repo market at zero haircut (i.e. the short position is achieved at zero cost for the fund.)

How Does Duration Hedging Perform?  

<table><tr><td>Spot Curve Shift</td><td>\(P_{c}\)</td><td>\(Z(0,T)\)</td><td>Position</td><td>Change in Portfolio Value</td></tr><tr><td>Initial Values</td><td>103.58</td><td>63.76</td><td>-1.3045</td><td></td></tr><tr><td>dr = 0.1%</td><td>102.75</td><td>63.13</td><td>-1.3045</td><td>-0.0003</td></tr><tr><td>dr = 1.0%</td><td>95.63</td><td>57.69</td><td>-1.3045</td><td>-0.0318</td></tr><tr><td>dr = 2.0%</td><td>88.38</td><td>52.20</td><td>-1.3045</td><td>-0.1210</td></tr><tr><td>dr = -0.1%</td><td>104.41</td><td>64.40</td><td>-1.3045</td><td>-0.0003</td></tr><tr><td>dr = -1.0%</td><td>112.29</td><td>70.47</td><td>-1.3045</td><td>-0.0350</td></tr><tr><td>dr = -2.0%</td><td>121.84</td><td>77.88</td><td>-1.3045</td><td>-0.1474</td></tr></table>

- Source of the underperformance? From  $dV = dP + k \times dZ$  we have

$$
\begin{array}{l} d V = - D P _ {c} d r + \frac {1}{2} P _ {c} C d r ^ {2} + k \left(- D _ {z} Z d r + \frac {1}{2} Z C _ {z} d r ^ {2}\right) \\ = - \left(D P _ {c} + k D _ {z} Z\right) d r + \frac {1}{2} \left(P _ {c} C + k Z C _ {z}\right) d r ^ {2} \tag {11} \\ \end{array}
$$

- Duration hedging takes care of the first term but not of the second, which is always negative in our example.

# Interest Rate Risk Management: Duration and Convexity Hedging

- Let  $P_{1}$  and  $P_{2}$  be the prices of two securities (e.g. short-term and a long-term zeros), with  $D_{1}, D_{2}, C_{1}$ , and  $C_{2}$  their durations and convexities, respectively.  
- Let  $k_{1}$  and  $k_{2}$  be the positions in the bonds. The value of the hedged portfolio is

$$
V = P _ {c} + k _ {1} P _ {1} + k _ {2} P _ {2} \Longrightarrow d V = d P _ {c} + k _ {1} d P _ {1} + k _ {2} d P _ {2}
$$

- Developing the expression and pulling together the terms in  $dr$  and  $dr^2$ :

$$
\begin{array}{l} d V = - \left(D P + k _ {1} D _ {1} P _ {1} + k _ {2} D _ {2} P _ {2}\right) d r \\ + \frac {1}{2} \left(C P + k _ {1} C _ {1} P _ {1} + k _ {2} C _ {2} P _ {2}\right) d r ^ {2} \\ \end{array}
$$

- Thus,  $dV = 0$  yields two equations

$$
k _ {1} D _ {1} P _ {1} + k _ {2} D _ {2} P _ {2} = - D P _ {c} \quad (\text {D e l t a H e d g i n g})
$$

$$
k _ {1} C _ {1} P _ {1} + k _ {2} C _ {2} P _ {2} = - C P _ {c} \quad (\text {C o n v e x i t y H e d g i n g})
$$

- The solution of this system of two equations in two unknowns is

$$
k _ {1} = - \frac {P _ {c}}{P _ {1}} \left(\frac {D C _ {2} - C D _ {2}}{D _ {1} C _ {2} - C _ {1} D _ {2}}\right); \quad k _ {2} = - \frac {P _ {c}}{P _ {2}} \left(\frac {D C _ {1} - C D _ {1}}{D _ {2} C _ {1} - C _ {2} D _ {1}}\right) \tag {12}
$$

# Duration and Convexity Hedging: Example

- In the previous example, now let the fund use also a \(T_{1} = 2\)-year zero for hedging (priced at \(Z(0, T_{1}) = \\)91.39\)).  
- The convexity of the bond we want to hedge is  $C = 73.87$ . Given  $D_{1} = 2$ ,  $D_{2} = 10$ ,  $C_{1} = 4$ , and  $C_{2} = 100$ , we obtain  $k_{1} = -0.4562$  and  $k_{2} = -1.1737$ .

<table><tr><td rowspan="2">Spot Curve Shift</td><td colspan="5">Panel B: Duration and Convexity</td><td rowspan="2">Change in Portfolio Value</td></tr><tr><td>P</td><td>\( P_{z}(0,T_{1}) \)</td><td>\( P_{z}(0,T_{2}) \)</td><td>Position \( k_{1} \)</td><td>Position \( k_{2} \)</td></tr><tr><td>Initial Value</td><td>103.58</td><td>91.39</td><td>63.76</td><td>-0.4562</td><td>-1.1737</td><td></td></tr><tr><td>dr = 0.1%</td><td>102.75</td><td>91.21</td><td>63.13</td><td>-0.4562</td><td>-1.1737</td><td>0.0000</td></tr><tr><td>dr = 1.0%</td><td>95.63</td><td>89.58</td><td>57.69</td><td>-0.4562</td><td>-1.1737</td><td>0.0003</td></tr><tr><td>dr = 2.0%</td><td>88.38</td><td>87.81</td><td>52.20</td><td>-0.4562</td><td>-1.1737</td><td>0.0023</td></tr><tr><td>dr = -0.1%</td><td>104.41</td><td>91.58</td><td>64.40</td><td>-0.4562</td><td>-1.1737</td><td>0.0000</td></tr><tr><td>dr = -1.0%</td><td>112.29</td><td>93.24</td><td>70.47</td><td>-0.4562</td><td>-1.1737</td><td>-0.0003</td></tr><tr><td>dr = -2.0%</td><td>121.84</td><td>95.12</td><td>77.88</td><td>-0.4562</td><td>-1.1737</td><td>-0.0027</td></tr></table>

- There duration plus convexity hedging strategy achieves a better hedge even with large changes in interest rates.

# Convexity Trading and the Passage of Time

- The previous example highlights a seemingly profitable trading strategy.
- If we go long bonds with high convexity, such as long-term bonds, and duration hedge the interest rate risk using bonds with low convexity, such as short-term bonds, we gain positive returns from convexity.  
- That is, in equation

$$
d V \approx - \left(D P _ {c} + k D _ {z} Z\right) d r + \frac {1}{2} \left(P _ {c} C + k Z C _ {z}\right) d r ^ {2}
$$

the first parenthesis is always zero, because of hedging, while the second parenthesis is always positive, entailing a positive flow of money.

- Is this an arbitrage? Can we make large profits by loading on convexity?
- No. The simple example above leaves out an important component of return, and this is the passage of time.

# An Issue with Duration Hedging

Suppose that on April 1, 2004 a fixed income fund has \$100 million (par amount) invested in a 3.875 coupon bond expiring on February 15, 2013. The price of the bond on that day is $101.50 (per $100 of face value), and its duration is D = 7.491  

- Let's duration hedges with the zero with  $T = \text{Feb 15, 2005 (duration } D_{S} = 0.87$

$$
k _ {S} = - \frac {D \times P}{D _ {S} \times P _ {S}} = \frac {7 . 4 9 1 \times 1 0 1 . 5}{0 . 8 7 \times 9 9 . 0 0 1 9} = - 8. 8 3
$$

- Between April 1, 2004 and April 15, 2004, the yield curve shifted up by  $0.5\%$ , on average.  
- An effective duration hedge should have largely hedged the losses due to the shift in interest rates.

– If we add 0.50% to each of the yield on April 1 and recompute the value of the hedged portfolio, we find its value would only change from $101.50 to $101.57, implying 0.07% increase in value.

# An Issue with Duration Hedging

- In sharp contrast, the new yield curve implies the value of the hedged portfolio is

$$
V_{4 / 15 / 2004} = \\(98.20,\quad \text{a decline of} 3.30\% .
$$

- The hedging strategy did not work as expected.  
- It did work partially, as the unhedged portfolio would have dropped instead to

$$
V _ {4 / 15 / 2004} ^ {\mathrm {n o h e d g e}} = \\mathbb {S} 97.42, \quad \mathrm {a d e c r e a s e o f} 4.01 \%.
$$

- The problem with the duration hedge is that the slope of the terms structure changed.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/b6361720248cb2095f4ef0acff88d5b62268e07b9e2ee5875dafa13b2d9d327c.jpg)  
2020 Variation in yields

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/d10b2579ed1ee5e3c71cca256e239cd88da6d382e24b2deb940b1d58fe255841.jpg)  
The Dynamics of the Term Structure: Level, Slope, and Curvature

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/a289bfbed2b2973cd181481dda3d3ee3f4b7ddc9d109009804010731ddbad64a.jpg)  
Panel B: Term Spread (Slope)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/07bef42dcf7924d8bde499cba1fd9ceeaed73db26fdc91c2a7eb5ec109757d6e.jpg)  
Panel C:Butterfly Spread (Curvature)

# A Factor Representation of Yield Changes

- Let  $\phi_1(t), \phi_2(t)$  and  $\phi_3(t)$  be three independent factors that affect the term structure.  
- We do not know them yet: The exercise is exactly to find them out.  
- Consider the constant maturities  $\tau_{1}, \tau_{2}, \ldots, \tau_{n}$ : that is,  $\tau_{1} =$  one month,  $\tau_{2} = 2$  months,  $\ldots$ $\tau_{n} = 10$  years, for instance.  
- Denoting  $r(t, t + \tau_i)$  the continuously compounded yield at  $t$  of a zero coupon bond maturing at  $t + \tau_i$ , for each of these maturities  $\tau_i$ , let

$$
\Delta r _ {i} (t) = r (t + h, t + h + \tau_ {i}) - r (t, t + \tau_ {i}).
$$

# A Factor Representation of Yield Changes

- Assume that the dynamics of interest rates is:

$$
\Delta r _ {1} (t) = \alpha_ {1} + \beta_ {1 1} \Delta \phi_ {1} (t) + \beta_ {1 2} \Delta \phi_ {2} (t) + \beta_ {1 3} \Delta \phi_ {3} (t) + \varepsilon_ {1} (t)
$$

$$
\Delta r _ {2} (t) = \alpha_ {2} + \beta_ {2 1} \Delta \phi_ {1} (t) + \beta_ {2 2} \Delta \phi_ {2} (t) + \beta_ {2 3} \Delta \phi_ {3} (t) + \varepsilon_ {2} (t)
$$

$$
\vdots = \vdots \tag {13}
$$

$$
\Delta r _ {n} (t) = \alpha_ {n} + \beta_ {n 1} \Delta \phi_ {1} (t) + \beta_ {n 2} \Delta \phi_ {2} (t) + \beta_ {n 3} \Delta \phi_ {3} (t) + \varepsilon_ {n} (t)
$$

# Identifying the Factors: Principal Component Analysis

- The factors driving the term structure are implicit in the  $\Delta r_{1}(t),\ldots,\Delta r_{n}(t)$ .  
- PCA assumes they are linear combination of the underlying yields.  
- That is, for  $i = 1,2,3$  we have

$$
\Delta \phi_ {i} (t) = a _ {i 1} \times \Delta r _ {1} (t) + \ldots + a _ {i n} \times \Delta r _ {n} (t)
$$

- Denote  $\sigma_{k\ell} = \operatorname{Cov}\left(\Delta r_k, \Delta r_\ell\right)$  
- Let's start with the first factor  $\phi_1(t)$ .  
- Objective: Find  $a_{11}, \ldots, a_{1n}$  to maximize the variance of  $\Delta \phi_1(t)$

$$
\max _ {\alpha_ {1 1}, \dots , \alpha_ {1 n}} V a r \left(\Delta \phi_ {i}\right) = \sum_ {k = 1} ^ {n} \sum_ {\ell = 1} ^ {n} a _ {1 k} a _ {1 \ell} \sigma_ {k \ell} \tag {14}
$$

under the restriction  $\Sigma_{j=1}^{n} a_{1j}^{2} = 1$  

- Since  $\Delta \phi_{1}(t)$  is a linear combination of all the yields and it is found to maximize its variability, it is intuitive that it will co-vary a lot with all the yields  $\Delta r_{1}(t),\ldots,\Delta r_{n}(t)$ .

# Identifying the Factors: Principal Component Analysis

- It is as if we are maximizing some weighted average of the  $\mathsf{R}^2$ s of the multiple regressions

$$
\begin{array}{l} \Delta r _ {1} (t) = \alpha_ {1} + \beta_ {1 1} \Delta \phi_ {1} (t) + \varepsilon_ {1} (t) \\ \Delta r _ {2} (t) = \alpha_ {2} + \beta_ {2 1} \Delta \phi_ {1} (t) + \varepsilon_ {2} (t) \\ \vdots = \vdots \tag {15} \\ \end{array}
$$

$$
\Delta r _ {n} (t) = \alpha_ {n} + \beta_ {n 1} \Delta \phi_ {1} (t) + \varepsilon_ {n} (t)
$$

- After the first component, we can compute the residual of the regression (15): For all  $i = 1,..,n$

$$
\hat {\varepsilon} _ {i} (t) = \Delta r _ {i} (t) - \alpha_ {i} - \beta_ {i 1} \Delta \phi_ {1} (t)
$$

- The variation of the residuals  $\hat{\varepsilon}_i(t)$  is what is left to "explain."
- Hence, we can compute the second component as

$$
\Delta \phi_ {2} (t) = a _ {2 1} \times \hat {\varepsilon} _ {1} (t) + \ldots + a _ {2 n} \times \hat {\varepsilon} _ {n} (t)
$$

- We find again the  $a_{21}, \ldots, a_{2n}$  that maximize

$$
\max  _ {a _ {2 1}, \dots , a _ {2 n}} V a r \left(\Delta \phi_ {2} (t)\right) \tag {16}
$$

- conditional again on  $\sum_{j=1}^{n} a_{2j}^{2} = 1$ . And so on.

# The Implementation of PCA

- Start from the  $n \times n$  variance-covariance matrix of  $\Delta r_{i}(t)$ 's. Denote it by

$$
M = C o v \left(\Delta r _ {1} (t), \dots , \Delta r _ {n} (t)\right)
$$

- Compute the eigenvalues and eigenvectors of  $M$ , i.e. those scalars  $\lambda_{i}$  (eigenvalues) and vectors  $\mathbf{v}_{i} = (v_{i1}, \ldots, v_{in})'$  related by

$$
M \mathbf {v} _ {i} = \lambda_ {i} \mathbf {v} _ {i}
$$

- Order  $\lambda_{1} > \lambda_{2} > \ldots > \lambda_{n}$ . It can be shown then the eigenvector  $\mathbf{v}_{1}$  is the solution to the first maximization (14), that is  $\mathbf{v}_{1} = (a_{11},\dots,a_{1n})$

— Accordingly, we set

$$
\Delta \phi_ {1} (t) = \sum_ {k = 1} ^ {n} v _ {1 k} \Delta r _ {k} (t)
$$

- We then run the regression (15) and compute the residuals  $\hat{\varepsilon}_1(t), \dots, \hat{\varepsilon}_n(t)$

# The Implementation of PCA

- $\mathbf{v}_{2}$  is the solution to the second maximization (16). Accordingly, we set the second factor

$$
\Delta \phi_ {2} (t) = \sum_ {k = 1} ^ {n} v _ {2 k} \hat {\varepsilon} _ {k} (t)
$$

- We run the regression (13) with two factors. And so on.  
Notes:

- This procedure gives  $\Delta \phi_{i}(t)$ . The factor  $\phi_{i}(t)$  is the cumulated sum.  
- Consider the "beta" from the regression from factor 1. Using vector notation

$$
\begin{array}{l} \beta_ {i 1} = \frac {C o v (\Delta r _ {i} (t) , \Delta \phi_ {1} (t))}{V a r (\Delta \Phi_ {1} (t))} = \frac {C o v (\Delta r _ {i} (t) , \Sigma_ {k = 1} ^ {n} v _ {1 k} \Delta r _ {k} (t))}{V a r (\Sigma_ {k = 1} ^ {n} v _ {1 k} \Delta r _ {k})} \\ = \frac {\mathbf {1} _ {i} ^ {\prime} M \mathbf {v} _ {1}}{\mathbf {v} _ {1} ^ {\prime} M \mathbf {v} _ {1}} = \frac {\mathbf {1} _ {i} ^ {\prime} \lambda_ {1} \mathbf {v} _ {1}}{\lambda_ {1} \mathbf {v} _ {1} ^ {\prime} \mathbf {v} _ {1}} = v _ {1 i} \\ \end{array}
$$

$\Rightarrow$  The beta coefficients in (13) are just the eigenvectors:  $\beta_{ij} = v_{ji}$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/d0fa1ad02ffad3666aa95a8f19e3126f3477ff07f6b6a905e7e20c7b7e5f3e2b.jpg)  
Factors from PCA

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/1424353fa685bf3c4338d70f824033d037edf0303928eac7e8bf80bf090d015c.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c47a251f7a697f64d04406867d8fcd49822e6fd3e0d68b41c36247584c075543.jpg)  
Data Source: CRSP

# Parallel Shifts, Slope Tilts and Curvature Changes

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/36d2f0af656e9889d6f6d4e936efed66db63d321974b668026bdd6340384bcb6.jpg)  
Regression coefficients  $\beta_{ij}$

# The Sensitivity of Interest Rates to PCA Level, Slope, and Curvature

<table><tr><td rowspan="2">Factor</td><td colspan="7">Maturity</td></tr><tr><td>1 month</td><td>6 months</td><td>1 year</td><td>2 year</td><td>3 year</td><td>4 year</td><td>5 year</td></tr><tr><td colspan="8">Panel A: Level</td></tr><tr><td>\( \beta_{i1}^{PCA} \)</td><td>0.4416</td><td>0.4167</td><td>0.4315</td><td>0.3762</td><td>0.3421</td><td>0.3169</td><td>0.2935</td></tr><tr><td>\( R^2 \)</td><td>61.15%</td><td>79.52%</td><td>91.66%</td><td>88.61%</td><td>83.89%</td><td>75.06%</td><td>73.03%</td></tr><tr><td colspan="8">Panel B: Slope</td></tr><tr><td>\( \beta_{i2}^{PCA} \)</td><td>-0.7307</td><td>-0.2774</td><td>0.0848</td><td>0.2425</td><td>0.2909</td><td>0.3559</td><td>0.3344</td></tr><tr><td>\( R^2 \)</td><td>95.91%</td><td>86.83%</td><td>92.39%</td><td>96.25%</td><td>96.48%</td><td>94.72%</td><td>92.71%</td></tr><tr><td colspan="8">Panel C: Curvature</td></tr><tr><td>\( \beta_{i3}^{PCA} \)</td><td>0.5186</td><td>-0.7099</td><td>-0.2869</td><td>-0.0231</td><td>0.1411</td><td>0.2267</td><td>0.2700</td></tr><tr><td>\( R^2 \)</td><td>99.99%</td><td>97.99%</td><td>94.35%</td><td>96.27%</td><td>97.17%</td><td>96.58%</td><td>95.70%</td></tr></table>

- The first three PCAs explain the vast majority of the variation in yields  $-\Rightarrow$  If we hedge the three PCAs, we hedge most of interest rate risk.

# Interest Rate Risk Management and Factor Duration

- The factor duration of an asset with price  $P$  with respect to factor  $j$ :

$$
D _ {j} = - \frac {1}{P} \frac {d P}{d \phi_ {j}} \tag {17}
$$

From PCA we can approximate

$$
\frac {d r _ {i}}{d \phi_ {j}} \approx \beta_ {i j}
$$

- Example 1. From the definition of a zero coupon bond  $Z(t, t + \tau_i) = e^{-r_i(t)\tau_i}$  the duration with respect to factor  $j$  is

$$
\begin{array}{l} D _ {z, j} = - \frac {1}{Z (t , t + \tau_ {i})} \frac {d Z (t , t + \tau_ {i})}{d \phi_ {j}} \\ = - \frac {1}{Z (t , t + \tau_ {i})} \frac {d Z (t , t + \tau_ {i})}{d r _ {i}} \times \frac {d r _ {i}}{d \phi_ {j}} \\ \mathbf {\tau} = \boldsymbol {\tau} _ {i} \times \boldsymbol {\beta} _ {i j} \\ \end{array}
$$

# Interest Rate Risk Management and Factor Duration

- Example 2. From the definition of a coupon bond:

$$
P _ {c} (t, T) = \frac {c}{2} \sum_ {i = 1} ^ {n} Z (t, T _ {i}) + Z (t, T _ {n})
$$

- the duration of the bond with respect to factor  $j$  is

$$
D _ {j} = - \frac {1}{P _ {c}} \frac {d P _ {c}}{d \phi_ {j}} = \sum_ {i = 1} ^ {n} w _ {i} \tau_ {i} \beta_ {i j}
$$

- Given  $D_{j}$ , we can approximate the return of a security by

$$
\frac {d P}{P} \approx - D _ {1} d \phi_ {1} - D _ {2} d \phi_ {2} - D _ {3} d \phi_ {3}
$$

# Interest Rate Risk Management: Factor Neutrality

- A portfolio  $P$  has factor durations  $D_{1}$  and  $D_{2}$  with respect to level and slope.  
- To implement factor neutrality, we need to select two other securities.  
- E.g. a shortand a long-dated zero coupon bonds, denoted by  $P_{z}^{S}$  and  $P_{z}^{L}$ . For each, compute the factor durations,  $D_{z,1}^{S}, D_{z,2}^{S}, D_{z,1}^{L}$  and  $D_{z,2}^{L}$ .  
- We want to choose  $k_{S}$  and  $k_{L}$ , such that the variation of the portfolio plus the two bonds is approximately zero. That is, such that the change in  $V = P + k_{S} \times P_{z}^{S} + k_{L} \times P_{z}^{L}$  satisfies

$$
d V = d P + k _ {F} \times d P _ {z} ^ {S} + k _ {L} \times d P _ {z} ^ {L} = 0
$$

- The same steps as in the case of duration / convexity hedging yield the two equations:

$$
k _ {S} \times D _ {z 1} ^ {S} \times P _ {z} ^ {S} + k _ {L} \times D _ {z 1} ^ {L} \times P _ {z} ^ {L} = - D _ {1} \times P
$$

$$
k _ {S} \times D _ {z 2} ^ {S} \times P _ {z} ^ {S} + k _ {L} \times D _ {z 2} ^ {L} \times P _ {z} ^ {L} = - D _ {2} \times P
$$

# Interest Rate Risk Management: Factor Neutrality

- The solution of this system is:

$$
k _ {S} = - \frac {P}{P _ {z} ^ {S}} \left(\frac {D _ {1} \times D _ {z 2} ^ {L} - D _ {2} \times D _ {z 1} ^ {L}}{D _ {z 1} ^ {S} \times D _ {z 2} ^ {L} - D _ {z 2} ^ {S} \times D _ {z 1} ^ {L}}\right); \tag {18}
$$

$$
k _ {L} = - \frac {P}{P _ {z} ^ {L}} \left(\frac {D _ {1} \times D _ {z 2} ^ {S} - D _ {2} \times D _ {z 1} ^ {S}}{D _ {z 1} ^ {L} \times D _ {z 2} ^ {S} - D _ {z 2} ^ {L} \times D _ {z 1} ^ {S}}\right) \tag {19}
$$

# Factor Neutrality: Example

- Consider again the previous example, but use now a short-term and a long-term zeros to hedge. Specifically, use the zeros maturing on Feb. 15, 2005 and on Feb. 15, 2013.  
- Using the data about level and slope, we find the following factor durations:

$$
\begin{array}{l} \mathrm {L o n g - t e r m c o u p o n b o n d}: D _ {1} = 6. 9 6 2 4; \quad D _ {2} = 4. 0 7 9 7; \\ \text {S h o r t - t e r m z e r o}: D _ {1} ^ {S} = 0. 9 7 2 9; \quad D _ {2} ^ {S} = - 0. 2 2 1 5; \\ \mathrm {L o n g - t e r m z e r o}: D _ {1} ^ {L} = 8. 1 9 1 2; \quad D _ {2} ^ {L} = 5. 3 1 5 0. \\ \end{array}
$$

- Using Equation (18) we obtain that the positions  $k_{S}$  and  $k_{L}$  in the short-term and long-term zero coupon bonds are

$$
k _ {S} = - 0. 5 2 6 6; \quad k _ {L} = - 1. 1 2 5 9
$$

- In this case, on April 15 2007 the hedged portfolio is worth

$$
V _ {4 / 15 / 2004} ^ {\text {Factor Hedge}} = \$ 100.91, \quad \text {a drop of only} 0.58 \%
$$

# Teaching Notes

Understanding the Term Structure of Interest Rates<sup>1</sup>

# John Heaton

The University of Chicago

Booth School of Business

NBER

# Introduction

- There are numerous questions that arise when we think about the term structure of interest rates, such as:

1. Why does the term structure of interest rates tend to slope upwards?  
2. What is the risk involved in investing in Treasury securities?  
3. Can we predict medium-to-long term yields? What about returns?

# The Expectations Hypothesis

- The expectations hypothesis is the hypothesis that long-term yields just reflect market participants' expectation of future interest rates

Long-term yield  $=$  Expected future short-term rates

- To illustrate, let today be  $t$  and consider the case in which investors have perfect foresight of the next 1-year interest rates  $y_{t+1}(1)$ .  
- Investors then also know that the zero coupon bond price next year will be

$$
Z _ {t + 1} (1) = e ^ {- y _ {t + 1} (1) \times 1}
$$

- Because under these assumptions,  $Z_{t + 1}(1)$  is known today, its value today is the discounted value using the current 1-year yield:

$$
Z _ {t} (2) = Z _ {t} (1) \times Z _ {t + 1} (1) = e ^ {- (y _ {t} (1) + y _ {t + 1} (1))}
$$

- Because the two-year yield also satisfies  $Z_{t}(2) = e^{-y_{t}(2)\times 2}$ , we obtain that under perfect foresight

$$
y _ {t} (2) = \frac {1}{2} (y _ {t} (1) + y _ {t + 1} (1))
$$

# The Expectations Hypothesis (cntd.)

- Extending this reasoning to  $n$  future one-year yields, then under perfect foresight the yield of a zero-coupon bond with  $n + 1$  years to maturity is:

$$
y _ {t} (n + 1) = \mathsf {A v e r a g e} [ y _ {t} (1), y _ {t + 1} (1), \ldots , y _ {t + n} (1) ] = \frac {1}{n + 1} \sum_ {i = 0} ^ {n} y _ {t + i} (1)
$$

- The expectations hypothesis substitutes the perfect foresight with forecasts:

The long term yield  $=$  forecasted average path of future rates

$$
y _ {t} (n + 1) = E _ {t} \left[ \frac {1}{n + 1} \sum_ {i = 0} ^ {n} y _ {t + i} (1) \right] \tag {1}
$$

- Subtracting the current 1-year yield, we can also write

$$
y _ {t} (n + 1) - y _ {t} (1) = E _ {t} \left[ \frac {1}{n + 1} \sum_ {i = 0} ^ {n} y _ {t + i} (1) \right] - y _ {t} (1) \tag {2}
$$

# Preliminary Heuristic Evidence

- Does this relation holds in the data?

— Heuristically, next figure plots the expected future three-month rates from the Survey of Professional Forecasters from 1981 to 2015.  

- The forecasts are for the three-month T-bill rate for the current quarter, denote in the figure by  $r(t)$ , and for the next three quarters, denoted by  $r(t + 3m)$ ,  $r(t + 6m)$ , and  $r(t + 9m)$ , respectively.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/fee900fc30e0e5e1cf6089c33e1e2df48f38eb3797847fb38f22e41a998cf9e0.jpg)  
Consensus Forecasts of Future 3-Month T-Bill Rates

- Next figure shows the 1-year term spread, defined as  $y_{t}(1y) - r(t)$  together with the 1-year "expectation spread".

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/8b049bff6b262ebadf352696304ce509be26e4c863a14be2051c616aa8c9ae3e.jpg)  
1-Year Expectation Spread vs 1-Year Term Spread

- The 1-year term spread is greater than the "expectation spread" most of the time.  
- $\Rightarrow$  the expectation hypothesis does not hold (at least, using survey forecasts).

# The Expectation Hypothesis and Forward Rates

- We saw in Teaching Notes 1 that a forward rate at  $t$  for an investment between  $\tau_{1}$  and  $\tau_{2}$  can be written as

$$
f _ {t} (\tau_ {1}, \tau_ {2}) = \frac {1}{\tau_ {2} - \tau_ {1}} \ln \left(\frac {Z _ {t} (\tau_ {1})}{Z _ {t} (\tau_ {2})}\right) = \frac {1}{\tau_ {2} - \tau_ {1}} (y _ {t} (\tau_ {2}) \tau_ {2} - y _ {t} (\tau_ {1}) \tau_ {1}) \qquad (3)
$$

- Consider a sequence of maturities  $\tau_{i} = \tau_{i - 1} + \Delta t$ , for  $i = 2, \dots, n$ . We have

$$
\begin{array}{l} f _ {t} (\tau_ {1}, \tau_ {2}) = \frac {1}{\Delta t} (y _ {t} (\tau_ {2}) \tau_ {2} - y _ {t} (\tau_ {1}) \tau_ {1}) \\ f _ {t} (\tau_ {2}, \tau_ {3}) = \frac {1}{\Delta t} (y _ {t} (\tau_ {3}) \tau_ {3} - y _ {t} (\tau_ {2}) \tau_ {2}) \\ \vdots \qquad \vdots \qquad \vdots \\ f _ {t} (\tau_ {n - 2}, \tau_ {n - 1}) = \frac {1}{\Delta t} (y _ {t} (\tau_ {n - 1}) \tau_ {n - 1} - y _ {t} (\tau_ {n - 2}) \tau_ {n - 2}) \\ f _ {t} (\tau_ {n - 1}, \tau_ {n}) = \frac {1}{\Delta t} (y _ {t} (\tau_ {n}) \tau_ {n} - y _ {t} (\tau_ {n - 1}) \tau_ {n - 1}) \\ \end{array}
$$

# The Expectation Hypothesis and Forward Rates (cntd.)

- Summing over all of the forward rates, we find

$$
\sum_ {i = 2} ^ {n} f _ {t} (\tau_ {i - 1}, \tau_ {i}) = \frac {1}{\Delta t} (y _ {t} (\tau_ {n}) \tau_ {n} - y _ {t} (\tau_ {1}) \tau_ {1})
$$

- Assuming  $\tau_{1} = \Delta t$  and defining  $f_{t}(0, \Delta t) = y_{t}(\Delta t)$ , we the obtain

$$
y _ {t} (\tau_ {n}) = \frac {\Delta t}{\tau_ {n}} \sum_ {i = 1} ^ {n} f _ {t} (\tau_ {i - 1}, \tau_ {i}) = \text {A v e r a g e f o r w a r d r a t e s} \tag {4}
$$

- The expectation hypothesis then implies that for every  $i$  the forward rate is equal to the expected future short-term rate: $^2$

$$
f _ {t} (\tau_ {i}, \tau_ {i} + \Delta t) = E _ {t} [ y _ {t + \tau_ {i}} (\Delta t) ].
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/7a3fca6d9bd4130eff42bb150eb9dd6696a058f92c26106701dd7d22936014a4.jpg)  
Expected 3-Month T-Bill Rate vs. Forward Rate

- Again, expected future rates are mostly lower than forward rates.

# Time Varying Risk Premia

- The violation of the expectations hypothesis (and the time variation in spread) suggests the existence of an additional term in Equation (1):

$$
y _ {t} (n + 1) = E _ {t} \left[ \frac {1}{n + 1} \sum_ {i = 0} ^ {n} y _ {t + i} (1) \right] + R P _ {t} \tag {5}
$$

- where  $R{P}_{t}$  reflects a risk premium from holding the bond from  $t$  to  $t + 1$  .  
- The time variation in  $R{P}_{t}$  invalidates the expectations hypothesis.
- Even if the expectation of future interest rates does not change, the yield curve may change because  $R P_{t}$  changes.  
- Therefore, movements in the yield curve do not only correspond to variations in expected future short-term yields.

# Term Structure Decomposition

- Let  $y_{t}(n + 1) =$  yield at  $t$  of a bond with time to maturity  $(n + 1)$  years from  $t$

$$
Z _ {t} (n + 1) = e ^ {- y _ {t} (n + 1) (n + 1)} \tag {6}
$$

- The value of this bond next year will then be

$$
Z _ {t + 1} (n) = e ^ {- y _ {t + 1} (n) \times n}
$$

- The yield next year  $y_{t + 1}(n)$  is not known. Assume it normally distributed

$$
y _ {t + 1} (n) \sim \mathcal {N} (\overline {{y}}, V)) \quad \mathrm {w i t h} \quad \overline {{y}} = E [ y _ {t + 1} (n) ]
$$

- $Z_{t + 1}(n)$  is risky and so investors at  $t$  may require an additional discount  $RP$ :

$$
Z _ {t} (n + 1) = e ^ {- (y _ {t} (1) + R P _ {t}) \times 1} E _ {t} [ Z _ {t + 1} (n) ] \tag {7}
$$

- Using the properties of the normal distribution,³ we then obtain

$$
E _ {t} [ Z _ {t + 1} (n) ] = e ^ {- \overline {{y}} \times n + \frac {(n) ^ {2}}{2} V}
$$

3If  $x\sim N(\mu_x,\sigma_x^2)$  , then  $E[e^{x}] = e^{\mu_{x} + \frac{1}{2}\sigma_{x}^{2}} > e^{\mu_{x}}$  . Hence,  $\frac{1}{2}\sigma_x^2$  quantifies the Jensen's effect.

# Term Structure Decomposition (cntd.)

Using (6) and (7) we then obtain

$$
\begin{array}{l} y _ {t} (n + 1) = \frac {1}{n + 1} \times y _ {t} (1) + \frac {n}{n + 1} \times E _ {t} [ y _ {t + 1} (n) ] \qquad (\mathrm {E x p e c t e d f u t u r e y i e l d}) \\ + \frac {R P}{n + 1} \\ - \frac {n ^ {2}}{2 (n + 1)} V _ {t} \\ \end{array}
$$

(Convexity)

(8)

- The current long-term yield  $y_{t}(n + 1)$  depends on

1. The weighted average between the current short-term yield and the expected long-term yield next year.  
2. A risk premium RP that market participants require to hold long-term zero coupon bonds with maturity  $n + 1$  over safe bonds with maturity 1.  
3. A convexity term due to the nonlinear relation that exists between the yield  $y_{t + 1}(n)$  and the price  $Z_{t + 1}(n) = e^{-y_{t + 1}(n)\times n}$ .

# Expectation Hypothesis (again)

- Let  $R{P}_{t} = \frac{{n}^{2}}{2}{V}_{t}$  . Then the expectation hypothesis holds:

$$
y _ {t} (n + 1) = \frac {1}{n + 1} \times y _ {t} (1) + \frac {n}{n + 1} \times E _ {t} [ y _ {t + 1} (n) ] \qquad (9)
$$

- Subtract  $y_{t}(n + 1) \times (n) / (n + 1)$  on both sides, to get

$$
E _ {t} [ y _ {t + 1} (n) ] - y _ {t} (n + 1) = \frac {1}{n} [ y _ {t} (n + 1) - y _ {t} (1) ] \qquad (1 0)
$$

Expected Change in Yield

Slope of Term Structure

- A steep term structure (on the RHS) signals the market expects an increase in the yield  $y_{t}(n + 1)$  between  $t$  and  $t + 1$  (on the LHS)

$$
E _ {t} \left[ y _ {t + 1} (n) \right] > y _ {t} (n + 1)
$$

$- \Rightarrow$  market expects a low or negative return on  $(n + 1)$  maturity bond.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f1ca5282fa9100f6e452fbbb13e34ae437fa70e63f87248fe1fe6716264c2429.jpg)  
Long-Term Yield Increase

- Example: On  $t = 1 / 31 / 1994$  yield curve was increasing and the spread was  $3.3\%$ .  
- High spread may signal long-term yield  $y_{t}(30) = 6.87\%$  may increase.  
- And indeed, it did:  $t + 1 = 1 / 31 / 1995$  we have  $y_{t+1}(29) = 7.81\%$ .  
- This implies a loss on investment:  $R_{t,t+1} = \frac{Z_{t+1}(29)}{Z_t(30)} - 1 = \frac{10.3893}{12.7048} - 1 = -18\%$

# Does the Expectation Hypothesis Hold in the Data?

- Does a high slope predict an increase in future yields? (i.e. should you go short?)  
- In an influential paper, Campbell and Shiller (1988) run the following regressions

$$
\text {C h a n g e s i n y i e l d} = \alpha + \beta \times \operatorname {S l o p e} _ {t} + \varepsilon_ {t + 1} \tag {11}
$$

- That is, from yield data we can compute a dependent "Y" variable

$$
Y _ {t} = \text {C h a n g e s i n y i e l d} = y _ {t + 1} (n) - y _ {t} (n + 1); t = 1, 2, \dots , T
$$

and an explanatory "  $X$  " variable

$$
X _ {t} = \mathsf {S l o p e} _ {t} = \frac {1}{n} \left[ y _ {t} (n + 1) - y _ {t} (1) \right]; \quad t = 1, 2, \ldots , T
$$

- Then Campbell and Shiller (1988) run the regression

$$
Y _ {t} = \alpha + \beta X _ {t} + \varepsilon_ {t + 1} \tag {12}
$$

- The expectations hypothesis has  $\alpha = 0$  and  $\beta = 1$ .  
- We can see if this true in the data.

# Campbell and Shiller Regression

Test of the Expectation Hypothesis  

<table><tr><td rowspan="2">Maturity n</td><td colspan="5">Panel A: Yield Change Prediction from Slope</td></tr><tr><td>α</td><td>se(α)</td><td>β</td><td>se(β)</td><td>R²</td></tr><tr><td>2</td><td>-0.01</td><td>0.27</td><td>-0.83</td><td>0.52</td><td>0.03</td></tr><tr><td>3</td><td>0.09</td><td>0.24</td><td>-1.23</td><td>0.62</td><td>0.05</td></tr><tr><td>4</td><td>0.16</td><td>0.21</td><td>-1.59</td><td>0.70</td><td>0.07</td></tr><tr><td>5</td><td>0.17</td><td>0.21</td><td>-1.56</td><td>0.76</td><td>0.06</td></tr></table>

Notes: Regression results based on Fama Bliss discount bond data from CRSP. Sample: 1964 - 2006.

- Important to note:
- $\beta \neq 1 \Rightarrow$  Expectations Hypothesis is rejected  
- $\beta < 0 \Rightarrow$  steep yield curve predicts a decrease of long-term yield.

* This is the opposite of the basic simple intuition about a raising yield curve.

- Bottom line: A steep yield curve predicts high returns of long-term bonds.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/03f68dc2705d0adfc1717b58dbd63baa656639695a73879cbfb4a65db10ee845.jpg)  
Long-Term Yield Decrease

- Example: On  $t = 1/30 / 2004$  yield curve was increasing and the spread was  $4.1\%$ .  
- In the data, high spread forecast a decline of long-term yield  $y_{t}(30) = 5.347\%$ .  
- And indeed, it did:  $t + 1 = 1/31/2005$  we have  $y_{t+1}(29) = 4.655\%$ .  
- This implies a gain on investment:  $R_{t,t+1} = \frac{Z_{t+1}(29)}{Z_t(30)} - 1 = \frac{25.9279}{20.1046} - 1 = +29\%$

# Time Varying Risk Premia

- This result implies that the slope of the term structure predicts

$$
L R P _ {t} = R P _ {t} - \frac {n ^ {2}}{2} V _ {t}, \tag {13}
$$

- $LRP_{t}$  stands for "Log Risk Premium" (see below).  
- In fact, we can rewrite (8) as

$$
E _ {t} \left[ y _ {t + 1} (n) - y _ {t} (n + 1) \right] = \frac {1}{n} \left[ y _ {t} (n + 1) - y _ {t} (1) \right] - L R P _ {t} \tag {14}
$$

- We know slope is not positively related to the left-hand-side (previous table)  $\Rightarrow$  then it must be positively correlated with  $LRP_{t}$ .
- When slope increases so does  $LRP_{t}$ , thereby killing the positive correlation.
- Implication:
- High slope  $\nRightarrow$  market expects higher future rates.  
- High slope  $\Rightarrow$  high risk premium  $\Rightarrow$  high expected return of long-term bonds  $\Rightarrow$  strong price increase  $\Rightarrow$  low future yield.

# The Predictability of Bond Returns

- The Log Risk Premium  $LRP_{t}$  can also be rewritten as:

$$
L R P _ {t} = E _ {t} \left[ \log \left(\frac {Z _ {t + 1} (n)}{Z _ {t} (n + 1)}\right) - \log \left(\frac {1}{Z _ {t} (1)}\right) \right] \tag {15}
$$

- The expectation hypothesis implies  $LRP_{t} = 0$ .  
- To test for this hypothesis, denote the Log Excess Return (LER) from holding a long-term zero coupon bond over the short term bond by

$$
L E R _ {t} = \log \left(\frac {Z _ {t + 1} (n)}{Z _ {t} (n + 1)}\right) - \log \left(\frac {1}{Z _ {t} (1)}\right) \tag {16}
$$

- $LER_{t}$  is the ex-post realized empirical counterpart of  $LRP_{t}$ :

$$
L R P _ {t} = E _ {t} [ L E R _ {t} ]
$$

# Fama Bliss Regressions

- Fama and Bliss (1987) then run the following regression

$$
L E R _ {t} = \alpha + \beta \left[ f _ {t} (n, n + 1) - y _ {t} (1) \right] + \varepsilon (t) \tag {17}
$$

- The expectation hypothesis has  $LRP_{t} = 0$ , and therefore  $\alpha = \beta = 0$ .

Panel B: Log Excess Return Prediction from Forward Slope  

<table><tr><td>Maturity n</td><td>α</td><td>se(α)</td><td>β</td><td>se(β)</td><td>R2</td></tr><tr><td>2</td><td>-0.01</td><td>0.27</td><td>0.92</td><td>0.26</td><td>0.14</td></tr><tr><td>3</td><td>-0.19</td><td>0.49</td><td>1.22</td><td>0.34</td><td>0.15</td></tr><tr><td>4</td><td>-0.43</td><td>0.69</td><td>1.43</td><td>0.44</td><td>0.16</td></tr><tr><td>5</td><td>-0.16</td><td>0.93</td><td>1.11</td><td>0.51</td><td>0.07</td></tr></table>

- $\beta$  is significantly different from zero, and indeed positive.  
- This finding, again, shows that the excess log return is in fact predictable:  
  - When the forward spread is strongly positive, on average investments in long-term bonds generate a higher return compared to short term bonds.

# Cochrane and Piazzesi Factor

- Cochrane and Piazzesi (2005) have shown that a specific combination of forward rates successfully predicts excess log returns.  
- The predicting factor is defined by

$$
x _ {t} = \gamma_ {0} + \gamma_ {1} y _ {t} (1) + \gamma_ {3} f _ {t} (2, 3) + \gamma_ {5} f _ {t} (4, 5)
$$

- The parameters  $\gamma_{i}$  are estimated in a first stage regression:

— Define

$$
\overline {{L E R}} _ {t} = 0. 2 5 \times \sum_ {n = 2} ^ {5} L E R _ {t} (n)
$$

- Then, estimate  $\gamma_{i}$ 's with:

$$
\overline {{L E R}} _ {t} = \gamma_ {0} + \gamma_ {1} y _ {t} (1) + \gamma_ {3} f _ {t} (2, 3) + \gamma_ {4} f _ {t} (4, 5)) + \varepsilon_ {t}
$$

- The estimates for 1964 - 2006 sample are  $\widehat{\gamma}_0 = -3.26$ ,  $\widehat{\gamma}_1 = -1.87$ ,  $\widehat{\gamma}_3 = 3.94$ , and  $\widehat{\gamma}_5 = -1.64$ .

# Cochrane and Piazzesi Regression

- Cochrane and Piazzesi (2005) run the regression

$$
L E R _ {t} (n) = \alpha + \beta \times x _ {t} + \varepsilon_ {t} \tag {18}
$$

Panel C: Log Excess Return Prediction from Cochrane Piazzesi Factor  

<table><tr><td>Maturity n</td><td>β</td><td>se(β)</td><td>R2</td></tr><tr><td>2</td><td>0.47</td><td>0.07</td><td>0.30</td></tr><tr><td>3</td><td>0.88</td><td>0.13</td><td>0.33</td></tr><tr><td>4</td><td>1.22</td><td>0.19</td><td>0.35</td></tr><tr><td>5</td><td>1.43</td><td>0.24</td><td>0.32</td></tr></table>

- The coefficients are strongly positive, and the  $R^2$  higher than in Panel B, showing that including information on the whole term structure helps predict bond excess returns.

# Coping with Inflation Risk: Treasury Inflation-Protected Securities

- Treasury coupon bonds are in nominal terms, as they pay in dollars.  
- How much you can buy with those dollars depends on inflation before maturity.  
- Over long periods, the inflation can be pretty high.  
- CPI index = weighted average of the representative good prices.  
- The change in the CPI measures the realized inflation during the period.

# Simple Example

- We have monthly income of \(10,000 and let CPI = price of consumption basket.  
- How much we can buy at a given time \(t_1\) is \(C(t_1) = \\(10,000 / \mathsf{CPI}(t_1)\).

-E.g. if  $\mathsf{CPI}(t_1) = 10\Rightarrow$  we can buy 1000 units of consumption basket.  
 – If basket only contains \$10-burgers, we can buy C(t₁) = 1000 burgers at t₁.

- Let now be  $t_2$  and let our income be the same. Because of inflation, now  $\mathrm{CPI}(t_2) = 20$ .
- We can now only buy \(C(t_{2}) = \\)10,000 / \mathsf{CPI}(t_{2}) = 500\( burgers: big loss in consumption even if nominal income is the same.

# Inflation Risk and the Loss of Purchasing Power

- The ratio  $C(t_{2}) / C(t_{1}) = \text{loss in purchasing power of a dollar between } t_{1} \text{ and } t_{2}$ .  
- This ratio is given by  $C(t_2) / C(t_1) = \mathsf{CPI}(t_1) / \mathsf{CPI}(t_2)$ .
- In the previous example  $\mathsf{CPI}(t_1) / \mathsf{CPI}(t_2) = 0.5 \Rightarrow$  we can only afford at  $t_2$  half of the goods we could buy at  $t_1$ .
- Changes in CPI are unknown  $\Longrightarrow$  nominal securities have inflation risk
- Risk that the dollar payoff will afford less consumption goods than expected.  
- Inflation-protected securities are vehicles that hedge against this inflation risk.

# Treasury Inflation Protected Securities (TIPS)

- TIPS are coupon bonds issued with maturities of 5, 10, and 20 years.  
- The coupon rate of TIPS is a constant fraction of the principal.  
- The principal changes over time in response to inflation.
- If the CPI increases, then the principal amount increases proportionally.
- The Treasury publishes Index ratios

$$
\mathrm {I n d e x r a t i o} (t) = \max \left(\frac {\mathrm {R e f e r e n c e C P I} (t)}{\mathrm {C P I} (\mathrm {i s s u r a n c e})}, 0\right)
$$

$$
\mathrm {R e f e r e n c e C P I} (t) = w (t) \mathrm {C P I} (t - 1) + (1 - w (t)) \mathrm {C P I} (t - 2)
$$

where  $w(t)$  is a weight that depends on the quoted day of the month.

- Next Table contains quotes of Treasury securities on November 26, 2007.
- Given the index ratio, the next coupon payment is

$$
\text {C o u p o n p a y m e n t} (t) = \frac {\text {C o u p o n r a t e}}{2} \times 1 0 0 \times \text {I n d e x r a t i o} (t)
$$

<table><tr><td colspan="10">Treasury Securities on November 26, 2007</td></tr><tr><td colspan="10">Panel A: Treasury Bills</td></tr><tr><td>Coupon</td><td>Maturity</td><td>BID</td><td>ASK</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>12/20/2007</td><td>3.54</td><td>3.5</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>2/21/2008</td><td>3.05</td><td>3</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>5/22/2008</td><td>3.24</td><td>3.23</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td colspan="10">Panel B: Nominal Treasury Notes and Bonds</td></tr><tr><td>Coupon</td><td>Maturity</td><td>BID</td><td>ASK</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>3 5/8</td><td>10/31/2009</td><td>101.25</td><td>101.25</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>4 1/2</td><td>5/15/2010</td><td>103.75</td><td>103.7813</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>3 7/8</td><td>10/31/2012</td><td>102.7188</td><td>102.7188</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>4 1/4</td><td>11/15/2017</td><td>103.1563</td><td>103.1563</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>5</td><td>5/15/2037</td><td>111.7813</td><td>111.8438</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td colspan="10">Panel C: TIPS</td></tr><tr><td>Coupon</td><td>Maturity</td><td>BID</td><td>ASK</td><td>Issue Date</td><td>Issue Price</td><td>First Coupon</td><td>Reference CPI</td><td>CPI</td><td>Index Ratio</td></tr><tr><td>2</td><td>4/15/2012</td><td>104.2188</td><td>104.2813</td><td>4/30/2007</td><td>102.667</td><td>10/15/2007</td><td>202.9214</td><td>208.3945</td><td>1.02697</td></tr><tr><td>2 5/8</td><td>7/15/2017</td><td>110.125</td><td>110.2188</td><td>7/16/2007</td><td>102.722</td><td>1/15/2008</td><td>207.2564</td><td>208.3945</td><td>1.00549</td></tr><tr><td>2 3/8</td><td>1/15/2027</td><td>109.5313</td><td>109.7188</td><td>1/31/2007</td><td>99.57</td><td>7/15/2007</td><td>201.6645</td><td>208.3945</td><td>1.03337</td></tr><tr><td>3 3/8</td><td>4/15/2032</td><td>133.4063</td><td>133.625</td><td>10/15/2001</td><td>98.314</td><td>4/15/2002</td><td>177.5</td><td>208.3945</td><td>1.17405</td></tr><tr><td colspan="10">Data Source: Bloomberg, Inc.</td></tr></table>

# Reference Index Example

- The quotes in the Table are for November 26, 2007.  
- The CPI used to compute the index ratio is not the November CPI.  
  - CPI values are released by BLS during the third week of the following month.  
- CPI used is instead the average between the August and September CPIs (207.917 and 208.490, respectively).
- Because November 26 is 25 days after November 1, the calculation is

$$
\operatorname {C P I} (t) = \frac {5}{3 0} \times 2 0 7. 9 1 7 + \frac {2 5}{3 0} \times 2 0 8. 4 9 0 = 2 0 8. 3 9 4 5.
$$

- An investor in TIPS is still subject to a small inflation risk during the two months between the CPI measure and the actual payment.

# Real Bonds and the Real Term Structure of Interest Rates

- Borrowing and lending do not need dollars.
- You can borrow a car from a friend and return it in a week.  
- If you forget your wallet, you can ask your friend to buy a sandwich today with the agreement you will return the same sandwich tomorrow.

* If your "friend" see you very hungry today, he may ask you to return a bigger sandwich tomorrow. l.e. charge a big real interest rate.

- Real bonds are bonds that are denominated in units of a good instead of dollars.  
- Relevant to inflation linked securities are bonds that are denominated in units of the consumption basket that underlies the CPI index calculation.  
- A real discount factor  $Z^{real}(t;T)$  defines the exchange rate between consumption goods at  $t$  versus consumption goods at a later date  $T$ .
- How "bigger" a sandwich are we willing to give back to the "friend" tomorrow to have a sandwich today?

# Real Rates

- From real discounts  $Z^{real}(t;T)$  compute the real rate as usual:

$$
Z ^ {r e a l} (t; T) = e ^ {- r _ {r e a l} (t; T) (T - t)} \times 1 \tag {19}
$$

- implies

$$
r _ {r e a l} (t; T) = - \frac {\ln \left(Z ^ {r e a l} (t ; T)\right)}{T - t} \tag {20}
$$

- The real term structure of interest rates is  $r_{real}(t;T)$  for maturities  $T$ .  
- The value (in consumption goods) of a real coupon bond with maturity  $T$  and coupon rate  $c$  is

$$
P _ {c} ^ {r e a l} (t; T) = \frac {c \times 1 0 0}{2} \sum_ {i = 1} ^ {n} Z ^ {r e a l} (t; T _ {i}) + 1 0 0 \times Z ^ {r e a l} (t; T)
$$

# Real Bonds and TIPS

- Suppose an investment bank purchases a TIPS and strips the coupons from principal, generating a series of zero coupon bonds.  
- These zero coupon bonds pay an amount that is tied to the CPI.  
- Denoting by  $\operatorname{Idx}(T)$  the CPI adjustment for maturity  $T$  (recall, it depends on the CPI two months earlier), the payoff of a zero coupon TIPS is as follows:

$$
\text {Z e r o - c o u p o n T I P S p a y o f f a t} T = \frac {\operatorname {I d} x (T)}{\operatorname {I d} x (0)} \tag {21}
$$

- $\frac{I dx(T)}{I dx(0)} =$  increase in the consumption basket price between 0 and  $T$ .  
- For simplicity, assume

$$
I d x (T) = \operatorname {C P I} (T) = \$ \text {p r i c e o f o n e u n i t o f c o n s u m p t i o n b a s k e t}
$$

- Given  $Z^{real}(t;T)$ , the value at  $t$  of a security paying  $Idx(T)$  (i.e. the amount need to purchase one unit of consumption basket) is

$$
\text {P r e s e n t v a l u e o f} I d x (T) = \mathrm {P V} \text {o f o n e u n i t o f c o n s u m p t i o n} = Z ^ {\text {r e a l}} (t; T)
$$

# Real Bonds and TIPS (cntd)

- This present value though is expressed in terms of units of the consumption basket  $(Z^{real}(t, ;T)$  is an exchange rate of consumption at  $t$  for consumption at  $T$ ).  
- We can convert this value to dollars by multiplying it by the current price of the consumption basket  $I dx(t)$ . We then obtain

$$
\mathrm {D o l l a r p r e s e n t v a l u e o f} I d x (T) = Z ^ {\mathrm {r e a l}} (t; T) \times I d x (t)
$$

- Finally, to obtain the payoff of the zero-coupon TIPS we must divide by  $I dx(0)$ : Dollar value of a zero-coupon TIPS  $= Z^{TIPS}(t;T) = Z^{real}(t;T) \times \frac{I dx(t)}{I dx(0)}$  (22)  
- Given the value of zero-coupon TIPS, we can value coupon bearing TIPS.  
- Therefore, a TIPS value at  $t$ , with maturity  $T$ , and coupon rate  $c$  is given by

$$
P _ {c} ^ {T I P S} (t; T) = \frac {I d x (t)}{I d x (0)} \times \left[ \frac {c \times 1 0 0}{2} \sum_ {i = 1} ^ {n} Z ^ {r e a l} (t; T _ {i}) + Z ^ {r e a l} (t; T) \right] \tag {23}
$$

# Fitting the Real Yield Curve

- Clearly, zero-coupon real bonds  $Z^{real}(t; T_i)$  are not observable, but they are embedded in the prices of TIPS.  
- We can use the price of TIPS to "back out" the discount factors  $Z^{real}(t;T_i)$ .  
- One limitation compared to the case of Treasuries is that we do not have available as many bond prices, and therefore the bootstrapping strategy is not applicable.  
- However, we can use the curve fitting method using a flexible function for the discount factor, such as the Nelson Siegel model

$$
r _ {r e a l} (0, T) = \theta_ {0} + (\theta_ {1} + \theta_ {2}) \frac {1 - e ^ {- \frac {T}{\kappa_ {1}}}}{\frac {T}{\kappa_ {1}}} - \theta_ {2} e ^ {- \frac {T}{\kappa_ {1}}} + \theta_ {3} \left(\frac {1 - e ^ {- \frac {T}{\kappa_ {2}}}}{\frac {T}{\kappa_ {2}}} - e ^ {- \frac {T}{\kappa_ {2}}}\right) (2 4)
$$

- From the previous table, for instance, we obtain the following results

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/1dcdb3b83349ee40776271dfd98db1f30ebfe1aa4980df6ef6cd1dd3372c814a.jpg)  
Real and Nominal Rates on November 26, 2007

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/dd40d483e4701b3ad0cf438e36b383965fb1e2f01e253f213f0269459d698ba9.jpg)  
Data Source: Bloomberg.

- Next figure shows that the term structure of real rates changes over time.

Real Rates during and after the crisis  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/e0c948fb6e556cad82fc624c5dba2acb8004db1f937d39f960e45b0227da6c69.jpg)  
Data are from Gürkaynak, Sack, and Wright (2010), updated series.

- Negative real rates are not uncommon.
- We give back our "friend" a smaller sandwich because its price skyrocketed.

# Nominal and Real Interest Rates

- What is the relation between real and nominal rates?  
- We now show that

nominal rate = real rate + expected inflation + inflation risk premium - convexity

- Consider first the value today of \$1 at T

$$
Z (0, T) = e ^ {- r (0, T) T} \times \$ 1
$$

- Alternatively, we can express this in "consumption goods":
	- A \$1 nominal payment at time T will buy $C(T) = \frac{1}{\text{CPI}(T)}$ units of the consumption good.
- Unfortunately, this amount is not known today, because  $\mathrm{CPI}(T)$  is stochastic.  
- To compute the present value we need more assumptions.  
- Let  $\pi$  be the annualized inflation rate between 0 and  $T$
$$
\pi = \frac {1}{T} \ln \left(\frac {\mathsf {C P I} (T)}{\mathsf {C P I} (0)}\right)
$$

# The Fisher Equation under Perfect Foresight

- Consider first Perfect Foresight: Assume investors know  $\pi$  and hence  $\operatorname{CPI}(T)$ .  
- Then the value today of \$1 at T in consumption good units is

Present value of  $C(T) = Z^{real}(0, T) \times C(T) = Z^{real}(0, T) \times \frac{\S 1}{\mathsf{CPI}(T)}$

- To obtain the dollar value, we multiply this by the price of consumption good

Dollar present value of  $C(T) = \mathsf{CPI}(0)\left(Z^{real}(0,T)\times \frac{\mathbb{S}1}{\mathsf{CPI}(T)}\right)$

- The RHS is the  $value of the quantity of consumption purchased by$ 1 at  $T$ .  
- It is therefore a nominal discount, yielding the equality

$$
Z (0, T) = Z ^ {r e a l} (0, T) \times \frac {\mathsf {C P I} (0)}{\mathsf {C P I} (T)}
$$

- Substitute to obtain the Fisher equation:

$$
r (0, T) = r _ {r e a l} (0, T) + \pi
$$

# Inflation Risk Premium

- Assume now inflation rate is not known and assume it is log-normal<sup>5</sup>

$$
\log \left(\frac {\mathsf {C P I} (T)}{\mathsf {C P I} (0)}\right) = x \sim \mathcal {N} (\bar {\pi} T, \sigma \pi^ {2} T)
$$

- This implies that the amount of consumption we can buy at  $T$  is stochastic:

$$
C (T) = \frac {\S 1}{\mathsf {C P I} (T)} = \S 1 \times \frac {e ^ {- x}}{\mathsf {C P I} (0)}
$$

- Because  $C(T)$  is now risky, we cannot discount it to today using the real bond  $Z^{real}(0,T) = e^{-r_{real}(0,T)T}$ , but we thus must add a risk premium  $\kappa$ .  
- Multiplying also by  $\mathrm{CPI}(0)$  to obtain the dollar value, we obtain

Dollar Present value of expected  $C(T) = e^{-(r_{real}(0, T) + \kappa)T} \times E[e^{-x}]$

$$
= e ^ {- (r _ {r e a l} (0, T) + \kappa) T} \times e ^ {- \overline {{\pi}} T + \frac {1}{2} \sigma \pi^ {2} T}
$$

- This is dollar present value of \$ 1 at T. Therefore it equals Z(0,T) = e $^{-r(0,T)T}$ .

$$
r (0, T) = r _ {\mathrm {r e a l}} (0, T) + \overline {{\pi}} + \kappa - \frac {1}{2} \sigma \pi^ {2}
$$

# The Economics of Fixed Income Investments

- We now link all this to economic growth and agents' decisions.  
- We assume that investors have a utility function  $U(C(t), t)$ . This is:
- Decreasing with time: Eating soon is better than eating later.  
- Increasing in consumption: Eating more is better than eating less.  
- Concave:  $\Rightarrow$  Risk aversion: An amount of consumption that is certain is better than a fair bet to have more or less.

$$
E \left[ U (C) \right] <   U \left(E [ C ]\right)
$$

- A widely used utility function is the Constant Relative Risk Aversion (CRRA):

$$
U (C, t) = e ^ {- \rho t} \frac {C ^ {1 - \gamma}}{1 - \gamma}
$$

- $\rho =$  time-preference parameter  
$-\gamma = -CU''(C) / U'(C) =$  relative risk aversion parameter.

# Optimal Savings

- An investor has wage  $w(0)$  today and a random amount  $w(T)$  at  $T$ .  
- Then investor consumption plan is  $C(0) = \frac{w(0)}{\mathsf{CPI}(0)}$  and  $C(T) = \frac{w(T)}{\mathsf{CPI}(T)}$ .  
- Suppose the investor now has an unexpected bonus today of \$100 dollar.  
- The investor can:

1. Spend \$100 today and buy $\frac{\$100}{CPI(0)}$ amount of the consumption good, which will procure him/her an additional amount of utility

$$
U ^ {\prime} (C (0), 0) \times \frac {\S 1 0 0}{\mathsf {C P I} (0)}
$$

2. Save the 100 dollars, and buy  $\frac{\$ 100}{Z(0,T)}$  zero coupon bonds with maturity  $T$ . At that time, the investor can buy  $\frac{\$ 100}{Z(0,T)} \frac{1}{CPI(T)}$  of the consumption good, for an additional amount of utility

$$
\frac {\S 1 0 0}{Z (0 , T)} \frac {1}{\mathsf {C P I} (T)} U ^ {\prime} (C (T), T)
$$

# Equilibrium

- Equilibrium requires the agent to be indifferent between 1 and 2. Because quantities at  $T$  are unknown, the indifference condition is

$$
U ^ {\prime} \left(C (0), 0\right) \times \frac {\S 1 0 0}{\mathsf {C P I} (0)} = E \left[ \frac {\S 1 0 0}{Z (0 , T)} \frac {1}{\mathsf {C P I} (T)} U ^ {\prime} (C (T), T) \right]
$$

- By reshuffling, we obtain

$$
Z (0, T) = E \left[ \frac {\mathsf {C P I} (0)}{\mathsf {C P I} (T)} \times \frac {U ^ {\prime} (C (T) , T)}{U ^ {\prime} (C (0) , 0)} \right]
$$

- In aggregate, real consumption  $C(t)$  depends on real GDP  $Y(t)$ .  
- Assume that inflation and real GDP growth have the jointy log-normal distribution

$$
\left( \begin{array}{c} \log \left(\frac {\mathsf {C P I} (T)}{\mathsf {C P I} (0)}\right) \\ \log \left(\frac {Y (T)}{Y (0)}\right) \end{array} \right) = \left( \begin{array}{c} x \\ y \end{array} \right) \sim \mathcal {N} \left(\left( \begin{array}{c} \overline {{\pi}} T \\ \overline {{g}} T \end{array} \right), \left( \begin{array}{c c} \sigma \pi^ {2} T & , \sigma \pi \sigma_ {g} \rho_ {g, \pi} T \\ \sigma \pi \sigma_ {g} \rho_ {g, \pi} T & , \sigma_ {g} ^ {2} T \end{array} \right)\right)
$$

# Equilibrium Prices

- Substitute the CRRA utility function

$$
U ^ {\prime} (C, t) = e ^ {- \rho t} C (t) ^ {- \gamma}
$$

and use  $C(t) = Y(t)$  for  $t = 0, T$  to find

$$
\begin{array}{l} Z (0, T) = E \left[ e ^ {- x} \times \frac {e ^ {- \rho T} Y (T) ^ {- \gamma}}{Y (0) ^ {- \gamma}} \right] \\ = E \left[ e ^ {- \rho T} \times e ^ {- x - \gamma y} \right] \\ = e ^ {- \rho T} \times e ^ {- \overline {{\pi}} T - \gamma \overline {{g}} + \frac {1}{2} (\sigma \pi^ {2} + \gamma^ {2} \sigma_ {g} + 2 \gamma \sigma \pi \sigma_ {g} \rho_ {g, \pi}) T} \\ \end{array}
$$

- Thus, the nominal rate is
$$
r(0,T)
= \underbrace{\left( \rho \;+\; \gamma \,\overline{g} \;-\; \frac{\gamma^{2}}{2}\sigma_{g}^{2} \right)}_{\text{real rate } r_{\text{real}}(0,T)}
\;+\;
\underbrace{\left( \pi \;-\; \frac{1}{2}\sigma_{\pi}^{2} \right)}_{\text{exp.\ infl.\ \&\ conv.}}
\;-\;
\underbrace{\gamma \,\sigma_{\pi}\,\sigma_{g}\,\rho_{g,\pi}}_{\text{risk premium}}
$$

# The Economics of the Real Rate

- Following the same steps as above but using TIPS zero-coupon bonds  $Z^{TIPS}(0, T)$  instead of nominal bonds  $Z(0, T)$  we obtain the real rate as:

$$
r _ {r e a l} (0, T) = \rho + \gamma \overline {{g}} - \frac {\gamma^ {2}}{2} \sigma_ {g} ^ {2}
$$

- The real rate depends on:
1. Time preference  $\rho$ :
	- High  $\rho$  implies investors want to consume today rather than tomorrow. They will sell their (real) bonds which increase their yield.
2. The expected growth rate of the economy  $\overline{g}$ :
	- If  $\overline{g}$  is high we expect to be rich at  $T$  and hence consume a lot then. High  $\gamma$  implies we want "stable consumption" over time. Hence we want to borrow to consume more today, which increases real rates.
3. The volatility of GDP growth  $\sigma_{g}$
	- Higher economic risk implies a higher desire to save for the "rainy days". We buy more (real) bonds, which push their prices up and decrease yields.  
	- The higher the risk aversion  $\gamma$  and the more we want to save.

# Inflation Risk Premium

We found

$$
\text {i n f l a t i o n} = - \gamma \sigma \pi \sigma_ {g} \rho_ {g, \pi}
$$

where

$$
\rho_ {g, \pi} = \mathrm {C o r r e l a t i o n (I n f l a t i o n , r e a l G D P g r o w t h)}
$$

- Intuitively:

$$
\begin{array}{l} - \text {I f} \rho_ {g, \pi} <   0 \Longrightarrow \text {h i g h i n f l a t i o n o c c u r s w h e n r e a l G D P i s l o w} \\ \Longrightarrow \text {n o m i n a l b o n d i s d e v a l u e d i n r e c e s s i o n s , w h e n p e o l e m p l e m o s t n e e d t h e m o n e y !} \\ \Rightarrow \text {v e r y} \quad \text {r i s k} \quad \text {s e c u r i t y} \quad \Rightarrow \quad \text {h i g h} \quad \text {r i s k} \quad \text {p r e m i u m} \quad \Rightarrow \quad \text {h i g h} \quad \text {l o n g - t e r m} \quad \text {y i e l d} \\ \end{array}
$$

- Next figures show that the correlation  $\rho_{g,\pi}$  was negative until late 1990s. It then became closer to zero. And then became strongly positive around 2008.  
- In the meantime, real GDP volatility  $\sigma_{g}$  and inflation volatility  $\sigma \pi$  declined.  
- All of these variation are bound to impact the risk premium.

# Quarterly Real GDP Growth and CPI Inflation

Quarterly Real GDP Growth and CPI Inflation  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/884a217b5697b621a944e3b00422ed200af99bbb5c7354fe3cd7602b89c1c1b4.jpg)  
Data Source: Federal Reserve of St. Louis

# Correlation and Real GDP growth and CPI inflation Volatilities.

Backward-looking 10-year Rolling Window.  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/16d3d0b9d0d886b50a5a46c5294df85ee7a076d986634cb49508661289a0311f.jpg)  
Data Source: Federal Reserve of St. Louis

# Expected Excess Return: The Market Model

- Another way to understand the risk premium of nominal bonds is to look at its variation with the stock market  
Under the CAPM, for instance

$E\left[\text {Excess Return Nominal Bond}\right] = \beta \times E\left[\text {Excess Return Market}\right]$

- Next figure shows the time variation in the correlation between stock and bonds, and the corresponding CAPM beta.  
- Why did the CAPM beta change over time?

— David and Veronesi (2013, JPE): Time varying role of inflation signals

* Late 1970s/ early 1980s: Fear of stagflation (high inflation and low growth)  
$\Longrightarrow$  high inflation shocks are bad news for the economy  
$\Longrightarrow$  both nominal bonds and stock drop

* Mid 2000s: Fear of deflation (low inflation and low growth)

$\Longrightarrow$  high inflation shocks are good news for the economy  
$\Longrightarrow$  nominal bonds drop but stock rise

# The Covariance between Stocks and Bonds, and the CAPM Bond Beta

Stock Bond Covariance  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/71966d862a3bdc9416fb505050a89feb0162ecfd513ca1b4f1ecd91184a11bc0.jpg)  
Source: David and Veronesi (2016) "The Economics of the Comovement of Stocks and Bonds" in the Handbook of Fixed Income, Pietro Veronesi (Editor), Wiley and Sons

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/5f2a720b6f490cef50fd57d7db7c2599c07632b826a02561a636e6e040bbbe9e.jpg)  
Bond Beta

# Nominal and Real Stock Betas

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/56954bc73977b432f91e870259055cef145ae53196261bcf703740652b2aa14d.jpg)  
Figure 1: Rolling Nominal and Real Bond-Stock Betas

Source: Caroline Pflueger (2024) "Back to the 1980s or Not? The Drivers of Inflation and Real Risks in Treasury Bonds"

# More General Formulas

- All previous formulas have "flat" term structures:  $r(0, T)$  and  $r_{\text {real}}(0, T)$  do not depend on  $T$ .  
- They can be generalized by assuming that expected inflation  $\overline{\pi}_t$  and expected GDP growth  $\overline{g}_t$  are time varying.  
- Using the continuous time methodology, for instance, we may assume

$$
d \overline {{\pi}} _ {t} = (\alpha \pi - \beta \pi \overline {{\pi}} _ {t}) d t + \sigma_ {\overline {{\pi}}} d W _ {\overline {{\pi}}}
$$

$$
d \overline {{g}} _ {t} = (\alpha_ {g} - \beta_ {g} \overline {{g}} _ {t}) d t + \sigma_ {\overline {{g}}} d W _ {\overline {{g}}}
$$

- Inflation and real GDP growth themselves are

$$
d \log (\mathsf {C P I} _ {t}) = \overline {{\pi}} _ {t} d t + \sigma_ {\pi} d W _ {\pi}
$$

$$
d \log (Y _ {t}) = \overline {{g}} _ {t} d t + \sigma_ {g} d W _ {g}
$$

- The same argument as above has

$$
Z (t, T) = E _ {t} \left[ \frac {\mathsf {C P I} (t)}{\mathsf {C P I} (T)} e ^ {- \rho (T - t)} \left(\frac {Y (T)}{Y (t)}\right) ^ {- \gamma} \right]
$$

# Bond Pricing Formulas

- Solving the expectation, we obtain

$$
Z (t, T) = e ^ {A (t, T) - B (t, T) \overline {{\pi}} _ {t} - C (t, T) \gamma \overline {{g}} _ {t}}
$$

where

$$
B (t, T) = \frac {1 - e ^ {- \beta \pi (T - t)}}{\beta \pi}; C (t, T) = \frac {1 - e ^ {- \beta_ {g} (T - t)}}{\beta_ {g}}
$$

- and  $A(t,T)$  is a complicated function of maturity  $(T - t)$  which includes risk premia and other terms further discussed below.  
- The nominal yield curve is then

$$
r (t, T) = \frac {- A (t , T)}{T - t} + \frac {B (t , T)}{T - t} \overline {{\pi}} _ {t} + \frac {C (t , T)}{T - t} \gamma \overline {{g}} _ {t}
$$

- A higher expected inflation increases nominal yield, but differentially across maturities  
— A higher expected real growth increases nominal yields, but differentially across maturities

# The Function  $A(t, T)$

$$
\begin{array}{l} A (t, T) = (- \rho + \frac {1}{2} \sigma_ {\pi} ^ {2} + \frac {1}{2} \gamma^ {2} \sigma_ {g} ^ {2} + \gamma \sigma_ {\pi} \sigma_ {g} \rho_ {\pi g}) (T - t) \\ + \left[ \sigma_ {\pi} \sigma_ {\overline {{\pi}}} \rho_ {\pi \overline {{\pi}}} + \gamma \sigma_ {g} \sigma_ {\overline {{\pi}}} \rho_ {g \overline {{\pi}}} - \alpha_ {\pi} + \frac {1}{2} \frac {\sigma_ {\overline {{\pi}}} ^ {2}}{\beta_ {\pi}} + \frac {\gamma \sigma_ {\overline {{\pi}}} \sigma_ {\overline {{g}}} \rho_ {\overline {{\pi g}}}}{\beta_ {\pi} + \beta_ {g}} \right] \frac {1}{\beta_ {\pi}} ((T - t) - B (t, T)) \\ + \left[ \sigma_ {\pi} \sigma_ {\overline {{g}}} \rho_ {\pi \overline {{g}}} + \gamma \sigma_ {g} \sigma_ {\overline {{g}}} \rho_ {g \overline {{g}}} - \alpha_ {g} + \frac {1}{2} \frac {\gamma \sigma_ {\overline {{g}}} ^ {2}}{\beta_ {g}} + \frac {\sigma_ {\overline {{\pi}}} \sigma_ {\overline {{g}}} \rho_ {\overline {{\pi g}}}}{\beta_ {\pi} + \beta_ {g}} \right] \frac {\gamma}{\beta_ {g}} ((T - t) - C (t, T)) \\ - \frac {1}{4} \frac {\sigma_ {\pi} ^ {2}}{\beta_ {\pi}} B (t, T) ^ {2} - \frac {1}{4} \frac {\gamma^ {2} \sigma_ {\overline {{g}}} ^ {2}}{\beta_ {g}} C (t, T) ^ {2} - \frac {\gamma \sigma_ {\overline {{\pi}}} \sigma_ {\overline {{g}}} \rho_ {\overline {{\pi g}}}}{(\beta_ {\pi} + \beta_ {g})} B (t, T) C (t, T) \\ \end{array}
$$

- Many risk premia

1. Inflation risk premium:  $\gamma \sigma_{\pi} \sigma_{g} \rho_{\pi g}$ . If  $\rho_{\pi g} < 0 \Rightarrow Z(t, T) \downarrow \Rightarrow r(t, T)\uparrow$  
2. Expected inflation risk premium:  $\gamma \sigma_{g} \sigma_{\overline{\pi}} \rho_{g \overline{\pi}}$ . If  $\rho_{g, \overline{\pi}} < 0 \Rightarrow r(t, T)$  
3. Expected growth risk premium:  $\gamma \sigma_{g} \sigma_{\overline{g}} \rho_{g \overline{g}}$ . If  $\rho_{g, \overline{g}} < 0 \Rightarrow r(t, T)$  ↑

- and many convexity effects.

# The Shot-term Rate and Monetary Policy Interpretation

- As we take the limit  $T - t \to 0$  we obtain the formula for the "overnight" rate

$$
r _ {t} = \underbrace {\rho + \gamma \overline {{g}} _ {t} - \frac {\gamma^ {2}}{2} \sigma_ {g} ^ {2}} _ {\mathrm {r e a l r a t e} r _ {\mathrm {r e a l}, t}} \quad \underbrace {+ \pi_ {t} - \frac {1}{2} \sigma \pi^ {2}} _ {\mathrm {e x p . i n f l . \& c o n v .}} \underbrace {- \gamma \sigma \pi \sigma_ {g} \rho_ {\pi , g}} _ {\mathrm {r i s k p r e m i u m}}
$$

- The Federal Reserve is believed to follow the so-called "Taylor rule" in setting its target Federal Fund rate, which specifies

$$
r _ {t} = \alpha + \beta_ {1} (\mathrm {o u t p u t} _ {t} - \mathrm {p o t e n t i a l o u t p u t}) + \beta_ {1} (\mathrm {i n f l a t i o n} _ {t} - \mathrm {t a r g e t i n f l a t i o n})
$$

- The "forward looking" Taylor rule uses "expected inflation" and expected output to their realized values.  
- The result above can be casted in terms of monetary policy actions

$$
r _ {t} = \alpha + \gamma (\bar {g} _ {t} - \text {p o t e n t i a l o u t p u t}) + (\bar {\pi} _ {t} - \text {t a r g e t i n f l a t i o n})
$$

$$
- \text {w h e r e} \alpha = \rho - \frac {\gamma^ {2}}{2} \sigma_ {g} ^ {2} - \frac {1}{2} \sigma \pi^ {2} - \gamma \sigma \pi \sigma_ {g} \rho_ {\pi , g} + \gamma \text {p o t e n t i a l}
$$

# The Dynamics of the Real Rate

- From previous results and using lto's formula, the real rate follows a Vasicek model

$$
d r _ {r e a l, t} = \beta_ {g} (\overline {{r}} _ {r e a l} - r _ {r e a l, t}) d t + \sigma_ {r e a l} d W _ {\overline {{g}}}
$$

where

$$
\overline {{r}} _ {r e a l} = \rho + \gamma \frac {\alpha_ {g}}{\beta_ {g}} - \frac {\gamma^ {2} \sigma_ {\overline {{g}}} ^ {2}}{2}; \quad \sigma_ {r e a l} = \gamma \sigma_ {\overline {{g}}}
$$

- The real zero-coupon bond pricing formula is then

$$
Z _ {r e a l} (t, T) = e ^ {\overline {{A}} (t, T) - C (t, T) r _ {r e a l, t}}
$$

where

$$
\overline {{A}} (t, T) = \left(\overline {{r}} _ {r e a l} ^ {*} - \frac {1}{2} \frac {\sigma_ {r e a l} ^ {2}}{\beta_ {g} ^ {2}}\right) [ C (t, T) - (T - t) ] - \frac {C (t , T) ^ {2} \sigma_ {r e a l} ^ {2}}{4 \beta_ {g}}
$$

where  $\overline{r}_{real}^{*} = \overline{r}_{real} - \gamma \sigma_{g}\sigma_{real}\rho_{\rho ,real}$  

- The risk neutral process of the real rate is

$$
d r _ {r e a l, t} = \beta_ {g} (\overline {{r}} _ {r e a l} ^ {*} - r _ {r e a l, t}) d t + \sigma_ {r e a l} d W _ {\overline {{g}}} ^ {*}
$$

# Fitting Real Vasicek to TIPS

- We can use TIPS again to extract the real zero coupon bond prices  
- The procedure is the same for nominal Vasicek (see TN 7), except with the additional difficulty that we may not know what the short-term real rate  $r_{real,t}$  actually is.  
- One possibility is to estimate  $r_{real,t}$  as well together with other quantities.  
- For instance, fixing  $\sigma_{\text {real }} = .00967$  (estimated from the time series of real rates), we estimate the following parameters for November 27, 2007:

$$
\beta_ {g} ^ {*} = 0. 0 1 6 6, \overline {{r}} _ {r e a l} ^ {*} = 0. 1 6 9 5, r _ {r e a l, 0} = 0. 0 0 4 6
$$

- The fit is not as good as with the Extended Nelson-Siegel model in this case.  
- Next figure shows the fitted term structure of real rates.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/73f52d249371718532e425728ad456468a6a9a71ab4defcdf7d659f928cd58aa.jpg)  
Vasicek Fit to TIPS on November 27, 2007

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/740db79b3f68842ea2ec5d8e36895e24f0cb6f7eabacbf1408869c022f1b18d7.jpg)  
Data Source: Bloomberg

# Conclusions

- The term structure of interest rate depend on:

1. Expectation of future inflation  
2. Expectation of future real growth  
3. A whole set of risk premia

- Inflation risk premium  
- Expected inflation risk premium  
- Expected growth risk premium
- Multi-factor models tend to fit well the term structure of interest rates  
- The above setting with expected inflation and expected GDP growth can be generalized to any factors  $\phi_{1,t},\phi_{2,t}\ldots$  
- Moreover, pricing formulas can be obtained using no-arbitrage methodologies, as in TN 7.

# Appendix: Derivation of Two Factor Model

Define

$$
q = \log (C P I)
$$

$$
y = \log (Y)
$$

so that

$$
d q = \bar {\pi} _ {t} d t + \sigma_ {\pi} d W _ {\pi}
$$

$$
{ d y } { = } { \overline { { g } } _ { t } d t + \sigma _ { g } d W _ { g } }
$$

and recall

$$
d \bar {\pi} _ {t} = (\alpha_ {\pi} - \beta_ {\pi} \pi_ {t}) d t + \sigma_ {\bar {\pi}} d W _ {\bar {\pi}}
$$

$$
{d \bar {g}} = {\left(\alpha_ {g} - \beta_ {g} \pi_ {t}\right) d t + \sigma_ {\bar {g}} d W _ {\bar {g}}}
$$

From the pricing equation we have

$$
Z \left(t, T\right) = E \left[ e ^ {- \rho (T - t) - (q (T) - q (t)) - \gamma (y (T) - y (t))} \right]
$$

To be slightly more general, consider the following case

$$
\begin{array}{l} Z (t, T) = E \left[ e ^ {- \rho (T - t) - \eta (q (T) - q (t)) - \gamma (y (T) - y (t))} \right] \\ = e ^ {\eta q (t) + \gamma y (t)} E \left[ e ^ {- \rho (T - t)} G (q (T), y (T)) \right] \\ = e ^ {\eta q (t) + \gamma y (t)} V (q, y, \bar {\pi}, \bar {g}, t) \\ \end{array}
$$

When  $\eta = 1$  we have the case for nominal bonds. When  $\eta = 0$  we have the case of real bonds. When  $\eta$  is intermediate, this can be considered a case in which inflation affects the utility function of agents directly. A case in the literature is the one of money illusion.

From the Feynman Kac formula, we have that  $V$  satisfies

$$
\begin{array}{l} \rho V = V _ {t} + V _ {q} E [ d q ] + V _ {y} E [ d y ] + V _ {\overline {{\pi}}} E [ d \overline {{\pi}} ] + V _ {\overline {{g}}} E [ d \overline {{g}} ] + \frac {1}{2} V _ {q q} E [ d q ^ {2} ] + \frac {1}{2} V _ {y y} E [ d y ^ {2} ] + \frac {1}{2} V _ {\overline {{\pi}} \overline {{\pi}}} E [ d \overline {{\pi}} ^ {2} ] + \frac {1}{2} V _ {\overline {{g}} \overline {{g}}} E [ d \overline {{g}} ^ {2} ] \\ + V _ {q y} E \left[ d q d y \right] + V _ {q \overline {{\pi}}} E \left[ d q d \overline {{\pi}} \right] + V _ {q \overline {{g}}} E \left[ d q d \overline {{g}} \right] + V _ {y \overline {{\pi}}} E \left[ d y d \overline {{\pi}} \right] + V _ {y \overline {{g}}} E \left[ d y d \overline {{g}} \right] + V _ {\overline {{\pi g}}} E \left[ d \overline {{\pi}} d \overline {{g}} \right] \\ \end{array}
$$

with final condition

$$
V \left(q, y, \overline {{\pi}}, \overline {{g}}, T\right) = e ^ {- \eta q (T) - \gamma y (T)}
$$

We can conjecture the following

$$
V (q, y, \overline {{\pi}}, \overline {{g}}, t) = e ^ {- \eta q (t) - \gamma y (t) + A (t; T) - \eta B (t; T) \overline {{\pi}} - \gamma C (t; T) \overline {{g}}}
$$

Taking the first derivatives

$$
V _ {t} = \left[ A ^ {\prime} (t; T) - \eta B ^ {\prime} (t; T) \bar {\pi} - \gamma C ^ {\prime} (t; T) \bar {g} \right] V
$$

$$
V _ {q} = - \eta V; V _ {q q} = \eta^ {2} V; V _ {q y} = \eta \gamma V; V _ {q \overline {{\pi}}} = \eta^ {2} B (t; T) V; V _ {q \overline {{g}}} = \eta \gamma C (t; T) V
$$

$$
V _ {y} = - \gamma V; V _ {y y} = \gamma^ {2} V; V _ {y \bar {\pi}} = \gamma \eta B (t, T); V _ {y \bar {g}} = \gamma^ {2} C (t, T)
$$

$$
V _ {\overline {{\pi}}} = - \eta B (t, T) V; V _ {\overline {{\pi}} \overline {{\pi}}} = \eta^ {2} B (t, T) ^ {2} V; V _ {\overline {{\pi}} \overline {{g}}} = \eta \gamma B (t, T) C (t, T) V
$$

$$
V _ {\overline {{g}}} = - \gamma C (t, T) V; V _ {\overline {{g g}}} = \gamma^ {2} C (t, T) ^ {2} V
$$

Substituting and deleting the common  $V$

$$
\begin{array}{l} \rho = \left[ A ^ {\prime} (t; T) - \eta B ^ {\prime} (t; T) \overline {{\pi}} - \gamma C ^ {\prime} (t; T) \overline {{g}} \right] - \eta \overline {{\pi}} - \gamma \overline {{g}} - \eta B (t, T) (\alpha_ {\pi} - \beta_ {\pi} \overline {{\pi}}) - \gamma C (t, T) (\alpha_ {g} - \beta_ {g} \overline {{g}}) \\ + \frac {1}{2} \eta^ {2} \sigma_ {\pi} ^ {2} + \frac {1}{2} \gamma^ {2} \sigma_ {g} ^ {2} + \frac {1}{2} \eta^ {2} B (t, T) ^ {2} \sigma_ {\bar {\pi}} ^ {2} + \frac {1}{2} \gamma^ {2} C (t, T) ^ {2} \sigma_ {\bar {g}} ^ {2} \\ + \gamma \eta \sigma_ {\pi} \sigma_ {g} \rho_ {\pi g} + \eta^ {2} B (t, T) \sigma_ {\pi} \sigma_ {\bar {\pi}} \rho_ {\pi \bar {\pi}} + \eta \gamma C (t, T) \sigma_ {\pi} \sigma_ {\bar {g}} \rho_ {\pi \bar {g}} \\ + \gamma \eta B (t, T) \sigma_ {g} \sigma_ {\bar {\pi}} \rho_ {g \bar {\pi}} + \gamma^ {2} C (t, T) \sigma_ {g} \sigma_ {\bar {g}} \rho_ {g \bar {g}} + \eta \gamma B (t, T) C (t, T) \sigma_ {\bar {\pi}} \sigma_ {\bar {g}} \rho_ {\bar {\pi} \bar {g}} \\ \end{array}
$$

Factor out variables  $\overline{\pi}$  and  $\overline{g}$ :

$$
\begin{array}{l} \rho = - \eta [ B ^ {\prime} (t; T) + 1 - \beta_ {\pi} ] \overline {{\pi}} - \gamma [ C ^ {\prime} (t; T) + 1 - \beta_ {g} ] \overline {{g}} - \eta B (t, T) \alpha_ {\pi} - \gamma C (t, T) \alpha_ {g} \\ A ^ {\prime} (t; T) + \frac {1}{2} \eta^ {2} \sigma_ {\pi} ^ {2} + \frac {1}{2} \gamma^ {2} \sigma_ {g} ^ {2} + \frac {1}{2} \eta^ {2} B (t, T) ^ {2} \sigma_ {\bar {\pi}} ^ {2} + \frac {1}{2} \gamma^ {2} C (t, T) ^ {2} \sigma_ {\bar {g}} ^ {2} \\ + \gamma \eta \sigma_ {\pi} \sigma_ {g} \rho_ {\pi g} + \eta^ {2} B (t, T) \sigma_ {\pi} \sigma_ {\bar {\pi}} \rho_ {\pi \bar {\pi}} + \eta \gamma C (t, T) \sigma_ {\pi} \sigma_ {\bar {g}} \rho_ {\pi \bar {g}} \\ + \gamma \eta B (t, T) \sigma_ {g} \sigma_ {\bar {\pi}} \rho_ {g \bar {\pi}} + \gamma^ {2} C (t, T) \sigma_ {g} \sigma_ {\bar {g}} \rho_ {g \bar {g}} + \eta \gamma B (t, T) C (t, T) \sigma_ {\bar {\pi}} \sigma_ {\bar {g}} \rho_ {\bar {\pi} \bar {g}} \\ \end{array}
$$

This is satisfied for all values of  $\overline{\pi}$  and  $\overline{g}$  if and only if the following system is satisfied

$$
0 = \left[ B ^ {\prime} (t; T) + 1 - \beta_ {\pi} B (t, T) \right]
$$

$$
0 = \left[ C ^ {\prime} (t; T) + 1 - C (t, T) \beta_ {g} \right]
$$

and

$$
\rho = A ^ {\prime} (t; T) - \eta B (t, T) \alpha_ {\pi} - \gamma C (t, T) \alpha_ {g}
$$

$$
\begin{array}{l} + \frac {1}{2} \eta^ {2} \sigma_ {\pi} ^ {2} + \frac {1}{2} \gamma^ {2} \sigma_ {g} ^ {2} + \frac {1}{2} \eta^ {2} B (t, T) ^ {2} \sigma_ {\bar {\pi}} ^ {2} + \frac {1}{2} \gamma^ {2} C (t, T) ^ {2} \sigma_ {\bar {g}} ^ {2} \\ + \gamma \eta \sigma_ {\pi} \sigma_ {g} \rho_ {\pi g} + \eta^ {2} B (t, T) \sigma_ {\pi} \sigma_ {\bar {\pi}} \rho_ {\pi \bar {\pi}} + \eta \gamma C (t, T) \sigma_ {\pi} \sigma_ {\bar {g}} \rho_ {\pi \bar {g}} \\ + \gamma \eta B (t, T) \sigma_ {g} \sigma_ {\bar {\pi}} \rho_ {g \bar {\pi}} + \gamma^ {2} C (t, T) \sigma_ {g} \sigma_ {\bar {g}} \rho_ {g \bar {g}} + \eta \gamma B (t, T) C (t, T) \sigma_ {\bar {\pi}} \sigma_ {\bar {g}} \rho_ {\bar {\pi} \bar {g}} \\ \end{array}
$$

with final conditions

$$
B (T, T) = 0; C (T, T) = 0; A (t; T) = 0
$$

The first two ODEs have solutions

$$
B (t, T) = \frac {1 - e ^ {- \beta_ {\pi} (T - t)}}{\beta_ {\pi}}
$$

$$
C (t, T) = \frac {1 - e ^ {- \beta_ {g} (T - t)}}{\beta_ {g}}
$$

The last ODE has solution

$$
\begin{array}{l} A (t, T) = (- \rho + \frac {1}{2} \eta^ {2} \sigma_ {\pi} ^ {2} + \frac {1}{2} \gamma^ {2} \sigma_ {g} ^ {2} + \gamma \eta \sigma_ {\pi} \sigma_ {g} \rho_ {\pi g}) (T - t) \\ + \left[ \eta^ {2} \sigma_ {\pi} \sigma_ {\overline {{\pi}}} \rho_ {\pi \overline {{\pi}}} + \gamma \eta \sigma_ {g} \sigma_ {\overline {{\pi}}} \rho_ {g \overline {{\pi}}} - \eta \alpha_ {\pi} + \frac {1}{2} \frac {\eta^ {2} \sigma_ {\overline {{\pi}}} ^ {2}}{\beta_ {\pi}} + \frac {\eta \gamma \sigma_ {\overline {{\pi}}} \sigma_ {\overline {{g}}} \rho_ {\overline {{\pi g}}}}{\beta_ {\pi} + \beta_ {g}} \right] \frac {1}{\beta_ {\pi}} ((T - t) - B (t, T)) \\ + \left[ \eta \gamma \sigma_ {\pi} \sigma_ {\bar {g}} \rho_ {\pi \bar {g}} + \gamma^ {2} \sigma_ {g} \sigma_ {\bar {g}} \rho_ {g \bar {g}} - \gamma \alpha_ {g} + \frac {1}{2} \frac {\gamma^ {2} \sigma_ {\bar {g}} ^ {2}}{\beta_ {g}} + \frac {\eta \gamma \sigma_ {\bar {\pi}} \sigma_ {\bar {g}} \rho_ {\bar {\pi} g}}{\beta_ {\pi} + \beta_ {g}} \right] \frac {1}{\beta_ {g}} ((T - t) - C (t, T)) \\ - \frac {1}{4} \frac {\eta^ {2} \sigma_ {\overline {{\pi}}} ^ {2}}{\beta_ {\pi}} B (t, T) ^ {2} - \frac {1}{4} \frac {\gamma^ {2} \sigma_ {\overline {{g}}} ^ {2}}{\beta_ {g}} C (t, T) ^ {2} - \frac {\eta \gamma \sigma_ {\overline {{\pi}}} \sigma_ {\overline {{g}}} \rho_ {\overline {{\pi g}}}}{(\beta_ {\pi} + \beta_ {g})} B (t, T) C (t, T) \\ \end{array}
$$

Setting  $\eta = 1$  provides the formula for  $A(t,T)$  in the text. Moreover, the case  $\eta = 0$  corresponds to the real bond, obtaining

$$
{A _ {\mathrm {r e a l}} (t, T)} = {\left(- \rho + \frac {1}{2} \gamma^ {2} \sigma_ {g} ^ {2}\right) (T - t) + \left[ \gamma^ {2} \sigma_ {g} \sigma_ {\bar {g}} \rho_ {g \bar {g}} - \gamma \alpha_ {g} + \frac {1}{2} \frac {\gamma^ {2} \sigma_ {\bar {g}} ^ {2}}{\beta_ {g}} \right] \frac {1}{\beta_ {g}} ((T - t) - C (t, T)) - \frac {1}{4} \frac {\gamma^ {2} \sigma_ {\bar {g}} ^ {2}}{\beta_ {g}} C (t, T) ^ {2}}
$$

# Teaching Note 4

Interest Rate Derivatives<sup>1</sup>

# John Heaton

The University of Chicago

Booth School of Business

# The Notional Amount of Over-the-Counter Derivatives

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/5cafd664dc00cefcc824d077d1d4934b69aa779c91d1020b4a6ee79b7cc07fcd.jpg)  
Panel A. Millions of US Dollars

Panel B. Multiple of Global GDP  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/501dc0f603d76d363c0e5dce1d47495b51522f9d064c08bf61c685ac29d753ff.jpg)  
(Data Source: OTC derivatives data are from the Bank for International Settlements, while global GDP data are from the World Bank.)

# Interest Rate Derivatives: Forwards and Forward Rate Agreements

- Effective risk management is carried out using derivatives, such as forward, futures, and swaps.  
- Forward contracts and Forward Rate Agreements allow firms to lock in interest rates in the future.  
- A Forward Rate Agreement (FRA) is a contract between two counterparties who agree at time 0 to exchange the following net payment at a future date  $T_{2}$

$$
\text {N e t} \quad T _ {2} = N \times \Delta \times \left[ r _ {n} \left(T _ {1}, T _ {2}\right) - f _ {n} \right] \tag {1}
$$

- where  $r_n(T_1, T_2)$  is a  $n$ -times compounded floating reference rate,  $f_n$  is a fixed rate,  $N$  is the notional, and  $\Delta = 1/n$
- Example: Today  $(T_{0})$  is January 2, 2020 (we will treat this as January 1 …) and suppose a firm has a \$100 million receivable in six months on June 30, 2020. Ignoring overnight investing:
- If the firm will not need that cash immediately, but, say, six month later, it can lock-in an investment rate today for the future period  $T_{1} = 0.5$  is July 1, 2020 to  $T_{2} = 1$  is December 31, 2020 by entering into a forward rate agreement (FRA) with a bank.

* Assume the bank quotes the (semi-annually compounded) annualized rate of  $f_{2} = 1.59\%$ .

- When the firm receives \$100 million in six months (T₁) it can invest it at the then current floating rate  $r_2(T_1, T_2) = r_2(0.5, 1)$ , which is not known today.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/db29e689bae2410b01d3afdfa25f845cb58d88f57398ceed91463d103fc5ce2c.jpg)

# Hedging Interest Rate Risk

- Clearly, using the banks offer locks in the rate  $f_{2}$  for the period  $T_{1}$  to  $T_{2}$  for the firm, as

$$
\begin{array}{l} \begin{array}{l} \text {T o t a l a m o u n t} \\ \text {a t} T _ {2} \end{array} = \left\{\$ 1 0 0 \text {m i l l i o n} \times \left[ 1 + \frac {r _ {2} (0 . 5 , 1)}{2} \right] \right\} \quad (\text {R e t u r n o n i n v e s t m e n t}) \\ \left. \right. + \left\{\frac {N}{2} \times \left[ f _ {2} - r _ {2} (0. 5, 1) \right]\right\} \quad \text {(F R A p a y m e n t)} \\ = \$ 100 \text {m i l l i o n} \times \left[ 1 + \frac {f _ {2}}{2} \right] \\ = \mathbb {S} 1 0 0 \text {m i l l i o n} \times \left[ 1 + \frac {0 . 0 1 5 9}{2} \right] \\ = \$ 100.79 \text {m i l l i o n} \\ \end{array}
$$

- The question is: How does the bank determine the forward rate  $f_{2}$ ?
- Through a simple trading strategy.

# Trading Strategy to Compute Forward Rate

<table><tr><td>Today (Time 0)</td><td>T1</td><td>T2</td></tr><tr><td rowspan="2">Sell short \$99.180 m of T-bills maturing at T1</td><td>(a) Borrow \$100 m 
at rate r2(0.5,1)</td><td rowspan="2">Pay \$100 m × (1 + r2(0.5,1)/2)</td></tr><tr><td>(b) Close short position</td></tr><tr><td>Buy M = 1.0079 = $99.180 / $98.400 
of T-bills maturing at T2</td><td></td><td>Receive 1.0079 × \$100 m</td></tr><tr><td>Enter FRA with Firm</td><td colspan="2">Pay 100 m/2 × [f2(0,0.5,1) - r2(0.5,1)]</td></tr><tr><td>Total Net Cash Flow = 0</td><td>Total Net Cash Flow = 0</td><td>Total Net Cash Flow = 0</td></tr></table>

- The bank is perfectly hedged.  
- Note also that the quoted forward rate is effectively implicit in the ratio

$$
M = \frac {Z (0 , 0 . 5)}{Z (0 , 1)} = 1 + \frac {f _ {2}}{2}
$$

in the first step of the trading strategy.

- This fact leads to the notion of the forward discount factor, given by  $1 / M$ .

# The Forward Discount Factor

- The forward discount factor at time  $t$  defines the time value of money between two future dates,  $T_{1}$  and  $T_{2} > T_{1}$ .
- Given the discount factors  $Z\left( {t,{T}_{1}}\right)$  and  $Z\left( {t,{T}_{2}}\right)$  ,the forward discount factor is given by

$$
F (t, T _ {1}, T _ {2}) = \frac {Z (t , T _ {2})}{Z (t , T _ {1})} \tag {2}
$$

- Indeed, note that in the example  $Z(0, 0.5) = 0.9918$  and  $Z(0, 1) = 0.9840$  implying a forward discount factor

$$
F (0, 0. 5, 1) = \frac {Z (0 , 1)}{Z (0 , 0 . 5)} = 0. 9 9 2 1 \tag {3}
$$

- From any discount factor (forward or not), we can compute the  $n$ -times compounded rate as

$$
f _ {n} \left(t, T _ {1}, T _ {2}\right) = n \times \left(\frac {1}{F \left(t , T _ {1} , T _ {2}\right) ^ {\frac {1}{n \times \left(T _ {2} - T _ {1}\right)}}} - 1\right) \tag {4}
$$

- For instance, in the example we have

$$
f_{2}(0,0.5,1) = 2\times \left(\frac{1}{F(0,0.5,1)^{\frac{1}{2\times 0.5}}} -1\right) = 1.59\% ,
$$

# The Spot Curve and the Forward Curve

- The forward curve gives the relation between the forward rate  $f(0, T, T + \Delta)$  and the time of the investment  $T$ . Curves on January 2, 2020

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/4fd87a3232b75299a8bed1f71dd6576688dfb5a58c7419a96d141545a9864192.jpg)  
Data Source: US Treasury.

# The Value of a Forward Rate Agreement

- In previous example, suppose 3 months later, on April 1, 2020, the firm decides to close its FRA.
- As interest rates changed between January and April, so did the value of the FRA.  
- Recall bank's earlier strategy:

(a) short one T-bill maturing at  $T_{1}$  and (b) long  $M = 1.0079$  T-bills maturing at  $T_{2}$ .

- This portfolio  $(a) + (b)$  replicates the cash flow that the firm will receive.

$\Longrightarrow$  its value at  $t =$  value of the FRA for the firm. Thus:

$$
\text {V a l u e o f F R A t o t h e f i r m a t} \mathfrak {t} = V ^ {F R A} (t) = M \times Z (t, T _ {2}) - Z (t, T _ {1}) \tag {5}
$$

- On April 1, 2020 ( = t), we had Z(t,T1) = \$0.9993 and Z(t,T2) = \$0.9981. Therefore

$$
V ^ {F R A} (t) = 1. 0 0 7 9 \times Z (t, T _ {2}) - Z (t, T _ {1}) = 1. 0 0 7 9 \times \$ 0. 9 9 8 1 - \$ 0. 9 9 9 3 = \$ 0. 0 0 6 7 1 m i l l o n
$$

- ⇒ On April 1, 2020, the FRA initiated 3 months earlier was worth \$671,176.83 to the firm.
- In general, using the definition  $1 + f_{n}(t,T_{1},T_{2})\Delta = Z(t,T_{1}) / Z(t,T_{2})$ , we have

$$
\begin{array}{l} V ^ {F R A} (t) = N \times Z (t, T _ {2}) \times \left[ M - \frac {Z (t , T _ {1})}{Z (t , T _ {2})} \right] \\ = N \times Z (t, T _ {2}) \times \Delta \times [ f _ {n} (0, T _ {1}, T _ {2}) - f _ {n} (t, T _ {1}, T _ {2}) ] \tag {6} \\ \end{array}
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/9efc42306d6a794517d355de4784448886583b382a82e5bfc1c360de0de57f77.jpg)  
Changing Yield Curve

# Interest Rate Derivatives: Swaps

- A plain vanilla fixed-for-floating interest rate swap is an agreement between two counterparties to exchange cash flows at  $T_{1}, T_{2}, \ldots, T_{n} = T$ , with  $T_{i} = T_{i - 1} + \Delta$ , according to

$$
\text {N e t C a s h F l o w a t} T _ {i} = N \times \Delta \times \left[ r _ {n} \left(T _ {i - 1}\right) - c \right] \tag {7}
$$

where  $n = 1 / \Delta$  is the reference rate compounding frequency.  

- The constant  $c$  is called swap rate.
- How do we determine the Value of a Swap?
- At inception, the value is zero, as the counterparties agree to swap future payments, not today.  
- After inception, as the floating rate changes, so does the value of the swap.  
- Consider the party with net cash flow (7). This party is effectively long a floating rate bond  $(P_{FR}(t,T))$  and short a fixed rate bond with coupon  $c(P_c(t,T))$ .  
- $\Rightarrow$  the value of the swap is

$$
V ^ {s w a p} (t; c, T) = P _ {F R} (t, T) - P _ {c} (t, T) \tag {8}
$$

- At every  $T_{i}$ , the value of  $P_{FR}(T_i,T) = 100$ . Therefore, at these times

$$
V ^ {s w a p} (T _ {i}; c, T) = 1 0 0 - \left(\frac {c}{2} \times 1 0 0 \times \sum_ {j = i + 1} ^ {M} Z (T _ {i}, T _ {j}) + Z (T _ {i}, T _ {M}) \times 1 0 0\right) \qquad (9)
$$

# The Swap Rate and the Swap Curve

- How is the swap rate  $c$  determined?
- The swap rate  $c$  is given by that number that makes  $V^{swap}(0; c, T) = 0\$  in (8).  
- Rewriting the equation for any payment frequency  $n$  and payment dates  $T_{1}, \ldots, T_{M}$ , we have

$$
V ^ {s w a p} (0; c, T) = 1 0 0 - \left(\frac {c}{n} \times 1 0 0 \times \sum_ {j = 1} ^ {M} Z (0, T _ {j}) + Z (0, T _ {M}) \times 1 0 0\right) = 0 \tag {10}
$$

- Solving this equation for  $c$  we find

$$
c = n \times \left(\frac {1 - Z (0 , T _ {M})}{\Sigma_ {j = 1} ^ {M} Z (0 , T _ {j})}\right) \tag {11}
$$

- The swap curve at time  $t$  is the set of swap rates (at time  $t$ ) for all maturities  $T_{1}, T_{2}, \ldots, T_{M}$ .  
- I denote the swap curve at time  $t$  by  $c(t, T_{i})$  for  $i = 1, \ldots, M$ .

# The Swap Curve and the "Classic" LIBOR Curve

- The swap curve implicitly contains the discount factors  $Z(0, T_{i})$  that market participants use to quote swaps in the OTC market.  
- From the swap curve, we can then bootstrap out such discounts by inverting (11):

$$
Z \left(t, T _ {1}\right) = \frac {1}{1 + \frac {c (t , T _ {1})}{n}} \tag {12}
$$

while for  $i = 2,\ldots ,M$

$$
Z (t, T _ {i}) = \frac {1 - \frac {c (t , T _ {i})}{n} \times \sum_ {j = 1} ^ {i - 1} Z (t , T _ {j})}{1 + \frac {c (t , T _ {i})}{n}} \tag {13}
$$

- The resulting yield curve is called LIBOR curve.

# Treasury and Swap Discount and Yield on January 4, 2005

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/779dd716e5ecd2f7cd26463fb72d93d53a4df6fc8bcf2d3dfd7cf3cf8752c424.jpg)  
A: Discount Functions

B: Zero Coupon Yield Curves  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/fb0cdbe286f50f89859cf3f80f8392a61cd32ce9687cad628712098a5a320f76.jpg)  
Data Source: Federal Reserve and CRSP.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/352b8898020d292a72b2aa6a943388963fadb728f327444ec98bbe7794de991d.jpg)  
The 5-year Zero Coupon Treasury and Swap Yield

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/7286db626bf805a353a37fba0e281c06a04dbb35f751c994b29701087f0887f2.jpg)  
Data Source: Bloomberg and CRSP.

# Swap Spread Trades and the Risk in Convergence Trades

- Today is June 30, 2006, and we are looking to make a profit on the swap spread.  
- The market presented the following data:
- 3-month LIBOR:  $5.5081\%$ .  
- 3-month repo rate:  $5.27\%$ .  
- 5-year swap rate:  $5.69\%$ .  
- 5-year T-note with a  $5.125\%$  coupon priced at \$100.1172, and yield-to-maturity  $5.10\%$ .
- The swap spread equals the yield to maturity of the Treasury note minus the swap rate

$$
S S = 5.69 \% - 5.10 \% = 0.59 \% = 59 b p s
$$

- That is, receiving the fixed rate from the swap and paying the yield in a short T-notes would return 59 basis points per year.
- To secure this return of 59 basis points, we have to pay the LIBOR rate, as part of the swap, and receives the repo rate, as part of a reverse repo transaction to short the T-note.

# The LIBOR-Repo Spread

- The spread between LIBOR and repo (LRS) is

$$
L R S = 5.5081 \% - 5.27 \% = 0.2381 \%
$$

- The net spread is  $SS - LRS = 35.19$  bps.
- This spread is not very large, but the LIBOR-repo spread has been historically relatively stable at around 21 bps and so this net spread  $(SS - LRS)$  still appears a relatively safe trade.  
- Using daily data from Jan 2000 to Jun 2006, the distribution of the LIBOR-repo spread is as

3-month LIBOR - Repo Spread Distribution: January, 2000 - June, 2006  

<table><tr><td colspan="11">Percentiles</td></tr><tr><td>Mean</td><td>St.Dev.</td><td>1%</td><td>5%</td><td>10%</td><td>25%</td><td>50%</td><td>75%</td><td>90%</td><td>95%</td><td>99%</td></tr><tr><td>0.21%</td><td>.07%</td><td>0.05%</td><td>0.13%</td><td>0.14%</td><td>0.17%</td><td>0.20%</td><td>0.25%</td><td>0.29%</td><td>0.31%</td><td>0.37%</td></tr></table>

Data Source: Bloomberg.

- Even in extreme circumstances, the net spread would be at least  $0.59\% - 0.37\% = 22$  bps

# The Trade

- We finally decided to go ahead, and enter into the following transactions:

1. Short the 5-year bond through a reverse repo transaction. In cash flow terms, the fund would receive the repo rate and pay the coupon.  
2. Enter into a fixed-for-floating swap, in which we would receive fixed and pay LIBOR.

- Reverse Repo

– We want to set up a \$100 million trade. Thus, we need to sell

$$
N = \frac {\mathrm {\\( 1 0 0 m i l l o n}}{1 0 0 . 1 1 7 2} = 9 9 8, 8 2 9 \text {T r e a s u r y n o t e s (f o r \\) 1 0 0 p a r v a l u e)} \tag {14}
$$

– Assuming haircut = 0, we then borrow N = 998,829 5-year T-notes from the repo dealer, sells them in the cash market for \$100 million, and gives this cash to the repo dealer.  

- Assume we enter into a term reverse repo with 3-months maturity, and rolls it over every three months.  
 – Because the repo dealer keeps the \$100 million at every reset date, our total cash flow every quarter is

Reverse repo CF(t) =  $\begin{cases} \frac{\mathbb{S}100\mathbb{m}\mathbb{m}}{4} \times r(t - 0.25) - N \times 100 \times \frac{5.125\%}{2} & \text{if } t \text{ is a coupon date}\\ \frac{\mathbb{S}100\mathbb{m}\mathbb{m}}{4} \times r(t - 0.25) & \text{otherwise} \end{cases}$

# The Trade

# - Fixed-for-Floating Swap

- We have to enter into a 5-year, fixed-for-floating swap in which we pay the 3-month LIBOR rate and receive the 5-year fixed swap rate.  
* In a plain vanilla fixed-for-floating swap, the floating payments occur at quarterly frequency, while the fixed payments occur at semi-annual frequency, therefore exactly matching the payment frequency of the reverse repo transaction discussed earlier.  
- Denoting  $\ell(t)$  is the 3-month LIBOR rate at time  $t$ , the swap cash flows are then given by

$$
\operatorname {S w a p} \operatorname {C F} (t) = \left\{ \begin{array}{c c} \\ & \\ & - \frac {\$ 100 \mathrm {mm} \times \frac {5.69 \%}{2} - \frac {\$ 100 \mathrm {mm}}{4} \times \ell (t - 0.25)}{4} \text {if t i s f i x e d p a y m e n t d a t e} \\ & \\ & - \frac {\$ 100 \mathrm {mm}}{4} \times \ell (t - 0.25) \text {o t h e r w i s e} \end{array} \right.
$$

# The Quarterly Cash Flow

- It is useful to decompose the quarterly cash flow in two components, the swap spread (SS) component and the LIBOR-repo spread (LRS) component.  
- We have that every six months, the swap spread component of the cash flow is

$$
\begin{array}{l} SS CF every six months = \\(100 \mathrm{~mm} \times \frac{5.69\%}{2} - N \times 100 \times \frac{5.125\%}{2} \\ = \mathbb {S} 2 8 5, 4 9 9. 7 3 \\ \end{array}
$$

- The second component is the LIBOR-repo spread, which every quarter is given by

$$
\mathrm {L R S C F e v e r y t h r e e m o n t h s} = \frac {\mathbb {S} 1 0 0 \mathrm {m m}}{4} \times (r (t - 0. 2 5) - \ell (t - 0. 2 5))
$$

- For instance, on June 30 the  $r(0) = 5.27\%$  while  $\ell(0) = 5.5081\%$ , implying

$$
\text {L R S C F} \text {o n} 3 0, 2 0 0 6 = - \$ 5 9, 5 2 5. 0 0 \tag {15}
$$

- Since the LIBOR-repo spread is relatively stable, we expect to receive approximately

$$
\text {T o t a l} = 2 \times \$ 2 8 5, 4 9 9. 7 3 - 4 \times \$ 5 9, 5 2 5. 0 0
$$

$$
= \mathbb {S} 3 3 2, 8 9 8
$$

- …but risk may be just around the corner …

The Swap Spread and LIBOR-Repo Spread  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/23448009a402de69eb1000bff9911a3699beeb8a4acd11a91608a0810ea23060.jpg)  
Source: Federal Reserve and Bloomberg.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/6f3b8125f8e9d2f3b6f8d51d6a69d001a59a26d5bb0effb0878cd0172e4213dc.jpg)  
Net Cash Flows from Swap Spread Trade

# Unwinding the Position?

- Given the large negative quarterly payments due to the increase in the LIBOR-repo spread, we may start thinking about whether we should unwind their position.
- First question is: What is the value of the position?
- The Value of the Reverse Repo
- The ex-coupon value of the repo position on rollover quarter  $t$  is

$$
\text {V a l u e r e v e r s e r e p o a t} t = \mathbb {S} 1 0 0 \mathbf {m m} - N \times P _ {\text {n o t e}} (t, T)
$$

where  $P_{\text{note}}(t, T)$  is the value of the T-note at time  $t$ .

- The Value of the Fixed-for-Floating Swap
- As time passes and interest rates fluctuate, the value of the swap changes. We have:

$$
\text {V a l u e s w a p} t = P _ {c} (t, T) - P _ {F R} (t, T)
$$

- where  $P_{FR}(t, T)$  is the LIBOR-based floating rate bond, and  $P_{c}(t, T)$  is the fixed rate coupon bond with coupon  $c = 5.69\% =$  swap rate, given by

$$
P _ {c} (t, T) = \frac {100 \times 5.69 \%}{2} \times \sum_ {i = 1} ^ {n _ {t}} Z (t, T _ {i}) + 100 \times Z (t, T _ {n _ {t}})
$$

- Here,  $Z(t,T_{i})$  is the LIBOR discount curve (see next Figure)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f7ef1839dacaf3b47fa2e5344d2fc63b0a2dce1a71d2675b3fe4ff0ce0e18894.jpg)  
The LIBOR Curve: June 2006 – June 2008

# The Surprise

- On March, 2008, as we start unwinding the position, we have a good news: the value of the swap is now \$10.21 million.  
 – Indeed, the LIBOR yield curve now ranges between 2.7% at 1 month, and 3.3% at 5 years, which pushes up the value of the fixed part of the swap to \$110.21 million.  
 – Because the floating part is always equal to \$100 million at reset dates, by closing the position we would obtain an inflow of \$10.21 million.

- However, as we close the swap, we have also to close the reverse repo.

– The bad news is that now the T-note we are shorting is trading at \$110.23.  

 - Given the accrued interest of \$1.28, the total losses from the short position amount to \$100 million -N × $111.51 = -$11.38 million.
- In sum, to close the position on March, 2008, we receive \$10.21 million from the swap, but we have to pay \$11.38 million on the reverse repo, for a total loss of \$1.16 million. This number far outweighs the cumulative cash flows we have so far received.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f6f16f14261fc3b7f545cacebdbbdab5b3841197d201ccfc4afa63d45cc53d79.jpg)  
The Swap Spread Trade Value

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/b2e153462a44724da4461f67596c621ca5f88fad9b39c733d29087aba39d2b6e.jpg)

# Conclusion: The Risk in Relative Value Trades

1. Cost of Carry, due to the variation in the cost-of-carry, i.e. the cash-flow per period that a trade is expected to generate.

- In swap spread trade, it is the difference between the swap spread and the LIBOR-repo rate.  
- An arbitrageurs may find that holding up the trade is generating cash outflows that outstrip the expected gain from convergence.

2. Market Risk, that is, the potential capital losses due to the variation in the underlying spread.

- In a relative value trade speculators bet on the convergence of the underlying spread to an average level.  
- However, such spread may either not converge to the average level, or just widen for a while.

3. Funding Risk, that is, the ability to hold up the position until maturity.

- Even for those (arbitrage) trades in which a hedge fund is certain to make profits if it holds the position until maturity, it is quite possible that the spread may widen further before it narrows.  
- If the spread widens, then the hedge fund would potentially suffer large capital losses.  
- It is then key for the hedge fund survival that it has sufficient capital in cash or a large borrowing capacity that makes it able to withstand the capital loss.

# Funding Risk during the Crisis?

- Funding risk is especially important during periods of crisis, for a number of reasons:

1. All risk-based spreads – the spreads between a risky securities and Treasury securities – tend to widen, as investors dump risky securities and purchase safe U.S. Treasuries.

- $\Rightarrow$  Relative value trades experience large capital losses.

2. Lenders are more wary of default risk, and increase haircuts, margins, etc., making capital effectively more scarce

- It becomes harder for a hedge fund to keep up the position.

3. Investors withdraw money from hedge funds, if they can.

Hedge funds must liquidate positions, at a loss.

- Next figure shows negative swap spreads during the crisis for long term swaps

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/846ad7f6d7f87e7638c601047562ff118b95ec15bfa9ed29d3794cec7659e80e.jpg)  
Negative Swap Spreads during the Crisis

# Negative Swap Spread and No Arbitrage

- Negative swap spreads are a textbook arbitrage opportunity:
- Buy Treasury and pay fixed in a fixed for floating swap

$$
\Rightarrow \mathrm {C a s h F l o w a t} t = \left(c ^ {T - B o n d} - c ^ {s w a p}\right) + \left(L I B O R _ {t} - R E P O _ {t}\right)
$$

- Both terms are positive. The first because of the negative swap spread, and the second because LIBOR is the rate for uncollateralized borrowing, while REPO is the rate for collateralized borrowing.
- This is a textbook arbitrage opportunity if an arbitrageur can hold the position to maturity.  
- The risk of the spread increasing further, generating severe capital losses, may make arbitrageurs wary of entering the market.  
- At reset dates, the value of the trade is

$$
V _ {t} ^ {T r a d e} = (P _ {c} ^ {T - B o n d} (t, T) - P _ {c} ^ {S w a p} (t, T))
$$

- If the swap spread becomes even more negative, e.g. the yield on T-bond increases while the one of the swap remains the same, then  $V_{t}^{Trade}$  decreases even more.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c569621556aa31693d88d749d6e4ccdc4ae1d58811dab142c89ef44f72a3df3f.jpg)

Swap spread

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/71addf054cd91a9991a0b8d4c533774fdffbd66c91e7f1958b1e4325890e76f0.jpg)

Treasury yield (right scale)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/bcffa944c88e7d40c6af96743dc9069992ca4bb1af4bb2284bd88776b6686000.jpg)

Swap rate (right scale)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f80b54f53eb599d461dc863de39c5986f3f1e0a735b8646eee84554e961d6ade.jpg)  
Negative Spreads Continue

Two-year Ten-year

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c61b2d1a9d73d3e3648fa328036f5a97094d10d128510b90b6214d69ef6e873b.jpg)

Thirty-year

Basis Points  
Percent  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/cc6bdb315e205c05b10edc0a2619362af81ca03988c33ef4df9d0d10421c8f55.jpg)  
Source: Federal Reserve Board, H.15 release.

Basis Points  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/1f8be35e9e042280707a3b62040bae8f8fef0b197e38eb876f91eda562f0fb86.jpg)  
Chart 1 from Boyarchenko et.al. (2018) "Negative Swap Spreads," Federal Reserve Bank of New York Economic Policy Review

# Violation of no-arbitrage during the 2007 - 2008 crisis

- The violation of no-arbitrage rules was widespread during the recent crisis  
- For instance, another simple arbitrage restriction that was violated was the covered interest rate parity (CIP)
- The simple rule in the foreign exchange market according to which the forward exchange rate  $F_{t,T}$  equals the spot  $M_t$  times the ratio of investment rates in domestic versus foreign country.  
- For instance, if  $M_{t} = US / EURO$  exchange rate, then

$$
F _ {t, T} = M _ {t} e ^ {(r _ {\S} - r _ {e}) (T - t)}
$$

- Next figure shows the difference

$$
F _ {t, T} ^ {d a t a} - F _ {t, T}
$$

- before and during the crisis.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/4b1d6c88d88af1059c402b97551138bb1f318924278b42f7eee34a80bb9611d9.jpg)  
CIP Violation during the 2007 - 2009 Financial Crisis: Euro / Dollar

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/27428a9984d5cdcf27abd1af737379d8faeb0c4487169d4441789fad73783d97.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/a9ed67dfc59efec0cac610e165cdcfa3097ea920c36f56ac41b56b8217225484.jpg)  
CIP Violation during the 2007 - 2009 Financial Crisis: UKP / Dollar

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f9613e18610432d6cdaf03cbc19f3e83b0a8f877841a3681492d70b9cdaa591c.jpg)

# Why Did Covered Interest Rate Parity Fail during the 2007-2009 Crisis?

- Holding US Treasuries has its own "convenience yield" when everyone needs cash collateral.  
- During the crisis, from the graph, we had the following violation:

$$
F _ {t, t + m} ^ {d a t a} > F _ {t, t + m} = M _ {t} e ^ {(r _ {\S} - r _ {e}) m}
$$

- Recall that in this case, an arbitrage trade requires the following:

(a) Short Euro forward;  
(b) borrow dollars (or sell US Treasuries);  
(c) change them into Euro;  
(d) invest in Euro (or buy Euro bonds)

- But point (b) failed during the crisis, as:

1. Increase in credit risk concerns impaired the ability of any financial institution to borrow;  
2. Holding safe dollars (US Treasuries) is valuable during a financial crisis for liquidity management
- US Treasuries are the only collateral accepted for short-term lending transactions.
- It is very valuable to hold on to them for future cash management

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/1688439cfa4400d5776c7b14e9137cd5f7936bbb9ffb1636eac365b4a06e9de7.jpg)  
Cross-Currency Basis Risk after the Crisis  
Figure 5 from Du, Tepper, and Verdelhan (2017), "Deviations form Covered Interest Rate Parity," NBER working paper.

# Issues with LIBOR

- Until January 31, 2014: British Bankers Association (BBA) LIBOR

Survey of a panel of banks  

- Banks could underestimate their borrowing costs  
- Conflict within the bank: impact of LIBOR setting on derivatives trading.
- Now ICE LIBOR
- ICE now the benchmark administrator  
Regulator in UK: Financial Conduct Authority (FCA)  
- Rules for fall-back rates if there are issues

# Alternatives

- SOFR: "Secured Overnight Financing Rate"  
- ARRC: Alternative Reference Rates Committee.  
- Others:
- SONIA (Sterling Over Night Indexed Average)  
EONIA (Euro Overnight Index Average)  
- TONAR (Tokyo Overnight Average Rate)  
SARON (Swiss Average Rate Over-Night)  
- Measure of overnight secured borrowing.  
Collateralized US Treasuries in the repo market.  
 – Very liquid and likely resilient markets: \$1 trillion in daily volume  
- Contrast: USD LIBOR three-month tenor: about \$1 billion  
- Published by New York Fed. Along with 30-day, 90-day and 180-day averages

# Transition

- LIBOR market: \$200+ trillion of financial transactions contracts reference LIBOR  
- LIBOR permeates many contracts for in securities markets and the corporate world: leases, debt,  
- Derivatives market with Central Clearing Partners (e.g. CME … ).
- Cleared US Dollar interest rate swap contracts at CME: move to SOFR discounting.  
- Intercontinental Exchange (ICE) Benchmark Administration: USD LIBOR benchmarks will stopped
- Fannie and Freddie: have moved bo SOFR contracts  
- New York Fed: conducts repo and reverse repo through tri-party repo.  
- OTC SOFR swaps  
- SOFR caps products have developed since September 2020

# SOFR Derivatives

As an example: at the CME

- Futures: 3-month and 1-month. Using compounding or simple averages.  
- Term SOFR Reference rates based on futures contracts.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/1cfb22983027dd9d92909957a036a2d9f94852adb9e9a6c970e75fbb3a17525c.jpg)  
Some History

# Overnight Index Swaps (Is)

- In a Is, the two counterparties agree to exchange fixed for floating payments, where the floating payment is tied to the cumulative return from an overnight rate  
- Federal funds rate, SOFR in US. Europe: short-term rate (€STR), (formerly Euro OverNight Index Average (EONIA) rate).  
- Given a notional  $N$ , the floating rate payment at time  $T_{i}$  is

$$
C F \left(T _ {i}\right) = N \left(\prod_ {j = 1} ^ {n _ {j}} \left(1 + r _ {t _ {j}} \delta\right) - 1\right) \tag {16}
$$

- where  $\delta$  is the daily interval,  $r_t$  is the reference (annualized) overnight rate, and  $n_j$  is the number of days between reset periods.  
- The day count convention is normally Actual/360.  
- In the continuous time limit  $(\delta \to 0)$ , we have that

$$
C F \left(T _ {i}\right) = N \left(e ^ {\int_ {T _ {i - 1}} ^ {T _ {i}} r (u) d u} - 1\right) \tag {17}
$$

- Is with maturity less than 1 year have only one payment at the maturity.  
- Is with longer maturities have normally quarterly payments.

# What is the value of Is?

- The value of Is is the difference between the floating leg and the fixed leg:

$$
V _ {t} ^ {O I S} = V _ {t} ^ {F l o a t i n g} - V _ {t} ^ {F i x e d} \tag {18}
$$

- Floating Leg: At reset dates, and assuming the payment of a principal at maturity of the swap, the value of the floating leg is par.
- Indeed, investing the notional  $N$  in the overnight index daily gives at  $T_{i}$

$$
N \prod_ {j = 1} ^ {n _ {j}} \left(1 + r _ {t _ {j}} \Delta\right) = C F \left(T _ {i}\right) + N
$$

- $\Rightarrow$  we can replicate the floating payments, plus a residual of notional at maturity  $T_{i}$ , with an investment  $N$  at time 0.
- It follows

$$
V _ {0} ^ {F l o a t i n g} = N
$$

- Fixed leg: Given a proper discount function  $Z^{OIS}(0, T_i)$ , we obtain

$$
V _ {0} ^ {F i x e d} = N c \Delta \sum_ {i = 1} ^ {n} Z ^ {O I S} (0, T _ {i}) + N Z ^ {O I S} (0, T _ {n}) \tag {19}
$$

- The value of the contract at inception is zero,  $V_{0}^{OIS} = 0$ .  
It follows from (18) then that

$$
V _ {0} ^ {O I S} = V _ {0} ^ {F l o a t i n g} - V _ {0} ^ {F i x e d} = 0 \tag {20}
$$

- This equation implies that the swap rate  $c$  can be computed from

$$
1 = c \Delta \sum_ {i = 1} ^ {n} Z ^ {O I S} (0, T _ {i}) + Z ^ {O I S} (0, T _ {n}) \tag {21}
$$

which gives

$$
c (T _ {n}) = \frac {1}{\Delta} \frac {1 - Z ^ {O I S} (0 , T _ {n})}{\Sigma_ {i = 1} ^ {n} Z ^ {O I S} (0 , T _ {i})} \tag {22}
$$

- where we now emphasize that the coupon rate  $c$  is for a swap with maturity  $T_{n}$ , and thus write  $c(T_{n})$ .

# Is Discount Curve

- Given the Is coupon rates  $c\left( {T}_{i}\right)$  for every maturity  ${T}_{i}$  ,we can bootstrap the Is zero-coupon curve from (20).  
- We obtain the relation:

$$
Z ^ {O I S} \left(0, T _ {i}\right) = \frac {1 - c \left(T _ {i}\right) \Delta \sum_ {j = 1} ^ {i - 1} Z ^ {O I S} \left(0 , T _ {j}\right)}{1 + c \left(T _ {i}\right) \Delta} \tag {23}
$$

- recalling, however, that Is with maturity less than or equal to 1 year generally have only one payment.  
- Next Figure shows an example of bootstrapping from Is quotes, on January 2, 2009. Panel A reports the original Is quotes from Bloomberg. Panel B uses the quotes from Panel A along with bootstrap methodology (23) and defines the Is discount function  $Z^{OIS}(0,T)$ .

# Is Discount Curve on January 2th, 2009

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/32bb2fc661640341e232c4b5ac7da583da416b0e41a96acbbe7e427c05c62a70.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c4ff364871e633ee349af3632fd042dc6ac171687f73e3635d3a58a3f784d0b2.jpg)  
Data Source: Bloomberg

# Is and LIBOR Discount Curve on January 2nd, 2007

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/05a5d26a1b4060da0b9c880e0e59a58e3a191930626eb44bd422d5dd4c738c99.jpg)  
Panel A. Is and LIBOR Zero Coupon Curve

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/25f180080f770432874993376b3542f04ae5095956aea8c21b93e694fdf28d74.jpg)  
Panel B. Is and LIBOR Zero Curve  
Data Source: Bloomberg

- However, if we try after the crisis, we obtain the following figure:

# Is and LIBOR Discount Curve on January 2nd, 2009

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/171879c7b32b94eba3d1e656c446acfb28007b9f0285a9a2fa011932c42fff43.jpg)  
Panel A. Is and LIBOR Zero Coupon Curve

Panel B. Is and LIBOR Zero Curve  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/cc107a9cb557b22be575d0220d131da9867bb586e850ef7afeaab6e79f9e1864.jpg)  
Data Source: Bloomberg

which are quite different.

# Caps, Floors and Collars

$$
C F (T _ {i + 1}) = \Delta \times N \times \max (r _ {n} (T _ {i}, T _ {i + 1}) - r _ {K}, 0)
$$

- A cap pays a stream of payments at  $T_{i}$ ,  $i = 1, \dots, n$  with  $T_{i+1} = T_{i} + \Delta$ , where  
- where  $\Delta$  is the time interval between payments,  $N$  is the notional and  $r_n(T_i, T_{i+1})$  is the  $n$ -times compounded LIBOR rate.  
A floor pays

$$
C F \left(T _ {i + 1}\right) = \Delta \times N \times \max  \left(r _ {K} - r _ {n} \left(T _ {i}, T _ {i + 1}\right), 0\right)
$$

# Black's Formula for Caplet Valuation

- It is market practice to use Black's model to value Caps and Floors.  
- The main assumption is that under risk-adjusted probabilities (called "forward risk neutral probabilities"), the LIBOR rate has a log-normal distribution:

$$
\ln \left(r _ {n} \left(T _ {i}, T _ {i + 1}\right)\right) \sim N \left(\mu_ {i}, \sigma_ {f, i + 1} ^ {2} T _ {i}\right)
$$

- where we assume  $\sigma_{f,i+1}$  is a constant volatility and the subscript  $i+1$  is maturity of the caplet.  
- The valuation formula is then the following:

$$
\operatorname {c a p l e t} \left(T _ {i + 1}\right) = \Delta \times N \times Z \left(0, T _ {i + 1}\right) \left[ f _ {n} \left(0, T _ {i}, T _ {i + 1}\right) \mathcal {N} \left(d _ {1}\right) - r _ {K} \mathcal {N} \left(d _ {2}\right) \right] \tag {24}
$$

where  $f_{n}(0,T_{i},T_{i + 1}$  is the forward rate, and

$$
d _ {1} = \frac {\ln \left(f _ {n} (0 , T _ {i} , T _ {i + 1}) / r _ {K}\right) + \sigma_ {f , i + 1} ^ {2} T _ {i} / 2}{\sigma_ {f , i + 1} \sqrt {T _ {i}}}; d _ {2} = d _ {1} - \sigma_ {f, i + 1} \sqrt {T _ {i}}
$$

- Notice: We discount the payoff using  $Z(0, T_{i+1})$  and not  $Z(0, T_i)$  as the cash flow is realized at time  $T_{i+1}$ .

# Example

- On November 1, 2004. Consider a 1-year, quarterly cap with strike rate  $r_{K} = 2.555\%$ .  
- Assume this cap is trading at volatility  $\sigma_{f} = 23.5\%$ .  
- The current LIBOR discount curve is as follows

$$
Z (0, 0. 2 5) = 9 9. 4 5 8 0; Z (0, 0. 5) = 9 8. 8 5 1 0; Z (0, 0. 7 5) = 9 8. 1 8 9 9; Z (0, 1) = 9 7. 4 8 3 4.
$$

- From the LIBOR curve, we can compute the quarterly compounded forward rates:
- Forward Discount Factors

$$
F (0, T _ {i - 1}, T _ {i}) = \frac {Z (0 , T _ {i})}{Z (0 , T _ {i - 1})}
$$

- Forward rates

$$
f _ {4} (0, T _ {i - 1}, T _ {i}) = 4 \times \left(\frac {1}{F (0 , T _ {i - 1} , T _ {i})} - 1\right)
$$

We obtain

$$
f_{4}(0,0.25,0.5) = 2.4562\% ; f_{4}(0,0.5,0.75) = 2.6932\% ; f_{4}(0,0.75,1) = 2.8987\%
$$

# Example (cntd.)

- The last input in the Black's formula is the volatility  $\sigma_{f} \times \sqrt{T_{i}}$ 
- From the quoted volatility  $\sigma_{f} = 23.5\%$ , we obtain

$$
\sigma_ {f} \sqrt {T _ {1}} = 23.5 \% \sqrt {0.25} = 11.75 \%;
$$

$$
\sigma_ {f} \sqrt {T _ {2}} = 23.5 \% \sqrt {0.50} = 16.62 \%;
$$

$$
\sigma_ {f} \sqrt {T _ {3}} = 23.5 \% \sqrt {0.75} = 20.35 \%
$$

- At this point we have all the information to compute the value of each caplet in the cap.  
- In particular, using the formula for  $d_{1}$  and  $d_{2}$  we obtain

$$
d _ {1} (0. 5) = -. 2 7 7 0; d _ {2} (0. 5) = -. 3 9 4 5
$$

$$
d _ {1} (0. 7 5) = . 4 0 0 0; d _ {2} (0. 7 5) = . 2 3 3 8
$$

$$
d _ {1} (1) = = . 7 2 1 8; d _ {2} (1) = 0. 5 1 8 3
$$

# Example (cntd.)

- Then

$$
\begin{array}{l} \operatorname {caplet} (0.50) = \Delta \times N \times Z (0, 0.50) [ 2.4562 \% \times \mathcal {N} (d _ {1} (.50)) - 2.555 \% \times \mathcal {N} (d _ {2} (.50)) ] \\ = 0. 0 1 8 4 \\ \end{array}
$$

$$
\begin{array}{l} \operatorname {caplet} (0. 7 5) = \Delta \times N \times Z (0, 0. 7 5) [ 2. 6 9 3 2 \\ = 0. 0 6 1 7 \\ \end{array}
$$

$$
\begin{array}{l} \operatorname {caplet} (1.0) = \Delta \times N \times Z (0, 1.0) [ 2.8987 \% \times \mathcal {N} (d _ {1} (1.0)) - 2.555 \% \times \mathcal {N} (d _ {2} (1.0)) ] \\ = 0. 1 0 5 7 \\ \end{array}
$$

- and we obtain the value of the 1-year cap:

$$
C a p (1 Y) = 0. 0 1 8 4 + 0. 0 6 1 7 + 0. 1 0 5 7 = 0. 1 8 5 9
$$

# Flat Volatilities and Forward Volatilities

- Caps and floors are quoted in terms of flat volatilities.
- The volatility across caplets is kept constant for each cap.
- For example, from Bloomberg (code SSRC), one finds quotes such as

Table 1: Quotes of Caps and Swaptions on November 1, 2004  

<table><tr><td rowspan="2">Maturity</td><td rowspan="2">Swap Rates</td><td colspan="3">Swaption Vols</td><td colspan="2">Volatilities</td></tr><tr><td>3M</td><td>6M</td><td>1Y</td><td>Caps</td><td>Floors</td></tr><tr><td>1 Y</td><td>2.555</td><td>27.115</td><td>30.234</td><td>31.750</td><td>23.50</td><td>23.50</td></tr><tr><td>2 Y</td><td>2.932</td><td>32.210</td><td>32.327</td><td>31.258</td><td>29.89</td><td>29.89</td></tr><tr><td>3 Y</td><td>3.254</td><td>31.011</td><td>30.937</td><td>29.801</td><td>30.55</td><td>30.55</td></tr><tr><td>4 Y</td><td>3.520</td><td>29.901</td><td>29.622</td><td>28.491</td><td>29.86</td><td>29.86</td></tr><tr><td>5 Y</td><td>3.751</td><td>28.719</td><td>28.513</td><td>27.404</td><td>28.62</td><td>28.62</td></tr><tr><td>7 Y</td><td>4.118</td><td>25.337</td><td>25.332</td><td>24.711</td><td>26.48</td><td>26.48</td></tr><tr><td>10 Y</td><td>4.505</td><td>21.889</td><td>21.833</td><td>21.570</td><td>23.68</td><td>23.68</td></tr></table>

Source: Bloomberg.

- Each entry is a flat volatility for an "at-the-money" instrument, meaning that its strike rate (equal for all the caplets) is the swap rate with the same maturity of the cap.  
- The payment frequency of the underlying caps and floors is 3 months.  
- Since the first payment at horizon 3 months is known at time 0, it is practice to set this caplet equal to zero.

# Flat Volatilities and Forward Volatilities

- As an example, from Table 1, we obtain the following prices for caps

Table 2: Cap Prices and Volatilities  

<table><tr><td>Maturity</td><td>Swap Rate (%)</td><td>Cont. Comp. Yield (%)</td><td>Discount (×100)</td><td>Interp. Cap Vol (%)</td><td>Cap Prices (×100)</td><td>Fwd Vol (%)</td></tr><tr><td>0.25</td><td>2.180</td><td>2.174</td><td>99.4580</td><td>-</td><td>-</td><td>-</td></tr><tr><td>0.50</td><td>2.318</td><td>2.311</td><td>98.8510</td><td>21.156</td><td>0.046</td><td>21.156</td></tr><tr><td>0.75</td><td>2.442</td><td>2.436</td><td>98.1899</td><td>22.066</td><td>0.106</td><td>22.810</td></tr><tr><td>1.00</td><td>2.555</td><td>2.549</td><td>97.4834</td><td>23.500</td><td>0.186</td><td>25.540</td></tr><tr><td>1.25</td><td>2.659</td><td>2.653</td><td>96.7385</td><td>25.229</td><td>0.289</td><td>28.560</td></tr><tr><td>1.50</td><td>2.755</td><td>2.749</td><td>95.9598</td><td>27.023</td><td>0.416</td><td>31.360</td></tr><tr><td>1.75</td><td>2.845</td><td>2.841</td><td>95.1503</td><td>28.653</td><td>0.566</td><td>33.420</td></tr><tr><td>2.00</td><td>2.932</td><td>2.929</td><td>94.3109</td><td>29.890</td><td>0.736</td><td>34.040</td></tr><tr><td>2.25</td><td>3.017</td><td>3.015</td><td>93.4417</td><td>30.571</td><td>0.920</td><td>32.910</td></tr><tr><td>2.50</td><td>3.099</td><td>3.099</td><td>92.5456</td><td>30.796</td><td>1.113</td><td>31.210</td></tr><tr><td>2.75</td><td>3.178</td><td>3.180</td><td>91.6268</td><td>30.734</td><td>1.313</td><td>29.660</td></tr><tr><td>3.00</td><td>3.254</td><td>3.258</td><td>90.6899</td><td>30.550</td><td>1.519</td><td>28.760</td></tr></table>

Data Source: Bloomberg.

# Flat Volatilities and Forward Volatilities

- Issue: Consider the caps with maturities  $T = 0.5$ ,  $T = 0.75$ ,  $T = 1$ .  
- The  $T = 0.5$  cap has only one caplet with (implied)volatility  $21.156\%$  
- The  $T = 0.75$  cap has two caplets each computed with (implied) volatility  $22.066\%$  
- The  $T = 1$  cap has three caplets each computed with (implied) volatility  $23.500\%$  
- It looks like the same caplet would have a different price, depending on which cap it belongs to.  
- Instead, it is only a quoting convention, and due to the distinction between Flat (or quoted) volatility and Forward Volatility
- The Forward Volatility (or spot volatility) of a caplet with maturity  $T$  and strike rate  $r_{K}$  is the volatility  $\sigma_f^{Fwd}(T)$  that characterizes that particular caplet.

# Flat Volatilities and Forward Volatilities

- Next table illustrates the relation between forward volatility and flat volatility
- The forward volatility is used to price individual caplets and thus obtain a value of the cap.  
- The flat volatility is used to quote the cap, once its price is determined in the previous step.  
- The flat volatility is a sort of average (forward) volatility used for quoting purposes only.

Table 3: The Relation between Forward and Flat Volatility  

<table><tr><td rowspan="3">Flat Volatility</td><td></td><td colspan="5">Forward Volatility</td></tr><tr><td></td><td>σFwd(0.50)</td><td>σFwd(0.75)</td><td>σFwd(1.00)</td><td>…</td><td>σFwd(10.0)</td></tr><tr><td></td><td>↓</td><td>↓</td><td>↓</td><td>…</td><td>↓</td></tr><tr><td>σf(0.50) ⇒</td><td>Cap(0.50) =</td><td>caplet(0.50)</td><td>-</td><td>-</td><td>…</td><td>-</td></tr><tr><td>σf(0.75) ⇒</td><td>Cap(0.75) =</td><td>caplet(0.50) +</td><td>caplet(0.75)</td><td>-</td><td>…</td><td>-</td></tr><tr><td>σf(1.00) ⇒</td><td>Cap(1.00) =</td><td>caplet(0.50) +</td><td>caplet(0.75) +</td><td>caplet(1.00)</td><td>-</td><td>-</td></tr><tr><td>:</td><td>:</td><td>:</td><td>:</td><td>:</td><td>…</td><td>-</td></tr><tr><td>σf(10.0) ⇒</td><td>Cap(10.0) =</td><td>caplet(0.50) +</td><td>caplet(0.75) +</td><td>caplet(1.00) +</td><td>…</td><td>caplet(10.0)</td></tr></table>

# Extracting the Forward Volatility from Flat Volatility

- To set up arbitrage strategies, we need Forward Volatilities, and not Flat volatilities.  
- How do we extract the Fwd volatility from the Flat volatility?
- It is simple and analogous to the extraction of the discount  $Z(t;T)$  from bonds and swaps.  
- We start from the shortest maturity, and then bootstrap the Fwd volatility out of the Flat volatility, by using an iterative method.
- Consider a cap with maturity  $T_{i}$  and let  $\sigma_{f}(T_{i})$  be its "flat volatility".  
- Denote also  $\sigma_f^{Fwd}(T_j)$  the forward volatilities for  $j = 1,2,\ldots,n$ .  
- For all  $T_{i}$  the following equations must hold

$$
c a p \left(T _ {i}\right) = \sum_ {j = 1} ^ {i} c a p l e t \left(T _ {j}, \bar {r} _ {K, i}, \sigma_ {f} (T _ {i})\right)
$$

(How the market quotes)

$$
= \sum_ {j = 1} ^ {i} c a p l e t \left(T _ {j}, \overline {{r}} _ {K, i}, \sigma_ {f} ^ {F w d} (T _ {j})\right)
$$

(Implied by no arbitrage)

- where notice that the difference between the first and the second line is just the volatility.

# How do we extract the  $\sigma_f^{Fwd}(T_j)$ 's?

- Step 1: Use the quoted (flat) volatilities to obtain cap prices for all maturities (see Table 2).  
- Step 2: For the shortest maturity  $\left( {{T}_{1} = {0.5}}\right)$  ,the cap has only one caplet,and thus the forward and flat volatility must coincide. Thus:

$$
\sigma_ {f} (0.5) = \sigma_ {f} ^ {F w d} (0.5) = 21.156 \%
$$

- Step 3: For each subsequent time  $i = 2, \ldots$ , we use the following three step procedure:

1. Use the previously extracted forward volatilities  $\sigma_f^{Fwd}(T_j)$  for  $j = 1,..,i - 1$  to compute the caplets up to  $T_{j}$ , Caplet  $(T_{j},r_{K,i},\sigma_{f}^{Fwd}(T_{j}))$  
2. Obtain the dollar value of the remaining caplet  $T_{i}$  as the difference between the cap price for  $T_{i}$  (obtained in Step 1) and the sum of caplets up to  $T_{i-1}$

$$
\text {D o l l a r v a l u e o f} T _ {i} \text {c a p l e t} = C a p (T _ {i}) - \sum_ {j = 1} ^ {i - 1} C a p l e t \left(T _ {j}, r _ {K, i}, \sigma_ {f} ^ {F w d} (T _ {j})\right)
$$

3. Find the (forward) volatility  $\sigma_f^{Fwd}(T_i)$  such that

$$
C a p l e t \left(T _ {i}, r _ {K, i}, \sigma_ {f} ^ {F w d} (T _ {i})\right) = D o l l a r v a l u e \text {o f} T _ {i} \text {c a p l e t}
$$

# Example

- For instance, the second cap  $\left( {{T}_{2} = {0.75}}\right)$  has a dollar price of  $\operatorname{Cap}\left( {T}_{2}\right)  = \$ {0.1059}$  . We now use the three-step procedure in Step 3 above:

1. Compute the  $T_{1}$  caplet using the forward volatility  $\sigma_{f}^{Fwd}(T_{1}) = 21.1564\%$  just computed. Using the Black formula, we obtain

$$
C a p l e t (T _ {1}, r _ {K, 2}, \sigma_ {f} ^ {F w d} (T _ {1})) = \$ 0. 0 2 7 3
$$

2. The dollar value of the  $T_{2}$  caplet is then

$$
\begin{array}{l} \text {D o l l a r v a l u e o f} T _ {2} \text {c a p l e t} = C a p \left(T _ {2}\right) - C a p l e t \left(T _ {1}, r _ {K, 2}, \sigma_ {f} ^ {F w d} \left(T _ {1}\right)\right) \\ = \$ 0. 1 0 5 9 - \$ 0. 0 2 7 3 = \$ 0. 0 7 8 6 \\ \end{array}
$$

3. Use the Black formula again to find the (forward) volatility  $\sigma_f^{Fwd}(T_2)$  such that

$$
\operatorname {Caplet}\left(T_{2},r_{K,2},\sigma_{f}^{Fwd}(T_{2})\right) = \\ \\ \mathrm{\Phi}\\ \Rightarrow \quad \sigma_{f}^{Fwd}(T_{2}) = 22.81\%
$$

# Example (cntd.)

- Similarly, the  $T_{3}$  forward volatility is obtained as follows:

1. Compute the  $T_{1}$  and  $T_{2}$  caplets using the forward volatilities  $\sigma_{f}^{Fwd}(T_{1}) = 21.1564\%$  and  $\sigma_{f}^{Fwd}(T_{2}) = 22.81\%$  just computed. Using the Black formula with the new strike rate  $r_{K,3} = 2.4420\%$ , we obtain

$$
C a p l e t (T _ {1}, r _ {K, 3}, \sigma_ {f} ^ {F w d} (T _ {1})) = \$ 0. 0 1 5 7
$$

$$
C a p l e t (T _ {2}, r _ {K, 3}, \sigma_ {f} ^ {F w d} (T _ {2})) = \$ 0. 0 6 0 5
$$

2. The dollar value of the  $T_{3}$  caplet is then

$$
\begin{array}{l} \text {D o l l a r v a l u e o f} T _ {3} \text {c a p l e t} = C a p \left(T _ {3}\right) - \sum_ {j = 1} ^ {2} C a p l e t \left(T _ {j}, r _ {K, 3}, \sigma_ {f} ^ {F w d} \left(T _ {j}\right)\right) \\ = \$ 0. 1 8 5 9 - (\\$ 0. 0 1 5 7 + \$ 0. 0 6 0 5) = \$ 0. 1 0 9 6 \\ \end{array}
$$

3. Use the Black formula again to find the (forward) volatility  $\sigma_f^{Fwd}(T_3)$  such that

$$
\operatorname {Caplet}\left(T_{3},r_{K,3},\sigma_{f}^{Fwd}(T_{3})\right) = \\ \\ \S 0.1096\quad \Longrightarrow \quad \sigma_{f}^{Fwd}(T_{3}) = 25.54\%
$$

- Figure 1 plots the forward and flat volatilities on November 1, 2004

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/e27a451074b88f09e9ceda1bc9ebbcbb476ab0d1ef76c8ac51ac4acaf1ef0f88.jpg)  
Figure 1: Forward and Flat Volatilities

- Flat volatilities can be thought of a "cumulated averages" of forward volatilities.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/d3cda6c036c782a5d9202c2abfca92e3e769c91d76241e68c9284d2fbd9fc11e.jpg)  

- Cap (quoted) volatility changes over time.
- The average forward volatility curve is hump shaped:

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c2592b92ccd56e616b4a751b49aa4500e047cf5ff14707b53a3ec32a7cf55e45.jpg)  
Figure 2: Average Forward Volatility: 1987 - 2008

- The forward volatility has various shapes through time:

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/85e7eb82640a543ffc145e4962b806d257f0467e2898c27844622246f0031f56.jpg)  
Figure 3: Forward and Flat Volatilities

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/e475c919a538ef81b72062ab98d98149388f554795370d1f10a5b69a7a3180e6.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/63782c518c7bcdeb8723032d475395ebe64e4cdcbd3ceb10d116752d489cebdd.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/06162fab55d00685ee853d9338f83d90d4b3224f3f1024cdb55179266f06aa7c.jpg)

- The forward volatility is strongly time varying:

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/5e7fa48634bf1b507ec0c88e041606714a3f9e7f681cf57559d121f5bbc511f9.jpg)  
Figure 4: Forward and Flat Volatilities

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/49cccc6bb2fdc6f242d85c2cfc0e1a5b6e76cc9aba640fe29c79569c6f4ab8bb.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/7a6d480d99415b7c1ff4d672888b58ebec6c7fc1ba5c7c61c7c9d43b5c248d6f.jpg)

- where "slope =  $\sigma_{f}^{Fwd}(10) - \sigma_{f}^{Fwd}(1)$ " and "curvature = 2 $\sigma_{f}^{Fwd}(2) - \sigma_{f}^{Fwd}(1) - \sigma_{f}^{Fwd}(10)$ .

# Put-Call Parity

- A put-call parity relationship exists for caps and floors.  
- Clearly, a portfolio of a long caplet and short floorlet with equal strikes gives

$$
\max \left(r _ {n} (\tau , T) - r _ {K}, 0\right) - \max \left(r _ {K} - r _ {n} (\tau , T), 0\right) = r _ {n} (\tau , T) - r _ {K}
$$

- But this is the payoff to a swap. Hence, we have

$$
\mathrm {c a p} = \mathrm {f l o o r} + \mathrm {s w a p}
$$

# Swaptions

- A buyer of a swaption has the right, but not the obligation to enter into a swap with given characteristics (such as maturity, swap rate, payment frequency, etc.) at a given maturity  $T_{O}$ .  
- In a payer swaption the swaption buyer has the right to enter into a swap as a fixed-rate payer (and receive floating.) In a receiver swaption the swaption buyer has the right to enter into the swap as fixed-rate receiver (and pay floating).  
- For instance, in Table 1, an investor can purchase an at-the-money six-month option to enter into a 10-year swap at "implied volatility" of  $21.883\%$ .

Table 1: Quotes of Caps and Swaptions on November 1, 2004  

<table><tr><td rowspan="2">Maturity</td><td rowspan="2">Swap Rates</td><td colspan="3">Swaption Vols</td><td colspan="2">Volatilities</td></tr><tr><td>3M</td><td>6M</td><td>1Y</td><td>Caps</td><td>Floors</td></tr><tr><td>1 Y</td><td>2.555</td><td>27.115</td><td>30.234</td><td>31.750</td><td>23.50</td><td>23.50</td></tr><tr><td>2 Y</td><td>2.932</td><td>32.210</td><td>32.327</td><td>31.258</td><td>29.89</td><td>29.89</td></tr><tr><td>3 Y</td><td>3.254</td><td>31.011</td><td>30.937</td><td>29.801</td><td>30.55</td><td>30.55</td></tr><tr><td>4 Y</td><td>3.520</td><td>29.901</td><td>29.622</td><td>28.491</td><td>29.86</td><td>29.86</td></tr><tr><td>5 Y</td><td>3.751</td><td>28.719</td><td>28.513</td><td>27.404</td><td>28.62</td><td>28.62</td></tr><tr><td>7 Y</td><td>4.118</td><td>25.337</td><td>25.332</td><td>24.711</td><td>26.48</td><td>26.48</td></tr><tr><td>10 Y</td><td>4.505</td><td>21.889</td><td>21.833</td><td>21.570</td><td>23.68</td><td>23.68</td></tr></table>

Source: Bloomberg.

# Swaptions

- A swap, recall, is a contract between two parties to exchange at times  $T_{1},..,T_{n}$  the net cash flows

$$
C F (T _ {i + 1}) = \Delta \times N \times (r _ {K} - r _ {n} (T _ {i}, T _ {i + 1}))
$$

- On each of the reset dates dates, the value of the swap is

$$
V \left(T _ {i}, r _ {K}\right) = P \left(T _ {i}, T; r _ {K}\right) - 1 0 0
$$

- where  $P\left(T_{i}, T; r_{K}\right)$  is the price of a coupon bond with  $r_{K}$  as coupon rate and maturity  $T$ .  
- Consider an option that gives its holder the right (not the obligation) to enter as the fixed rate receiver in the swap at time  $T_{O} = T_{i^{*}}$  for some  $i^{*} < n$ , at the exercise rate  $r_{K}$ .  
- Let  $c\left(T_{i^{*}}, T\right)$  be the market swap rate at time  $T_{i^{*}}$  for a swap maturing at  $T$ .
- If  $c(T_{i^*}, T) < r_K$ , optimal to exercise the option (and receive  $r_K$  instead of lower  $c(T_{i^*}, T)$ ).  
- If  $c\left(T_{i^{*}}, T\right) > r_{K}$ , optimal not to exercise the option (better receive the market rate  $c\left(T_{i^{*}}, T\right)$ ).

# Swaption Payoff

- We now show that the payoff of a receiver swaption is positive if and only if the market swap rate is below the strike swap rate:

$$
V \left(T _ {i ^ {*}}, r _ {K}\right) > 0 \Longleftrightarrow c \left(T _ {i ^ {*}}, T\right) <   r _ {K}
$$

- The payoff from the Swaption can be written as

$$
\begin{array}{l} \text {P a y o f f} = V \left(T _ {i ^ {*}}, r _ {K}\right) - 0 \\ = V \left(T _ {i ^ {*}}, r _ {K}\right) - V \left(T _ {i ^ {*}}, c \left(T _ {i ^ {*}}, T\right)\right) \\ = \left[ P \left(T _ {i ^ {*}}, T; r _ {K}\right) - 1 0 0 \right] - \left[ P \left(T _ {i ^ {*}}, T; c \left(T _ {i ^ {*}}, T\right)\right) - 1 0 0 \right] \\ = P \left(T _ {i ^ {*}}, T; r _ {K}\right) - P \left(T _ {i ^ {*}}, T; c \left(T _ {i ^ {*}}, T\right)\right) \\ = \sum_ {j = i ^ {*} + 1} ^ {n} Z (T _ {i ^ {*}}, T _ {j}) r _ {K} \Delta N + Z (T _ {i ^ {*}}, T _ {n}) \times 1 \\ - \sum_ {j = i ^ {*} + 1} ^ {n} Z (T _ {i ^ {*}}, T _ {j}) c (T _ {i ^ {*}}, T) \Delta N - Z (T _ {i ^ {*}}, T _ {n}) \times 1 \\ = \sum_ {j = i ^ {*} + 1} ^ {n} Z (T _ {i ^ {*}}, T _ {j}) \Delta N (r _ {K} - c (T _ {i ^ {*}}, T)) \\ \end{array}
$$

- The value of a swap at time  $T_{O}$  is positive if and only if  $(r_{K} - c(T_{i^{*}}, T))$

# Swaption Payoff

- Clearly, the option buyer exercises the option if and only if the payoff is positive, so the receiver swaption payoff at  $T_{i^*}$  is

$$
\mathrm {P a y o f f o f R e c e i v e r S w a p t i o n} = \sum_ {j = i ^ {*} + 1} ^ {n} Z (T _ {i ^ {*}}, T _ {j}) \Delta N \max (r _ {K} - c (T _ {i ^ {*}}, T), 0)
$$

- The payoff to the swap is equivalent to the cash flow

$$
\Delta N \max (r _ {K} - c (T _ {i ^ {*}}, T), 0)
$$

determined at  $T_{i}^{*}$ , paid out at times  $T_{i^{*} + 1}, T_{i^{*} + 2}, \ldots, T_{n}$ , and thus discounted to  $T_{i^{*}}$  through the terms  $\sum_{j = i^{*} + 1}^{n} Z\left(T_{i^{*}}, T_{j}\right)$ .

- The payoff at each time  $T_{i^{*} + j}$  is always the same determined at  $T_{i^{*}}$ .
- Similar, the payer swaption payoff at  $T_{i^{*}}$  is

$$
\mathrm {P a y o f f o f P a y e r S w a p t i o n} = \sum_ {j = i ^ {*} + 1} ^ {n} Z (T _ {i ^ {*}}, T _ {j}) \Delta N \max (c (T _ {i ^ {*}}, T) - r _ {K}, 0)
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/fe60f1fc4667e2d31a4a010a93b20f6f1b5cbe88b0b2f43c70507be4aad111e0.jpg)  
Payoff of Receiver Swaption

# Swaption Pricing

- The price of the receiver swaption is obtained by pricing each of those payments  $\Delta N \max \left(r_{K} - c\left(T_{i^{*}}, T\right), 0\right)$  at times  $T_{i^{*}+1}, T_{i^{*}+2}, \ldots, T_{i^{*}+n}$ , individually.  
- Like for caps and floors, the Black's formula assumes that under the proper risk-adjusted probabilities, the swap rate  $c(T_{i^*}, T)$  is log-normally distributed

$$
\log c (T _ {i ^ {*}}, T) \sim \mathcal {N} (\mu , \sigma_ {T _ {i ^ {*}}} ^ {2} T _ {i ^ {*}})
$$

- where  $\sigma_{T_{i^*}}$  is the swap rate volatility, which is what is quoted by market participants.  
- Thus, the (risk adjusted) expected value of a payer and receiver cash flows at  $T_{i^{*} + j}$  are, respectively,

$$
{E ^ {*} \left[ P V \left[ \max (c (T _ {i ^ {*}}, T) - r _ {K}, 0) \right] \right]} = {Z (0, T _ {i ^ {*} + j}) \left[ f _ {n} ^ {s} (0, T _ {i ^ {*}}, T) \mathcal {N} (d _ {1}) - r _ {K} \mathcal {N} (d _ {2}) \right]}
$$

$$
{E ^ {*} \left[ P V \left[ \max (r _ {K} - c (T _ {i ^ {*}}, T), 0) \right] \right]} = {Z (0, T _ {i ^ {*} + j}) \left[ - f _ {n} ^ {s} (0, T _ {i ^ {*}}, T) \mathcal {N} (- d _ {1}) + r _ {K} \mathcal {N} (- d _ {2}) \right]}
$$

- where  $f_{n}^{s}(0, T_{i^{*}}, T)$  is the forward swap rate. and

$$
d _ {1} = \frac {\ln \left(f _ {n} ^ {s} (0 , T _ {i ^ {*}} , T) / r _ {K}\right) + \sigma_ {T _ {i ^ {*}}} ^ {2} T _ {i ^ {*}} / 2}{\sigma_ {T _ {i ^ {*}}} \sqrt {T _ {i ^ {*}}}}; d _ {2} = d _ {1} - \sigma_ {T _ {i ^ {*}}} \sqrt {T _ {i ^ {*}}}
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/1aa7d6188daab94739eb568c8d79ec1109f4fed721c4c6a59633dafb9678b3d3.jpg)  
Quoted Swaption Implied Volatility Surface

# Swaption Pricing

Hence, the value of a payer swaption

$$
\begin{array}{l} \mathrm {P a y e r S w a p t i o n} = \sum_ {j = i ^ {*} + 1} ^ {n} \Delta \times N \times Z (0, T _ {j}) [ f _ {n} ^ {s} (0, T _ {i ^ {*}}, T) \mathcal {N} (d _ {1}) - r _ {K} \mathcal {N} (d _ {2}) ] \\ = A N [ f _ {n} ^ {s} (0, T _ {i ^ {*}}, T) \mathcal {N} (d _ {1}) - r _ {K} \mathcal {N} (d _ {2}) ] \\ \end{array}
$$

where

$$
A = \sum_ {j = i ^ {*} + 1} ^ {n} \Delta \times Z (0, T _ {j})
$$

- Similarly, the value of a receiver swaption is

$$
\mathrm {R e c e i v e r S w a p t i o n} = A N \left[ - f _ {n} ^ {s} (0, T _ {i ^ {*}}, T) \mathcal {N} (- d _ {1}) + r _ {K} \mathcal {N} (- d _ {2}) \right]
$$

# How do we compute the Forward Swap Rate?

- This is implicit in the forward discount curve

$$
F \left(0, T _ {i ^ {*}}, T\right) = \frac {Z \left(0 , T\right)}{Z \left(0 , T _ {i ^ {*}}\right)}
$$

- Using that just as a discount function and following the same steps as for regular swap rate, we can compute the Forward Swap Rate  $f_{n}^{s}(0,T_{i^{*}},T)$ , for a swap starting at time  $T_{i^{*}}$  and lasting until time  $T_{n}$ , as

$$
f _ {n} ^ {s} (0, T _ {i ^ {*}}, T) = \frac {1}{\Delta} \frac {1 - F (0 , T _ {i ^ {*}} , T _ {n})}{\Sigma_ {j = i ^ {*} + 1} ^ {n} F (0 , T _ {i ^ {*}} , T _ {i})}
$$

# Example:

- Today is November 1, 2004. Consider a 1-year swaption to enter into a 5-year swap at strike rate  $r_{K} = 3.751\%$ .  
- Table 1 shows that such a swaption is trading at implied volatility  $\sigma_f^s = 27.404\%$ .  
- Table 4 provides the LIBOR discount curve up to  $T = 6$ .  
- to derive the Forward Discount curve we also need  $Z(0,1) \times 100 = 97.48$ .  
We then obtain

$$
A = \Delta \times \sum_ {i = 1} ^ {n} Z (0, T _ {i}) = 4. 4 0 4 6
$$

- The forward swap rate can be computed from the forward discounts using the previous formula  $f_{4}^{s}(0, T_{O}, T_{S}) = 4.261\%$

$$
d _ {1} = \frac {l n (4 . 2 6 1 \% / 3 . 7 5 1 \%) + 0 . 2 7 4 0 4 ^ {2} \times 1 / 2}{0 . 2 7 4 0 4 \times \sqrt {1}} = 0. 6 0 2 3, d _ {2} = 0. 6 0 2 3 - 0. 2 7 4 0 4 \times \sqrt {1} = 0. 3 2 8 2
$$

- The Black's formula then gives for a receiver swaption with  $N = 100$ :

$$
\begin{array}{l} \mathrm {S w a p t i o n} = \sum_ {j = i ^ {*} + 1} ^ {n} \Delta \times N \times Z (0, T _ {j}) [ - f _ {n} ^ {s} (0, T _ {i ^ {*}}, T) \mathcal {N} (- d _ {1}) + r _ {K} \mathcal {N} (- d _ {2}) ] \\ = \$ 1. 0 0 2 6 \\ \end{array}
$$

Table 4: LIBOR Discount and Forward Discount  

<table><tr><td>Maturity</td><td>Discount (×100)</td><td>Forward Discount (×100)</td></tr><tr><td>1.2500</td><td>96.7402</td><td>99.2367</td></tr><tr><td>1.5000</td><td>95.9608</td><td>98.4372</td></tr><tr><td>1.7500</td><td>95.1491</td><td>97.6045</td></tr><tr><td>2.0000</td><td>94.3075</td><td>96.7412</td></tr><tr><td>2.2500</td><td>93.4385</td><td>95.8498</td></tr><tr><td>2.5000</td><td>92.5449</td><td>94.9331</td></tr><tr><td>2.7500</td><td>91.6294</td><td>93.9940</td></tr><tr><td>3.0000</td><td>90.6949</td><td>93.0354</td></tr><tr><td>3.2500</td><td>89.7441</td><td>92.0600</td></tr><tr><td>3.5000</td><td>88.7793</td><td>91.0703</td></tr><tr><td>3.7500</td><td>87.8027</td><td>90.0686</td></tr><tr><td>4.0000</td><td>86.8162</td><td>89.0566</td></tr><tr><td>4.2500</td><td>85.8211</td><td>88.0358</td></tr><tr><td>4.5000</td><td>84.8186</td><td>87.0075</td></tr><tr><td>4.7500</td><td>83.8100</td><td>85.9728</td></tr><tr><td>5.0000</td><td>82.7963</td><td>84.9329</td></tr><tr><td>5.2500</td><td>81.7786</td><td>83.8890</td></tr><tr><td>5.5000</td><td>80.7584</td><td>82.8424</td></tr><tr><td>5.7500</td><td>79.7370</td><td>81.7947</td></tr><tr><td>6.0000</td><td>78.7161</td><td>80.7474</td></tr></table>

Original Swap Data Source: Bloomberg.

# Fixed Income Pircing

# Black and Scholes Formula

John Heaton

The University of Chicago

Booth School of Business

1. Black and Scholes Formula

1.1 Dynamic Replication  
1.2 Black and Scholes and the Binomial Trees

# Option Premium

- Black, Scholes and Merton show that (under certain conditions) there exists a trading strategy involving only stocks and bonds that replicate the payoff at  $T$  of a call or a put option.  
- Assume a stock  $S_{t}$  has constant expected (log) return  $\mu$  and constant volatility  $\sigma$ .  
- That is, if the log return during a small time interval  $h$  be  $R_{t} = \log (S_{t + h} / S_{t})$ , assume

$$
E [ R _ {t} ] = \mu \times h; E [ R _ {t} ^ {2} ] = \sigma^ {2} \times h
$$

- $(\mu$  and  $\sigma$  are the annualized expected log return and volatility)
- Consider now a put option with strike price  $K$  and maturity  $T$ .  
- The following trading strategy replicates the final payoff  $\max (K - S_T,0)$ .

# Option Premium by Dynamic Replication

1. At time 0:

(a) Short  $\Delta_0 = -N(-d_{1,0})$  of stocks

- Here  $N(x)$  is the standard normal cumulative density function, and  $d_{1,t}$  is

$$
d _ {1, t} = \frac {\ln {(S _ {t} / K)} + (r + \sigma^ {2} / 2) (T - t)}{\sigma \sqrt {T - t}}
$$

- $r$  is the continuously compounded risk free rate;  $\sigma$  is the volatility of stock returns.

(b) Buy an amount  $B_{0} = K \times e^{-r \times T} \times N(-d_{2,0})$  of Treasury Zero Coupon bonds.

Here  $d_{2,0} = d_{1,t} - \sigma \times \sqrt{T}$  

- The portfolio so constructed has value at time 0

$$
P _ {0} = B _ {0} + \Delta_ {0} S _ {0}
$$

- (it can be shown  $P_{0} > 0$ ).

2. From now on, rebalance the portfolio, to make sure that at every  $t$ , the portfolio has a position in stocks given by  $\Delta_t = -N(-d_{1,t})$

- E.g. if  $S_{t} \downarrow \Rightarrow \Delta_{t} \downarrow \Rightarrow$  short more stocks and put proceeds into bonds  $\Rightarrow B_{t} \uparrow$ .  
- Or if  $S_{t} \uparrow \Rightarrow \Delta_{t} \uparrow \Rightarrow$  buy back stocks by liquidating some bonds  $\Rightarrow B_{t} \downarrow$ .

# Option Premium by Dynamic Replication

- For instance, let  $S = K = 100$ ,  $T = 1$ ,  $r = 5\%$ ,  $\sigma = 20\%$ . Then,

$$
d _ {1} = . 3 5; d _ {2} = . 1 5; N (- d _ {1}) = 0. 3 6 3 2; N (- d _ {2}) = 0. 4 4 0 4 \Longrightarrow \Delta_ {0} = - N (- d _ {1}) = - 0. 3 6 3 2
$$

- Initial short position in stocks:  $\Delta \times 100 = -N(d_{1}) \times 100 = -0.3632 \times 100 = -\$36.32$ .  
- Initial bond position: \(B_{0} = Ke^{-rT}N(-d_{2}) = \\)41.89.\(  
- Initial value of the portfolio: \(P_{0} = B_{0} + \Delta_{0}S_{0} = \\)41.89 - \\(36.32 = \$5.57\(
- One day later ( $h = 1/252 = 1$  day) the stock is  $S_{h} = 99 \Rightarrow \Delta_{h} = -N(-d_{1,h}) = -.3821$
- Need to short more, and thus sell  $|\Delta_h - \Delta_0| = |-.3821 - (-0.3632)| = 0.0189$  shares.  
- Obtain cash = 0.0189 × 99 = \$1.879, and put it in bonds:

New Bond Position  $= B_{h} = B_{0}\times e^{r\times h} + \\$ 1.879 = \$41.89 - \$ 1.879 = \$43.777

New Portfolio Position = \(P_{h} = B_{h} + \Delta_{h}\times S_{h} = \\)43.777 - .3821\times 99 = \\(5.941\$

# Option Premium by Dynamic Replication

- Fact: The portfolio  $P_{t} = \Delta_{t}S_{t} + B_{t}$  obtained from the above trading strategy replicates the put option payoff.
- That is, at maturity

$$
P _ {T} = \Delta_ {T} S _ {T} + B _ {T} = \max (K - S _ {T}, 0)
$$

- Proof by simulation: Next two figures show that the strategy works, even when portfolio rebalancing is at daily interval  $(h = 1 / 252)$ .
- I simulate stock price paths. And then performed the above trading strategy.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/785cb5fb2ea7262304e6f309c0ddd0a7c91ea6cc3c636e1bcfc2fd05c0685310.jpg)  
Option Premium by Dynamic Replication

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c22c8f99694ac40bf4c27b2847b0133d465819f35fb24e3042b4ea91ced08139.jpg)  
Position in Stocks  $\Delta_{t}$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/3dc1d21c89bd402d9456c519a15f184dc71047cb4ccb31a69ed9b102059ebd1e.jpg)  
Replicating Portfolio and Black and Scholes Price

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/b069d9dd48dfdc5be8257692c68e2c9e41b4c8919358ca91bbeb0b2bb1940946.jpg)  
Option Premium by Dynamic Replication

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/7d476f519ab4af4425ea782f8b4ab5188af1bf17ccb9394aa1983e31658c899e.jpg)  
Position in Stocks  $\Delta_{t}$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/6e6559c8f2d791866ac4015de65ebf66a2d75b8f7d9c15dcad2668534534c065.jpg)  
Replicating Portfolio and Black and Scholes Price

# Black and Scholes Formula

- Since portfolio  $P_{t}$  replicates the payoff of the put option, the value of the portfolio at any time must equal the value of the put option.
- Why?  
- Arbitrage: "Buy Cheap / Sell Dear".  
- For instance, if  $P_{t} <$  Put Option Premium  $\Longrightarrow$

1. Sell option and set up the replicating portfolio (which costs  $P_{t}$ )  
2. Today make (Put Option Premium  $-P_{t}) > 0$  
3. At maturity  $T$  the replicating portfolio provides the payoff, exactly.

- In particular, at time 0, the value of the option must be

$$
\begin{array}{l} \mathrm {P u t P r e m i u m a t 0 ,} p _ {0} = P _ {0} = B _ {0} + \Delta_ {0} \times S _ {0} \\ = K \times e ^ {- r T} \times N (- d _ {2, 0}) - S _ {0} \times N (- d _ {1, 0}) \\ \end{array}
$$

- This is the celebrated "Black and Scholes" formula for option pricing.
- Similarly, a call option formula is given by

$$
\mathrm {C a l l P r e m i u m a t 0 ,} c _ {0} = S _ {0} \times N (d _ {1, 0}) - K \times e ^ {- r T} \times N (d _ {2, 0})
$$

# Delta Hedging and Dynamic Replication

- Why does the dynamic replication strategy work?
- Suppose you sold a put option and decide to hedge using the replicating portfolio  $P$ .  
- Let  $\Pi$  be the portfolio short the put  $(-p)$  and long the replicating portfolio

$$
\begin{array}{l} \Pi = - p + P \\ {\bf \Pi} = {\bf \Pi} - p + \Delta S + B \\ \end{array}
$$

- What is the sensitivity of  $\Pi$  to small variations in stocks?

$$
\frac {d \Pi}{d S} = - \frac {d p}{d S} + \Delta \times 1 + 0
$$

- The portfolio  $\Pi$  is delta hedged ( $d\ \Pi / d\ S = 0$ ) if

$$
\Delta = \frac {d p}{d S}
$$

- It can be shown that indeed  $\Delta = -N(-d_{1})$  is exactly  $d p / d S$
- This implies that for every small variation in stock  $S$ , the portfolio and the option move exactly by the same amount.
- $\Longrightarrow$  the dynamic replication works.

# Delta Hedging and Dynamic Replication

- The next figure shows the dynamic replication at work in a graph:

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/3f03764af279d91f1c3fe97d1697062a6a020d510238ba10918da8e59ac9d398.jpg)

# Black and Scholes Formula

- Example: Consider an at-the-money option.
- The stock price is  $S = 100$ , the strike price is  $K = 100$ , the (continuously compounded) interest rate is  $r = 5\%$ , maturity is  $T = 1$ , and the return volatility  $\sigma = 30\%$ .
- We then have

$$
d _ {1} = \frac {\log \left(\frac {S}{K}\right) + (r - \delta + \sigma^ {2} / 2) T}{\sigma \sqrt {T}} = \frac {\log \left(\frac {1 0 0}{1 0 0}\right) + (. 0 5 + (0 . 3 0) ^ {2} / 2) \times 1}{0 . 3 0 \sqrt {1}} = 0. 3 1 6 7;
$$

$$
d _ {2} = d _ {1} - \sigma \sqrt {T} = 0. 3 1 6 7 -. 3 \sqrt {1} = 0. 0 1 6 7
$$

- Therefore  $N(d_{1}) = 0.62425$  and  $N(d_{2}) = 0.50665$ .  
- The value of the call option is

$$
c _ {0} = S N (d _ {1}) - K e ^ {- r T} N (d _ {2}) = 1 0 0 \times 0. 6 2 4 2 5 - 1 0 0 \times e ^ {. 0 5 \times 1} \times 0. 5 0 6 6 5 = 1 4. 2 3 1 2
$$

- The value of a put option can be computed from these data by recalling that

$$
N (- d _ {1}) = 1 - N (d _ {1}) = 0. 3 7 5 7 5; \quad N (- d _ {2}) = 1 - N (d _ {2}) = 0. 4 9 3 3 5
$$

so that

$$
p _ {0} = - S N (- d _ {1}) + K e ^ {- r T} N (- d _ {2}) = - 1 0 0 \times 0. 3 7 5 7 5 + 1 0 0 \times e ^ {. 0 5 \times 1} \times 0. 4 9 3 3 5 = 9. 3 5 4 2
$$

# The Binomial Tree and Black and Scholes Formula

- To interpret the Black and Scholes formula it is convenient to go back to binomial trees.  
- Black and Scholes model assumes continuous trading
  - That is, traders can trade at any instant  $t$  
- Moreover, stock prices can take on any value, and not only the values on a tree.  
- Both conditions are approximately met as we let the time interval binomial tree go to zero.  
- To see the similarity of Black and Scholes formula with the one stemming from a binomial tree, consider the following example.

# The Binomial Tree and Black and Scholes Formula

$$
i = 0
$$

$$
i = 1
$$

$$
\begin{array}{l} {S _ {0}} \\ {c _ {0} = e ^ {- r \times T} E ^ {*} [ \max (S _ {1} - K, 0) ]} \end{array}
$$

$$
\begin{array}{l} {S _ {1, u} = S _ {0} \times u} \\ {c _ {1, u} = \max (S _ {1} - K, 0) = S _ {1} - K} \end{array}
$$

$$
\begin{array}{l} {S _ {1, d} = S _ {0} \times d} \\ {c _ {1, d} = \max (S _ {1} - K, 0) = 0} \end{array}
$$

- Consider  $i = 0$  and  $i = 1$  with  $S_{1,u} = S_0 \times u$  and  $S_{1,d} = S_0 \times d$ .  
- Assume the price of the option has  $S_{1,u} > K > S_{1,d}$ , so that the payoffs from the tree above result.  
- Let  $q^{*}$  be the risk neutral probability of going up in the tree.

# The Binomial Tree and Black and Scholes Formula

- The price of the option at time 0 according to risk neutral pricing is the

$$
\begin{array}{l} c _ {0} = e ^ {- r \times T} E ^ {*} [ \max (S _ {1} - K, 0) ] \\ = e ^ {- r \times T} \times [ q ^ {*} \times \max (S _ {1, u} - K, 0) + (1 - q ^ {*}) \times \max (S _ {1, d} - K, 0) ] \\ = e ^ {- r \times T} \times q ^ {*} \times (S _ {1, u} - K) \\ = S _ {0} \times e ^ {- r \times T} \times q ^ {*} \times u - e ^ {- r \times T} \times K \times q ^ {*} \\ = S _ {0} \times N _ {1} - e ^ {- r \times T} \times K \times N _ {2} \\ \end{array}
$$

- where, defining by  $u_{cc}$  the annualized c.c. return from an up movement  $S_{1,u} / S_0 = e^{u_{cc}\times T} = u$

$$
N _ {1} = e ^ {- r \times T} \times q ^ {*} \times u = e ^ {(u _ {c c} - r) \times T} \times q ^ {*} \quad \mathrm {a n d} \quad N _ {2} = q ^ {*}
$$

- The similarity with Black and Scholes formula is not coincidental

$$
\mathrm {C a l l} = S \times N (d _ {1}) - K \times e ^ {- r T} \times N (d _ {2})
$$

- Interpretation:

$$
\begin{array}{l} - N _ {2} = N (d _ {2}) \mathrm {r i s k n e u t r a l p r o b a b i l i t y t o b e i n t h e m o n e y a t m a t u r i t y}; \\ - N _ {1} = N (d _ {1}) \mathrm {r i s k n e u t r a l e x p e c t e d e x c e s s r e t u r n c o n d i t i o n a l o n e x e r c i s e a t} T. \\ \end{array}
$$

# The Binomial Tree and Black and Scholes Formula

- For a large number of binomial steps,  $n$  for a fixed maturity:

$$
\begin{array}{l} c _ {0} = e ^ {- r T} E ^ {*} [ \max (S _ {T} - K, 0) ] \\ = e ^ {- r \times T} \sum_ {j = 0} ^ {n} \left(\frac {n !}{j ! (n - j) !}\right) \max (S _ {T, j} - K, 0) \\ \end{array}
$$

where  $S_{T,j} = S_0\times u^{(n - j)}\times d^j$  

- Let  $a$  be the smallest integer for which  $S_{T,j} > K$  for  $j \geq a$ , and  $S_{T,j} < K$  for  $j < a$ .  
- Putting all together:

$$
\begin{array}{l} c _ {0} = e ^ {- r \times T} \sum_ {j = a} ^ {n} \left(\frac {n !}{j ! (n - j) !}\right) (S _ {T, j} - K) \\ = S _ {0} \times N _ {1} - K \times e ^ {- r \times T} \times N _ {2} \\ \end{array}
$$

$$
\mathrm {w i t h} N _ {1} = \left(e ^ {- r \times T} \sum_ {j = a} ^ {n} \left(\frac {n !}{j ! (n - j) !}\right) \times u ^ {(n - j)} \times d ^ {j}\right) \quad \mathrm {a n d} N _ {2} = \sum_ {j = a} ^ {n} \left(\frac {n !}{j ! (n - j) !}\right)
$$

- It can be shown that  $N_{1} \to N(d_{1})$  and  $N_{2} \to N(d_{2})$  as  $n \to \infty$  
- The interpretation, though, is the same as in the simple 2-period model.

# Teaching Notes 5

Risk Neutral Pricing: Binomial Trees and Monte Carlo Simulations<sup>1</sup>

John Heaton

The University of Chicago

Booth School of Business

NBER

# Binomial Trees

- Let's start from an example.  
- Let's assume the six-month, continuously compounded risk-free rate is estimated to move according to the following tree (step  $= 1/2$  year), where there is probability  $p = 1/2$  to move up or down.

$$
\begin{array}{l} i = 0 \\ t = 0 \\ i = 1 \\ t = 0. 5 \\ i = 2 \\ t = 1 \\ \end{array}
$$

$$
r _ {2, u u} = 0. 0 5 5 7
$$

$$
\begin{array}{l} r _ {0} = 0. 0 1 6 8 \\ r _ {1, u} = 0. 0 3 8 7 \\ \begin{array}{c} r _ {2, u d} \\ r _ {2, d u} \end{array} = 0. 0 2 7 9 \\ r _ {1, d} = 0. 0 0 7 4 \\ r _ {2, d d} = 0. 0 0 0 1 \\ \end{array}
$$

# Binomial Trees

- The expected rate in six and twelve months are

$$
E \left[ r _ {1} \right] = \frac {1}{2} r _ {1, u} + \frac {1}{2} r _ {1, d} = 0. 0 2 3 0 5
$$

$$
E \left[ r _ {2} \right] = \frac {1}{4} r _ {2, u u} + \frac {1}{2} r _ {2, u d} + \frac {1}{4} r _ {2, d d} = . 0 2 7 9
$$

- Note:  $r_t$  here is the continuously compounded, one period interest rate.
- For trees, it is convenient to denote bonds in terms of steps and nodes.  
Let

$$
Z _ {i, j} (k)
$$

- be the value of a zero coupon bond at index time  $i$  (e.g.  $i = 1$ ), at node  $j$  (e.g.  $j = u, d \ldots$ ) and with maturity at index  $k$  (e.g.  $k = 2$ ).  
- For instance

$$
Z _ {0} (1) = \text {Z e r o a t t i m e 0 t h a t m a t u r e s a t t i m e 1}
$$

$$
Z _ {1, u} (2) = \text {Z e r o a t t i m e 1 i n n o d e u p t h a t m a t u r e s a t t i m e 2}
$$

# Relative Pricing on Trees

Example: Bond and Option  

- Suppose that by using any of the methodologies in TN 1 we obtained the following discounts:

$$
Z _ {0} (1) = 0. 9 9 1 6, Z _ {0} (2) = 0. 9 7 8 1, Z _ {0} (3) = 0. 9 6 1 5
$$

- Let  $C_0$  be a call option on a six-month zero-coupon bond with maturity  $i = 1$  and strike price  $K$ .
- A call option on a zero coupon bond gives its owner the right, but not the obligation, to buy a six-month zero coupon at  $i$  for price  $K$ .
- The payoff to the buyer of the option is

$$
C _ {1} = \max \left(Z _ {1} (2) - K, 0\right)
$$

- At time  $i = 1$ , we know  $Z_{1}(2)$  under the two scenarios that the yield went up or down.  
- Thus we can compute  $C_1$ . Assuming  $K = 0.99$ , consider the tree

$$
i = 0
$$

$$
i = 1
$$

$$
Z _ {1, u} (2) = e ^ {- r _ {1 u} \times 0. 5} = 0. 9 8 0 8
$$

$$
C _ {1, u} = \max  (0. 9 8 0 8 - K, 0) = 0
$$

$$
Z _ {0} (2) = 0. 9 7 8 1
$$

$$
C _ {0} =??
$$

$$
Z _ {1, d} (2) = e ^ {- r _ {1, d} \times 0. 5} = 0. 9 9 6 3
$$

$$
C _ {1, d} = \max  (0. 9 9 6 3 - K, 0) = . 0 0 6 3 0 7
$$

- We now consider a hedging strategy that allows us to evaluate options on the tree.

# The Option Hedging Strategy

- Consider a portfolio at time  $i = 0$  that is long the option and short  $\Delta$  units of the 2-period zero coupon bonds - Its value at time  $j = 0$  is

$$
\Pi_ {0} = C _ {0} - \Delta \times Z _ {0} (2)
$$

- What is its value at time  $j = 1$ ?

In up node :  $\Pi_{1,u} = C_{1,u} - \Delta Z_{1,u}$  (2)

In down node :  $\Pi_{1,d} = C_{1,d} - \Delta Z_{1,d}(2)$

- Besides  $\Delta$ , all quantities on the right-hand side are known.

Key step

Choose  $\Delta$  to make  $\Pi_{1,u} = \Pi_{1,d}$

# The Option Hedging Strategy

- Imposing equality

$$
C _ {1, u} - \Delta Z _ {1, u} (2) = C _ {1, d} - \Delta Z _ {1, d} (2)
$$

- yields

$$
\Delta = \frac {C _ {1 , u} - C _ {1 , d}}{Z _ {1 , u} (2) - Z _ {1 , d} (2)}
$$

- $\Delta$  is now known. For instance, if  $K = .99$  we have  $\Delta = .4076$  
-In this case,we find  $\Pi_{1,u} = C_{1,u} - \Delta Z_{1,u}\left(2\right) = -0.3998$  (also equal to  $= \Pi_{1,d}$  ）

- What is the value of the portfolio at time  $i = 0$ ?
- The portfolio is riskless between time  $i = 0$  and  $i = 1$ .  
- Therefore, its value must be the discounted value of  $\Pi_{1,u}$  using the risk free rate to discount.

No Arbitrage  $\Longrightarrow \Pi_0 = Z_0(1) \Pi_{1,u}$

- (Recall  $\Pi_{1,u} = \Pi_{1,d}$  so it does not matter what you put on the RHS)

# The Option Value

- Therefore

$$
C _ {0} - \Delta Z _ {0} (2) = Z _ {0} (1) \Pi_ {1, u}
$$

- implying

$$
C _ {0} = \Delta Z _ {0} (2) + Z _ {0} (1) \Pi_ {1, u} = 0. 0 0 2 2 3
$$

- (recall  $Z_{0}(1) = 0.9916, Z_{0}(2) = 0.9781$ )

# The Replicating Portfolio

- Note that the option is a portfolio of zeros:

$$
\begin{array}{l} - N _ {1} = \Delta =. 4 0 7 6 \text {o f o n e - y e a r z e r o} Z _ {0} (2); \text {a n d} \\ - N _ {2} = \Pi_ {1, u} = - 0. 3 9 9 8 o f s i x - m o n t h z e r o Z _ {0} (1). \\ \end{array}
$$

- That is, the portfolio of bonds

$$
P _ {0} = N _ {1} \times Z _ {0} (2) + N _ {2} \times Z _ {0} (1)
$$

- exactly replicates the payoff of the option.

# The Replicating Portfolio

$$
i = 0
$$

$$
i = 1
$$

$$
Z _ {0} (1) = 0. 9 9 1 6
$$

$$
Z _ {0} (2) = 0. 9 7 8 1
$$

$$
P _ {0} = N _ {1} Z _ {0} (2) + N _ {2} Z _ {0} (1) = 0. 0 0 2 2 3
$$

$$
Z _ {1, u} (1) = 1
$$

$$
Z _ {1, u} (2) = 0. 9 8 0 8
$$

$$
P _ {1, u} = N _ {1} Z _ {1, u} (2) + N _ {2} = 0
$$

$$
Z _ {1, d} \left(1\right) = 1
$$

$$
Z _ {1, d} (2) = 0. 9 9 6 3
$$

$$
P _ {1, d} = N _ {1} Z _ {1, d} (2) + N _ {2} =. 0 0 6 3 0 7
$$

- $P$  is called "replicating portfolio," a key concept.

# A No Arbitrage Relation

- What was special about the fact that  $C_0$  was an option on zero-coupon bond?
- Nothing in particular!  
- We could do the same derivation with any other security.
- Let's do the same steps, but now using ANY other security, that depends on interest rates.  
- Generically, let  $Z_0(j)$  be any zero coupon bond, and let's consider the following generic tree

$$
\begin{array}{l} i = 0 \\ i = 1 \\ \end{array}
$$

$$
\begin{array}{l} Z _ {1, u} (j) \\ V _ {1, u} \\ \end{array}
$$

$$
\begin{array}{l} Z _ {0} \left(j\right) \\ V _ {0} \\ \end{array}
$$

$$
\begin{array}{l} Z _ {1, d} (j) \\ V _ {1, d} \\ \end{array}
$$

# A No Arbitrage Relation

- Let's follow the same steps:  
- Step 1: Portfolio

$$
\Pi_ {0} = V _ {0} - \Delta Z _ {0} (j)
$$

- Step 2: Choose  $\Delta$  to make portfolio at time  $j = 1$  independent of interest rates

$$
\Pi_ {1, u} = \Pi_ {1, d}
$$

$$
\Longleftrightarrow
$$

$$
{V _ {1, u} - \Delta Z _ {1, u} (j)} = {V _ {1, d} - \Delta Z _ {1, d} (j)}
$$

$$
\Longleftrightarrow
$$

$$
\Delta = \frac {V _ {1 , u} - V _ {1 , d}}{Z _ {1 , u} (j) - Z _ {1 , d} (j)} \tag {1}
$$

- Step 3: The portfolio is riskless, no arbitrage requires

$$
\Pi_ {0} = Z _ {0} (1) \Pi_ {1, u} \text {o r , e q u i v a l e n t l y ,} \Pi_ {0} = Z _ {0} (1) \Pi_ {1, d}
$$

# A No Arbitrage Relation

- In fact, we can take the expected value using any probability  $\tilde{p}$

$$
\Pi_ {1, u} = \Pi_ {1, d} = E ^ {\tilde {p}} \left[ \Pi_ {1} \right]
$$

where

$$
\begin{array}{l} {E ^ {\tilde {p}} \left[ \Pi_ {1} \right]} = {\tilde {p} \Pi_ {1, u} + (1 - \tilde {p}) \Pi_ {1, d}} \\ = \tilde {p} [ V _ {1, u} - \Delta Z _ {1, u} (j) ] + (1 - \tilde {p}) [ V _ {1, d} - \Delta Z _ {1, d} (j) ] \\ = E ^ {\tilde {p}} [ V _ {1} ] - \Delta E ^ {\tilde {p}} [ Z _ {1} (j) ] \\ \end{array}
$$

- Substituting

$$
{\Pi_ {0}} = {Z _ {0} (1) E ^ {\tilde {p}} [ \Pi_ {1} ]}
$$

$$
\Longleftrightarrow
$$

$$
{V _ {0} - \Delta Z _ {0} (j)} = {Z _ {0} (1) \left\{E ^ {\tilde {p}} [ V _ {1} ] - \Delta E ^ {\tilde {p}} [ Z _ {1} (j) ] \right\}}
$$

# A No Arbitrage Relation

- Step 4: Rearrange

$$
V _ {0} = Z _ {0} (1) E ^ {\tilde {p}} (V _ {1}) - \Delta \times \left\{Z _ {0} (1) E ^ {\tilde {p}} [ Z _ {1} (j) ] - Z _ {0} (j) \right\} \tag {2}
$$

- Substitute  $\Delta$  from (1) and rearrange again

$$
\frac {Z _ {0} (1) E ^ {\tilde {p}} [ Z _ {1} (j) ] - Z _ {0} (j)}{Z _ {1 , u} (j) - Z _ {1 , d} (j)} = \frac {Z _ {0} (1) E ^ {\tilde {p}} (V _ {1}) - V _ {0}}{V _ {1 , u} - V _ {1 , d}}
$$

- This last expression is key to the whole fixed income asset pricing.  
- To interpret it, let's rewrite the equality as

$$
\frac {E ^ {\tilde {p}} \left[ \frac {V _ {1}}{V _ {0}} \right] - \frac {1}{Z _ {0} (1)}}{\left[ \frac {V _ {1 , u}}{V _ {0}} - \frac {V _ {1 , d}}{V _ {0}} \right]} = \frac {E ^ {\tilde {p}} \left[ \frac {Z _ {1} (j)}{Z _ {0} (j)} \right] - \frac {1}{Z _ {0} (1)}}{\left[ \frac {Z _ {1 , u} (j)}{Z _ {0} (j)} - \frac {Z _ {1 , d} (j)}{Z _ {0} (j)} \right]} \tag {3}
$$

# A No Arbitrage Relation

- Notice

$$
E ^ {\tilde {p}} \left[ \frac {V _ {1}}{V _ {0}} \right] = \text {E x p e c t e d R e t u r n (u n d e r} \tilde {p}) \text {f r o m p u r c h a s i n g V _ {0}}
$$

$$
E ^ {\tilde {p}} \left[ \frac {V _ {1}}{V _ {0}} \right] - \frac {1}{Z _ {0} (1)} = \mathrm {E x p e c t e d R e t u r n i n E x c e s s o f T r e a s u r y}
$$

$$
\left[ \frac {V _ {1 , u}}{V _ {0}} - \frac {V _ {1 , d}}{V _ {0}} \right] = \text {R i s k f r o m i n v e s t i n g i n} V _ {0}
$$

- The above hold for any  $\tilde{p}$ . To have economic meaning, we must though use the true  $\tilde{p} = p = 0.5$ .  
- Denoting  $E[.]$  (without superscript) the expectations under the true probability, we have

$$
\frac {E \left[ \frac {V _ {1}}{V _ {0}} \right] - \frac {1}{Z _ {0} (1)}}{\left[ \frac {V _ {1 , u}}{V _ {0}} - \frac {V _ {1 , d}}{V _ {0}} \right]} = \frac {\text {E x p e c t e d E x c e s s R e t u r n}}{\text {R i s k f r o m i n v e s t m e n t}} = \left\{ \begin{array}{c} \text {S h a r p e R a t i o} \\ \text {o r} \\ \text {M a r k e t P r i c e o f} \\ \text {I n t e r e s t R a t e R i s k} \end{array} \right.
$$

- Similarly for the right hand side of (3).

# No Arbitrage Implication 1

- Equality (3) applies to all securities that depend on the interest rate.

No Arbitrage  $\Rightarrow$  All assets that depend on the interest rate have the same market price of risk

- That is, for any security  $V$ , we have

$$
\frac {E \left[ \frac {V _ {1}}{V _ {0}} \right] - \frac {1}{Z _ {0} (1)}}{\left[ \frac {V _ {1 , u}}{V _ {0}} - \frac {V _ {1 , d}}{V _ {0}} \right]} = \lambda \tag {4}
$$

where  $\lambda$  does not depend on the security considered.  

- This includes options, long term bonds and so on.  
- Caveat: The quantity

$$
\left[ \frac {V _ {1 , u}}{V _ {0}} - \frac {V _ {1 , d}}{V _ {0}} \right]
$$

- can be positive or negative (for bonds, it is negative: if interest rate is "up", then  $V_{u}$  is "down". Thus  $V_{1,u} < V_{1,d}$ ).

# No Arbitrage Implication 2

- If we know  $\lambda$ , we can compute the price of any other security simply by inverting (4):

$$
V _ {0} = Z _ {0} (1) \left\{E \left[ V _ {1} \right] - \lambda \left[ V _ {1, u} - V _ {1, d} \right] \right\} \tag {5}
$$

Where do we get  $\lambda$ ?

- Since relation (4) holds for all securities, it holds for the 2-period bond:

$$
\lambda = \frac {E \left[ \frac {Z _ {1} (2)}{Z _ {0} (2)} \right] - \frac {1}{Z _ {0} (1)}}{\left[ \frac {Z _ {1 , u} (2)}{Z _ {0} (2)} - \frac {Z _ {1 , d} (2)}{Z _ {0} (2)} \right]}
$$

- From the original tree we can compute

$$
\lambda = \frac {1 . 0 1 0 7 0 5 8 8 2 - 1 . 0 0 8 4 3 5 3 7 9}{- 0 . 0 1 5 8 1 7 2 2 4} = - 0. 1 4 3 5
$$

Using (5), the price of the call option is

$$
C _ {0} = Z _ {0} (1) \left\{E \left[ C _ {1} \right] + 0. 1 4 3 5 \times \left[ C _ {1, u} - C _ {1, d} \right] \right\} = 0. 0 0 2 2 3
$$

- Once we know  $\lambda$ , we can compute the price of any derivative security on the interest rate, maturing (for now) one period ahead, by using (5).

# Option Pricing Example

- Example: How do we price a caplet? That is, a security that pays at  $i = 1$  the amount

$$
\mathsf {p a y} (i) = \mathsf {N} \times \max (r _ {i} - \bar {r}, 0)
$$

- where  $\mathsf{N}$  is some notional.
- If  $N = 1000$  and  $\overline{r} = .0168$  (at the money), we have

$$
\mathsf {p a y} _ {u} (1) = N \times \max  (0. 0 3 8 7 - 0. 0 1 6 8, 0) = 2 1. 9
$$

$$
\mathsf {p a y} _ {d} (1) = N \times \max (0. 0 0 7 4 - 0. 0 1 6 8, 0) = 0.
$$

- We then immediately obtain

$$
\begin{array}{l} \operatorname {C a p l e t} (0) = Z _ {0} (1) \left\{E [ \mathsf {p a y} (1) ] + 0. 1 4 3 5 [ \mathsf {p a y} _ {u} - \mathsf {p a y} _ {d} ] \right\} \\ = 1 3. 9 7 \\ \end{array}
$$

# No Arbitrage Pricing

- Can we obtain the price of a 2-period bond itself  $Z_{0}(2)$ ?
- No! That's one of our inputs. (We used it to compute  $\lambda$ )
- Can we obtain the price of any security that matures in period  $j = 2$  (rather than  $j = 1$ )?
- Yes, by moving backward (but need more work).  
- We will see how to do so using a different pricing methodology.

# Risk Neutral Pricing

- Recall that "Step 4" in our derivations above gave us the equation (2) is

$$
V _ {0} = Z _ {0} (1) E ^ {\tilde {p}} (V _ {1}) - \Delta \times \left\{Z _ {0} (1) E ^ {\tilde {p}} [ Z _ {1} (j) ] - Z _ {0} (j) \right\} \tag {6}
$$

- This equation held for any probability  $\tilde{p}$ . We can thus choose a  $\tilde{p}$  that makes life easier.  
- What is the probability  $\tilde{p}$  that makes the second term  $= 0$ ?  
- That is, we want to find the probability  $\pi^{*}$  such that

$$
Z _ {0} (1) E ^ {*} [ Z _ {1} (j) ] - Z _ {0} (j) = 0
$$

where  $E^{*}[]$  denotes the expectation that uses the probability  $\pi^{*}$ .

- Develop the expectation

$$
Z _ {0} (1) \left[ \pi^ {*} Z _ {1, u} (j) + (1 - \pi^ {*}) Z _ {1, d} (j) \right] - Z _ {0} (j) = 0 \tag {7}
$$

to get

$$
\pi^ {*} \left[ Z _ {1, u} (j) + Z _ {1, d} (j) \right] + Z _ {1, d} (j) = Z _ {0} (j) / Z _ {0} (1)
$$

# Risk Neutral Probabilities

- Solving the previous equation, we obtain

$$
\pi^ {*} = \frac {Z _ {0} (j) / Z _ {0} (1) - Z _ {1 , d} (j)}{Z _ {1 , u} (j) - Z _ {1 , d} (j)}
$$

- $\pi^{*}$  is the risk neutral probability or risk adjusted probability of moving up in the tree.  
- $E^{*}$ .] - the expectation computed using  $\pi^{*}$  - is called risk neutral expectation.  
- The term "risk neutral" refers to the fact that under  $\pi^{*}$ , all assets yield the risk free rate of return.  
- In fact, from its derivation in equation (7) we also have

$$
\underbrace {\pi^ {*} \frac {Z _ {1 , u} (j)}{Z _ {0} (j)} + (1 - \pi^ {*}) \frac {Z _ {1 , d} (j)}{Z _ {0} (j)}} = \underbrace {1} _ {Z _ {0} (1)}
$$

Expected Return on 2-period bond  $=$  Return on 1-period Bond

- Indeed, because under  $\tilde{p} = \pi^{*}$  the last term in (6) is zero, we have the

risk-neutral pricing formula

$$
V _ {0} = Z _ {0} \left(1\right) E ^ {*} \left[ V _ {1} \right]
$$

# Risk Neutral Pricing

- The risk neutral pricing formula implies

$$
\underbrace {E ^ {*} \left[ \frac {V _ {1}}{V _ {0}} \right]} = \underbrace {\frac {1}{Z _ {0} (1)}} \tag {8}
$$

$$
E ^ {*} [ \text {R e t u r n} V ] = \text {R e t u r n} 6 - \text {m o n t h T b i l l} \tag {9}
$$

- Risk neutral pricing is nothing more than a "trick" to easily compute the price of derivatives.  
- It implies a simple recipe to price securities:
- Recipe:

1. Assume agents are risk neutral.  
2. Find risk neutrality probabilities, that is, find  $\pi^{*}$  
3. Compute the price of derivatives using  $\pi^{*}$  and discounting at the risk free rate.

# Does Risk Neutral Pricing Work?

- In the example above, using the 2-period bond  $(j = 2)$  we obtain  $\pi^{*} = 0.643546229$  
- The call price is then

$$
\begin{array}{l} C _ {0} = Z _ {0} (1) \left(\pi^ {*} \times C _ {1, u} + (1 - \pi^ {*}) \times C _ {1, d}\right) \\ = 0. 9 9 1 6 \times (0. 6 4 3 5 \times 0 + 0. 3 5 6 4 5 \times . 0 0 6 3 0 7) \\ = 0. 0 0 2 2 3 \\ \end{array}
$$

- The price of the caplet is

$$
\begin{array}{l} \operatorname {C a p l e t} _ {0} = Z _ {0} (1) \times E ^ {*} [ \text {p a y} (1) ] \\ = 0. 9 9 1 6 \times (0. 6 4 3 5 \times 2 1. 9 + 0. 3 5 6 4 5 \times 0) \\ = 1 3. 9 7 \\ \end{array}
$$

It works beautifully.

# Risk Neutral vs. True Probabilities

# Question

- Under the risk neutral probabilities, the expected interest rate is

$$
E ^ {*} \left[ r _ {1} \right] = \pi^ {*} \times r _ {1, u} + \left(1 - \pi^ {*}\right) \times r _ {1, d} = 0. 0 2 7 5
$$

If your boss asks you what is your forecast of the interest rate in six months, would you tell him  $2.75\%$ ?

- In the real world, the expected interest rate was

$$
E \left[ r _ {1} \right] = 2.305 \% <   2.75 \% = E ^ {*} \left[ r _ {1} \right]
$$

- Passing from the real to the risk neutral world implies increasing the expected interest rate.  
- Interestingly, note that the forward rate is (recall the time step is 0.5)

$$
f(0,1,2) = -2\times \ln \left(\frac{Z_{0}(2)}{Z_{0}(1)}\right) = 2.7487\%
$$

- This is very close to the risk-neutral expected future rate

# Using Risk Neutral Trees

- From now on, we assume that the tree that we are using is "risk neutral"  
- Rather than finding probabilities that make an original "true" tree into a risk neutral one, we start immediately from the latter.  
- We will see later how to build a tree that is risk neutral directly from traded securities.  
- Suppose that the short-term, continuously compounded interest rate moves according to the following tree.  
- At every time (1 period = 6 months), there is equal risk neutral probability  $(\pi^{*} = 1 / 2)$  to move up or down.

$$
\begin{array}{l} i = 0 \\ i = 1 \\ i = 2 \\ \end{array}
$$

$$
r _ {2, u u} = 0. 0 6 3 8
$$

$$
r _ {0} = 0. 0 1 6 8
$$

$$
r _ {1, u} = 0. 0 4 3 3
$$

$$
\begin{array}{c} {r _ {2, u d}} \\ {r _ {2, d u}} \end{array} = 0. 0 3 6 1
$$

$$
r _ {1, d} = 0. 0 1 2 0
$$

$$
r _ {2, d d} = 0. 0 0 8 3
$$

- The value of a zero-coupon bond paying one dollar in period  $i = 1$  is (the time step  $\Delta t = 0.5$ )

$$
Z _ {0} \left(1\right) = e ^ {- r _ {0} \times \Delta t} \times 1 = 0. 9 9 1 6
$$

- What is the value of bond paying \$1 in one year (i = 2)?  
- It can be obtained by proceeding backward on the tree:

$$
\begin{array}{l} i = 0 \\ i = 1 \\ i = 2 \\ Z _ {2, u u} (2) = 1 \\ \end{array}
$$

$$
\begin{array}{l} r _ {0} = 0. 0 1 6 8 \\ Z _ {0} (2) = \\ = e ^ {- r _ {0} \Delta t} \times \\ \times \left(\frac {1}{2} Z _ {1, u} (2) + \frac {1}{2} Z _ {1, d} (2)\right) \\ = 0. 9 7 8 1 \\ \end{array}
$$

$$
\begin{array}{l} r _ {1, u} = 0. 0 4 3 3 \\ Z _ {1, u} (2) = \\ = e ^ {- r _ {1, u} \Delta t} \times 1 \\ = 0. 9 7 8 6 \\ \end{array}
$$

$$
\begin{array}{r l} {Z _ {2, u d} (2)} & \\ {Z _ {2, d u} (2)} & \end{array} = 1
$$

$$
\begin{array}{l} r _ {1, d} = 0. 0 1 2 0 \\ Z _ {1, d} (2) = \\ = e ^ {- r _ {1, d} \Delta t} \times 1 \\ = 0. 9 9 4 0 \\ \end{array}
$$

$$
Z _ {2, d d} (2) = 1
$$

- Similarly, a bond paying \$1 in 1.5 years (i = 3):

$$
\begin{array}{l} i = 0 \\ i = 1 \\ i = 2 \\ i = 3 \\ \end{array}
$$

$$
Z _ {3, u u u} (3) = 1
$$

$$
\begin{array}{l} r _ {1, u} = 0. 0 4 3 3 \\ Z _ {1, u} (3) = 0. 9 5 4 5 \end{array}
$$

$$
\begin{array}{l} r _ {2, u u} = 0. 0 6 3 8 \\ Z _ {2, u u} (3) = 0. 9 6 8 6 \end{array}
$$

$$
\begin{array}{l} Z _ {3, u u d} (3) \\ Z _ {3, u d u} (3) \end{array} = 1
$$

$$
\begin{array}{l} \begin{array}{l l} & r _ {0} = 0. 0 1 6 8 \\ & Z _ {0} (3) = 0. 9 6 0 7 \end{array} \\ \begin{array}{l} r _ {1, d} = 0. 0 1 2 0 \\ Z _ {1, d} (3) = 0. 9 8 3 0 \end{array} \\ \begin{array}{l} {r _ {2, u d} = 0. 0 3 6 1} \\ {Z _ {2, u d} (3) = 0. 9 8 2 1} \end{array} \\ \begin{array}{l} Z _ {3, u d d} (3) \\ Z _ {3, d d u} (3) \end{array} = 1 \\ \begin{array}{l} {r _ {2, d d} = 0. 0 0 8 3} \\ {Z _ {2, d d} (3) = 0. 9 9 5 9} \end{array} \\ Z _ {3, d d d} (3) = 1 \\ \end{array}
$$

- These prices imply the zero-coupon yields

$$
y _ {0} (1) = - \frac {\ln [ Z _ {0} (1) ]}{\Delta t} = 0. 0 1 6 8
$$

$$
y _ {0} (2) = - \frac {\ln [ Z _ {0} (2) ]}{2 \Delta t} = 0. 0 2 2 2
$$

$$
y _ {0} (3) = - \frac {\ln [ Z _ {0} (3) ]}{3 \Delta t} = 0. 0 2 6 7
$$

- The methodology is actually quite simple.  
- In addition, computers can be programmed rather easily to carry out the backward computation.  
Example:

<table><tr><td colspan="12">Table 2: An Interest Rate Tree</td></tr><tr><td>i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>t</td><td>0</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td>j</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>1</td><td>1.68</td><td>5.71</td><td>9.6</td><td>13.35</td><td>16.97</td><td>20.46</td><td>23.83</td><td>27.09</td><td>30.23</td><td>33.25</td><td></td></tr><tr><td>2</td><td></td><td>-0.84</td><td>3.17</td><td>6.97</td><td>10.62</td><td>14.13</td><td>17.5</td><td>20.76</td><td>23.9</td><td>26.93</td><td></td></tr><tr><td>3</td><td></td><td></td><td>-3.27</td><td>0.77</td><td>4.55</td><td>8.13</td><td>11.55</td><td>14.83</td><td>17.99</td><td>21.02</td><td></td></tr><tr><td>4</td><td></td><td></td><td></td><td>-5.61</td><td>-1.52</td><td>2.27</td><td>5.84</td><td>9.2</td><td>12.41</td><td>15.48</td><td></td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>-7.87</td><td>-3.72</td><td>0.12</td><td>3.69</td><td>7.04</td><td>10.2</td><td></td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>-10.06</td><td>-5.83</td><td>-1.94</td><td>1.66</td><td>5.01</td><td></td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>-12.16</td><td>-7.87</td><td>-3.92</td><td>-0.27</td><td></td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-14.19</td><td>-9.83</td><td>-5.82</td><td></td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-16.15</td><td>-11.72</td><td></td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-18.05</td><td></td></tr><tr><td>11</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td colspan="12">Backward Computation of Bond Prices</td></tr><tr><td>j,i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>1</td><td>81.15</td><td>70.9</td><td>64.39</td><td>60.65</td><td>59.12</td><td>59.58</td><td>62.03</td><td>66.68</td><td>73.97</td><td>84.68</td><td>100</td></tr><tr><td>2</td><td></td><td>92.78</td><td>81.51</td><td>74.47</td><td>70.54</td><td>69.13</td><td>69.97</td><td>73.09</td><td>78.72</td><td>87.4</td><td>100</td></tr><tr><td>3</td><td></td><td></td><td>103.27</td><td>91.14</td><td>83.68</td><td>79.65</td><td>78.4</td><td>79.66</td><td>83.44</td><td>90.02</td><td>100</td></tr><tr><td>4</td><td></td><td></td><td></td><td>112.06</td><td>99.3</td><td>91.56</td><td>87.52</td><td>86.48</td><td>88.15</td><td>92.55</td><td>100</td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>118.62</td><td>105.54</td><td>97.69</td><td>93.74</td><td>92.95</td><td>95.03</td><td>100</td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>122.54</td><td>109.5</td><td>101.77</td><td>98.02</td><td>97.53</td><td>100</td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>123.56</td><td>110.93</td><td>103.55</td><td>100.14</td><td>100</td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>121.61</td><td>109.76</td><td>102.95</td><td>100</td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>116.8</td><td>106.04</td><td>100</td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>109.44</td><td>100</td></tr><tr><td>11</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>100</td></tr></table>

# Describing Big Trees

# - How do we describe a long tree?

- Using the earlier notation  $u, uu$  etc is OK for small trees.  
- When we start looking at long trees (30-60 steps), then we use a slightly different notation.  
- Specifically, each point on the tree can be described by a time index  $i$  and a node index  $j$ .  
-In the example in Table 2,  $i = 0,\ldots ,10$  and  $j = 1,\ldots ,11$

# Intermediate Cash Flows

- Notice that given a tree, we can insert any type of known cash flow.  
- Specifically, at any time-node  $(i,j)$ , we just must add the CF

$$
P _ {i, j} = e ^ {- r _ {i, j} \Delta t} \left(\frac {1}{2} P _ {i + 1, j} + \frac {1}{2} P _ {i + 1, j + 1} + C F _ {i + 1}\right)
$$

- So, for example, a 1.5 year,  $4\%$  coupon bond is just given by

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/5937be9ca4cd70270ddf0551bf8484e3002a60399be1e2daaacfde6ea549d4a8.jpg)

- This tree gives "ex-coupon" prices.  
- Using ex-coupon prices is useful in a number of circumstances, as we shall see.

# Examples

- Trees turn out to be very useful tools (not only pedagogically).  
- One of the most important features of them is the ability to deal with "American options."  
- As a consequence, a very simple application of the "tree" methodology is the computation of prices of callable bonds.

# Callable Bonds

- Consider the 1.5 year,  $4\%$  coupon bond we discussed earlier, but assume it is callable at par 100.  
- That is, at any point in time before maturity, the issuer (Treasury) may "call it back" in exchange of 100.
- In general, bonds become callable after some period of time.  
- For example, the Nov 2012 Treasury bond is callable at par starting on Nov 2007.  
- If issuer calls the bond between coupon days, it has to pay the accrued interest to the bond holder.

# How do we Compute the Price of American Options?

- We move backwards on the tree:
- At any node  $(i,j)$  the issuer can decide whether to "exercise" option or wait.  
- If exercises, the payoff ( $=$  value of the option) is

$$
C a l l _ {i, j} ^ {\mathrm {E x}} = P _ {i, j} - 1 0 0
$$

- If waits, the value of the option

$$
C a l l _ {i, j} ^ {\text {W a i t}} = e ^ {- r _ {i, j} \Delta t} E ^ {*} [ C a l l _ {i + 1} ] = e ^ {- r _ {i, j} \Delta t} \left(\frac {1}{2} C a l l _ {i + 1, j} + \frac {1}{2} C a l l _ {i + 1, j + 1}\right)
$$

- Therefore, the value at node  $i, j$  is

$$
\begin{array}{l} C a l l _ {i, j} = \max  \left(C a l l _ {i, j} ^ {\text {W a i t}}, C a l l _ {i, j} ^ {\mathsf {E} \times}\right) \tag {10} \\ = \max \left(e ^ {- r _ {i, j} \times \Delta t} E ^ {*} [ C a l l _ {i + 1} ], P _ {i, j} - 1 0 0\right) \\ \end{array}
$$

- Since at maturity  $I = T / \Delta t$  we have

$$
C a l l _ {I, j} = 0 \text {f o r a l l} j
$$

- (the option expires worthless at maturity, as the issuer has to redeem the bond at par)  
- we can start the procedure (10) backward.

$$
\begin{array}{l} i = 0 \\ i = 1 \\ i = 2 \\ i = 3 \\ \end{array}
$$

$$
C _ {3, u u u} (3) = 0
$$

$$
\begin{array}{l} C _ {1, u} (3) = \\ = \max  \left(9 9. 3 1 - 1 0 0, e ^ {-. 0 4 3 3 / 2} 0. 1 8 / 2\right) \\ = 0. 0 9 \\ \end{array}
$$

$$
\begin{array}{l} C _ {2, u u} (3) = \\ = \max  (9 8. 8 0 - 1 0 0, 0) \\ = 0 \\ \end{array}
$$

$$
\begin{array}{l} C _ {3, u u d} (3) \quad - 0 \\ C _ {3, u d u} (3) \quad - 0 \\ \end{array}
$$

$$
\begin{array}{l} C _ {0} (3) = \\ = e ^ {- 0. 0 1 6 8 / 2} \\ \times \frac {1}{2} (0. 0 9 + 2. 2 6) \\ = 1. 1 6 \\ \end{array}
$$

$$
\begin{array}{l} C _ {1, d} (3) = \\ = \max  (1 0 2. 2 6 - 1 0 0, \\ e ^ {- 0. 0 1 2 0 / 2} (1. 1 8 + 1. 5 8) / 2) \\ = 2. 2 6 \\ \end{array}
$$

$$
\begin{array}{l} C _ {2, u d} (3) = \\ = \max  (1 0 0. 1 8 - 1 0 0, 0) \\ = 0. 1 8 \\ \end{array}
$$

$$
\begin{array}{l} C _ {3, u d d} (3) - 0 \\ C _ {3, d d u} (3) \quad - \\ \end{array}
$$

$$
\begin{array}{l} C _ {2, d d} (3) \\ = \max  (1 0 1. 5 8 - 1 0 0, 0) \\ = 1. 5 8 \\ \end{array}
$$

$$
C _ {3, d d d} (3) = 0
$$

# Callable Bond Pricing

- What is then the price of the callable bond?
- The buyer of a callable bond is: (1) buying a non-callable bond; + (2) Selling a call to the issuer.  
Hence,

$$
\begin{array}{l} P _ {0} ^ {\mathbf {C a l l}} (3) = P _ {0} ^ {\mathbf {N o C a l l}} (3) - C _ {0} (3) \\ = 1 0 1. 9 3 - 1. 1 6 \\ = 1 0 0. 7 7 \\ \end{array}
$$

# Caps and Floors

- A cap is a security that pays the stream of cash-flows

$$
C F (t) = \Delta t \times N \times \max  (r (t - 1) - \bar {r}, 0) \tag {11}
$$

- where  $\overline{r}$  is the strike rate,  $r(t)$  is some floating rate interest rate, such as the three month t-bill rate or LIBOR,  $N$  is the notional and  $\Delta t$  is the amount of time between payments.  
Each payment (11) is called "caplet".

- Caps offer insurance against the interest rate increasing to above some level.  
- They are often attached to floating rate bonds, so as to limit the amount of interest to pay.
- A floor is instead a security paying

$$
C F (t) = \Delta t \times N \times \max  (\bar {r} - r (t - 1), 0) \tag {12}
$$

# Cap Pricing Example

- Consider a 1.5 years cap, with continuously compounded strike rate  $\bar{r} = 3\%$ , semi-annual payments ( $\Delta t = 1/2$ ) and  $N = 100$ .  
- Assume that the risk-neutral tree is given by (18) and let

$$
\begin{array}{l} C F _ {i, j} (i + 1) = \text {C a s h F l o w a t t i m e} i + 1, \text {d u e t o r a t a n o d e} i, j \\ = \frac {1}{2} \times N \times \max (r _ {i, j} - \overline {{r}}, 0) \\ \end{array}
$$

- We then have:

<table><tr><td>i=0</td><td>i=1</td><td>i=2</td></tr><tr><td></td><td colspan="2">r2,uu=0.0638CF2,uu(3)==1/2N max (r2,uu-μr,0)=1.69</td></tr><tr><td></td><td colspan="2">r1,u=0.0433CF1,u(2)==1/2N max (r1,u-μr,0)=.67</td></tr><tr><td>r0=0.0168CF0(1)==1/2N max (r0-μr,0)=0</td><td colspan="2">r2,ud=0.0361CF2,ud(3)==1/2N max (r2,ud-μr,0)=.31</td></tr><tr><td></td><td colspan="2">r1,d=0.0120CF1,d(2)==1/2N max (r1,d-μr,0)=0</td></tr><tr><td></td><td colspan="2">r2,dd=0.0083CF2,dd(3)==1/2N max (r2,dd-μr,0)=0</td></tr></table>

# Cap Pricing Example

- Given these cash flows, define

$$
\begin{array}{l} V _ {i, j} = \text {V a l u e} i \text {o f a l l C a s h F l o w s} k > i \\ = e ^ {- \frac {1}{2} r _ {i, j}} \times \left(\frac {1}{2} V _ {i + 1, j} + \frac {1}{2} V _ {i + 1, j + 1} + C F _ {i, j} (i + 1)\right) \\ \end{array}
$$

- Then, the following backward tree gives a cap price  $V_{0} = 0.87$  
- Table 3 shows the pricing of a cap on the bigger tree in Table 2, with  $\bar{r} = 5\%$ ; and  $N = 100$ .

$$
\begin{array}{l} i = 0 \\ i = 1 \\ i = 2 \\ V _ {2, u u} = \\ = e ^ {- 0. 0 6 3 8 / 2} 1. 6 9 \\ = 1. 6 4 \\ \end{array}
$$

$$
\begin{array}{l} V _ {1, u} = e ^ {- 0. 0 4 3 3 / 2} \times \\ \times \left[ \frac {1}{2} (1. 6 4 +. 3 0) +. 6 7 \right] \\ = . 9 5 +. 6 5 = 1. 6 0 \\ \end{array}
$$

$$
\begin{array}{l} V _ {0} = e ^ {- 0. 0 1 6 8 / 2} \times \\ \times \left[ \frac {1}{2} (1. 6 0 +. 1 5) + 0 \right] \\ = 0. 8 7 + 0 = 0. 8 7 \\ \end{array}
$$

$$
\begin{array}{l} V _ {1, d} = e ^ {- 0. 0 1 2 0 / 2} \times \\ \times \left[ \frac {1}{2} (. 3 0 + 0) + 0 \right] \\ = 0. 1 5 + 0 = . 1 5 \\ \end{array}
$$

$$
\begin{array}{l} V _ {2, u d} = \\ = e ^ {- 0. 0 3 6 1 / 2} 0. 3 0 \\ = 0. 3 0 \\ \end{array}
$$

$$
\begin{array}{l} V _ {2, d d} = \\ = e ^ {- 0. 0 0 8 3 / 2} \frac {1}{2} \times 0 \\ = 0 \\ \end{array}
$$

<table><tr><td colspan="12">Table 3: A Cap</td></tr><tr><td colspan="12">Cash Flows (paid one period later)</td></tr><tr><td>j,i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>1</td><td>0</td><td>0.35</td><td>2.3</td><td>4.18</td><td>5.99</td><td>7.73</td><td>9.42</td><td>11.04</td><td>12.61</td><td>14.13</td><td>-</td></tr><tr><td>2</td><td></td><td>0</td><td>0</td><td>0.99</td><td>2.81</td><td>4.56</td><td>6.25</td><td>7.88</td><td>9.45</td><td>10.96</td><td>-</td></tr><tr><td>3</td><td></td><td></td><td>0</td><td>0</td><td>0</td><td>1.57</td><td>3.28</td><td>4.92</td><td>6.49</td><td>8.01</td><td></td></tr><tr><td>4</td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td>0.42</td><td>2.1</td><td>3.71</td><td>5.24</td><td></td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td>0</td><td>1.02</td><td>2.6</td><td></td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td></td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td>0</td><td></td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td></td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td></td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td></td></tr><tr><td colspan="12">Expected NPV of Future CashFlows</td></tr><tr><td>j,i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>1</td><td>9.00</td><td>13.38</td><td>19.43</td><td>24.58</td><td>27.82</td><td>29.02</td><td>28.22</td><td>25.34</td><td>20.11</td><td>11.97</td><td></td></tr><tr><td>2</td><td></td><td>4.78</td><td>7.40</td><td>11.59</td><td>16.37</td><td>19.57</td><td>20.61</td><td>19.4</td><td>15.84</td><td>9.58</td><td></td></tr><tr><td>3</td><td></td><td></td><td>2.12</td><td>3.45</td><td>5.66</td><td>9.33</td><td>12.28</td><td>13.1</td><td>11.44</td><td>7.21</td><td></td></tr><tr><td>4</td><td></td><td></td><td></td><td>0.73</td><td>1.27</td><td>2.25</td><td>4.02</td><td>6.36</td><td>6.93</td><td>4.85</td><td></td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>0.14</td><td>0.27</td><td>0.53</td><td>1.07</td><td>2.18</td><td>2.47</td><td></td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td></td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td>0</td><td></td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td></td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td></td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td></td></tr><tr><td>11</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>

# Swaps and Swaptions

- Similarly, the computation of Swaps and Swaptions (options to enter into a Swap) are simple.  
- Consider a 2 year swap (Maturity  $= i = 4$ ), with swap rate (c.c.)  $\overline{r} = .0304$ ,  $N = 100$ .  
- Again, denote by

$$
\begin{array}{l} C F _ {i, j} (i + 1) = \text {C a s h F l o w a t t i m e} i + 1, \text {d u e t o r a t e a t n o d e} i, j \\ = \frac {1}{2} \times N \times (r _ {i, j} - \overline {{r}}) \\ \end{array}
$$

- We obtain the tree of cash flows:

$i = 0$

$i = 1$

$i = 2$

$i = 3$

$$
\begin{array}{l} r _ {3, u u u} = 0. 0 8 \\ C F _ {3, u u u} (4) = \\ = \frac {1}{2} N \times (r _ {3, u u u} - \bar {r}) = 2. 4 7 \\ \end{array}
$$

$$
\begin{array}{l} r _ {1, u} = 0. 0 4 3 3 \\ C F _ {1, u} (2) = \\ = \frac {1}{2} N \times (r _ {1, u} - \bar {r}) = 0. 6 4 \\ \end{array}
$$

$$
\begin{array}{l} r _ {2, u u} = 0. 0 6 3 8 \\ C F _ {2, u u} (3) = \\ = \frac {1}{2} N \times \left(r _ {2, u u} - \bar {r}\right) = 1. 6 7 \\ \end{array}
$$

$$
\begin{array}{l} r _ {3, u u d} = 0. 0 5 3 \\ C F _ {3, u u d} (4) = \\ = \frac {1}{2} N \times \left(r _ {3, u u d} - \bar {r}\right) = 1. 1 5 \\ \end{array}
$$

$$
\begin{array}{l} r _ {0} = 0. 0 1 6 8 \\ C F _ {0} (1) = \\ = \frac {1}{2} N \times \left(r _ {1, u} - \bar {r}\right) = - 0. 6 8 \\ \end{array}
$$

$$
\begin{array}{l} r _ {1, d} = 0. 0 1 2 0 \\ C F _ {1, d} (2) = \\ = \frac {1}{2} N \times \left(r _ {1, d} - \bar {r}\right) = - 0. 9 2 \\ \end{array}
$$

$$
\begin{array}{l} r _ {2, u d} = 0. 0 3 6 1 \\ C F _ {2, u d} (3) = \\ = \frac {1}{2} N \times \left(r _ {2, u d} - \bar {r}\right) = 0. 2 8 \\ \end{array}
$$

$$
\begin{array}{l} r _ {3, u d d} = 0. 0 3 2 \\ C F _ {3, u d d} (4) = \\ = \frac {1}{2} N \times (r _ {3, u d d} - \bar {r}) = 0. 0 7 \\ \end{array}
$$

$$
\begin{array}{l} r _ {2, d d} = 0. 0 0 8 3 \\ C F _ {2, d d} (3) = \\ = \frac {1}{2} N \times \left(r _ {2, d d} - \bar {r}\right) = - 1. 1 \\ \end{array}
$$

$$
\begin{array}{l} r _ {3. d d d} = 0. 0 0 5 4 \\ C F _ {3, d d d} (4) = \\ = \frac {1}{2} N \times \left(r _ {3, d d d} - \bar {r}\right) = - 1. 2 5 \\ \end{array}
$$

- The tree for the value of the swap (for the fixed payer) is then immediately computed.  
Denoting again

$$
\begin{array}{l} V _ {i, j} = \text {V a l u e} i \text {o f a l l C a s h F l o w s} k > i \\ = e ^ {- \frac {1}{2} r _ {i, j}} \times \left(\frac {1}{2} V _ {i + 1, j} + \frac {1}{2} V _ {i + 1, j + 1} + C F _ {i, j} (i + 1)\right) \\ \end{array}
$$

we obtain

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c7ad836a1271c5b4f5c2b1e81d954ff1f8cb35a7460ab0b49670bb987bb71a09.jpg)

- The swap rate  $\overline{r} = 0.0304$  was chosen to make the value of the Swap contract  $= 0$  at time  $i = 0$ .

# Swaptions

- A Swaption is an option to enter into a swap, at a given swap rate  $r_{X}$
- A Receiver Swaption is an option to enter into a swap and receive fixed  $r_X$ .  
- A Payer Swaption is an option to enter into a swap and pay fixed  $r_X$ .
- Computing now the value of a European Swaption is simple.
- Consider for instance a European Swaption with maturity  $T = 1$  (i.e.  $i = 2$ ) to enter a one year swap and pay fixed  $r_{X} = .0304$ .  
- Let  $\overline{r}_{ij}$  be the swap rate in the node  $ij$ .<sup>2</sup>  
- Then:

* If  $\overline{r}_{2j} > r_X$  we exercise the option (we pay  $r_X$  instead of current rate  $\overline{r}_{2j}$ ).  
* If  $\overline{r}_{2j} < r_X$  we do not exercise the option (we are better off paying the market rate  $\overline{r}_{2j}$ ).

- It looks complicated. How do we model this decision?
- We remember that the swap rate  $\overline{r}_{ij}$  is determined in node  $ij$  to make the value of the swap at that node equal to 0.

# Swaptions

- Therefore, we first compute the value of the swap with given swap rate  $r_X$  along the tree  $V_{i,j}$

$$
V _ {i, j} = e ^ {- r _ {i, j} \Delta t} \left(\frac {1}{2} V _ {i + 1, j} + \frac {1}{2} V _ {i + 1, j + 1} + (r _ {i, j} - r _ {X})\right)
$$

- Since

$V_{2j} > 0$  if and only if  $r_X < \overline{r}_{2j} = \text{current market swap rate}$

- we exercise at time  $i = 2$  in node  $j$  if and only if  $V_{2j} > 0$ .  
- The payoff of the swaption at  $i = 2$  is then

$$
\mathsf {P a y o f f} _ {2 j} = C _ {2, j} = \max (V _ {2 j}, 0)
$$

- The value of the European Swaption can then be computed by backward calculations:

$$
C _ {i, j} = e ^ {- r _ {i j} \Delta t} \left(\frac {1}{2} C _ {i + 1, j} + \frac {1}{2} C _ {i + 1, j + 1}\right)
$$

# Swaptions: Example

- Consider receiver swaption with a strike swap rate  $r_{X} = .0304$  
- The swaption is at the money, that is  $r_X = \overline{r}_0 =$  current swap rate at 0.  
- The relevant tree for  $V_{i,j}$  is then the one given earlier.  
- Since  $V_{2,uu} = 3.31$ ,  $V_{2,ud} = 0.86$  and  $V_{2,dd} = -1.68$ , we only exercise in the top two nodes at  $i = 2$ .  
- The tree to value the swaption is then given by:

$$
i = 0
$$

$$
i = 1
$$

$$
i = 2
$$

$$
C _ {0} = e ^ {- 0. 0 1 6 8 / 2} \times
$$

$$
C _ {1, u} = e ^ {- 0. 0 4 3 3 / 2} \times
$$

$$
C _ {2, u u} =
$$

$$
\times 1 / 2 (3. 3 1 + 0. 8 6) = 2. 0 4
$$

$$
= \max  \left(V _ {2, u u}, 0\right)
$$

$$
= 3. 3 1
$$

$$
\times \left[ 1 / 2 (2. 0 4 + 0. 4 3) \right]
$$

$$
= \max  \left(V _ {2, u d}, 0\right)
$$

$$
= 1. 2 2
$$

$$
= 0. 8 6
$$

$$
C _ {1, d} = e ^ {- 0. 0 1 2 0 / 2} \times
$$

$$
\times 1 / 2 (0. 8 6 + 0) = 0. 4 3
$$

$$
\begin{array}{l} C _ {2, u d} = \\ = \max  \left(V _ {2, d d}, 0\right) \\ = 0 \\ \end{array}
$$

# American Swaptions: Example

- Computing an American style swaption exploits the same methodology illustrated earlier. That is, we must have

$$
C _ {i, j} ^ {A m} = \max \left(V _ {i, j}, e ^ {- r _ {i, j} \Delta t} \times \left(\frac {1}{2} C _ {i + 1, j} ^ {A m} + \frac {1}{2} C _ {i + 1, j + 1} ^ {A m}\right)\right)
$$

In this case, we find

<table><tr><td>i=0</td><td>i=1</td><td>i=2</td></tr><tr><td></td><td>CAm2,uu=Cmax(V2,uu,0)=3.31</td><td></td></tr><tr><td></td><td>CAm1,u=max[e-0.0433/2××1/2(3.31+0.86),V1,u]=max[2.04,2.67]=2.67</td><td></td></tr><tr><td>CAm0=e-0.0168/2××[1/2(2.67+0.43)]=1.53</td><td></td><td>CAm2,ud=Cmax(V2,ud,0)=0.86</td></tr><tr><td></td><td>CAm1,d=max[e-0.0120/2××1/2(0.86+0),V1,d]=0.43</td><td></td></tr></table>

# Swaptions: Examples

- Note that  $C_0^{Am} = 1.53 > C_0 = 1.22$ . An American option always gives more "rights" than the European option.  
- Note also that we exercise before maturity at node  $(1, u)$ .  
- In a slightly more serious exercise, we have a table like the following:  
- Let the "Terms" be:

$$
\begin{array}{l} - \bar {r} = 0. 0 3 9 9 9; \\ - T = 5 \text {y e a r s}; \\ - \text {S e m i - a n n u a l p a y m e n t s}; \\ - \text {A t - t h e - m o n e y P a y e r S w a p t i o n w i t h} T ^ {*} = 3 \text {y e a r s :} \\ - \left(\text {I n t h e l a s t p a n e l , a}" * "\right. \text {d e n o t e s e a l y e x i c e o f t h e o p t i o n)} \\ \end{array}
$$

<table><tr><td colspan="12">Table 4: Swap and Swaption</td></tr><tr><td colspan="12">Cash Flows (paid one period later)</td></tr><tr><td>j,i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>1</td><td>-1.16</td><td>0.86</td><td>2.8</td><td>4.68</td><td>6.49</td><td>8.23</td><td>9.92</td><td>11.54</td><td>13.11</td><td>14.63</td><td></td></tr><tr><td>2</td><td></td><td>-2.42</td><td>-0.42</td><td>1.49</td><td>3.31</td><td>5.06</td><td>6.75</td><td>8.38</td><td>9.95</td><td>11.46</td><td></td></tr><tr><td>3</td><td></td><td></td><td>-3.63</td><td>-1.62</td><td>0.27</td><td>2.07</td><td>3.78</td><td>5.42</td><td>6.99</td><td>8.51</td><td></td></tr><tr><td>4</td><td></td><td></td><td></td><td>-4.81</td><td>-2.76</td><td>-0.86</td><td>0.92</td><td>2.6</td><td>4.21</td><td>5.74</td><td></td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>-5.94</td><td>-3.86</td><td>-1.94</td><td>-0.16</td><td>1.52</td><td>3.1</td><td></td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>-7.03</td><td>-4.91</td><td>-2.97</td><td>-1.17</td><td>0.5</td><td></td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>-8.08</td><td>-5.93</td><td>-3.96</td><td>-2.14</td><td></td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-9.1</td><td>-6.91</td><td>-4.91</td><td></td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-10.08</td><td>-7.86</td><td></td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-11.02</td><td></td></tr><tr><td colspan="12">Expected NPV of Future CashFlows</td></tr><tr><td>j,i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>1</td><td>0</td><td>13.11</td><td>21.73</td><td>27.14</td><td>30.06</td><td>30.87</td><td>29.71</td><td>26.48</td><td>20.9</td><td>12.39</td><td></td></tr><tr><td>2</td><td></td><td>-10.8</td><td>3.52</td><td>12.85</td><td>18.61</td><td>21.59</td><td>22.22</td><td>20.62</td><td>16.67</td><td>10.02</td><td></td></tr><tr><td>3</td><td></td><td></td><td>-20.18</td><td>-4.85</td><td>5.03</td><td>11.03</td><td>14</td><td>14.39</td><td>12.32</td><td>7.66</td><td></td></tr><tr><td>4</td><td></td><td></td><td></td><td>-27.6</td><td>-11.53</td><td>-1.27</td><td>4.84</td><td>7.72</td><td>7.84</td><td>5.31</td><td></td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>-32.52</td><td>-16.09</td><td>-5.68</td><td>0.41</td><td>3.13</td><td>2.95</td><td></td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>-34.55</td><td>-18.18</td><td>-7.89</td><td>-1.98</td><td>0.49</td><td></td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>-33.47</td><td>-17.6</td><td>-7.7</td><td>-2.14</td><td></td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-29.23</td><td>-14.28</td><td>-5.05</td><td></td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-21.98</td><td>-8.33</td><td></td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-12.06</td><td></td></tr><tr><td>11</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>

European Option  

<table><tr><td>j,i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>1</td><td>6.05</td><td>8.21</td><td>10.98</td><td>14.41</td><td>18.52</td><td>23.44</td><td>29.71</td><td></td><td></td><td></td><td></td></tr><tr><td>2</td><td></td><td>3.99</td><td>5.91</td><td>8.63</td><td>12.29</td><td>16.88</td><td>22.22</td><td></td><td></td><td></td><td></td></tr><tr><td>3</td><td></td><td></td><td>2.03</td><td>3.38</td><td>5.59</td><td>9.04</td><td>14</td><td></td><td></td><td></td><td></td></tr><tr><td>4</td><td></td><td></td><td></td><td>0.62</td><td>1.2</td><td>2.39</td><td>4.84</td><td></td><td></td><td></td><td></td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td></td><td></td><td></td><td></td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td></td><td></td><td></td><td></td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td></td><td></td><td></td><td></td></tr></table>

American Option  

<table><tr><td>j,i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>1</td><td>9.84</td><td>14.56</td><td>21.73*</td><td>27.14*</td><td>30.06*</td><td>30.87*</td><td>29.71</td><td></td><td></td><td></td><td></td></tr><tr><td>2</td><td></td><td>5.28</td><td>8.23</td><td>12.85*</td><td>18.61*</td><td>21.59*</td><td>22.22</td><td></td><td></td><td></td><td></td></tr><tr><td>3</td><td></td><td></td><td>2.28</td><td>3.87</td><td>6.56</td><td>11.03*</td><td>14</td><td></td><td></td><td></td><td></td></tr><tr><td>4</td><td></td><td></td><td></td><td>0.62</td><td>1.2</td><td>2.39</td><td>4.84</td><td></td><td></td><td></td><td></td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td>0</td><td></td><td></td><td></td><td></td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>0</td><td>0</td><td></td><td></td><td></td><td></td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td><td></td><td></td><td></td><td></td></tr></table>

# Tree Building

- How can we construct a tree?  
- There are various models and methodologies. We consider two simple models here.

# The Ho-Lee Model

- The Ho-Lee model makes a simple assumption about the dynamics of the short-term interest rate.  
- Let  $\Delta t$  be the time step. Then, for every node  $(i,j)$  the next interest rate is given by

$$
r _ {i + 1, j} = r _ {i, j} + \theta_ {i} \times \Delta t + \sigma \times \sqrt {\Delta t} \quad \text {f o r a " u p " m o v e m e n t} \tag {13}
$$

$$
r _ {i + 1, j + 1} = r _ {i, j} + \theta_ {i} \times \Delta t - \sigma \times \sqrt {\Delta t} \quad \text {f o r a “ d o w n ” m o v e m e n t} \tag {14}
$$

- where the risk neutral probability of an up movement is  $\pi^{*} = 0.5$ ;  $\sigma$  is the annualized volatility; and  $\theta_{i}$  are chosen recursively so as to fit the current term structure of interest rates.  
- The tree from Ho Lee is naturally recombining: an "up + down" movement produces the same interest rate as a "down + up" movement.
- To see this easily, consider  $r_0$  and use the "  $u, d, ud, du$ " notation.

$$
r _ {1, u} = r _ {0} + \theta_ {0} \times \Delta t + \sigma \times \sqrt {\Delta t}
$$

$$
r _ {1, d} = r _ {0} + \theta_ {0} \times \Delta t - \sigma \times \sqrt {\Delta t}
$$

- Similarly, the next steps are:

$$
\begin{array}{l} r _ {2, u d} = r _ {1, u} + \theta_ {1} \times \Delta t - \sigma \times \sqrt {\Delta t} \\ = r _ {0} + (\theta_ {0} + \theta_ {1}) \times \Delta t \\ \end{array}
$$

and

$$
\begin{array}{l} r _ {2, d u} = r _ {1, d} + \theta_ {1} \times \Delta t + \sigma \times \sqrt {\Delta t} \\ = r _ {0} + (\theta_ {0} + \theta_ {1}) \times \Delta t \\ = r _ {2, u d} \\ \end{array}
$$

- How do we select  $\theta_{i}$ ?
- We choose  $\theta_{i}$  iteratively from  $i = 0,1,\ldots ,n$  to fit the zero-coupon bond prices.  
- To illustrate, consider the zero-coupon bonds

$$
Z _ {0} (1) = 0. 9 9 1 6, Z _ {0} (2) = 0. 9 7 8 1, Z _ {0} (3) = 0. 9 6 1 5
$$

- We already have the root of the tree:  $r_0 = -\ln (Z_0(1)) / 2 = 0.0169$ .  
- We next must choose  $r_{1u}$  and  $r_{1d}$ . Let volatility be  $\sigma = .015$ .  
- We can search for  $\theta_0$  such that the value of the bond from the tree equals  $Z_0(2) = 0.9781$ .
- Given a  $\theta_0$  we have

$$
i = 0
$$

$$
i = 1
$$

$$
r _ {1, u} = r _ {0} + \theta_ {0} \times \Delta t + \sigma \times \sqrt {\Delta t}
$$

$$
Z _ {1, u} \left(2\right) = e ^ {- r _ {1 u} \times \Delta t}
$$

$$
\begin{array}{l} r _ {0} = 1.69 \% \\ Z _ {0} (2) = Z _ {0} (1) \times \left[ \frac {1}{2} Z _ {1, u} (2) + \frac {1}{2} Z _ {1, d} (2) \right] \\ = 0. 9 7 8 1 \\ \end{array}
$$

$$
r _ {1, d} = r _ {0} + \theta_ {0} \times \Delta t - \sigma \times \sqrt {\Delta t}
$$

$$
Z _ {1, d} (2) = e ^ {- r _ {1, d} \times \Delta t}
$$

- We want to search over  $\theta_0$  so that

$$
Z _ {0} (2) = 0. 9 7 8 1
$$

- Searching over  $\theta_0$  we find  $\theta_0 = .021145$ , resulting thus in

$$
\begin{array}{l} i = 0 \\ i = 1 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,u} = 3.81\% \\ Z _ {1, u} (2) = 0. 9 8 1 1 5 \\ \end{array}
$$

$$
\begin{array}{l} r_0 = 1.69\% \\ Z _ {0} (2) = 0. 9 7 8 1 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,d} = 1.68\% \\ Z _ {1, d} (2) = 0. 9 9 1 6 2 \\ \end{array}
$$

- Given  $\theta_0$ , we now look for  $\theta_{1}$  by trying to match the next bond  $Z_{0}(3) = 0.9615$ .

$$
i = 0
$$

$$
i = 1
$$

$$
i = 2
$$

$$
\begin{array}{l} r _ {0} = 1.69 \% \\ Z _ {0} (3) = Z _ {0} (1) \left[ \frac {Z _ {1 , u} (3)}{2} + \frac {Z _ {1 , d} (3)}{2} \right] \\ = 0. 9 6 1 5 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,u} = 3.81\% \\ Z _ {1, u} (3) = Z _ {1, u} (2) \left[ \frac {Z _ {2 , u u} (3)}{2} + \frac {Z _ {2 , u d} (3)}{2} \right] \\ \end{array}
$$

$$
\begin{array}{l} r _ {2, u u} = 3.81 \% + \theta_ {1} \Delta t + \sigma \sqrt {\Delta t} \\ Z _ {2, u u} (3) = e ^ {- r _ {2, u u} \Delta t} \\ \end{array}
$$

$$
\begin{array}{l} r_{1,d} = 1.68\% \\ Z _ {1, d} (3) = Z _ {1, d} (2) [ \frac {Z _ {2 , u d} (3)}{2} + \frac {Z _ {2 , d d} (3)}{2} ] \\ \end{array}
$$

$$
\begin{array}{l} r _ {2, u d} = 3.81 \% + \theta_ {1} \Delta t - \sigma \sqrt {\Delta t} \\ Z _ {2, u d} (3) = e ^ {- r _ {2, u d} \Delta t} \\ \end{array}
$$

$$
\begin{array}{l} r_{2.dd} = 1.68\% +\theta_1\Delta t - \sigma \sqrt{\Delta t} \\ Z _ {2, d d} (3) = e ^ {- r _ {2, d d} \Delta t} \\ \end{array}
$$

- Clearly,  $Z_{0}(3)$  from the tree only depends on  $\theta_{1}$ .  
- Searching for  $\theta_{1}$  yields  $\theta_{1} = 0.013807$ , yielding

$$
\begin{array}{l} i = 0 \\ i = 1 \\ i = 2 \\ \end{array}
$$

$$
\begin{array}{l} r_{2,uu} = 5.56\% \\ Z _ {2, u u} (3) = 0. 9 7 2 6 0 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,u} = 3.81\% \\ Z _ {1, u} (3) = 0. 9 5 9 3 6 \\ \end{array}
$$

$$
\begin{array}{l} r_{0} = 1.69\% \\ Z _ {0} (3) = 0. 9 6 1 5 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,d} = 1.68\% \\ Z _ {1, d} (3) = 0. 9 7 9 9 3 \\ \end{array}
$$

$$
\begin{array}{l} r _ {2, u d} = 3.43 \% \\ Z _ {2, u d} (3) = 0. 9 8 2 9 7 \\ \end{array}
$$

$$
\begin{array}{l} r_{2,dd} = 1.31\% \\ Z _ {2, d d} (3) = 0. 9 9 3 4 5 \\ \end{array}
$$

- And so on for all the possible available maturities.

# The Simple Black-Derman-Toy

- One potential issue with the Ho-Lee model is that interest rates can easily get negative. If  $\sigma$  is large, for instance, there is nothing in the procedure above that guarantees that  $r_{i,j} > 0$ .  
- A simple solution is to model the Ho-Lee mode in "logarithm", that is, let  $z_{ij} = \ln (r_{ij})$  and then assume

$$
z _ {i + 1, j} = z _ {i, j} + \theta_ {i} \times \Delta t + \sigma \times \sqrt {\Delta t} \quad \text {f o r a " u p " m o v e m e n t} \tag {15}
$$

$$
z _ {i + 1, j + 1} = z _ {i, j} + \theta_ {i} \times \Delta t - \sigma \times \sqrt {\Delta t} \quad \text {f o r a “ d o w n ” m o v e m e n t} \tag {16}
$$

- Clearly, even if  $z_{ij} < 0$  we have  $r_{ij} = e^{z_{ij}} > 0$ .  
- Note that now  $\sigma$  is the standard deviation of log interest rates. It can be estimated from  $\Delta \ln (r_t)$ .

Note that to a first order approximation  $\Delta z_{t} \approx \frac{1}{r_{t}} \Delta r_{t}$ .  

- Therefore,  $\sigma(z_{t}) \approx \sigma(r_{t}) / r_{t}$  
- In the previous example,  $\sigma(r_{t}) = 0.015$  and  $r_{0} = 1.69\%$ , and thus  $\sigma(z_{t}) \approx 88.91\%$ .  
- Using the same procedure, we obtain  $\theta_0 = 0.603652218$ ,  $\theta_1 = 0.089246544$  and the binomial tree

$$
\begin{array}{l} i = 0 \\ i = 1 \\ i = 2 \\ \end{array}
$$

$$
\begin{array}{l} r_{2,uu} = 8.39\% \\ Z _ {2, u u} (2) = 1; \\ Z _ {2, u u} (3) = 0. 9 5 8 9 3 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,u} = 4.28\% \\ Z _ {1, u} (2) = 0. 9 7 8 8 4 \\ Z _ {1, u} (3) = 0. 9 5 2 9 3 \\ \end{array}
$$

$$
\begin{array}{l} r_0 = 1.69\% \\ Z _ {0} (2) = 0. 9 7 8 1 \\ Z _ {0} (3) = 0. 9 6 1 5 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,d} = 1.22\% \\ Z _ {1, d} (2) = 0. 9 9 3 9 3 \\ Z _ {1, d} (3) = 0. 9 8 6 3 6 \\ \end{array}
$$

$$
\begin{array}{l} r_{2,ud} = 2.39\% \\ Z _ {2, u d} (2) = 1 \\ Z _ {2, u d} (3) = 0. 9 8 8 1 4 \\ \end{array}
$$

$$
\begin{array}{l} r_{2,dd} = 0.68\% \\ Z _ {2, d d} (2) = 1 \\ Z _ {2, d d} (3) = 0. 9 9 6 6 \\ \end{array}
$$

# The Black-Derman-Toy Model

- The previous models are popular, but they have constant volatility.  
- It is hard for them to match the term structure of volatility, that is, the fact that options of different maturity may have different volatility.  
- The Black-Derman-Toy model still assume  $z_{i,j} = \log (r_{i,j})$  as in the simple BDT, but it assumes that between  $i$  and  $i + 1$ , for every two adjacent nodes  $j$  and  $j + 1$ , the variance is

$$
\sigma_ {i + 1} ^ {2} \Delta t = V a r i a n c e [ z _ {i} | z _ {i - 1, j} ]
$$

- This implies that for every node  $j$ :

$$
\begin{array}{l} \sigma_ {i + 1} ^ {2} \Delta t = V a r i a n c e [ z _ {i} | z _ {i - 1, j} ] \\ = \frac {1}{2} \left(z _ {i, j} - E [ z _ {i} | z _ {i - 1, j} ]\right) ^ {2} + \frac {1}{2} \left(z _ {i, j + 1} - E [ z _ {i} | z _ {i - 1, j} ]\right) ^ {2} \\ = \frac {1}{2} \left(z _ {i, j} - \frac {1}{2} z _ {i, j} - \frac {1}{2} z _ {i, j + 1}\right) ^ {2} + \frac {1}{2} \left(z _ {i, j + 1} - \frac {1}{2} z _ {i, j} - \frac {1}{2} z _ {i, j + 1}\right) ^ {2} \\ = \frac {1}{2} \left(\frac {1}{2} z _ {i, j} - \frac {1}{2} z _ {i, j + 1}\right) ^ {2} + \frac {1}{2} \left(\frac {1}{2} z _ {i, j + 1} - \frac {1}{2} z _ {i, j}\right) ^ {2} \\ = \frac {1}{4} \left(z _ {i, j} - z _ {i, j + 1}\right) ^ {2} \\ \end{array}
$$

- The final equation is then

$$
\sigma_ {i + 1} \sqrt {\Delta t} = \frac {1}{2} \left(z _ {i, j} - z _ {i, j + 1}\right) \tag {17}
$$

- We then need two types of inputs in this model

1. The current term-structure of yields;  
2. The current term-structure of forward volatility of interest rates.

- The forward volatility can be estimated from options (caps and floors), and it reflects the volatility of forward rates with the indicated maturity.  
- Therefore, assume the following data

Table 1: Inputs to BDT Model  

<table><tr><td>Maturity</td><td>Yield</td><td>Fwd Volatility (%)</td></tr><tr><td>1</td><td>2.13</td><td>27.80</td></tr><tr><td>2</td><td>3.04</td><td>24.02</td></tr><tr><td>3</td><td>3.79</td><td>20.64</td></tr><tr><td>4</td><td>4.22</td><td>19.49</td></tr><tr><td>5</td><td>4.52</td><td>18.22</td></tr></table>

- Objective: Construct an interest rate tree that matches the data in Table 1 exactly.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/93d1704f4af4d562b834a4bef81fac36f57499e577348d7048b42d059f618470.jpg)

(18)

- For every two states  $j$  and  $j + 1$ , using equation (17) we can rewrite

$$
z _ {i, j + 1} = z _ {i, j} - 2 \sigma_ {i + 1} \sqrt {\Delta t}
$$

or

$$
z _ {i, j + 1} = z _ {i, 1} - 2 \times j \times \sigma_ {i + 1} \sqrt {\Delta t} \tag {19}
$$

- The unknowns in our original model, with  $\Delta t = 1$  are then

$$
\begin{array}{l} i = 0 \\ i = 1 \left(\mathsf {u s e} \sigma_ {2}\right) \\ i = 2 \left(\text {u s e} \sigma_ {3}\right) \quad i = 3 \\ \end{array}
$$

$$
z _ {1, u} = ?
$$

$$
z _ {2, u u} = ?
$$

···

$$
z _ {0} = \log (.. 0 2 1 3)
$$

$$
z _ {1, d} = z _ {1, u} - 2 \sigma_ {2}
$$

$$
z _ {2, u d} = z _ {2, u u} - 2 \sigma_ {3}
$$

···

···

$$
z _ {2, d d} = z _ {2, u u} - 4 \sigma_ {3}
$$

··

(20)

- At time  $i = 1$  we look for  $z_{1,u}$ , at time  $i = 2$  we need to look for  $z_{2,uu}$  etc.  
- Since we are already using the "volatility" condition, the only equation to satisfy for every  $i$  is the bond price out of the tree corresponds to the data  $Z(0, T_i)$  that we have available.  
- This last computation can be done recursively by going backward from the end of the tree, as usual.
- Example: Suppose you had the data (extracted from Bloomberg)

<table><tr><td></td><td></td><td colspan="9">Table 4: Data from Swap Curve and Caps</td></tr><tr><td>Maturity</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>Yield</td><td>.0239</td><td>.0334</td><td>.0406</td><td>.0456</td><td>.0492</td><td>.0517</td><td>.0534</td><td>.0547</td><td>.0559</td><td>.0574</td></tr><tr><td>FwdVol</td><td>.364</td><td>.3400</td><td>.2940</td><td>.2740</td><td>.2530</td><td>.2391</td><td>.2330</td><td>.2299</td><td>.2249</td><td>.2130</td></tr></table>

Source: Bloomberg

- The implied BDT tree (already in interest rate format  $r_{ij} = \exp(z_{ij})$  that matches the data is

<table><tr><td colspan="11">Table 5: BDT tree</td></tr><tr><td>j,i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td></tr><tr><td>1</td><td>2.39</td><td>5.71</td><td>9.17</td><td>12.55</td><td>15.93</td><td>19.40</td><td>23.55</td><td>29.01</td><td>36.29</td><td>45.19</td></tr><tr><td>2</td><td></td><td>2.89</td><td>5.10</td><td>7.26</td><td>9.60</td><td>12.03</td><td>14.78</td><td>18.32</td><td>23.15</td><td>29.52</td></tr><tr><td>3</td><td></td><td></td><td>2.83</td><td>4.20</td><td>5.79</td><td>7.46</td><td>9.27</td><td>11.57</td><td>14.76</td><td>19.28</td></tr><tr><td>4</td><td></td><td></td><td></td><td>2.42</td><td>3.49</td><td>4.62</td><td>5.82</td><td>7.30</td><td>9.41</td><td>12.59</td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td>2.10</td><td>2.87</td><td>3.65</td><td>4.61</td><td>6.00</td><td>8.22</td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td>1.78</td><td>2.29</td><td>2.91</td><td>3.83</td><td>5.37</td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td>1.44</td><td>1.84</td><td>2.44</td><td>3.51</td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>1.16</td><td>1.56</td><td>2.29</td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0.99</td><td>1.50</td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0.98</td></tr></table>

# Monte Carlo Simulations on Binomial Trees

- Monte Carlo simulations is the most popular methodology to price securities  
- Consider a one-step risk neutral binomial tree with equal chance of up or down movement.  
- We want to price an interest rate option that pays at time  $i = 1$

$$
c _ {1} = 1 0 0 \times \max (r _ {1} - r _ {K}, 0)
$$

where  $r_K$  is the strike rate.  

- Using risk neutral pricing, the value of the option is:

$$
c _ {0} = E ^ {*} \left[ e ^ {- r _ {0} \times T} \times c _ {1} \right] = e ^ {- r _ {0} \times T} \left[ \frac {1}{2} \times c _ {1, u} + \frac {1}{2} \times c _ {1, d} \right] \tag {21}
$$

- Next figure computes the value of the option for a given binomial tree.

$$
i = 0
$$

$$
i = 1
$$

$$
\begin{array}{l} r_0 = 1.74\% \\ c _ {0} = e ^ {- 1.74 \% / 2} \times \frac {1}{2} \times 1.747 \\ = 0. 8 6 6 0 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,u} = 3.75\% \\ c _ {1, u} = 1. 7 4 7 \\ \end{array}
$$

$$
\begin{array}{l} r_{1,d} = 1.30\% \\ c _ {1, d} = 0 \\ \end{array}
$$

# Monte Carlo Simulations on Binomial Tree

- Another way of computing the expected future payoff is to simulate upward and downward movements in the tree using a computer.
- In Excel and Matlab the function  $\text{RAND}()$  simulates a uniform [0, 1] random variable.  
- We can simulate  $\text{RAND}()$  a large number  $N$  of times, and then impose the following:

(a) If  $\text{RAND}(.) < 0.5 \Rightarrow$  the interest rate moved up the tree  
(b) If  $\text{RAND}() \geq 0.5 \Rightarrow$  the interest rate moved down the tree

- For each of realization  $s$  of  $RAND()$ , we use the corresponding simulated  $r_{1,u}^{s}$  or  $r_{1,d}^{s}$  to compute the option payoff.

$$
c _ {1} ^ {s} = 1 0 0 \times \max (r _ {1} ^ {s} - r _ {K}, 0)
$$

- We can compute the expected discounted payoff in (21) as the average of the discounted payoff across all simulations:

$$
\begin{array}{l} \hat {c} _ {0} = \mathsf {a v e r a g e o f} \left\{e ^ {- r _ {0} \times T} \times c _ {1} ^ {1}, e ^ {- r _ {0} \times T} \times c _ {1} ^ {2}, e ^ {- r _ {0} \times T} \times c _ {1} ^ {3}, \dots , e ^ {- r _ {0} \times T} \times c _ {1} ^ {3} \right\} \\ = \frac {1}{N} \sum_ {s = 1} ^ {N} e ^ {- r _ {0} \times T} c _ {1} ^ {s} \tag {22} \\ \end{array}
$$

# - Next Table illustrates the procedure

- The first column reports the simulation number.  
- The second column displays the actual realization of the  $\text{RAND}()$  function in Excel.  
- The third column tells us the movement in the tree implied by the  $\text{RAND}()$  realization.  
- The fourth column reports the payoff at maturity, i.e.  $c_1^s = 100 \times \max(r_1^s - r_K, 0)$ .  
- The last column computes the discounted payoff,  $e^{-r_0 \times T} \times c_1^s$ .

Ten Simulations on the Binomial Tree  

<table><tr><td>Simulation Number</td><td>Realization of RAND()</td><td>Move on the Tree</td><td>Interest Rate Realization</td><td>Payoff at Maturity T</td><td>Discounted Payoff</td></tr><tr><td>1</td><td>0.67901</td><td>down</td><td>1.30%</td><td>0.000</td><td>0.000</td></tr><tr><td>2</td><td>0.222179</td><td>up</td><td>3.75%</td><td>1.747</td><td>1.732</td></tr><tr><td>3</td><td>0.684549</td><td>down</td><td>1.30%</td><td>0.000</td><td>0.000</td></tr><tr><td>4</td><td>0.761836</td><td>down</td><td>1.30%</td><td>0.000</td><td>0.000</td></tr><tr><td>5</td><td>0.140407</td><td>up</td><td>3.75%</td><td>1.747</td><td>1.732</td></tr><tr><td>6</td><td>0.092252</td><td>up</td><td>3.75%</td><td>1.747</td><td>1.732</td></tr><tr><td>7</td><td>0.999465</td><td>down</td><td>1.30%</td><td>0.000</td><td>0.000</td></tr><tr><td>8</td><td>0.472856</td><td>up</td><td>3.75%</td><td>1.747</td><td>1.732</td></tr><tr><td>9</td><td>0.521622</td><td>down</td><td>1.30%</td><td>0.000</td><td>0.000</td></tr><tr><td>10</td><td>0.575471</td><td>down</td><td>1.30%</td><td>0.000</td><td>0.000</td></tr><tr><td></td><td></td><td></td><td></td><td>Average</td><td>0.693</td></tr></table>

- The simulated value is

$$
\hat {c} _ {0} = 0. 6 9 3.
$$

- With only  $N = 10$  simulation, it is no surprise that the value of the security  $\hat{c}_0 = 0.693$  comes in rather different than the value from the tree  $(c_0 = 0.8660)$ .  
- However, as the number of simulations  $N$  increases, the value from the simulations becomes more and more accurate.  
- For instance

$$
\begin{array}{l} N = 5 0 0 \Longrightarrow \hat {c} _ {0} = 0. 8 9 7 \\ N = 1 0 0 0 \Longrightarrow \hat {c} _ {0} = 0. 8 8 8 \\ N = 1 0 0 0 0 \Longrightarrow \hat {c} _ {0} = 0. 8 5 7 5 \\ \end{array}
$$

# Monte Carlo Simulations on Binomial Trees

- Consider once again the same option, but now with one year to maturity, i.e.  $i = 2$ .

$$
i = 0
$$

$$
i = 1
$$

$$
i = 2
$$

$$
r_{1,u} = 3.75\%
$$

$$
c_{1,u} = e^{-3.75\% /2}
$$

$$
\times \left[ \frac {1}{2} (4. 0 6 1 6 + 1. 6 1 5 0) \right]
$$

$$
= 2. 7 8 5 6
$$

$$
r_{2,uu} = 6.06\%
$$

$$
c _ {2, u u} = 4. 0 6 1 6
$$

$$
\begin{array}{l} r _ {0} = 1.74 \% \\ c _ {0} = e ^ {- 1.74 \% / 2} \times \\ \times \left[ \frac {1}{2} (2. 7 8 5 6 + 0. 8 0 2 2) \right] \\ = 1. 7 7 8 4 \\ \end{array}
$$

$$
r _ {2, u d} = r _ {2, d u} = 3.61 \%
$$

$$
c _ {2, u d} = c _ {2, d u} = 1. 6 1 5 0
$$

$$
\begin{array}{l} r_{1,d} = 1.30\% \\ c _ {1, d} = e ^ {- 1.30 \% / 2} \\ \times \frac {1}{2} \times 1. 6 1 5 0 \\ = \overline {{0 . 8 0 2 2}} \\ \end{array}
$$

$$
\begin{array}{l} r_{2,dd} = 1.17\% \\ c _ {2, d d} = 0 \\ \end{array}
$$

- First note that the backward computation methodology is equivalent to the outright calculation of the value of the security as the risk neutral present discounted value of the payoff at maturity, discounted at the risk free rate.  
- That is, the value of the security is equal to

$$
c _ {0} = E ^ {*} \left[ \underbrace {\left(e ^ {- r _ {0} \times 0 . 5}\right)} _ {\times} \quad \times \quad \underbrace {\left(e ^ {- r _ {1} \times 0 . 5}\right)} _ {\times} \quad \times \quad \underbrace {c _ {2}} _ {\times} \right] \tag {23}
$$

(Discount  $1 \to 0$ ) (Discount  $2 \to 1$ ) Payoff at 2

$$
= E ^ {*} \left[ e ^ {- \left(r _ {0} + r _ {1}\right) \times 0. 5} \times c _ {2} \right] \tag {24}
$$

- Indeed, the interest rates  $r_{2,uu}, r_{2,ud}, r_{2,du}$  and  $r_{2,dd}$  occur with a  $25\%$  chance.  
- Thus, the value of the option is also equal to

$$
\begin{array}{l} c _ {0} = 0. 2 5 \times e ^ {- (r _ {0} + r _ {1, u}) \times 0. 5} \times c _ {2, u u} + 0. 2 5 \times e ^ {- (r _ {0} + r _ {1, u}) \times 0. 5} \times c _ {2, u d} (25) \\ + 0. 2 5 \times e ^ {- (r _ {0} + r _ {1, d}) \times 0. 5} \times c _ {2, d u} + 0. 2 5 \times e ^ {- (r _ {0} + r _ {1, d}) \times 0. 5} \times c _ {2, d d} (26) \\ = 1. 7 7 8 4, \\ \end{array}
$$

- the same price as from the tree
- We now perform exactly the same simulation exercise as before two realizations of  $\text{RAND}()$  
- The only caveat now is to figure out how we should discount simulated cash flows back to time 0.
- From (24), and its explicit development in (25) and (26) we must discount cash flow by using the realized interest rate path in that simulation.

<table><tr><td>Sim Number</td><td>First RAND()</td><td>First Move on the Tree</td><td>Interest Rate Realization at Time i = 1</td><td>Second RAND()</td><td>Second Move on the Tree</td><td>Interest Rate Realization at Time i = 2</td><td>Payoff at Maturity</td><td>Discounted Payoff</td></tr><tr><td>1</td><td>0.468692</td><td>up</td><td>3.75%</td><td>0.513012</td><td>down</td><td>3.61%</td><td>1.615</td><td>1.571</td></tr><tr><td>2</td><td>0.103819</td><td>up</td><td>3.75%</td><td>0.164345</td><td>up</td><td>6.06%</td><td>4.062</td><td>3.952</td></tr><tr><td>3</td><td>0.848307</td><td>down</td><td>1.30%</td><td>0.340712</td><td>up</td><td>3.61%</td><td>1.615</td><td>1.591</td></tr><tr><td>4</td><td>0.702089</td><td>down</td><td>1.30%</td><td>0.254097</td><td>up</td><td>3.61%</td><td>1.615</td><td>1.591</td></tr><tr><td>5</td><td>0.001839</td><td>up</td><td>3.75%</td><td>0.118779</td><td>up</td><td>6.06%</td><td>4.062</td><td>3.952</td></tr><tr><td>6</td><td>0.444781</td><td>up</td><td>3.75%</td><td>0.241821</td><td>up</td><td>6.06%</td><td>4.062</td><td>3.952</td></tr><tr><td>7</td><td>0.066274</td><td>up</td><td>3.75%</td><td>0.55081</td><td>down</td><td>3.61%</td><td>1.615</td><td>1.571</td></tr><tr><td>8</td><td>0.386942</td><td>up</td><td>3.75%</td><td>0.765509</td><td>down</td><td>3.61%</td><td>1.615</td><td>1.571</td></tr><tr><td>9</td><td>0.769553</td><td>down</td><td>1.30%</td><td>0.627444</td><td>down</td><td>1.17%</td><td>0.000</td><td>0.000</td></tr><tr><td>10</td><td>0.888142</td><td>down</td><td>1.30%</td><td>0.97949</td><td>down</td><td>1.17%</td><td>0.000</td><td>0.000</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>Average</td><td>1.975</td></tr></table>

- Higher number of simulations improves accuracy:

$$
N = 1 0 \Longrightarrow \hat {c} _ {0} = 1. 9 7 5
$$

$$
N = 1, 0 0 0 \Longrightarrow \hat {c} = 1. 8 3 9
$$

# Monte Carlo Simulations for Path Dependent Securities

- Many securities have payoffs that are path dependent
- The payoff at maturity depends on the whole path taken by interest rates before maturity  
- Examples include

* Asian options: Payoff at maturity depend on average interest rates;  
* Corridor bonds: Pay coupon so long interest rate is within a band;  
* Amortizing Interest Rate Swaps: The notional of IRS depend on path of interest rates:  
* Mortgage Backed Securities: Because of frictions in deciding when to pay back mortgage, payoff depends on path of interest rates (and many other variables)

- The pricing of path dependent securities is easier to perform using Monte Carlo simulations.

# Example: Asian Options

- An Asian interest rate option is an option whose payoff at maturity is given by

$$
\text {P a y o f f} T = \left\{ \begin{array}{l l} \max  (\text {a v e r a g e r a t e f r o m 0 t o} T - r _ {K}, 0) & (\text {A s i a n C a l l}) \\ \max  (r _ {K} - \text {a v e r a g e r a t e f r o m 0 t o} T, 0) & (\text {A s i a n P u t}) \end{array} \right. \tag {27}
$$

- This payoff makes the binomial tree non-recombining, as the payoff from "up-down movement" is different from the payoff from a "down-up movement"  
- Denote by  $\overline{r}_{i,j} = \text{average}(r_k)$  for  $k \leq j$  on the path to  $(i,j)$ .  
- For such short binomial tree we can still compute the value of path-dependent security using backward calculation.

<table><tr><td>i=0</td><td>i=1</td><td>i=2</td></tr><tr><td></td><td>r2,uu = 6.06%
r2,uu = 3.85%</td><td>c2,uu = 1.8495</td></tr><tr><td></td><td>r1,u = 3.75%
r1,u = 2.7%</td><td></td></tr><tr><td></td><td>r2,ud = 3.61%
r2,ud = 3.03%</td><td>c2,ud = 1.0340</td></tr><tr><td>r0=1.74%</td><td></td><td></td></tr><tr><td></td><td>r2,du = 3.61%
r2,ud = 2.22%</td><td>c2,du = 0.2185</td></tr><tr><td></td><td>r1,d = 1.30%
r1,d = 1.52%</td><td></td></tr><tr><td></td><td>r2,dd = 1.17%
r2,ud = 1.40%</td><td>c2,dd = 0</td></tr></table>

$$
i = 0
$$

$$
i = 1
$$

$$
i = 2
$$

$$
c _ {2, u u} = 1. 8 4 9 5
$$

$$
\begin{array}{l} c_{1,u} = e^{-3.75\% /2} \\ \times \left[ \frac {1}{2} \times 1. 8 4 9 5 + \frac {1}{2} \times 1. 0 3 4 0 \right] \\ = 1. 4 1 5 0 \\ \end{array}
$$

$$
c _ {2, u d} = 1. 0 3 4 0
$$

$$
\begin{array}{l} c _ {0} = e ^ {- 1.74 \% / 2} \\ \times \left[ \frac {1}{2} \times 1. 4 1 5 0 + \frac {1}{2} \times 0. 1 0 8 5 \right] \\ = 0. 7 5 5 2 \\ \end{array}
$$

$$
c _ {2, d u} = 0. 2 1 8 5
$$

$$
\begin{array}{l} c_{1,d} = e^{-1.30\% /2} \\ \times \left[ \frac {1}{2} \times 0. 2 1 8 5 + \frac {1}{2} \times 0 \right] \\ = 0. 1 0 8 5 \\ \end{array}
$$

$$
c _ {2, d d} = 0
$$

# Monte Carlo Simulations for Path Dependent Securities

- The tree becomes non-recombining. When we use "big trees", this is a serious problem.
- For instance, for mortgage backed security with monthly payment we need a tree with 360 steps. This implies a tree with  $2^{360} = 2.345E + 108$  nodes by the end of the tree (!).
- MC simulations do not require a backward calculation. Problem solved!  
- In the example above, with 10 simulations, we obtain the following table:

<table><tr><td>Sim Number</td><td>First RAND()</td><td>First Move on the Tree</td><td>Interest Rate Realization at Time i = 1</td><td>Second RAND()</td><td>Second Move on the Tree</td><td>Interest Rate Realization at Time i = 2</td><td>Payoff at Maturity</td><td>Discounted Payoff</td></tr><tr><td>1</td><td>0.468692</td><td>up</td><td>3.75%</td><td>0.513012</td><td>down</td><td>3.61%</td><td>1.034</td><td>1.006</td></tr><tr><td>2</td><td>0.103819</td><td>up</td><td>3.75%</td><td>0.164345</td><td>up</td><td>6.06%</td><td>1.84953</td><td>1.799</td></tr><tr><td>3</td><td>0.848307</td><td>down</td><td>1.30%</td><td>0.340712</td><td>up</td><td>3.61%</td><td>0.21847</td><td>0.215</td></tr><tr><td>4</td><td>0.702089</td><td>down</td><td>1.30%</td><td>0.254097</td><td>up</td><td>3.61%</td><td>0.21847</td><td>0.215</td></tr><tr><td>5</td><td>0.001839</td><td>up</td><td>3.75%</td><td>0.118779</td><td>up</td><td>6.06%</td><td>1.84953</td><td>1.799</td></tr><tr><td>6</td><td>0.444781</td><td>up</td><td>3.75%</td><td>0.241821</td><td>up</td><td>6.06%</td><td>1.84953</td><td>1.799</td></tr><tr><td>7</td><td>0.066274</td><td>up</td><td>3.75%</td><td>0.55081</td><td>down</td><td>3.61%</td><td>1.034</td><td>1.006</td></tr><tr><td>8</td><td>0.386942</td><td>up</td><td>3.75%</td><td>0.765509</td><td>down</td><td>3.61%</td><td>1.034</td><td>1.006</td></tr><tr><td>9</td><td>0.769553</td><td>down</td><td>1.30%</td><td>0.627444</td><td>down</td><td>1.17%</td><td>0</td><td>0.000</td></tr><tr><td>10</td><td>0.888142</td><td>down</td><td>1.30%</td><td>0.97949</td><td>down</td><td>1.17%</td><td>0</td><td>0.000</td></tr></table>

Average: 0.885

# Monte Carlo Simulations with Multi Step Trees

- The approach readily extends to multi-period binomial trees, which is an important extension as it allows us to evaluate relatively complex securities.  
- For instance, in the Ho-Lee model we can simulate directly the tree

$$
r _ {i + 1, j} = r _ {i, j} + \theta_ {i} \times \Delta + \sigma \times \sqrt {\Delta} \quad \text {w i t h R N p r o b a b i l i t y} p ^ {*} = 1 / 2 \tag {28}
$$

$$
r _ {i + 1, j + 1} = r _ {i, j} + \theta_ {i} \times \Delta - \sigma \times \sqrt {\Delta} \quad \text {w i t h R N p r o b a b i l i t y} p ^ {*} = 1 / 2 \tag {29}
$$

<table><tr><td colspan="12">Ho-Lee Binomial Tree</td></tr><tr><td>Time T</td><td>0</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td>Period i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>θi(×100)</td><td>1.5675</td><td>2.1824</td><td>1.4374</td><td>1.7324</td><td>0.7873</td><td>0.0423</td><td>-0.0628</td><td>0.4322</td><td>0.9271</td><td>0.1202</td><td></td></tr><tr><td colspan="12">Panel A: The Ho-Lee Interest Rate Tree</td></tr><tr><td>j</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>0</td><td>1.74</td><td>3.75</td><td>6.06</td><td>8.00</td><td>10.09</td><td>11.71</td><td>12.95</td><td>14.15</td><td>15.59</td><td>17.27</td><td>18.56</td></tr><tr><td>1</td><td></td><td>1.30</td><td>3.61</td><td>5.56</td><td>7.65</td><td>9.26</td><td>10.51</td><td>11.70</td><td>13.14</td><td>14.83</td><td>16.11</td></tr><tr><td>2</td><td></td><td></td><td>1.17</td><td>3.11</td><td>5.20</td><td>6.82</td><td>8.06</td><td>9.25</td><td>10.69</td><td>12.38</td><td>13.66</td></tr><tr><td>3</td><td></td><td></td><td></td><td>0.66</td><td>2.75</td><td>4.37</td><td>5.61</td><td>6.81</td><td>8.25</td><td>9.93</td><td>11.22</td></tr><tr><td>4</td><td></td><td></td><td></td><td></td><td>0.31</td><td>1.92</td><td>3.17</td><td>4.36</td><td>5.80</td><td>7.49</td><td>8.77</td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td></td><td>-0.52</td><td>0.72</td><td>1.91</td><td>3.35</td><td>5.04</td><td>6.32</td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td></td><td>-1.73</td><td>-0.53</td><td>0.91</td><td>2.59</td><td>3.88</td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-2.98</td><td>-1.54</td><td>0.15</td><td>1.43</td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-3.99</td><td>-2.30</td><td>-1.02</td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-4.75</td><td>-3.46</td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>-5.91</td></tr><tr><td colspan="12">Simulations on Ho-Lee Binomial Tree</td></tr><tr><td>Time T</td><td>0</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td>Period i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td colspan="12">Panel B: Ten Simulated Paths of Ho-Lee Tree</td></tr><tr><td colspan="12">——Period i——</td></tr><tr><td>Simulation</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>1</td><td>1.74</td><td>1.30</td><td>3.61</td><td>5.56</td><td>5.20</td><td>6.82</td><td>8.06</td><td>6.81</td><td>8.25</td><td>7.49</td><td>6.32</td></tr><tr><td>2</td><td>1.74</td><td>3.75</td><td>3.61</td><td>3.11</td><td>2.75</td><td>4.37</td><td>5.61</td><td>6.81</td><td>5.80</td><td>5.04</td><td>3.88</td></tr><tr><td>3</td><td>1.74</td><td>3.75</td><td>3.61</td><td>3.11</td><td>5.20</td><td>6.82</td><td>8.06</td><td>9.25</td><td>8.25</td><td>9.93</td><td>8.77</td></tr><tr><td>4</td><td>1.74</td><td>3.75</td><td>6.06</td><td>5.56</td><td>7.65</td><td>9.26</td><td>8.06</td><td>6.81</td><td>8.25</td><td>7.49</td><td>8.77</td></tr><tr><td>5</td><td>1.74</td><td>1.30</td><td>3.61</td><td>3.11</td><td>5.20</td><td>6.82</td><td>5.61</td><td>6.81</td><td>5.80</td><td>7.49</td><td>6.32</td></tr><tr><td>6</td><td>1.74</td><td>1.30</td><td>3.61</td><td>3.11</td><td>5.20</td><td>4.37</td><td>5.61</td><td>6.81</td><td>5.80</td><td>7.49</td><td>6.32</td></tr><tr><td>7</td><td>1.74</td><td>1.30</td><td>3.61</td><td>5.56</td><td>5.20</td><td>4.37</td><td>3.17</td><td>4.36</td><td>3.35</td><td>2.59</td><td>1.43</td></tr><tr><td>8</td><td>1.74</td><td>1.30</td><td>1.17</td><td>0.66</td><td>2.75</td><td>1.92</td><td>0.72</td><td>1.91</td><td>3.35</td><td>5.04</td><td>3.88</td></tr><tr><td>9</td><td>1.74</td><td>3.75</td><td>3.61</td><td>3.11</td><td>5.20</td><td>6.82</td><td>8.06</td><td>6.81</td><td>5.80</td><td>7.49</td><td>8.77</td></tr><tr><td>10</td><td>1.74</td><td>3.75</td><td>6.06</td><td>8.00</td><td>10.09</td><td>9.26</td><td>8.06</td><td>9.25</td><td>10.69</td><td>12.38</td><td>11.22</td></tr></table>

# Ho-Lee Binomial Tree: Simulated Discounts

- For each simulated path  $r_0, r_1^s, r_2^s, \ldots, r_{k-1}^s$ , compute the simulated zero with maturity  $T_k$  as

$$
Z ^ {s} (0, T _ {k}) = e ^ {- \sum_ {i = 1} ^ {k - 1} r _ {i} ^ {s} \Delta t}
$$

<table><tr><td>Time T</td><td>0</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td>Period i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr></table>

Panel C: Ten Simulated Discounts  $Z^{s}(0,T_{i})$  

<table><tr><td>Simulation</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td><td>5.5</td></tr><tr><td>1</td><td>0.9913</td><td>0.9849</td><td>0.9673</td><td>0.9408</td><td>0.9166</td><td>0.8859</td><td>0.8509</td><td>0.8224</td><td>0.7892</td><td>0.7602</td><td>0.7366</td></tr><tr><td>2</td><td>0.9913</td><td>0.9729</td><td>0.9555</td><td>0.9408</td><td>0.9279</td><td>0.9078</td><td>0.8827</td><td>0.8532</td><td>0.8288</td><td>0.8082</td><td>0.7927</td></tr><tr><td>3</td><td>0.9913</td><td>0.9729</td><td>0.9555</td><td>0.9408</td><td>0.9166</td><td>0.8859</td><td>0.8509</td><td>0.8124</td><td>0.7796</td><td>0.7418</td><td>0.7100</td></tr><tr><td>4</td><td>0.9913</td><td>0.9729</td><td>0.9439</td><td>0.9180</td><td>0.8836</td><td>0.8436</td><td>0.8103</td><td>0.7832</td><td>0.7515</td><td>0.7239</td><td>0.6929</td></tr><tr><td>5</td><td>0.9913</td><td>0.9849</td><td>0.9673</td><td>0.9523</td><td>0.9279</td><td>0.8968</td><td>0.8720</td><td>0.8428</td><td>0.8187</td><td>0.7886</td><td>0.7641</td></tr><tr><td>6</td><td>0.9913</td><td>0.9849</td><td>0.9673</td><td>0.9523</td><td>0.9279</td><td>0.9078</td><td>0.8827</td><td>0.8532</td><td>0.8288</td><td>0.7983</td><td>0.7735</td></tr><tr><td>7</td><td>0.9913</td><td>0.9849</td><td>0.9673</td><td>0.9408</td><td>0.9166</td><td>0.8968</td><td>0.8827</td><td>0.8637</td><td>0.8493</td><td>0.8384</td><td>0.8324</td></tr><tr><td>8</td><td>0.9913</td><td>0.9849</td><td>0.9792</td><td>0.9759</td><td>0.9626</td><td>0.9534</td><td>0.9499</td><td>0.9409</td><td>0.9253</td><td>0.9022</td><td>0.8849</td></tr><tr><td>9</td><td>0.9913</td><td>0.9729</td><td>0.9555</td><td>0.9408</td><td>0.9166</td><td>0.8859</td><td>0.8509</td><td>0.8224</td><td>0.7989</td><td>0.7696</td><td>0.7366</td></tr><tr><td>10</td><td>0.9913</td><td>0.9729</td><td>0.9439</td><td>0.9069</td><td>0.8622</td><td>0.8232</td><td>0.7907</td><td>0.7549</td><td>0.7156</td><td>0.6727</td><td>0.6360</td></tr></table>

# Simulated Ho-Lee Binomial Tree: Valuation of Zero-Coupon Bonds

- The simulated value of a zero coupon bond is the average across simulated discounts

$$
\widehat {Z} (0, T _ {k}) = \frac {1}{N} \sum_ {s = 1} ^ {N} Z ^ {s} (0, T _ {k})
$$

- The simulated values with  $N = 1000$  are reported in the next table, together with the data used to fit the Ho-Lee tree model

<table><tr><td>Maturity</td><td>Data</td><td>Simulated Zeros</td></tr><tr><td>0.5</td><td>99.1338</td><td>99.1338</td></tr><tr><td>1.0</td><td>97.8925</td><td>97.9140</td></tr><tr><td>1.5</td><td>96.1462</td><td>96.2376</td></tr><tr><td>2.0</td><td>94.1011</td><td>94.3031</td></tr><tr><td>2.5</td><td>91.7136</td><td>92.0217</td></tr><tr><td>3.0</td><td>89.2258</td><td>89.6090</td></tr><tr><td>3.5</td><td>86.8142</td><td>87.2894</td></tr><tr><td>4.0</td><td>84.5016</td><td>85.0911</td></tr><tr><td>4.5</td><td>82.1848</td><td>82.8855</td></tr><tr><td>5.0</td><td>79.7718</td><td>80.5609</td></tr><tr><td>5.5</td><td>77.4339</td><td>78.3302</td></tr></table>

# Simulated Ho-Lee Binomial Tree: Valuation of an Interest Rate Option

- The same valuation methodology can be used to price long-term options, such as one paying at  $i = 1,\ldots ,{10}$

$$
\text {P a y o f f} i = 1 0 0 \times \max  \left(r _ {i} - r _ {K}, 0\right)
$$

- Risk neutral pricing implies that the price of this option is given by

$$
c _ {0} \left(T _ {i}\right) = E ^ {*} [ \text {P r e s e n t v a l u e o f p a y o f f a t} T _ {i} ] \tag {30}
$$

$$
= E ^ {*} \left[ e ^ {- (r _ {0} + r _ {1} + \dots + r _ {i - 1}) \times \Delta} \times 1 0 0 \times \max  (r _ {i} - r _ {K}, 0) \right] \tag {31}
$$

- For each simulation path  $s$ ,  $r_0, r_1^s, r_2^s, \ldots, r_n^s$ ,  $s = 1, \ldots, N$ , we compute the discounted payoff

$$
\begin{array}{l} c _ {0} ^ {s} (T _ {i}) = e ^ {- \left(r _ {0} + r _ {1} ^ {s} + r _ {2} ^ {s} + \dots + r _ {i - 1} ^ {s}\right) \times \Delta} \times 1 0 0 \times \max  \left(r _ {i} ^ {s} - r _ {K}, 0\right) \\ = Z ^ {s} (0, T _ {i}) \times \times 1 0 0 \times \max (r _ {i} ^ {s} - r _ {K}, 0) \tag {32} \\ \end{array}
$$

where we used  $Z^{s}(0,T_{i}) = e^{-\left(r_{0} + r_{1}^{s} + r_{2}^{s} + \ldots +r_{i - 1}^{s}\right)\times \Delta}$  

- Today's value of the option with maturity  $T_{i}$  is then given by the average of  $c_0^s (T_i)$

$$
\hat {c} _ {0} (T _ {i}) = \frac {1}{N} \sum_ {s = 1} ^ {N} c _ {0} ^ {s} (T _ {i}) \tag {33}
$$

- Panel A of next table reports the value of interest rate options with maturity from  $T_{i} = 0.5$  to  $T_{i} = 5$  and for a strike rate  $r_{K} = 1.74\%$ .  
- Panel B of next table shows the results of the first ten simulated discounted payoffs in (32).
- For instance, the first element of the first row is given by

$$
c _ {0} ^ {1} (0. 5) = Z ^ {1} (0, 0. 5) \times 1 0 0 \times \max (r _ {1} ^ {1} - r _ {K}, 0) = 0. 9 9 1 3 \times 1 0 0 \times \max (1. 3 0
$$

where the sequence of the simulated interest rate and discounts are given in Panels B and C of previous table.  

- Similarly, the second entry in the first row is given by

$$
c _ {0} ^ {1} (1) = Z ^ {1} (0, 1) \times 1 0 0 \times \max (r _ {2} ^ {1} - r _ {K}, 0) = 0. 9 8 4 9 \times 1 0 0 \times \max (3. 6 1
$$

- The option values in Panel A are then computed as the average of values in the corresponding column in Panel B
- (although the average is taken over all the 1,000 simulated paths, rather than only the ten paths reported in Panel B).

<table><tr><td></td><td colspan="9">Panel A: Simulated Interest Rate Call Options —— Maturity \(T_i\) ——</td></tr><tr><td></td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td></tr><tr><td></td><td>0.9650</td><td>1.8857</td><td>2.4959</td><td>3.1892</td><td>3.4691</td><td>3.4134</td><td>3.2866</td><td>3.4007</td><td>3.6378</td></tr><tr><td></td><td colspan="9">Panel B: Ten Simulated Discounted Payoffs —— Maturity \(T_i\) ——</td></tr><tr><td>Simulation</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td></tr><tr><td>1</td><td>0.00</td><td>1.85</td><td>3.69</td><td>3.25</td><td>4.65</td><td>5.60</td><td>4.31</td><td>5.35</td><td>4.53</td></tr><tr><td>2</td><td>1.99</td><td>1.82</td><td>1.31</td><td>0.95</td><td>2.44</td><td>3.52</td><td>4.47</td><td>3.46</td><td>2.73</td></tr><tr><td>3</td><td>1.99</td><td>1.82</td><td>1.31</td><td>3.25</td><td>4.65</td><td>5.60</td><td>6.39</td><td>5.29</td><td>6.39</td></tr><tr><td>4</td><td>1.99</td><td>4.20</td><td>3.60</td><td>5.42</td><td>6.65</td><td>5.33</td><td>4.11</td><td>5.10</td><td>4.32</td></tr><tr><td>5</td><td>0.00</td><td>1.85</td><td>1.33</td><td>3.29</td><td>4.71</td><td>3.47</td><td>4.42</td><td>3.42</td><td>4.70</td></tr><tr><td>6</td><td>0.00</td><td>1.85</td><td>1.33</td><td>3.29</td><td>2.44</td><td>3.52</td><td>4.47</td><td>3.46</td><td>4.76</td></tr><tr><td>7</td><td>0.00</td><td>1.85</td><td>3.69</td><td>3.25</td><td>2.41</td><td>1.28</td><td>2.31</td><td>1.39</td><td>0.72</td></tr><tr><td>8</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.99</td><td>0.18</td><td>0.00</td><td>0.16</td><td>1.52</td><td>3.05</td></tr><tr><td>9</td><td>1.99</td><td>1.82</td><td>1.31</td><td>3.25</td><td>4.65</td><td>5.60</td><td>4.31</td><td>3.34</td><td>4.59</td></tr><tr><td>10</td><td>1.99</td><td>4.20</td><td>5.91</td><td>7.58</td><td>6.49</td><td>5.20</td><td>5.94</td><td>6.76</td><td>7.61</td></tr></table>

# How Many Simulations are Enough?

- A price of a security computed by Monte Carlo Simulations is an estimate of the true price. - Using simulations we are generating a sample of observations of the price of the security  
- Because it is an estimate, we can compute the price's standard error.

$$
\mathrm {S t a n d a r d e r r o r} = \frac {\mathrm {S t a n d a r d d e v i a t i o n o f} \{c _ {0} ^ {1} , c _ {0} ^ {2} , c _ {0} ^ {3} , \ldots , c _ {0} ^ {N} \}}{\sqrt {N}}
$$

- For instance, the first two rows in next Table reports the prices (again) and standard errors of the long-term interest call options discussed earlier.

<table><tr><td rowspan="2"></td><td colspan="10">Maturity Ti</td></tr><tr><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td>Price</td><td>0.9650</td><td>1.8857</td><td>2.4959</td><td>3.1892</td><td>3.4691</td><td>3.4134</td><td>3.2866</td><td>3.4007</td><td>3.6378</td><td>3.5060</td></tr><tr><td>Standard Errors</td><td>0.0315</td><td>0.0464</td><td>0.0562</td><td>0.0639</td><td>0.0708</td><td>0.0715</td><td>0.0751</td><td>0.0737</td><td>0.0758</td><td>0.0745</td></tr><tr><td>Upper C.I.</td><td>1.0279</td><td>1.9784</td><td>2.6083</td><td>3.3170</td><td>3.6107</td><td>3.5563</td><td>3.4368</td><td>3.5482</td><td>3.7893</td><td>3.6550</td></tr><tr><td>Lower C.I.</td><td>0.9021</td><td>1.7930</td><td>2.3835</td><td>3.0613</td><td>3.3274</td><td>3.2705</td><td>3.1363</td><td>3.2532</td><td>3.4862</td><td>3.3569</td></tr><tr><td>True Price (Tree)</td><td>1.000</td><td>1.976</td><td>2.612</td><td>3.309</td><td>3.542</td><td>3.507</td><td>3.361</td><td>3.463</td><td>3.687</td><td>3.596</td></tr></table>

# Monte Carlo Simulations and Confidence Intervals

- How small should a standard error be to make a trader confident on the price of the option?  
- The related concept of a (95%) confidence interval answers this question:

$$
\text {C o n f i d e n c e} = \left[ \hat {c} _ {0} - 2 \times \text {S t . E r r .}, \hat {c} _ {0} + 2 \times \text {S t . E r r .} \right]
$$

- There  $95\%$  probability that the true value  $c_{0}$  is between the upper and lower boundary of the confidence interval.
- In previous Table, the upper and lower boundaries of the confidence interval are reported in the third and fourth rows, respectively.  
- The last row of the table reports the value of the option from the Binomial Tree itself.
- In all but one case, the true price is within the confidence interval.  
- Is this surprising?

* No, because there is only 95% chance that the true value lies within the confidence interval.  
* l.e. for 5% of the time, the true value will not be within the confidence interval.

- The confidence intervals in the Table are quite wide, and so no trader would use them.  
- Raising the number of simulations reduces the spread in the confidence interval.

# Long-term Asian Options

- At this point, we can estimate the values of a long-term Asian options with maturities  $T_{i} = 0.5,\ldots ,5$  
- Next table computes the value (Panel A), and the first 10 simulated discounted payoffs (Panel B).

<table><tr><td rowspan="2"></td><td colspan="10">Panel A: Simulated Interest Rate Asian Call Options</td></tr><tr><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td>price</td><td>0.4825</td><td>0.9079</td><td>1.2579</td><td>1.6022</td><td>1.8616</td><td>2.0189</td><td>2.1100</td><td>2.1750</td><td>2.2386</td><td>2.2647</td></tr><tr><td>standard errors</td><td>0.0157</td><td>0.0243</td><td>0.0308</td><td>0.0351</td><td>0.0382</td><td>0.0401</td><td>0.0416</td><td>0.0424</td><td>0.0428</td><td>0.0426</td></tr><tr><td>Upper C.I.</td><td>0.5140</td><td>0.9566</td><td>1.3194</td><td>1.6723</td><td>1.9380</td><td>2.0991</td><td>2.1932</td><td>2.2598</td><td>2.3242</td><td>2.3500</td></tr><tr><td>Lower C.I.</td><td>0.4510</td><td>0.8592</td><td>1.1964</td><td>1.5320</td><td>1.7851</td><td>1.9386</td><td>2.0269</td><td>2.0902</td><td>2.1529</td><td>2.1794</td></tr><tr><td colspan="11">Panel B: Ten Simulated Discounted Payoffs</td></tr><tr><td>simulation #</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td>1</td><td>0.00</td><td>0.47</td><td>1.27</td><td>1.64</td><td>2.11</td><td>2.55</td><td>2.68</td><td>2.90</td><td>2.95</td><td>2.90</td></tr><tr><td>2</td><td>0.99</td><td>1.26</td><td>1.25</td><td>1.18</td><td>1.38</td><td>1.66</td><td>1.97</td><td>2.08</td><td>2.09</td><td>2.01</td></tr><tr><td>3</td><td>0.99</td><td>1.26</td><td>1.25</td><td>1.64</td><td>2.11</td><td>2.55</td><td>2.94</td><td>3.08</td><td>3.30</td><td>3.33</td></tr><tr><td>4</td><td>0.99</td><td>2.05</td><td>2.39</td><td>2.95</td><td>3.47</td><td>3.60</td><td>3.54</td><td>3.61</td><td>3.55</td><td>3.57</td></tr><tr><td>5</td><td>0.00</td><td>0.47</td><td>0.68</td><td>1.19</td><td>1.75</td><td>1.95</td><td>2.21</td><td>2.28</td><td>2.46</td><td>2.49</td></tr><tr><td>6</td><td>0.00</td><td>0.47</td><td>0.68</td><td>1.19</td><td>1.38</td><td>1.66</td><td>1.97</td><td>2.08</td><td>2.29</td><td>2.34</td></tr><tr><td>7</td><td>0.00</td><td>0.47</td><td>1.27</td><td>1.64</td><td>1.73</td><td>1.64</td><td>1.70</td><td>1.63</td><td>1.52</td><td>1.34</td></tr><tr><td>8</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.29</td><td>0.44</td></tr><tr><td>9</td><td>0.99</td><td>1.26</td><td>1.25</td><td>1.64</td><td>2.11</td><td>2.55</td><td>2.68</td><td>2.67</td><td>2.79</td><td>2.94</td></tr><tr><td>10</td><td>0.99</td><td>2.05</td><td>2.97</td><td>3.80</td><td>4.09</td><td>4.09</td><td>4.18</td><td>4.30</td><td>4.43</td><td>4.36</td></tr></table>

# Duration Calculations by Monte Carlo Simulations

- How can we compute measures of risk if we use Monte Carlo simulations for valuation?
- We can use Monte Carlo simulations to compute the "spot rate" duration, defined as

$$
\text {S p o t r a t e d u r a t i o n} = - \frac {1}{P} \frac {d P}{d r} \approx - \frac {1}{\widehat {P} \left(r _ {0}\right)} \frac {\widehat {P} \left(r _ {0} + d r\right) - \widehat {P} \left(r _ {0}\right)}{d r} \tag {34}
$$

- That is, compute the price starting from  $r_0$  and from  $r_0 + dr$ . Then approximate the duration numerically.  
- Important: To avoid introducing simulation errors, use the same realizations of the RAND() for the computation of the two prices.
- Does it work?
- Panel A of next Table contains the duration approximation for zero coupon bonds. It works pretty nicely.  
- Panel B and C compute the durations for long-term options and Asian options discussed earlier. Note:

* First, the duration of the interest rate call option is negative.  
* Second, the duration of Asian options is also negative and higher than the one of plain vanilla options.

This may be surprising, as Asian options' underlying (the average of interest rates) is less volatile than the interest rate itself.  

- However, the price of an Asian option is also smaller. Thus, in percentage, the sensitivity of the Asian option to changes in interest rates is higher.

Duration Calculations by Monte Carlo Simulations  

<table><tr><td>Maturity</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td colspan="11">Panel A: Simulated Spot Rate Duration of Zero Coupon Bonds</td></tr><tr><td>\(\widehat{Z}(r_0,T_i)\)</td><td>99.1338</td><td>97.9105</td><td>96.2084</td><td>94.2228</td><td>91.8927</td><td>89.4423</td><td>87.0761</td><td>84.8009</td><td>82.5165</td><td>80.1298</td></tr><tr><td>\(\widehat{Z}(r_0+dr,T_i)\)</td><td>99.1288</td><td>97.9007</td><td>96.1940</td><td>94.2039</td><td>91.8698</td><td>89.4155</td><td>87.0456</td><td>84.7670</td><td>82.4794</td><td>80.0897</td></tr><tr><td>Spot Rate Duration</td><td>0.5000</td><td>1.0000</td><td>1.4999</td><td>1.9998</td><td>2.4997</td><td>2.9996</td><td>3.4994</td><td>3.9992</td><td>4.4990</td><td>4.9988</td></tr><tr><td colspan="11">Panel B: Simulated Spot Rate Duration of Long-Term Call Options</td></tr><tr><td>\(\widehat{c}(r_0)\)</td><td>0.9650</td><td>1.8857</td><td>2.4959</td><td>3.1892</td><td>3.4691</td><td>3.4134</td><td>3.2866</td><td>3.4007</td><td>3.6378</td><td>3.5060</td></tr><tr><td>\(\widehat{c}(r_0+dr)\)</td><td>0.9697</td><td>1.8927</td><td>2.5038</td><td>3.1973</td><td>3.4770</td><td>3.4202</td><td>3.2935</td><td>3.4064</td><td>3.6434</td><td>3.5107</td></tr><tr><td>Spot Rate Duration</td><td>-49.3222</td><td>-37.1823</td><td>-31.5883</td><td>-25.4278</td><td>-22.9155</td><td>-19.8689</td><td>-21.0933</td><td>-16.8563</td><td>-15.5984</td><td>-13.4163</td></tr><tr><td colspan="11">Panel C: Simulated Spot Rate Duration of Asian Call Options</td></tr><tr><td>\(\widehat{c}^A(r_0)\)</td><td>0.4825</td><td>0.9079</td><td>1.2579</td><td>1.6022</td><td>1.8616</td><td>2.0189</td><td>2.1100</td><td>2.1750</td><td>2.2386</td><td>2.2647</td></tr><tr><td>\(\widehat{c}(r_0+dr)\)</td><td>0.4873</td><td>0.9150</td><td>1.2659</td><td>1.6099</td><td>1.8693</td><td>2.0264</td><td>2.1171</td><td>2.1816</td><td>2.2450</td><td>2.2708</td></tr><tr><td>Spot Rate Duration</td><td>-99.1445</td><td>-78.3049</td><td>-64.1551</td><td>-48.3325</td><td>-41.7412</td><td>-37.4040</td><td>-33.7344</td><td>-30.3088</td><td>-28.5699</td><td>-26.9281</td></tr></table>

# Monte Carlo Simulations in General

- The Monte Carlo simulation method is far more general than what I presented so far.  
- For instance, the Ho-Lee model also works with "continuous" shocks

$$
r _ {t + \Delta t} = r _ {t} + \theta_ {t} \Delta t + \sigma \sqrt {\Delta t} \varepsilon_ {t + \delta}
$$

- where  $\Delta t$  is a small interval of time, and

$$
\varepsilon_ {t + \Delta t} \sim N (0, 1)
$$

- More generally, we can have

$$
r _ {t + \Delta t} = r _ {t} + \mu (r _ {t}) \Delta t + \sigma (r _ {t}) \sqrt {\Delta t} \varepsilon_ {t + \delta}
$$

- for some function  $\mu(r_{t})$  and  $\sigma(r_{t})$ .
- Important: The functions  $\mu(r_{t})$  and  $\sigma(r_{t})$  must be estimated with securities data, to obtain "risk neutral" (or risk adjusted) processes.  
- The methodology is an extension of what we did to estimate  $\theta_{i}$  with Ho-Lee model on trees.
- The price of a security with payoff  $g(r_{T})$  at maturity  $T$ , with a time interval  $\Delta t = T / n$ , is

$$
Z (0, T) = E ^ {*} \left[ e ^ {- \sum_ {j = 0} ^ {n - 1} r _ {j} \Delta t} \times g (r _ {T}) \right] \approx \frac {1}{N} \sum_ {s = 1} ^ {N} \left[ e ^ {- \sum_ {j = 0} ^ {n - 1} r _ {j} ^ {s} \Delta t} \times g (r _ {T} ^ {s}) \right]
$$

# Teaching Note 6

Mortgage Backed Securities<sup>1</sup> John Heaton

The University of Chicago

Booth School of Business

NBER

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/5c2fa25ea2a0e025c329a7e2298d185cfb3f4daec58b37afd3bc458c88ba46c1.jpg)  
Panel A. Billions of US Dollars

Panel B. Percentage of US GDP  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/b6ecb4ac01bf4595aa840788fb3138d6b14a8be29f3f4e4bbe1c7c33dc7a57b0.jpg)  
(Source: SIFMA and FRED at Federal Reserve of St. Louis.)

House Prices and the Mortgage Backed Securities Market  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f4dd117a177b68e4f5b4657caf4edb73b5f7d1db8c3602a9e99eb0fc6444309e.jpg)  
Source: SIFMA and Standard & Poor / Case-Shiller.

# The Securitization Process

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/3710da6f85146804be05bd269d19fc5547e20e1be65b78073631a0896a497043.jpg)

# MBS Players

- Three main government sponsored agencies exist:
- FNMA (Federal National Mortgage Association, or Fannie Mae): Used to be a publicly traded corporation, but it was placed in conservatorship in September 2008. It provides secondary markets for mortgage loans from FHA (Federal Housing Administration) and VA (Veterans Administration).  
- GNMA (Government National Mortgage Association, or Ginnie Mae): Government owned. GNMA guarantees loans in FHA and VA.  
- FHLMC (Federal Home Loan Mortgage Corporation, or Freddie Mac): Similarly to Fannie Mae, it provides a link between mortgage lenders and capital markets. It buys from S&ls, mortgage bankers and commercial banks, and sell mortgage pass-through securities.
- In addition, other private labels also exist, although in recent times they cover a small fraction of the total issuance, because of credit risk  
- There are some differences across the agencies on the type of mortgage pools they guarantee or buy/sell.  
- The most common MBS is the Pass-Through MBS: all the cash flows from the original pool are passed to the investors.
- Pass through MBSs have their own interest rate  $r^{PT}$ , lower than the average mortgage rate in the pool as agencies keep a fee for arranging the MBS market (and provide default insurance)

Mortgage Related Issuance  

<table><tr><td>Year</td><td>Agency</td><td>Nonagency</td><td>Total</td><td>Agency Share</td><td>Nonagency Share</td></tr><tr><td>1996</td><td>444.1</td><td>85.9</td><td>530.0</td><td>83.79%</td><td>16.21%</td></tr><tr><td>1997</td><td>544.5</td><td>133.7</td><td>678.2</td><td>80.28%</td><td>19.72%</td></tr><tr><td>1998</td><td>954.9</td><td>228.5</td><td>1,183.4</td><td>80.69%</td><td>19.31%</td></tr><tr><td>1999</td><td>887.1</td><td>181.8</td><td>1,068.9</td><td>82.99%</td><td>17.01%</td></tr><tr><td>2000</td><td>583.3</td><td>144.6</td><td>727.9</td><td>80.14%</td><td>19.86%</td></tr><tr><td>2001</td><td>1,480.4</td><td>268.6</td><td>1,749.0</td><td>84.64%</td><td>15.36%</td></tr><tr><td>2002</td><td>2,044.3</td><td>398.9</td><td>2,443.2</td><td>83.67%</td><td>16.33%</td></tr><tr><td>2003</td><td>2,757.2</td><td>572.6</td><td>3,329.8</td><td>82.81%</td><td>17.19%</td></tr><tr><td>2004</td><td>1,393.0</td><td>855.2</td><td>2,248.2</td><td>61.96%</td><td>38.04%</td></tr><tr><td>2005</td><td>1,347.7</td><td>1,186.6</td><td>2,534.3</td><td>53.18%</td><td>46.82%</td></tr><tr><td>2006</td><td>1,239.1</td><td>1,170.2</td><td>2,409.3</td><td>51.43%</td><td>48.57%</td></tr><tr><td>2007</td><td>1,465.6</td><td>724.0</td><td>2,189.6</td><td>66.93%</td><td>33.07%</td></tr><tr><td>2008</td><td>1,366.8</td><td>52.6</td><td>1,419.4</td><td>96.29%</td><td>3.71%</td></tr><tr><td>2009</td><td>2,022.9</td><td>71.2</td><td>2,094.2</td><td>96.60%</td><td>3.40%</td></tr><tr><td>2010</td><td>1,919.9</td><td>34.2</td><td>1,954.1</td><td>98.25%</td><td>1.75%</td></tr><tr><td>2011</td><td>1,630.0</td><td>36.2</td><td>1,666.2</td><td>97.83%</td><td>2.17%</td></tr><tr><td>2012</td><td>2,082.0</td><td>27.5</td><td>2,109.5</td><td>98.70%</td><td>1.30%</td></tr><tr><td>2013</td><td>1,953.7</td><td>45.3</td><td>1,999.0</td><td>97.73%</td><td>2.27%</td></tr><tr><td>2014</td><td>1,191.6</td><td>54.8</td><td>1,246.4</td><td>95.60%</td><td>4.40%</td></tr><tr><td>2015</td><td>1,513.8</td><td>92.5</td><td>1,606.3</td><td>94.24%</td><td>5.76%</td></tr></table>

Notes: Agency issuance includes GNMA, FNMA, and FHLMC mortgage backed securities and CMOs.  
Nonagency issuance includes both private-label RMBS, Resecuritization, and Home Equity Loans.  
Quantities are $ billions.  
Source: SIFMA. Government-Sponsored Enterprises, Thomson Financial, Bloomberg

# Mortgages and the Prepayment Option

It is important to review some basic facts about mortgages  

- Consider for instance a 30-year fixed-rate mortgage, with mortgage rate of  $\overline{r}_{12}^{m}$ .  
- Let  $L$  be the amount of the mortgage lent from the bank to the homeowner.  
- According to the standard present value relation, the periodic coupon  $C$  must then satisfy

$$
L = \sum_ {i = 1} ^ {3 0 \times 1 2} \frac {C}{\left(1 + \frac {r _ {1 2} ^ {m}}{1 2}\right) ^ {i}} = \sum_ {i = 1} ^ {3 0 \times 1 2} C \times A ^ {i} \tag {1}
$$

where

$$
A = \frac {1}{1 + \frac {\bar {r} _ {1 2} ^ {m}}{1 2}} \tag {2}
$$

- The coupon in (1) is then given by

$$
C = \frac {L}{\sum_ {i = 1} ^ {3 0 \times 1 2} A ^ {i}} \tag {3}
$$

- The interest and the principal paid at any time  $t$  are given by:

$$
\text {I n t e r s t} t = I _ {t} = \frac {\bar {r} _ {1 2} ^ {m}}{1 2} \times L _ {t} \tag {4}
$$

$$
\text {P r i n c i p a l} t = L _ {t} ^ {\text {p a i d}} = C - I _ {t} \tag {5}
$$

$$
\text {P r i n c i p a l} t + 1 = L _ {t + 1} = L _ {t} - L _ {t} ^ {\text {p a i d}} \tag {6}
$$

# Scheduled Principal Balance, Scheduled Interest, and Principal Payments

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/a0ebf9922666ee2b524ac3ac5d2f7de27b91e9ec017f61bb67fdfc9758e5933f.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/e4f3e54cc0c1b677dfd1f4fa1cc28432599d8276cdd4cebc8ef766f2e0f0464e.jpg)

# The Refinancing Option

- The value of the mortgage debt changes over time as mortgage rates change:

$$
\text {V a l u e o f m o r t g a g e d e b t} = P (t) = \sum_ {i = 1} ^ {n} \frac {C}{\left(1 + r _ {1 2} ^ {m} (t , T _ {i}) / 1 2\right) ^ {i}}
$$

- where  $n$  is the number of payments left at time  $t$  and  $r_{12}^{m}(t,T_{i})$  are appropriate spot rates, related to the current term structure of mortgage rates.
- At every  $t$ , the homeowner can compare the amount of principal left to pay,  $L_{t}$ , with the market value of his liability to the bank  $P(t)$ .  
- As in any bond,  $P(t)$  increases in value whenever interest rates decline.
- $\Rightarrow$  when interest rates decline,  $P(t)$  may increase to a higher level than  $L_{t}$  
- $\Rightarrow$  optimal to refinance the mortgage.

Refinancing and the Federal Funds Rate: 1990 - 2008  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/4db95e980d87c1aab9427e5064afbab50068a0c149cecdda8378d20c4e6978b1.jpg)  
Source: Federal Reserve and Bloomberg.

# Mortgage Prepayments

- Interest rates declines are but one component of the prepayment, albeit very important.  
- Other reasons include the following

1. Seasonality: (Late) summers are characterized by larger prepayments, because of the relocation seasonality.  
2. Age of mortgage pool: Young (but not too young) mortgage pools tend to be refinanced more heavily.  
3. Family circumstances: Defaults, disasters, or sale of the house.  
4. Housing prices: Higher prices makes it easier to refinance.  
5. Burnout effect: Mortgage pools heavily refinanced in the past tend to be insensitive to interest rates.

- If a mortgage pool has been heavily refinanced in the past, most homeowners that could refinance already did.  
- The only homeowners left in the pool are those who could not refinance.

6. Media effect: The more newspaper talk about refinancing possibilities, the more refinancing actually occurs.

# Standard Measures of Prepayment Speed

- The industry developed some standard measures of prepayments, mainly to have available one number to "characterize" the type of prepayment.  
- Constant Maturity Mortality: It assumes a constant probability  $p$  that the mortgage will be prepaid after the next coupon.

$$
\Pr \left(\text {P r e p a m e n t} t = n \text {m o n t h s f r o m n o w}\right) = (1 - p) ^ {n} p
$$

- The annualized rate, the conditional prepayment rate (CPR) given by:

$$
\Pr \left(\text {S u r v i v a l} t = 1 2\right) = (1 - p) ^ {1 2} = (1 - C P R)
$$

- Thus, the CPR is computed from  $p$  as  $CPR = 1 - (1 - p)^{12}$ .
- PSA Experience The benchmark  $100\%$  PSA (Public Securities Association), makes the following assumptions:

1. CPR = 0.2% of the principal is paid in the first month;  
2. CPR increases by  $0.2\%$  in each of the following 30 months; and  
3. CPR then levels off at  $6\%$  until maturity.

- This measure makes the amount of prepayment depend only on the age of the mortgage pool.  
- By scaling up or down the CPR in the PSA description, we obtain faster or slower speeds of prepayments.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/6b04bce721a6e5e6464bf0c76464c3b3b9899ed73b0d6a358c55a53684ca8bb4.jpg)  
PSA Prepayment Convention

# PSA and MBS Pricing

- A PSA prepayment speed is simply a quoting convention to allow traders to quote RMBS.  
- Indeed, given a PSA speed defines the path for the monthly prepayment probability  $p_t$ .  
- Given the path  $\{p_t\}$ , the MBS cash flows follow. Let  $L_{t}$  be the outstanding principal, then

Mortgage interest payment:  $I_{t} = \frac{r_{12}^{m}}{12}\times L_{t}$  (7)

Scheduled principal:  $Pay_{t}^{scheduled} = C_{t} - I_{t}$  (8)

Principal prepayment:  $Pay_{t}^{prepaid} = p_{t} \times \left(L_{t} - Pay_{t}^{scheduled}\right)$  (9)

Outstanding principal:  $L_{t + 1} = L_t - Pay_t^{scheduled} - Pay_t^{prepaid}$  (10)

Update of scheduled coupon:  $C_{t + 1} = (1 - p_t)\times C_t$  (11)

- Given the dynamics of  $L_{t}$  implicit in PSA, we can compute the path though future cash flows:

Pass-through interest payment:  $I_{t}^{PT} = \frac{r_{12}^{PT}}{12} \times L_{t}$  (12)

Total cash flow:  $CF_{t} = I_{t}^{PT} + Pay_{t}^{scheduled} + Pay_{t}^{prepaid}$  (13)

- The price of the pass-through MBS is then simply:

$$
P ^ {M B S} (0, T) = \sum_ {t = 1} ^ {T} Z (0, t) C F _ {t} \tag {14}
$$

# The Negative Convexity of Mortgage Backed Securities

- When interest rates drop, regular T-bonds increase in a convex manner.  
- However, if prepayment occurs, then Mortgage Backed Securities will move towards principal.  
  - $\Rightarrow$  negative convexity  
- Indeed, MBS is equal to a portfolio with long bond and short call option.  
  - While long bond has positive convexity, the short call has a strong negative convexity.  
- Negative convexity implies a negative loss on average

$$
P ^ {M B S} (t + 1, T) \approx P ^ {M B S} (t, T) + \frac {d P ^ {M B S} (t , T)}{d r} (r (t + 1) - r (t)) + \frac {1}{2} \frac {d ^ {2} P ^ {M B S} (t , T)}{d r ^ {2}} (r (t + 1) - r (t)) ^ {2} + \dots .
$$

- Thus, assuming over a short period  $E\left\lbrack  {r\left( {t + 1}\right)  - r\left( t\right) }\right\rbrack   = 0$  ,we have:

$$
E \left[ \frac {P ^ {M B S} (t + 1 , T) - P ^ {M B S} (t , T)}{P ^ {M B S} (t , T)} \right] \approx \frac {1}{2} C E \left[ (r (t + 1) - r (t)) ^ {2} \right]
$$

- Because  $E\left[\left(r(t + 1) - r(t)\right)^2\right] > 0$ , the negative convexity  $C$  implies an average loss generated by the average variation in interest rates.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/df9b01f84bd1034c06b62d215e39e82d0b8a88bc58e917451511eecb84a1a39b.jpg)  
The Value of a Pass-Through MBS with Respect to the Interest Rate

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f1eba32c8f99b416b20d47be61f86c5cbc4c618cf51c192241fd947610461017.jpg)  
The Convexity of MBS: GNMA 7 Prices and Mortgage Rates

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/2db90d436d66aac17aa3b8d4987b4387d9df954361579c0c34e18c95f94a5cbb.jpg)  
Data source: Bloomberg and Federal Reserve Board.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c6302bed9d068795a73575364565c77fc4ddb0468b9dae157b56072bf533121b.jpg)  
Refinancing Speed and Rates: GNMA 7 PSA and Mortgage Rates

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/a2aa9d2ae6f323e49dee853367e0f147c9592fa364f25210e7ba55d282418cd2.jpg)  
Data source: Bloomberg and Federal Reserve Board.

# A Higher Yield for MBS

# A Sample of Par Value Ginnie Mae Pass-Through Prices and Treasury Yields

Ginnie Mae Pass-Through  
Treasury Constant Maturity Rates  

<table><tr><td>Date</td><td>Ask</td><td>Bid</td><td>Coupon</td><td>WAC</td><td>WAM</td><td>10-Year</td><td>20-Year</td><td>30-Year</td></tr><tr><td>09/26/1997</td><td>100.0313</td><td>100.0000</td><td>7.0</td><td>7.5</td><td>315</td><td>6.08</td><td>6.43</td><td>6.37</td></tr><tr><td>06/12/1998</td><td>100.0313</td><td>100.0000</td><td>6.5</td><td>7.0</td><td>324</td><td>5.43</td><td>5.75</td><td>5.66</td></tr><tr><td>08/07/1998</td><td>100.0000</td><td>99.96875</td><td>6.5</td><td>7.0</td><td>327</td><td>5.40</td><td>5.72</td><td>5.63</td></tr><tr><td>05/05/2006</td><td>100.1250</td><td>100.0938</td><td>6.0</td><td>6.5</td><td>315</td><td>5.12</td><td>5.35</td><td>5.20</td></tr><tr><td>07/28/2006</td><td>99.96875</td><td>99.9375</td><td>6.0</td><td>6.5</td><td>318</td><td>5.00</td><td>5.17</td><td>5.07</td></tr><tr><td>08/17/2007</td><td>100.0938</td><td>100.0625</td><td>6.0</td><td>6.5</td><td>320</td><td>4.68</td><td>5.06</td><td>5.00</td></tr></table>

WAC = Weighted Average Coupon of underlying Pool; WAM = Weighted Average Maturity of underlying Pool.  
Source: Bloomberg and Federal Reserve Board.

- MBS securities pay a higher coupon than similar Treasury securities, even if credit risk is the same
  - Ginnie Mae-issued RMBS have the full backing of the US government.

# RMBS and Interest Rate Risk Management: Example

- Let today be June 8, 2007, and assume we have invested \$300 million in the GNSF 6 pass-through.
- The underlying pool of this pass through has a WAC of  $6.5\%$  and a WAM of 320 months.  
- The pass through has a  $6 \%$ coupon, and it is quoted at bid/ask prices = [99.4375 / 99.40625].
- We want to hedge the risk against an increase in interest rates. How do we compute duration and convexity?
- For instance, simply using the same formulas as for bonds seems wrong. Indeed, two simple formulas are

$$
D = - \frac {1}{P ^ {M B S} (0 , T)} \frac {d P ^ {M B S} (0 , T)}{d r} = \sum_ {i = 1} ^ {n} w _ {i} T _ {i}; \quad \text {a n d} \tag {15}
$$

$$
C = \frac {1}{P ^ {M B S} (0 , T)} \frac {d ^ {2} P ^ {M B S} (0 , T)}{d r ^ {2}} = \sum_ {i = 1} ^ {n} w _ {i} T _ {i} ^ {2} \tag {16}
$$

where

$$
w _ {i} = \frac {C F _ {T _ {i}} Z (0 , T _ {i})}{P ^ {M B S} (0 , T)}
$$

- This calculation yields  $D = 4.39$  and  $C = 36.1590$ .
- Where is the negative convexity?

# RMBS and Interest Rate Risk Management: PSA-adjusted Effective Duration

- The earlier computations does not take into account that PSA speed, and thus CFs, change with the interest rate.  
- The PSA-adjusted Effective Duration corrects for this.  
- How can we forecast the change in PSA speed for given interest rate?
- SIFMA survey forecasts provide a simple way

# Mortgage Prepayment Projection

GNMA I 30 Y

Participating dealers: BS CITI CTW GC GS JPM LB ML MS UBS

Yield Curve Scenarios

Avg -300 Avg -200 Avg -100 Avg -50 Avg Base  $\mathrm{Avg} + 50$ $\mathrm{Avg} + 100$ $\mathrm{Avg} + 200$ $\mathrm{Avg} + 300$

983 854 508 312 225 179 156 130 116

Source: SIFMA.

# RMBS and IRRM: PSA-adjusted Effective Duration and Convexity

- We can use these projections to adjust the cash flows.  
- Using for instance a 50bps increase / decrease, we obtain

$$
D \approx - \frac {1}{P} \frac {P (+ 5 0 b p s) - P (- 5 0 b p s)}{2 \times 5 0 b p s} = - \frac {1}{9 9 . 4 3} \frac {9 6 . 7 9 - 1 0 1 . 4 3}{2 \times 5 0 b p s} = 4. 6 8
$$

$$
C \approx \frac {1}{P} \frac {P (+ 5 0 b p s) + P (- 5 0 b p s) - 2 \times P}{(5 0 b p s) ^ {2}} = \frac {1}{9 9 . 4 3} \frac {9 6 . 7 9 + 1 0 1 . 4 3 - 2 \times 9 9 . 4 3}{(5 0 b p s) ^ {2}} = - 2 5 1. 0 8
$$

- Using instead a 100bps increase / decrease, we obtain

$$
D \approx - \frac {1}{P} \frac {P (+ 1 0 0 b p s) - P (- 1 0 0 b p s)}{2 \times 1 0 0 b p s} = - \frac {1}{9 9 . 4 3} \frac {9 4 . 0 0 - 1 0 2 . 2 4}{2 \times 1 0 0 b p s} = 4. 1 4
$$

$$
C \approx \frac {1}{P} \frac {P (+ 1 0 0 b p s) + P (- 1 0 0 b p s) - 2 \times P}{(1 0 0 b p s) ^ {2}} = \frac {1}{9 9 . 4 3} \frac {9 4 . 0 0 + 1 0 2 . 2 4 - 2 \times 9 9 . 4 3}{(1 0 0 b p s) ^ {2}} = - 2 6 2. 6 3
$$

- These numbers for convexity are much more in line with the intuition that cash flows increase when interest rate decline, because of the prepayment option.

# RMBS and IRRM: Empirical Duration and Convexity

- A third methodology is to use past data to inform about the sensitivity of MBS to changes to interest rates.  
- This methodology can be particularly useful as we can check the relation between MBS prices and the relevant interest rate for hedging.  
- Indeed, given the liquidity of the OTC swap market, interest rate swaps are typically the preferred derivative instrument to hedge against changes in interest rates
- Next figures show the relation between GNMA prices, and the 5-year swap rate.  
- Using these data, and denoting  $c_{t}(5)$  the 5-year swap rate at  $t$ , we can also estimate a (simple) polynomial regression

$$
P _ {t} = \alpha + \sum_ {i = 1} ^ {4} \beta_ {i} \times c _ {t} (5) ^ {i} + \epsilon_ {t}
$$

- Given the estimates, we can easily compute  $\frac{dP}{dr}$  and  $\frac{d^2P}{dr^2}$ , obtaining then

$$
\text {E m p i r i c a l D u r a t i o n} = - \frac {1}{P} \frac {d P}{d c (5)} = \frac {4 4 4 . 6 6}{9 9 . 4 2 1 9} = 4. 4 7 2 5 \tag {17}
$$

$$
\text {E m p i r i c a l C o n v e x i t y} = \frac {1}{P} \frac {d ^ {2} P}{d c (5) ^ {2}} = \frac {- 1 4 7 3 1 . 4}{9 9 . 4 2 1 9} = - 1 4 8. 1 7 \tag {18}
$$

- Given  $D$  and  $C$ , hedging can then be achieved using the same methodologies as before.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/177956d7e77e30b60bd4a0fa34241d761dca0f4c0faba5966d50df90dd98448c.jpg)  
GNSF 6 Price and the 5-Year Swap Rate

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/effa1e927df76695e6615c141b8fe261f3bbf915551b52b8566d94692295c919.jpg)  
Data Source: Bloomberg.

# Pricing Prepayment Option on Binomial Trees

- Mortgages have an implicit American option. We can use Binomial Trees to evaluate its fair value.  
- This is the first step to compute the fair value of Mortgage Backed Securities using no-arbitrage methods  
- Example: consider the simple case with annual rather than monthly payments.

Suppose that interest rate tree is the following:

$$
i = 0
$$

$$
i = 1
$$

$$
i = 2
$$

$$
i = 3
$$

$$
r _ {3, u u u} = 0. 0 9 8 2
$$

$$
r _ {2, u u} = 0. 0 8 4 8
$$

$$
\begin{array}{l} r _ {3, u u d} \\ r _ {3, u d u} \end{array} = 0. 0 6 6 6
$$

$$
r _ {0} = 0. 0 1 6 8
$$

$$
r _ {2, u d} = 0. 0 5 0 5
$$

$$
\begin{array}{l} r _ {3, u d d} \\ r _ {3, d d u} \end{array} = 0. 0 4 7 6
$$

$$
r _ {1, d} = 0. 0 1 6 4
$$

$$
r _ {2, d d} = 0. 0 1 6 2
$$

$$
r _ {3, d d d} = 0. 0 1 6 0
$$

- Consider a 10,000 mortgage with 4 years to maturity, and mortgage rate  $\bar{r}^m = 0.372$  (annually compounded).  
- We need to compute the principal amounts left after each coupon payment.  
- What is the annual coupon?
- Need to solve

$$
1 0, 0 0 0 = \sum_ {i = 1} ^ {4} \frac {C}{(1 + \bar {r} ^ {m}) ^ {i}}
$$

- This yields  $C = 2736.7581$ .  
- We then obtain

<table><tr><td colspan="4">Table 3: Mortgage Payments</td></tr><tr><td>Year</td><td>Value</td><td>int pay</td><td>pri/pay</td></tr><tr><td>0</td><td>10000</td><td>372.0212</td><td>2364.737</td></tr><tr><td>1</td><td>7635.263</td><td>284.048</td><td>2452.71</td></tr><tr><td>2</td><td>5182.553</td><td>192.802</td><td>2543.956</td></tr><tr><td>3</td><td>2638.597</td><td>98.16139</td><td>2638.597</td></tr></table>

- We now need to compute the value of the American option implicit in the mortgage.  
- At every payment date, we must compare the net present value of future mortgage payments with the principal remaining.  
- Refinancing occurs when the NPV of future payments is above principal.  
- So, first we compute the NPV of future payments

$$
\begin{array}{l} i = 0 \\ \mathrm {P r i n c i p a l} = 1 0 0 0 0 \\ i = 1 \\ \mathrm {P r i n c i p a l} = 7 6 3 5. 2 6 3 \\ i = 2 \\ \text {P r i n c i p a l} = 5 1 8 2. 5 5 3 \\ i = 3 \\ \mathrm {P r i n c i p a l} = 2 6 3 8. 5 9 7 \\ \end{array}
$$

$$
\begin{array}{l} V _ {3, u u u} = \\ = C e ^ {- r _ {3, u u u}} = 2 4 8 0. 8 4 8 8 \\ \end{array}
$$

$$
\begin{array}{l} V _ {2, u u} = e ^ {- r _ {2, u u}} \times (C + \\ + (V _ {3, u u u} + V _ {3, u u d}) / 2) \\ = 4 8 2 9. 9 9 8 9 \\ \end{array}
$$

$$
\begin{array}{l} V _ {1, u} = e ^ {- r _ {1, u}} \times (C + \\ + \left(V _ {2, u u} + V _ {2, u d}\right) / 2) \\ = 7 2 3 0. 0 5 8 9 \\ \end{array}
$$

$$
\begin{array}{l} V _ {3, u u d} = \\ = C e ^ {- r _ {3, u u d}} = 2 5 6 0. 4 5 7 5 \\ \end{array}
$$

$$
\begin{array}{l} V _ {0} = e ^ {- r _ {0}} \times (C + \\ + \left(V _ {1, u} + V _ {1, d}\right) / 2) \\ = 1 0 0 7 5. 5 0 8 8 \\ \end{array}
$$

$$
\begin{array}{l} V _ {1, d} = e ^ {- r _ {1, d}} \times (C + \\ + \left(V _ {2, d d} + V _ {2, u d}\right) / 2) \\ = 7 7 8 8. 8 3 9 3 \\ \end{array}
$$

$$
\begin{array}{l} V _ {2, u d} = e ^ {- r _ {2, u d}} \times (C \\ + (V _ {3, u u d} + V _ {3, u d d}) / 2) \\ = 5 0 5 9. 7 8 2 6 \\ \end{array}
$$

$$
\begin{array}{l} V _ {3, u d d} = \\ = C e ^ {- r _ {3, u d d}} = 2 6 0 9. 4 9 3 9 \\ \end{array}
$$

$$
\begin{array}{l} V _ {2, d d} = e ^ {- r _ {2, d d}} \times (C + \\ + (V _ {3, d d d} + V _ {3, u d d}) / 2) \\ = 5 3 0 1. 7 5 4 8 \\ \end{array}
$$

$$
\begin{array}{l} V _ {3, d d d} = \\ = C e ^ {- r _ {3, d d d}} = 2 6 9 3. 2 3 0 8 \\ \end{array}
$$

- The net present value of future mortgage payments is 10075.5089.  
 – Notice that the bank has only given them \$10000.  
- However, the bank is selling an American call to the home-owner, which is valued in the next tree  
- (For the sake of simplicity, denote by  $(a,b)^{+} = \max(a,b)$ )  
- From the tree, we see that the value of the mortgage is fair:

Mortgage  $= 10000 =$  NPV(Future CFs) - Prepayment Call

$$
i = 0
$$

Principal = 10000

$$
i = 1
$$

Principal  $= 7635.263$

$$
i = 2
$$

Principal  $= 5182.553$

$$
i = 3
$$

Principal  $= 2638.597$

$$
\begin{array}{l} C A _ {3, u u u} = \\ = \left(V _ {3, u u u} - P _ {3}, 0\right) ^ {+} = 0 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {2, u u} = \left(V _ {2, u u} - P _ {2}, \right. \\ e ^ {- r _ {2, u u} \frac {C A _ {3 , u u u} + C A _ {3 , u u d}}{2}}) ^ {+} \\ = 0 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {1, u} = \left(V _ {1, u} - P _ {1}, \right. \\ e ^ {- r _ {1, u} \frac {C A _ {2 , u u} + C A _ {2 , u d}}{2}}) ^ {+} \\ = 0 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {3, u u d} = \\ = (V _ {3, u u d} - P _ {3}, 0) ^ {+} = 0 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {0} = e ^ {- r _ {0}} \times \\ \times \frac {C A _ {1 , u} + C A _ {1 , d}}{2}) \\ = 7 5. 5 0 8 9 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {1, d} = \left(V _ {1, d} - P _ {1}, \right. \\ e ^ {- r _ {1, d} \frac {C A _ {2 , u d} + C A _ {2 , d d}}{2}}) ^ {+} \\ = 1 5 3. 5 7 6 2 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {2, u d} = (V _ {2, u d} - P _ {2}, \\ \left. e ^ {- r _ {2, u d} \frac {C A _ {3 , u u d} + C A _ {3 , u d d}}{2}}\right) ^ {+} \\ = 0 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {3, u d d} = \\ = (V _ {3, u d d} - P _ {3}, 0) ^ {+} = 0 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {2, d d} = \left(V _ {2, d d} - P _ {2}, \right. \\ \left. e ^ {- r _ {2, d d} \frac {C A _ {3 , u d d} + C A _ {3 , d d d}}{2}}\right) ^ {+} \\ = 1 1 9. 2 0 1 9 \\ \end{array}
$$

$$
\begin{array}{l} C A _ {3, d d d} = \\ = \left(V _ {3, d d d} - P _ {3}, 0\right) ^ {+} = 5 4. 6 3 4 0 \\ \end{array}
$$

# Pricing Pass Through's on Binomial Trees

- We now look at how to value PT securities on a binomial tree  
- The main difference between valuing a PT security and valuing the mortgage in the previous example is that the PT security has a lower interest rate than the coupon rate.
- The lower coupon paid by the issuer of the PT security to investors compared to the average mortgage coupon rate (WAC) is due in part as a compensation for holding default risk and in part as a service fee.
- The following is the same example as earlier, but now we compute the value of a PT security with coupon rate  $r_{PT} = 2\%$ .  
- In the original tree, exercise only occurs at the nodes  $(1, d)$ ,  $(2, dd)$ ,  $(3, ddd)$ .
- At these nodes, the value of the PT security simply equals the outstanding principal.
- Given these cash flows, the computation of the value of the PT security proceeds exactly as any other fixed income security  
- As a sanity check, note that if we use  $r_{PT} = .0372$ , we indeed obtain  $V_0^{PT} = 10000$ .

$i = 0$

Principal  $= 10000$

$i = 1$

Principal  $= 7635.263$

Interest  $= 10000 \times r_{PT}$ .

Sched.  $\mathrm{Prin} = 2364.737$

$i = 2$

Principal  $= 5182.553$

Interest  $= 7635.263 \times r_{PT}$

Sched.  $\operatorname{Prin} = 2452.710$

$i = 3$

Principal  $= 2638.597$

Interest  $= 5182.553 \times r_{PT}$

Sched.  $\operatorname{Prin} = 2543.956$

$i = 4$

Principal  $= 0$

Interest  $= 2638.597\times r_{PT}$

Sched.  $\mathrm{Prin} = 2638.597$

$$
\begin{array}{l} V _ {3, u u u} ^ {P T} \\ = e ^ {- r _ {3, u u u}} \times \\ (2 6 3 8. 5 9 7 \times r _ {P T} \\ + 2 6 3 8. 5 9 7) \\ = 2 4 3 9. 7 0 4 \\ \end{array}
$$

$$
\begin{array}{l} V _ {2, u u} ^ {P T} = e ^ {- r _ {2, u u}} \times \\ (5 1 8 2. 5 5 3 \times r _ {P T} \\ + 2 5 4 3. 9 5 6 \\ + \left(V _ {3, u u u} ^ {P T} + V _ {3, u u d} ^ {P T}\right) / 2) \\ = 4 7 0 9. 6 8 9 \\ \end{array}
$$

$$
\begin{array}{l} V _ {1, u} ^ {P T} = e ^ {- r _ {1, u}} \times \\ (7 6 3 5. 2 6 3 \times r _ {P T} \\ + 2 4 5 2. 7 1 0 + \\ + (V _ {2, u t} ^ {P U} + V _ {2, u d} ^ {P D}) / 2) \\ = 6 9 9 0. 7 4 6 \\ \end{array}
$$

$$
\begin{array}{l} V _ {3, u u d} ^ {P T} \\ = e ^ {- r _ {3, u u d}} \times \\ (2 6 3 8. 5 9 7 \times r _ {P T} \\ + 2 6 3 8. 5 9 7) \\ = 2 5 1 7. 9 9 2 \\ \end{array}
$$

$$
\begin{array}{l} V _ {0} ^ {P T} = e ^ {- r _ {0}} \times \\ (1 0 0 0 0 \times r _ {P T} \\ + 2 3 6 4. 7 3 7 + \\ + \left(V _ {1, u} ^ {P T} + V _ {1, d} ^ {P T}\right) / 2) \\ = 9 7 1 3. 1 8 2 \\ \end{array}
$$

$$
\begin{array}{l} V _ {1, d} ^ {P T} = 7 6 3 5. 2 6 3 \\ (E x e c i s e \quad n o d e) \\ \end{array}
$$

$$
\begin{array}{l} V _ {2, u d} ^ {P T} = e ^ {- r _ {2, u d}} \times \\ (5 1 8 2. 5 5 3 \times r _ {P T} \\ + 2 5 4 3. 9 5 6 \\ + \left(V _ {3, u u d} ^ {P T} + V _ {3, u d d} ^ {P T}\right) / 2) \\ = 4 9 3 4. 2 5 8 \\ \end{array}
$$

$$
\begin{array}{l} V _ {2, d d} ^ {P T} = 5 1 8 2. 5 5 3 \\ (E x e c i s e \quad n o d e) \\ \end{array}
$$

$$
\begin{array}{l} V _ {3, u d d} ^ {P T} = \\ = e ^ {- r _ {3, u d d}} \times \\ (2 6 3 8. 5 9 7 \times r _ {P T} \\ + 2 6 3 8. 5 9 7) \\ = 2 5 6 6. 2 1 5 \\ \end{array}
$$

$$
\begin{array}{l} V _ {3, d d d} ^ {P T} = 2 6 3 8. 5 9 7 \\ (E x e c i s e \quad n o d e) \\ \end{array}
$$

# Pricing Pass Through's on Binomial Trees

- On a "bigger tree", consider a 5-year mortgage with \(N = \\)100,000\( and semi-annual payments.  
- The semi-annually compounded mortgage rate is  $r_2^m = 7.564\% \Rightarrow C = \$12196$ .  
- Today is January 31, 2000: What is the value of this mortgage? What is the value of a pass-through security on a pool of mortgages with WAC = 7.564% and WAM = 5 years?  
- First, we fit a tree to the current term structure of interest rates

Zero Coupon Bonds and the Simple BDT Model on January 31, 2000  

<table><tr><td colspan="11">Panel A: Term Structure of Interest rates</td></tr><tr><td>Maturity</td><td>0.5</td><td>1</td><td>1.5</td><td>2</td><td>2.5</td><td>3</td><td>3.5</td><td>4</td><td>4.5</td><td>5</td></tr><tr><td>Zero</td><td>97.11</td><td>94.00</td><td>90.86</td><td>87.77</td><td>84.79</td><td>81.94</td><td>79.26</td><td>76.59</td><td>74.14</td><td>71.70</td></tr><tr><td>Yield</td><td>5.86%</td><td>6.19%</td><td>6.39%</td><td>6.52%</td><td>6.60%</td><td>6.64%</td><td>6.64%</td><td>6.67%</td><td>6.65%</td><td>6.65%</td></tr></table>

Panel B: Simple BDT Model  

<table><tr><td>θi</td><td>0.187</td><td>0.069</td><td>0.011</td><td>-0.018</td><td>-0.031</td><td>-0.080</td><td>0.055</td><td>-0.118</td><td>0.057</td><td>-0.103</td><td>0.059</td></tr><tr><td>i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>j</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>0</td><td>5.86%</td><td>7.49%</td><td>9.02%</td><td>10.55%</td><td>12.17%</td><td>13.94%</td><td>15.58%</td><td>18.64%</td><td>20.44%</td><td>24.47%</td><td>27.04%</td></tr><tr><td>1</td><td></td><td>5.53%</td><td>6.66%</td><td>7.79%</td><td>8.99%</td><td>10.30%</td><td>11.51%</td><td>13.77%</td><td>15.10%</td><td>18.07%</td><td>19.97%</td></tr><tr><td>2</td><td></td><td></td><td>4.92%</td><td>5.76%</td><td>6.64%</td><td>7.61%</td><td>8.50%</td><td>10.17%</td><td>11.15%</td><td>13.35%</td><td>14.75%</td></tr><tr><td>3</td><td></td><td></td><td></td><td>4.25%</td><td>4.90%</td><td>5.62%</td><td>6.28%</td><td>7.51%</td><td>8.24%</td><td>9.86%</td><td>10.90%</td></tr><tr><td>4</td><td></td><td></td><td></td><td></td><td>3.62%</td><td>4.15%</td><td>4.64%</td><td>5.55%</td><td>6.08%</td><td>7.28%</td><td>8.05%</td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td></td><td>3.07%</td><td>3.43%</td><td>4.10%</td><td>4.49%</td><td>5.38%</td><td>5.95%</td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td></td><td>2.53%</td><td>3.03%</td><td>3.32%</td><td>3.97%</td><td>4.39%</td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>2.24%</td><td>2.45%</td><td>2.94%</td><td>3.24%</td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>1.81%</td><td>2.17%</td><td>2.40%</td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>1.60%</td><td>1.77%</td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>1.31%</td></tr></table>

- Second, we compute the value of the mortgage and the optimal exercise time

The Mortgage Value without Prepayment Option and the Outstanding Principal  
Panel A: The Mortgage Value without Prepayment Option Tree  

<table><tr><td>i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>j</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>0</td><td>102220</td><td>90816</td><td>80008</td><td>69644</td><td>59617</td><td>49838</td><td>40216</td><td>30550</td><td>20912</td><td>10791</td><td>0</td></tr><tr><td>1</td><td></td><td>95314</td><td>84165</td><td>73363</td><td>62826</td><td>52484</td><td>42263</td><td>32007</td><td>21764</td><td>11142</td><td>0</td></tr><tr><td>2</td><td></td><td></td><td>87420</td><td>76278</td><td>65340</td><td>54552</td><td>43858</td><td>33135</td><td>22419</td><td>11408</td><td>0</td></tr><tr><td>3</td><td></td><td></td><td></td><td>78528</td><td>67280</td><td>56147</td><td>45084</td><td>33999</td><td>22916</td><td>11609</td><td>0</td></tr><tr><td>4</td><td></td><td></td><td></td><td></td><td>68760</td><td>57362</td><td>46017</td><td>34654</td><td>23292</td><td>11760</td><td>0</td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td></td><td>58280</td><td>46721</td><td>35147</td><td>23574</td><td>11872</td><td>0</td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td></td><td>47249</td><td>35517</td><td>23784</td><td>11956</td><td>0</td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>35793</td><td>23941</td><td>12018</td><td>0</td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>24058</td><td>12064</td><td>0</td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>12098</td><td>0</td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td></tr></table>

Panel B: Computation of Outstanding Balance  

<table><tr><td>Interest Paid</td><td>0</td><td>3782</td><td>3464</td><td>3134</td><td>2791</td><td>2435</td><td>2066</td><td>1683</td><td>1285</td><td>873</td><td>444</td></tr><tr><td>Principal Paid</td><td>0</td><td>8414</td><td>8732</td><td>9062</td><td>9405</td><td>9761</td><td>10130</td><td>10513</td><td>10910</td><td>11323</td><td>11751</td></tr><tr><td>Outstanding Principal</td><td>100000</td><td>91586</td><td>82855</td><td>73792</td><td>64388</td><td>54627</td><td>44497</td><td>33985</td><td>23074</td><td>11751</td><td>0</td></tr></table>

Panel C: Prepayment Option Tree  

<table><tr><td>i</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr><tr><td>j</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>0</td><td>2220</td><td>845</td><td>294</td><td>81</td><td>12</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1</td><td></td><td>3728</td><td>1460</td><td>534</td><td>159</td><td>25</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>2</td><td></td><td></td><td>4566</td><td>2485</td><td>952</td><td>307</td><td>52</td><td>2</td><td>0</td><td>0</td><td>0</td></tr><tr><td>3</td><td></td><td></td><td></td><td>4735</td><td>2892</td><td>1519</td><td>587</td><td>107</td><td>4</td><td>0</td><td>0</td></tr><tr><td>4</td><td></td><td></td><td></td><td></td><td>4372</td><td>2735</td><td>1519</td><td>669</td><td>218</td><td>8</td><td>0</td></tr><tr><td>5</td><td></td><td></td><td></td><td></td><td></td><td>3653</td><td>2223</td><td>1163</td><td>500</td><td>121</td><td>0</td></tr><tr><td>6</td><td></td><td></td><td></td><td></td><td></td><td></td><td>2752</td><td>1532</td><td>710</td><td>204</td><td>0</td></tr><tr><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>1808</td><td>867</td><td>267</td><td>0</td></tr><tr><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>984</td><td>313</td><td>0</td></tr><tr><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>347</td><td>0</td></tr><tr><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td></tr></table>

- Third, consider now a Pass Through security with coupon rate  $r_{PT} = 7\%$ .  
- We can compute its value by backward computation, remembering that at those nodes where there is exercise, the investor gets all of the (remaining) principal back.

A Pass-Through Security  

<table><tr><td colspan="2">Interest Paid (Pass Through)</td><td>3500</td><td>3206</td><td>2900</td><td>2583</td><td>2254</td><td>1912</td><td>1557</td><td>1189</td><td>808</td><td>411</td></tr><tr><td colspan="2">Scheduled Principal Paid (Pool)</td><td>8414</td><td>8732</td><td>9062</td><td>9405</td><td>9761</td><td>10130</td><td>10513</td><td>10910</td><td>11323</td><td>11751</td></tr><tr><td colspan="2">Outstanding Principal (Pool)</td><td>100000</td><td>91586</td><td>82855</td><td>73792</td><td>64388</td><td>54627</td><td>44497</td><td>33985</td><td>23074</td><td>0</td></tr><tr><td></td><td>i</td><td>0.0</td><td>1.0</td><td>2.0</td><td>3.0</td><td>4.0</td><td>5.0</td><td>6.0</td><td>7.0</td><td>8.0</td><td>9.0</td></tr><tr><td></td><td>j</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>0</td><td>99323</td><td>89141</td><td>78947</td><td>68867</td><td>59054</td><td>49435</td><td>39942</td><td>30384</td><td>20827</td><td>10762</td></tr><tr><td></td><td>1</td><td></td><td>91586</td><td>82265</td><td>72388</td><td>62168</td><td>52053</td><td>41981</td><td>31833</td><td>21675</td><td>11112</td></tr><tr><td></td><td>2</td><td></td><td></td><td>82855</td><td>73792</td><td>64388</td><td>53969</td><td>43542</td><td>32962</td><td>22328</td><td>11377</td></tr><tr><td></td><td>3</td><td></td><td></td><td></td><td>73792</td><td>64388</td><td>54627</td><td>44497</td><td>33762</td><td>22835</td><td>11577</td></tr><tr><td></td><td>4</td><td></td><td></td><td></td><td></td><td>64388</td><td>54627</td><td>44497</td><td>33985</td><td>23074</td><td>11751</td></tr><tr><td></td><td>5</td><td></td><td></td><td></td><td></td><td></td><td>54627</td><td>44497</td><td>33985</td><td>23074</td><td>11751</td></tr><tr><td></td><td>6</td><td></td><td></td><td></td><td></td><td></td><td></td><td>44497</td><td>33985</td><td>23074</td><td>11751</td></tr><tr><td></td><td>7</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>33985</td><td>23074</td><td>11751</td></tr><tr><td></td><td>8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>23074</td><td>11751</td></tr><tr><td></td><td>9</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>11751</td></tr><tr><td></td><td>10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>

- The Pass Through security displays negative convexity

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/3ba5779bd9f5a0066b6fdd151d2b93df7641e8ae72bd49f999e2031d3c154ac7.jpg)  
The Negative Convexity of a Pass Through Security: Theory

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/ef28faacdd941516b5eb8b2f4eb23b98c324f5bb9345585a66ee2d356fdb7f5a.jpg)  
The Negative Convexity of a Pass Through Security: Data

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f329c1df234b0290f1061703da37943164e31d1c6d7a832baba03a2116c9f6e4.jpg)  
source:Bloomberg

# Collateralized Mortgage Obligations (CMOs)

- The idea is to redistribute the cash flows from a pool of mortgage in relation to their sensitivity to prepayment risk.
- $\Rightarrow$  Varying levels of protection against prepayment risk. Suited for different types of investors.

Characteristics:

High credit rating  

- Total value of bonds issued (CMOs) is less than value of collateral (Pool of mortgages) even under extreme prepayment scenario;  
- CMO pay quarterly or semi-annual, while mortgage pay monthly. Some reinvestment takes place.
- Two main types of CMOs (or REMICs = Real Estate Mortgage Investment Conduit):

1. CMO Sequential Structure

- In tranches: A, B, C plus a residual Z class.  
- CashFlows in tranches A, B, C receive

(a) A Fixed Coupon Payment  
(b) Sequentially, prepayments on the principal.

- Class Z receives no cash flows, but a coupon is accrued over time. Once all the other classes have been retired, then prepayments go to Z.  
- Each Tranche appeals to a certain types of investors:

*Tranche A/B: Short-medium duration. Investors = money managers, commercial banks;  
*Tranche C:Longer duration.Investors  $=$  insurance companies,pension funds;  
*Tranche Z:Longest duration.Investors  $=$  insurance companies,pension funds.

2. CMO Planned Amortization Class (PAC).

- In Tranches: A, B, C and Companion.

* Tranches A, B etc receive prepayments according to specified schedule, related to some PSA level.  
* Companion absorbs the difference between the PSAs schedule and the actual prepayments.

- Tranches A, B etc then have very stable (and known) cash flows ex ante.  
- The companion tranche is instead very unstable.

# Monte-Carlo Simulations

- Given a path dependent pre-payment function, the valuation of a mortgage backed security is generally carried out by MC simulations.  
What do we simulate?

1. Interest rates.  
2. Housing prices.  
3. Macro-economic factors.

- For each risk-neutral simulation, Cash Flows are computed  $CF_{t}^{s}$ , which depend on path of various factors, age of the mortgage etc., and we compute

$$
P ^ {s} = \sum_ {t = 1} ^ {T} Z ^ {s} (0, t) C F _ {t} ^ {s}
$$

- where  $Z^{s}(0,t) = e^{-\sum_{i=0}^{t-1} r_{j}^{s}\Delta}$  is the zero-coupon bond in simulated path  $s$ .

The price is then computed as

$$
P = \frac {1}{N} \sum_ {s = 1} ^ {N} P ^ {s}
$$

- We simulate all the processes under the risk-neutral probabilities.

# Option Adjusted Spread

- Consider a given (pool of) mortgage, and suppose that its quoted for  $P_{M}(t)$  at time  $t$ .  
- Since homeowners have a prepayment option, it is not correct to compare the  $P_{M}(t)$  just with the expected value of future payments  $V(t)$ .
- We know that probably  $V(t) > P_M(t)$  
- For example, in the earlier tree example, we had  $V(0) = 10,075.50$  while  $P_{M}(0) = 10,000$ ;
- Given a model for prepayment - either rational prepayment or one of the models discussed - a trader can calculate the value of the net present value of future mortgage payments, net of the prepayment option.  
- Call this model price  $P\left(t, r_{t}\right)$ , which depends on the current interest rate  $r_{t}$ .  
- The Option Adjusted Spread is that value  $OAS$  such that

$$
P (t, r _ {t} + O A S) = P _ {M} (t)
$$

- That is, it is the spread on the interest rate that makes the model price (adjusted for the prepayment option) equal to market value.
- Notice that there are then two adjustments in  $P(t, r_t)$ : One for risk, because we use the risk-neutral model, and one for the option.  
- The spread capture what is left, if anything.  
In the previous example,  $OAS = 0$ , as  $V_{0} - CA_{0} = 10,000$ .  
- Suppose instead, for the sake of argument, that the mortgage rate  $\overline{r}^m = .034$ .  
- The same calculations yield  $C = 2716.0513$ ,  $V_{0} = 9999.2757$  and  $CA_{0} = 52.0968$ .  
Hence, the risk-adjusted, option adjusted price is

$$
V _ {0} ^ {A} = V _ {0} - C A _ {0} = 9 9 4 7. 1 7 1 9
$$

- If we think of the original loan  $= 10000$  as the market value of the loan, it would be overpriced.  
- Thus,  $OAS = -0.004123$ , as we need to reduce the interest rate on the tree to ensure the market value equals the model-value.

# Interest Only and Principal Only Strips

- From the MBS markets, a number of mortgage "derivatives" can be constructed to fit the needs of investors.  
- Strips: Obtained by dividing the cash flows from an underlying pool of mortgages through specific allocation of interest and principal.
- The most famous strips are the Interest Only (IO) strips and the Principal Only (PO) strip.
- Interest-Only (IO) Strip:
- Receive all of the interest payment from the underlying collateral and none from the principal.  
- The price movements of IO are highly sensitive to interest rate changes.

* If  $r_t \downarrow \Rightarrow$  prepayment  $\uparrow \Rightarrow$  no more interest payments  $\Rightarrow$  IO Strip loose value.

- Notice that most Fixed Income instruments tend to appreciate when  $r_t$  declines.  
- IO Strips are very different.

Principal-Only (PO) Strip:

- PO Strips receive all of the principal payments from the underlying collateral and none from interest.  
- The price movement of PO strips is also highly sensitive to interest rate movements.  $\ast$  If  $r_t \downarrow \Rightarrow$  prepayment  $\uparrow \Rightarrow$  PO value tend to increase.

# Simple Example

- Consider a mortgage pool with 10 years to maturity and average mortgage rate of  $r_m = 6.5\%$ .  
- Suppose prepayments depend only on past interest rates and assume the following simple function for the probability that an homeowner would refinance its mortgage at time  $t$ :

$$
p _ {t} = c \times \max (r _ {m} - s p - r _ {t}, 0)
$$

- This is a simple function of just the past interest rate: If interest rate drops below some spread below the mortgage rate, the probability increases, with sensitivity  $c$ .
- In the industry, much more complicated pre-payment functions are used.  
In general,

$$
p _ {t} = f \left(r _ {t}, r _ {t -}, a g e _ {t}, h _ {t}, \dots ,\right)
$$

where  $h_t$  denotes the housing price.  

- But the above simple function makes the point.

# Simple Example: Monte Carlo Simulations

- I simulate a (risk-neutral) Ho-Lee model at the daily frequency  $(\Delta = 1 / 252)$

$$
r _ {t + 1} = r _ {t} + \theta_ {t} \Delta + \sigma \sqrt {\Delta} \varepsilon_ {t + 1}
$$

and then computed monthly payments as

$$
C F _ {t + 2 1} = C _ {t + 2 1} + p r e p a y _ {t + 2 1}
$$

where

$$
C _ {t + 2 1} = C _ {t} \left(1 - p _ {t}\right)
$$

$$
\mathit {p r e p a y} _ {t + 2 1} = \mathit {p} _ {t} \times \mathit {\mathrm {p r i n c i p a l}} _ {t}
$$

- and the principal is adjusted for the principal payments over time

$$
\text {I n t e r s t} \mathrm {P a i d} _ {t} = r _ {m} / 1 2 \times \text {p r i n c i p a l} _ {t}
$$

$$
\text {P r i n c i p a l} \mathrm {P a i d} _ {t} = C _ {t} + \text {p r e p a y} _ {t} - \text {I n t e r s t} \mathrm {P a i d} _ {t}
$$

$$
\operatorname {p r i n c i p a l} _ {t + 2 1} = \operatorname {p r i n c i p a l} _ {t} - \operatorname {P r i n c i p a l} \operatorname {P a i d} _ {t}
$$

- Then cash flows can be divided at leisure
- For example, for  $c = 1.5$  and  $sp = .0484$ , we obtain

<table><tr><td></td><td>Price</td><td>Se</td><td>Duration</td></tr><tr><td>MBSNoPrepay</td><td>104.61</td><td>.3534</td><td>4.458</td></tr><tr><td>MBSPrepay</td><td>103.67</td><td>.2953</td><td>3.873</td></tr><tr><td>IO</td><td>29.15</td><td>.072</td><td>-1.15</td></tr><tr><td>PO</td><td>74.53</td><td>.293</td><td>5.535</td></tr></table>

For  $c = 1.5$  and  $sp = 0$ , we obtain

<table><tr><td></td><td>Price</td><td>Se</td><td>Duration</td></tr><tr><td>MBSNoPrepay</td><td>105.19</td><td>.356</td><td>4.475</td></tr><tr><td>MBSPrepay</td><td>101.73</td><td>.1253</td><td>2.048</td></tr><tr><td>IO</td><td>13.02</td><td>.1284</td><td>-22.50</td></tr><tr><td>PO</td><td>88.71</td><td>.2414</td><td>5.74</td></tr></table>

- In this latter case, we are assuming a quicker responsiveness of prepayments to changes in interest rates, which increase the prepayment rate. This implies that the MBS $_{\text{Prepay}}$  would decline.

# Simple Example: Option Adjusted Spread

- Suppose that in the market, the price of the MBS $_{\text{Prepay}}$  is quoted at 99.38.  
- This implies that the OAS = 10 basis points.  
- In fact, by increasing the discount rate by 10 basis points and re-simulating the CFs, one obtains a price equal to the quoted price.  
- A positive OAS shows that the market price of the security is too low, calling for a strategy to buy it and contemporaneously hedge it using other traded securities with similar (non-linear) duration, such as portfolios of caps and floors.

# Teaching Notes 7

A Rundown on Continuous Time Models

# John Heaton

The University of Chicago

Booth School of Business

and NBER

# The Vasicek Model of Interest Rates

- We now derive the main tools of continuous time models as a limit from the discrete time model.  
- Consider the AR(1) model for interest rates:

$$
r _ {t + 1} = \alpha + \beta r _ {t} + \epsilon_ {t + 1}
$$

- We can rewrite

$$
r _ {t + 1} - r _ {t} = \alpha - (1 - \beta) r _ {t} + \epsilon_ {t + 1}
$$

- We had daily data, so "1" is one day, and all coefficients  $\alpha$ ,  $\beta$  and  $Var(\epsilon_{t+1})$  are daily quantities.  
- In financial applications we consider "annualized" quantities. Let  $\Delta t = 1 / 252$  be the daily fraction out of the 252 business days. Then

$$
r _ {t + \Delta t} - r _ {t} = \alpha - \gamma r _ {t} \Delta t + \sigma \eta_ {t + \Delta t}
$$

- where  $\gamma = (1 - \beta) / \Delta t$  is an "annualized" regression coefficient,  $\sigma$  is the annualized volatility, and therefore

$$
\eta_ {t + \Delta t} \sim N (0, \Delta t)
$$

- We can therefore equivalently write

$$
r _ {t + \Delta t} - r _ {t} = \gamma \left(\frac {\alpha}{\gamma \Delta t} - r _ {t}\right) \Delta t + \sigma \eta_ {t + \Delta t}
$$

- Note that

$$
\frac {\alpha}{\gamma \Delta t} = \bar {r} = \text {c e n t r a l}
$$

- Because  $E[\eta_{t + \Delta t}] = 0$ , we have

$$
E _ {t} [ r _ {t + \Delta t} - r _ {t} ] = \gamma (\overline {{r}} - r _ {t}) \Delta t
$$

Hence:

$$
\begin{array}{l} - \text {I f} r _ {t} > \bar {r} \Longrightarrow E _ {t} \left[ r _ {t + \Delta t} - r _ {t} \right] <   0 \Longrightarrow \text {r a t e s} \\ - \mathrm {I f} r _ {t} <   \overline {{r}} \Longrightarrow E _ {t} [ r _ {t + \Delta t} - r _ {t} ] > 0 \Longrightarrow \mathrm {r a t e s a r e e x p e c t e d t o r i s e} \\ \end{array}
$$

- We take the limit until  $\Delta t \to dt$ , an infinitesimal, and we obtain

$$
\begin{array}{l} r _ {t + \Delta t} - r _ {t} \rightarrow d r _ {t} = \text {c h a n g e i n i n t e r s t r a t e o v e r} d t \\ \eta_ {t + \Delta t} \rightarrow d W _ {t} \sim N (0, d t) = \mathrm {B r o w n i a n m o t i o n} = \mathrm {s h o c k t o i n t e r s e t r a t e s} \\ \end{array}
$$

# The Vasicek Model of Interest Rates

- We can then rewrite

$$
d r _ {t} = \gamma (\overline {{r}} - r _ {t}) d t + \sigma d W _ {t}
$$

- This is the Vasicek Model of interest rates.
- It is the continuous time version of the standard AR(1) process.

* The term " $\gamma (\overline{r} - r_t)$ " is called drift;  
* The term " $\sigma$ " is called diffusion.

- Next figure shows two simulations of the interest rate process for two different volatility levels  $\sigma$ .

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f1132e1481c04549afa595d028e9d8c3c84055f84fff0bed84451edd1ecc130c.jpg)  
Interest rate paths for two volatility levels

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/575cecf5f5bfaf4fffb17a1270d5fd39847c49efa2ef55b7a0c095b4b60560d0.jpg)

# Properties of a Brownian Motion

- $W_{t}$  is called Brownian motion or Wiener process.  
- $dW_{t} = W_{t + dt} - W_{t}\sim N(0,dt)$  is its change over time.  
- $W_{t}$  has the following properties:

— Finite  

- Continuous  
- Martingale: For  $\tau > t$ ,  $E[W_{t + \tau}|W_t] = W_t$  
- Normality: For  $\tau > t$ ,  $W_{t + \tau} - W_t \sim N(0, \tau)$  
- Quadratic variation: Consider the partition  $[0, t_1, \ldots, t_n]$  with  $t_i = it / n$

$$
\sum_ {j = 2} ^ {n} \left(W _ {t _ {j}} - W _ {t _ {j - 1}}\right) ^ {2} \rightarrow t (a. s.)
$$

- The last property essentially says that  $dW_{t}^{2} = dt$  
- Other useful rules are:  $dt^{2} = 0$  and  $dW_{t}dt = 0$

# Taylor Expansion and Ito's Formula

- Consider a security with value  $P(r_{t}, t)$  at time  $t$  when the interest rate is  $r_{t}$ .  
- Over a small time interval  $\Delta t$ , the second order Taylor rule approximation has

$$
P (r _ {t + \Delta t}, t + \Delta t) \approx P (r _ {t}, t) + \frac {\partial P}{\partial t} \Delta t + \frac {\partial P}{\partial r} (r _ {t + \Delta t} - r _ {t}) + \frac {1}{2} \frac {\partial^ {2} P}{\partial r ^ {2}} (r _ {t + \Delta t} - r _ {t}) ^ {2}
$$

- Substitute the change in interest rates and rewrite

$$
\begin{array}{l} P (r _ {t + \Delta t}, t + \Delta t) - P (r _ {t}, t) \approx \frac {\partial P}{\partial t} \Delta t + \frac {\partial P}{\partial r} [ \gamma (\overline {{r}} - r _ {t}) \Delta t + \sigma \eta_ {t + \Delta t} ] \\ + \frac {1}{2} \frac {\partial^ {2} P}{\partial r ^ {2}} \left[ \gamma (\overline {{r}} - r _ {t}) \Delta t + \sigma \eta_ {t + \Delta t} \right] ^ {2} \\ \end{array}
$$

- Take the limit as  $\Delta t \to dt$ . Consider the quadratic term

$$
\begin{array}{l} \left[ \gamma (\overline {{r}} - r _ {t}) \Delta t + \sigma \eta_ {t + \Delta t} \right] ^ {2} = \left[ \gamma^ {2} (\overline {{r}} - r _ {t}) ^ {2} \Delta t ^ {2} + \sigma^ {2} \eta_ {t + \Delta t} ^ {2} + 2 \gamma (\overline {{r}} - r _ {t}) \Delta t \sigma \eta_ {t + \Delta t} \right] \\ \rightarrow \left[ \gamma^ {2} (\overline {{r}} - r _ {t}) ^ {2} d t ^ {2} + \sigma^ {2} d W _ {t} ^ {2} + 2 \gamma (\overline {{r}} - r _ {t}) d t \sigma d W _ {t} \right] \\ = \sigma^ {2} d t \\ \end{array}
$$

# Taylor Expansion and Ito's Formula

- The capital gain over the period  $dt$  is:  $dP_{t} = P(r_{t + dt}, t + dt) - P(r_{t}, t)$ .  
- We obtain in the limit Ito's Formula:

$$
d P _ {t} = \left\{\frac {\partial P}{\partial t} + \frac {\partial P}{\partial r} \gamma (\overline {{r}} - r _ {t}) + \frac {1}{2} \frac {\partial^ {2} P}{\partial r ^ {2}} \sigma^ {2} \right\} d t + \frac {\partial P}{\partial r} \sigma d W _ {t}
$$

- The expected capital gain over an infinitesimal period  $dt$  is

$$
E [ d P _ {t} ] = \left\{\frac {\partial P}{\partial t} + \frac {\partial P}{\partial r} \gamma (\overline {{r}} - r _ {t}) + \frac {1}{2} \frac {\partial^ {2} P}{\partial r ^ {2}} \sigma^ {2} \right\} d t
$$

- There are three terms determining a bond expected return:

1. The passage of time  
2. The expectation of future rate times the sensitivity of bond to rate changes  
3. A convexity effect due to a non-linear relation between the security and the interest rate.

- The volatility of bond return depends on the interest rate volatility  $\sigma$  times the sensitivity of bonds to interest rates.

# Risk Neutral Pricing in Continuous Time

- Consider a generic model of interest rates

$$
d r _ {t} = m (r _ {t}, t) d t + s (r _ {t}, t) d W _ {t} \tag {1}
$$

- where  $m(r, t)$  and  $s(r, t)$  are functions of the interest rate  $r$  and time  $t$ . The choice of  $m(r, t)$  and  $s(r, t)$  give rise to different models.  
- Consider two fixed income securities that depend on the interest rate.

1. $V(r, t) = \mathrm{e.g.}$  option  
2. $Z(r, t) = \text{zero-coupon bond}.$

- What is a no-arbitrage relation between  $V(r, t)$  and  $Z(r, t)$ ?  
- As a matter of notation, I often write  $V$  instead of  $V(r,t)$ , and partial derivatives are often indicated as follows:

$$
V _ {t} = \frac {\partial V}{\partial t}; \quad V _ {r} = \frac {\partial V}{\partial r}; \quad V _ {r r} = \frac {\partial^ {2} V}{\partial r ^ {2}}; \qquad (2)
$$

# Risk Neutral Pricing in Continuous Time

1. Portfolio: Set up a portfolio that is long one unit of the security  $V(r, t)$  and  $N$  units of the zero coupon bond  $Z(r, t)$  with maturity  $T$ :

$$
\Pi (r, t) = V (r, t) + N Z (r, t) \qquad \qquad (3)
$$

2. Hedging: Choose  $N$  to eliminate sensitivity to interest rates:

$$
\frac {\partial \Pi (r , t)}{\partial r} = 0 \tag {4}
$$

- This condition translates into the equation

$$
\frac {\partial V (r , t)}{\partial r} + N \frac {\partial Z (r , t)}{\partial r} = 0 \tag {5}
$$

- Solve for optimal hedge ratio  $N$ :

$$
N = - \frac {\partial V (r , t) / \partial r}{\partial Z (r , t) / \partial r} = - \frac {\text {S e n s i t i v i t y o f V t o i n t e r e s t r a t e s}}{\text {S e n s i t i v i t y o f Z t o i n t e r e s t r a t e s}} \tag {6}
$$

3. No Arbitrage: Apply Ito's formula to the portfolio  $\Pi(r, t)$ :

$$
d \Pi = \left\{\Pi_ {t} + \Pi_ {r} m (r, t) + \frac {1}{2} \Pi_ {r r} s (r, t) ^ {2} \right\} d t + \Pi_ {r} s (r, t) d W _ {t} \qquad (7)
$$

- We know from hedging that  $\Pi_r = \partial \Pi / \partial r = 0$ , which implies

$$
d \Pi = \left\{\Pi_ {t} + \frac {1}{2} \Pi_ {r r} s (r, t) ^ {2} \right\} d t \tag {8}
$$

- Interest rate risk  $dW_{t}$  does not affect the portfolio  $\Longrightarrow$  portfolio is riskless.

$$
\text {N o A r b i t r a g e} \quad \Longrightarrow \quad d \Pi = r \Pi d t \tag {9}
$$

4. Reshuffle: Substitute in (9) the expression for  $d\Pi$  from (8):

$$
\Pi_ {t} + \frac {1}{2} \Pi_ {r r} s (r, t) ^ {2} = r \Pi
$$

- Substitute:  $\Pi = V + NZ$ ,  $\Pi_t = V_t + NZ_t$ ,  $\Pi_{rr} = V_{rr} + NZ_{rr}$ , to obtain

$$
V _ {t} + \frac {1}{2} V _ {r r} s (r, t) ^ {2} - r V = N \left[ Z _ {t} + \frac {1}{2} Z _ {r r} s (r, t) ^ {2} - r Z \right]
$$

- Substitute also  $N$  from (6) to get

$$
\frac {V _ {t} + \frac {1}{2} V _ {r r} s (r , t) ^ {2} - r V}{V _ {r}} = \frac {Z _ {t} + \frac {1}{2} Z _ {r r} s (r , t) ^ {2} - r Z}{Z _ {r}} \tag {10}
$$

- Note that the left-hand-side is identical to the right-hand side.
- $\Longrightarrow$  All pairs of fixed income securities must satisfy (10)
- Denote by " $-m^{*}(r,t)$ " the common ratio, which we will estimate from data:2

$$
\frac {V _ {t} + \frac {1}{2} V _ {r r} s (r , t) ^ {2} - r V}{V _ {r}} = - m ^ {*} (r, t) \tag {11}
$$

- Reorganize to obtain the Fundamental Pricing Equation:

$$
V _ {t} + V _ {r} m ^ {*} (r, t) + \frac {1}{2} V _ {r r} s (r, t) ^ {2} = r V \tag {12}
$$

- All fixed income security must satisfy this Partial Differential Equation (PDE) subject to the boundary condition

$$
V (r, T) = g (r, T) = \text {P a y o f f o f s e c u r i t y} T \tag {13}
$$

# Risk Neutral Pricing

5. Risk-Neutral Pricing: How can we solve equation (12)?

- The Feynman Kac formula shows the solution of (12) is:

$$
V (r, T) = E _ {t} ^ {*} \left[ e ^ {- \int_ {t} ^ {T} r _ {u} d u} g (r _ {T}, T) \right] \tag {14}
$$

- The notation  $E^{*}[.]$  means we compute the expectation using the Risk Neutral Process for interest rates:

$$
d r = m ^ {*} (r, t) d t + s (r, t) d W _ {t} ^ {*} \tag {15}
$$

where  $dW_{t}^{*}$  is another Brownian motion  $dW_{t}^{*} \sim \mathcal{N}(0, dt)$ .

and not the original process (1):

$$
d r = m (r, t) d t + s (r, t) d W _ {t} \tag {16}
$$

# Interest Rate Models

- Choice of  $m^{*}(r, t)$  and  $s(r, t) \Rightarrow$  interest rate model.  
- Affine Models: In the following four cases, the value of a zero coupon bond at  $t$  with maturity  $T$  is:

$$
Z (r, t; T) = e ^ {A (t, T) - B (t, T) r}; \tag {17}
$$

1. Vasicek:  $m^{*}(r,t) = \eta^{*} - \gamma^{*}r$  and  $s(r,t) = \sigma$ , and

$$
B (t, T) = \frac {1}{\gamma^ {*}} \left(1 - e ^ {- \gamma^ {*} (T - t)}\right) \tag {18}
$$

$$
A (t, T) = \frac {1}{(\gamma^ {*}) ^ {2}} \left(B (t, T) - (T - t)\right) \left(\eta^ {*} \gamma^ {*} - \frac {1}{2} \sigma^ {2}\right) - \frac {\sigma^ {2} B (t ; T) ^ {2}}{4 \gamma^ {*}} \tag {19}
$$

- We often denote the risk-neutral central tendency as

$$
\bar {r} ^ {*} = \frac {\eta^ {*}}{\gamma^ {*}}
$$

2. Cox, Ingersol, and Ross (CIR):  $m^{*}(r,t) = \eta^{*} - \gamma^{*}r$  and  $s(r,t) = \sqrt{\alpha r}$ ;

$$
B (t; T) = \frac {2 \left(e ^ {\psi_ {1} (T - t)} - 1\right)}{\left(\gamma^ {*} + \psi_ {1}\right) \left(e ^ {\psi_ {1} (T - t)} - 1\right) + 2 \psi_ {1}} \tag {20}
$$

$$
A (t; T) = 2 \frac {\eta^ {*}}{\alpha} \log \left(\frac {2 \psi_ {1} e ^ {(\psi_ {1} + \gamma^ {*}) \frac {(T - t)}{2}}}{(\gamma^ {*} + \psi_ {1}) (e ^ {\psi_ {1} (T - t)} - 1) + 2 \psi_ {1}}\right) \qquad (2 1)
$$

with

$$
\psi_ {1} = \sqrt {(\gamma^ {*}) ^ {2} + 2 \alpha}
$$

- The risk-neutral central tendency is often denoted by

$$
\bar {r} ^ {*} = \frac {\eta^ {*}}{\gamma^ {*}}
$$

3. Ho and Lee:  $m^{*}(r,t) = \eta^{*}(t)$  and  $s(r,t) = \sigma$ ;

$$
B (t, T) = T - t
$$

$$
A (t, T) = - \int_ {t} ^ {T} \eta^ {*} (\tau) (T - \tau) d \tau + \frac {1}{6} \sigma^ {2} (T - t) ^ {3}
$$

4. Hull and White:  $m^{*}(r,t) = \eta^{*}(t) - \gamma^{*}r$  and  $s(r,t) = \sigma$ ;

$$
B (t, T) = \frac {1}{\gamma^ {*}} \left(1 - e ^ {- \gamma^ {*} (T - t)}\right)
$$

$$
\begin{array}{l} A (t, T) = - \int_ {t} ^ {T} B (\tau ; T) \eta^ {*} (\tau) d \tau \\ + \frac {\sigma^ {2}}{2 (\gamma^ {*}) ^ {2}} \left(T - t + \frac {1 - e ^ {- 2 \gamma^ {*} (T - t)}}{2 \gamma} - 2 B (t; T)\right) \\ \end{array}
$$

# Fitting the Vasicek Model to Data

- Where do the risk neutral parameters of an interest rate model come from? - They are estimated by non-linear OLS in the same fashion as Nelson and Siegel.  
- Given today's rate  $r = r_0$ , we can fit the discount function implied by e.g. the Vasicek model,  $Z(0, r_0; T) = e^{A(0; T) - B(0; T) \times r_0}$  in (17) to the current bond prices.  
- To recap, remember that from quoted data, we have available  $n$  prices  $P^i(0, T_i)$  for coupon bonds with maturities  $T_1, \ldots, T_n$ , as well as their respective coupons  $c^i$ ,  $i = 1, \ldots, n$ .  
- We look for a discount function that generates prices that are "close" to these bonds as follows:

1. For given set of parameters  $(\gamma^{*}, \overline{r}^{*}, \sigma)$  we can compute the functions  $A(0; T)$  and  $B(0; T)$  in (18) and (19) for any maturity  $T$ , and hence the discount function (17).  
2. Given the function (17) and the coupon  $c^i$ , we can compute  $n$  theoretical bond prices  $\widehat{P}^i(0, r_0; T_i)$  for the same maturities (notice that the bond prices depend on the current interest rate  $r_0$  as well).
3. We can finally find the parameters that minimize the distance between the actual prices and the theoretical ones as

$$
\min _ {\gamma^ {*}, \bar {r} ^ {*}, \sigma} J = \sum_ {i = 1} ^ {n} \left(P ^ {i} (0, T _ {i}) - \widehat {P} ^ {i} (0, r _ {0}; T _ {i})\right) ^ {2} \tag {22}
$$

- I find  $\gamma^{*} = 0.0702, \overline{r}^{*} = 0.2322, \sigma = 0.0463$  
- The next figures compare the results using the Vasicek model and the Nelson-Siegel model.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/6649ba4bb9e847b66e05e45df18b70d3e49490a7e3f37120e537247c4b55d2ff.jpg)  
Bond Prices and Fitted Prices: 08-Jan-2002

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/4ab02c71e81ae35b1f200820c85ec28c2168470cca547ea49a1a6308a5180ad6.jpg)  
Zero-Coupon Yield Curves: 08-Jan-2002

- Next Figure reports the risk neutral stationary distribution that is implied by the above estimates.

# The Risk Neutral Stationary Distribution of Interest Rates

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/51a43ad6b0275405cb6ff4855ff2d5cfec19d32f41bab9b36169957d09e53a1b.jpg)

- As can be seen, the risk neutral distribution results in a large area with negative interest rates.

# The Market Price of Risk

- Consider the expected return from an investment in the security  $V$ .  
- According to Ito's formula:

$$
\frac {d V}{V} = \mu_ {V} d t + \sigma_ {V} d W
$$

- where the diffusion  $\sigma_{V}$  is

$$
\sigma_ {V} = \frac {V _ {r}}{V} s (r, t) \tag {23}
$$

- and the expected return  $\mu_{V}$  is

$$
E \left[ \frac {d V}{V} \right] = \mu_ {V} d t = \frac {1}{V} \left\{V _ {t} + V _ {r} m (r, t) + \frac {1}{2} V _ {r r} s ^ {2} (r, t) \right\} d t
$$

- The two terms  $\left(V_{t} + \frac{1}{2} V_{rr}s^{2}(r,t)\right)$ , also appear in the pricing PDE (12):

$$
V _ {t} + \frac {1}{2} V _ {r r} s ^ {2} (r, t) = r V - V _ {r} m ^ {*} (r, t)
$$

- Substitute, to obtain the expected return as

$$
E \left[ \frac {d V}{V} \right] = \left\{r + \frac {V _ {r}}{V} (m (r, t) - m ^ {*} (r, t)) \right\} d t
$$

- Using expression (23), we can rewrite this as

$$
\frac {E \left[ \frac {d V}{V} \right] - r d t}{\sigma_ {V}} = \frac {1}{s (r , t)} \left(m (r, t) - m ^ {*} (r, t)\right) d t \tag {24}
$$

- On the left is the market price of interest rate risk, or Sharpe ratio

$$
\frac {E \left[ \frac {d V}{V} \right] - r d t}{\sigma_ {V}} = \frac {\text {R i s k P r e m i u m}}{\text {V o l a t i l i t y}}
$$

- The right-hand-side of (24) shows that such ratio does not depend on  $V$ . All fixed income securities have the same market price of risk  
- We thus define the market price of risk as

$$
\lambda (r, t) = \frac {1}{s (r , t)} (m (r, t) - m ^ {*} (r, t)) \tag {25}
$$

- Every fixed-income security  $V$  we must have a risk premium given by

$$
E \left[ \frac {d V}{V} \right] - r d t = \sigma_ {V} \lambda (r, t) d t \tag {26}
$$

- The risk premium of a fixed income security depends on

* Amount of risk  ${\sigma }_{V}$  
* Market price of risk  $\lambda\left( {r,t}\right)$

- Given an estimate of  $\lambda(r, t)$ , the risk-neutral drift  $m^{*}(r, t)$  is

$$
m ^ {*} (r, t) = m (r, t) - \lambda (r, t) s (r, t) \tag {27}
$$

- that is, it is equal to the original drift adjusted for the market price of risk. The risk-neutral process is a "risk-adjusted" process.

# Estimating the Market Price of Risk

- In Vasicek model, the Market Price of Interest Rate Risk is

$$
\lambda (r) = \frac {1}{\sigma} (\gamma (\bar {r} - r) - \gamma^ {*} (\bar {r} ^ {*} - r)) \tag {28}
$$

- Generically, we can write the market price of risk as:

$$
\lambda (r) = \lambda_ {0} + \lambda_ {1} \times r
$$

where

$$
\lambda_ {0} = \frac {1}{\sigma} \times \left(\gamma \bar {r} - \gamma^ {*} \bar {r} ^ {*}\right); \quad \text {a n d} \quad \lambda_ {1} = - \frac {1}{\sigma} \times \left(\gamma - \gamma^ {*}\right) \tag {29}
$$

- Given estimates of true parameters and risk neutral parameters, we can estimate the market price of risk

# Understanding "risk neutral" parameters

- We have the following two sets of parameters
- From fitting bond prices

$$
\gamma^ {*} = 0. 0 7 0 2; \quad \overline {{r}} ^ {*} = 0. 2 3 2 2; \quad \sigma = 0. 0 4 6 3
$$

- From running a regression of  $r_{t + \Delta t}$  onto  $r_t$ ,

$$
\gamma = 0. 3 2 6 1; \quad \overline {{r}} = 0. 0 5 0 9; \quad \sigma = 0. 0 2 2 1.
$$

These results show two main "problems":

1. The risk-neutral long-term interest rate is very high;  
2. The risk-neutral volatility of the interest rate is also high.

- A high "risk-neutral"  $\overline{r}^{*}$  is not necessarily a problem, as it may just imply a market price of risk:

$$
\lambda (r) = \lambda_ {0} + \lambda_ {1} r
$$

where  $\lambda_0$  and  $\lambda_{1}$  are in (29).

- Indeed, we find  $\lambda_0 = 0.006437365$  and  $\lambda_1 = -5.52699784$ .  
- Given the current interest rate  $r = 1.68\%$ , the current market price of risk is

$$
\lambda (r) = - 0. 0 8 6 4 1 6 1 9 9
$$

- It is small, but not unreasonable. (Note: What does  $\lambda(r) < 0$  imply for the bond risk premium?)
- One important issue that the volatility  $\sigma$  should be the same under risk neutral and true parameters.
- This can be seen by comparing (15) and (16): The two processes have different means but the same volatility.

# Restricted Vasicek Model

- This suggests we should restrict the Vasicek model to have the volatility estimated from interest rates.  
- By redoing the non-linear least square estimate on  $\gamma^{*}$  and  $\overline{r}^{*}$  while restricting  $\sigma = .0221$  yields

$$
\gamma^ {*} = 0. 4 4 7 6, \bar {r} ^ {*} = 0. 0 6 5 4, \sigma = . 0 2 2 1 (\mathrm {r e s t r i c t e d})
$$

- Next figures show the implications for fitting:

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/d8c91421473e00fe5fc6c336e2e7ecb26b08d25f1061de53e579b4dea7685d94.jpg)  
Fitted Prices for Various Models

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f7d91c64c16c4f2ea7032089e464c1ff9ebe8df54335abb2e9821e80ac6ef040.jpg)  
Zero-Coupon Yield Curves

# Application. Relative Value Trades on the Yield Curve

- Let today be February 17, 2004.  
- We use the Vasicek model to implement the relative value trade.  
- The first step to set up a relative value trade is to obtain the parameters  $\overline{r}^*$ ,  $\gamma^*$  and  $\sigma$  of the Vasicek model that best fit the term structure of interest rates.  
- Because realistically the long/short strategy of the trade will involve repurchase agreements, the rate of interest to be used as the short-term rate should be the overnight repo rate.

The Overnight Repo Rate: May 21, 1991 - February 17, 2004  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/a8cb7d664f9c668b2cdbb5356e8f917010c882d27c956aa99271cf12becd0ef8.jpg)  
Data Source: Bloomberg

- The parameter  $\sigma$  is given by the volatility of the short-term interest rate.  
- The volatility of the overnight repo rate is substantial:  $\sigma = 3.17\%$ .  
- Instead,  $\overline{r}^*$  and  $\gamma^*$  are estimated by using a nonlinear least square technique.
- In particular, let  $c_{i}$  be the coupon rate of bond  $i$ ,  $n_{i}$  the number of coupon dates remaining, and  $T_{i,j}$ ,  $j = 1, \ldots, n_{i}$  the coupon dates for bond  $i$ .  
- The value of the bond according to the Vasicek model is then

$$
P _ {i} ^ {\text {V a s i c e k}} = \frac {c _ {i} \times 1 0 0}{2} \times \sum_ {j = 1} ^ {n _ {i}} Z (0, T _ {i, j}) + 1 0 0 \times Z (0, T _ {i, n _ {i}}) \qquad (3 0)
$$

- We then minimize

$$
J (\gamma^ {*}, \overline {{r}} ^ {*}) = \sum_ {i = 1} ^ {n} \left(P _ {i} ^ {D a t a} - P _ {i} ^ {V a s i c e k}\right) ^ {2}. \tag {31}
$$

- The minimization procedure yields  $\bar{r}^{*} = 18.99\%$  and  $\gamma^{*} = 0.0583$

# The Fit of the Vasicek Model to Bond Prices

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c24763f235f875b20dd929aeddd8d448b28744905140721b4385b6a0adc0a325.jpg)  
Panel A. Bond Prices

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c784e9881ae84a2f7205bba522fa6f3af6d52a7ca36d2982520be33cafd34278.jpg)  
Panel B. Vasicek Yield Curve

Panel C. Pricing Errors  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/34bd883cecc9ca786d01ce670265bdb81c55ff47e3c350f4095bf6637a25c32e.jpg)  
Data Source: CRSP.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/fd7501226dddb18f56db79b1c08015feb02b72f51ef094224108b67bba4019f4.jpg)  
Panel D. Relative Pricing Errors

# Application (cntd.) Design of the Relative Value Trade

- Panel C reports the pricing errors, that is, the difference between the prices in the data and the model:

$$
\text {P r i c i n g E r r o r o f T r e a s u r y S e c u r i t y} i = P _ {i} ^ {\text {D a t a}} - P _ {i} ^ {\text {V a s i c e k}}
$$

- Most securities are not priced correctly, and some of them display large differences.

– For instance, the 10-year T-note appears grossly overpriced by the market, as its traded price is almost \$1 higher than the Vasicek model's prediction.  

- Indeed, Panel D shows the pricing errors in percentage of the traded prices  $P_{i}^{Data}$ , and the price of the 10-year note is almost  $1\%$  higher than the model's prediction.

# Application (cntd.) Design of the Relative Value Trade

- For simplicity, we focus on short term bonds. Panels C and D show that short-term bonds are also mispriced.
- For our exercise, we focus on the T-note maturing on  $T = 1.5$ , which is overpriced by about 57 basis points compared to the model.
- Our relative value trade then calls for the following strategy:

Sell high / Buy low  $\Longrightarrow$  Sell 1.5-yr T-note / Buy Vasicek 1.5-yr note (32)

- That is, we want to sell the overpriced 1.5-year note, and purchase the 1.5-year note implied by the Vasicek model.

# Application (cntd.) Design of the Relative Value Trade

- While performing the first part of the trade is simple, how do we purchase the 1.5-year note that is "implied by the Vasicek model"?  
- This fair value is a mathematical formula, so we cannot purchase it per se.  
- The key to the trade is to recall that we can purchase, however, the replicating portfolio that according to the Vasicek model exactly replicates the 1.5-year note.  
- So, the proper strategy is

Sell 1.5-yr T-note / Buy portfolio that replicates the Vasicek 1.5-yr note (33)

- The key insight of no arbitrage and relative value trading is that such a (replicating) portfolio costs exactly the Vasicek value of the 1.5-year note.

# Application (cntd.) The Replicating Portfolio

- To set up the replicating portfolio we need to find a security that is fairly priced according to the model, and we therefore use the 7.5-year T-note, which has a pricing error of only 3 basis points.  
- When we derived the no arbitrage condition, we considered the following portfolio, now specialized for the securities at hand:

$$
\Pi (r _ {t}, t) = - P _ {1. 5 - y r} ^ {V a s i c e k} (r _ {t}, t) + N _ {t} \times P _ {7. 5 - y r} ^ {V a s i c e k} (r _ {t}, t) \tag {34}
$$

- where  $P_{1.5 - yr}^{Vasicek}(r_t, t)$  and  $P_{7.5 - yr}^{Vasicek}(r_t, t)$  denote the 1.5-year and the 7.5-year coupon notes, at  $t$ , respectively.  
- The hedging strategy calls for selecting  $N_{t}$  in order to make the portfolio insensitive to changes in the interest rate. That is

$$
\frac {\partial \Pi}{\partial r} = 0 \Longrightarrow N _ {t} = \frac {\partial P _ {1 . 5 - y r} ^ {V a s i c e k} (r , t) / \partial r}{\partial P _ {7 . 5 - y r} ^ {V a s i c e k} (r , t) / \partial r} \tag {35}
$$

- According to the model, no arbitrage then implies that

$$
d \Pi = r \Pi d t \tag {36}
$$

- that is,  $\Pi$  behaves as the return from a safe investment.  
- To figure out the replicating portfolio, we must invert (34), and rewrite

$$
P _ {1. 5 - y r} ^ {V a s i c e k} (r _ {t}, t) = N _ {t} \times P _ {7. 5 - y r} ^ {V a s i c e k} (r _ {t}, t) - \Pi (r _ {t}, t) \tag {37}
$$

- According to the model, we can replicate the Vasicek 1.5-year note by using a position in the 7.5-year note, and by borrowing  $\Pi_t$  at the risk free rate  $r_t$ .  
- Since  $\Pi_t$  is a borrowed cash position, let us denote it by  $C_t$  and let us substitute it into the right-hand side of (37).  
- With no arbitrage, the replicating portfolio is then given by

$$
P _ {1. 5 - y r} ^ {V a s i c e k} (r _ {t}, t) = N _ {t} \times P _ {7. 5 - y r} ^ {V a s i c e k} (r _ {t}, t) - C _ {t} \tag {38}
$$

- Recall that  $C_t$  is the amount borrowed for the replication strategy.
- If  $C_t < 0$ , then we are net lenders in our position.
- Once we know  $C_t$  and  $N_t$ , we follow a rebalancing strategy in which we keep our position  $N_t$  in the 7.5-year T-note, and borrow or lend cash  $C_t$  at the rate  $r_t$ , so that indeed  $dC = rCdt$  
- The initial amount borrowed  $C_0$  must be given by the theoretical portfolio value at time 0:

$$
C _ {0} = - P _ {1. 5 - y r} ^ {V a s i c e k} (r _ {0}, 0) + N _ {0} \times P _ {7. 5 - y r} ^ {V a s i c e k} (r _ {0}, 0) \tag {39}
$$

- Vasicek model tells us the position in each bond to take, as

$$
\begin{array}{l} \frac {\partial P _ {c} (r , 0)}{\partial r} = \frac {c \times 1 0 0}{2} \sum_ {i = 1} ^ {n} \frac {\partial Z (r , 0 ; T _ {i})}{\partial r} + 1 0 0 \times \frac {\partial Z (r , 0 ; T _ {n})}{\partial r} \\ = - \frac {c \times 1 0 0}{2} \sum_ {i = 1} ^ {n} B (0; T _ {i}) Z (r, 0; T _ {i}) - 1 0 0 \times B (0; T _ {n}) Z (r, 0; T _ {n}) \\ \end{array}
$$

$$
- \mathrm {w h e r e} \mathrm {r e c a l l} B (0, T _ {i}) = \left(1 - e ^ {- \gamma^ {*} \times T _ {i}}\right) / \gamma^ {*}.
$$

- We then get

$$
N _ {0} = \frac {\partial P _ {1 . 5 - y r} (r , 0) / \partial r}{\partial P _ {7 . 5 - y r} (r , 0) / \partial r} = \frac {1 . 4 9 1 2}{5 . 6 8 5 4} = 0. 2 6 2 3 \tag {40}
$$

- $\Rightarrow$  for each 1.5-year note sold, we must purchase 0.2623 of the 7.5-year note.
- Given  $N_{0}$ , we can compute the value of  $C_{0}$

$$
C _ {0} = - 1 0 6. 9 7 9 1 + 0. 2 6 2 3 \times 1 0 8. 7 3 4 4 = - 7 8. 4 5 8 1
$$

- To conclude, the replicating portfolio is then

$$
\begin{array}{l} P _ {0} = N _ {0} \times P _ {7. 5 - y r} (0) - C _ {0} = 0. 2 6 2 3 \times 1 0 8. 7 3 4 4 + 7 8. 4 5 8 1 \\ = 1 0 6. 9 7 9 1 = P _ {1. 5 - y r} ^ {V a s i c e k} (r _ {0}, 0) \\ \end{array}
$$

- By selling  $P_{1.5 - yr}^{data} = 107.5469\$  and buying the replicating portfolio, which costs 106.9791, the initial lock in profit is

$$
\text {I n i t i a l p r o f i t} = \$ 1 0 7. 5 4 6 9 - \$ 1 0 6. 9 7 9 1 = \$ 0. 5 6 7 8
$$

# Application (cntd.) The Dynamic Trade

- The dynamic trade recall implies the following steps

1. For each new  $r_t$ , recompute the optimal hedge ratio  $N_t$  using Equation 35.  
2. Compute the new cash requirement  $= \left( {{N}_{t} - {N}_{t - {dt}}}\right)  \times  {P}_{7.5 - {yr}}^{\text{data }}\left( t\right)$  .  
3. Adjust the amount of cash borrowed<sup>3</sup>

$$
C _ {t} = C _ {t - d t} + C _ {t - d t} \times r _ {t - d t} \times d t + \mathrm {C a s h n e e d e d}
$$

4. At every coupon period  $T_{i}$ , borrow more to pay the coupons due in the short position, and use the coupons received to decrease the amount borrowed.

$$
\begin{array}{l} C _ {T _ {i}} = C _ {T _ {i} - d t} + C _ {T _ {i} - d t} \times r _ {T _ {i} - d t} \times d t + \mathrm {C a s h n e e d e d} + \left(1 0 0 \times \frac {c ^ {1 . 5 - y r}}{2}\right) \\ - N _ {T _ {i} - d t} \left(\frac {1 0 0 \times c ^ {7 . 5 - y r}}{2}\right) \\ \end{array}
$$

# Application (cntd.). The Replicating Portfolio: Simulations

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/836237ef60d09526e07ee4528be4dc17c3d44cdb678a0f12d8bd8b75ac6613a2.jpg)  
Panel A: Simulated Repo Rate

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/9e5ea78b76a94d3d5f088c9ee7381368bf10d4c95508ab91f318c406cc5b4a39.jpg)  
Panel B: Replicating Portfolio in Simulations

# Application (cntd.). The Replicating Portfolio: Data

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/a0640ac9df059f4a68eaaad6a824fc0a4bf6c94341d2444902fadfeb291929aa.jpg)  
Panel A. Realized Repo Rate

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/eba66afa8d160f35e44e8b5f9422b4d53badeecc969b678ced468d01c603664f.jpg)  
Panel B. 1.5-year Bond

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/14579951bbe345f3cec65a304a123f4de66058009a324d8e2e1bc2ffcc93cf69.jpg)  
Panel C. 7.5-year Bond

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/57a3c31e52d262abdfbdfda18b7a94267f22e003bb2049906d14eec0405e9300.jpg)  
Panel D. Replicating Portfolio in Data

# Application (cntd.). The Replicating Portfolio: Data

- Panel B shows the observed 1.5-year note and its Vasicek value. Note:

1. The two values are close to each other, and they both converge to their final payout of  $100 + 6.50 / 2 = 103.25$ .  
2. The volatility of the Vasicek price is not nearly as large as the one of the actual traded price, especially during the initial period.

- This low volatility is indeed one of the shortcomings of the Vasicek model.
- Panel C shows the observed 7.5-year note and its Vasicek value. Note:  
- The true price and the model price move much less in sync, if at all.  
- Panel D shows that, surprisingly, on this occasion the replicating strategy actually worked relatively well, especially when compared with the performance of the Vasicek model in Panel C.  
- In fact, the dotted line in Panel D represents the traded 1.5-year bond, while the solid line represents the value of the replicating portfolio, which only uses traded assets and the true repo rate for its implementation.

# Application (cntd.). The Replicating Portfolio: Data

- We finally obtain

$$
\text {F i n a l r e p l i c a t i o n e r r o r} = P _ {T} - P _ {1. 5 - y r} ^ {\text {d a t a}} = \\ \mathbb {1 0 3 . 4 6 9 5} - \mathbb {1 0 3 . 2 5} = \mathbb {1 0 3 . 2 5}
$$

- The total profit for this trade is then the sum of the profit at time 0, \$0.5678, plus the interest accrued on this profit over 1.5 years, plus the replication error:

$$
\text {T o t a l P r o f i t} = \\ 0. 5 6 7 8 / Z (0, 1. 5) + \\ 0. 2 1 9 5 = \\ 0. 5 7 9 0 + \\ 0. 2 1 9 5 = \\ 0. 7 9 8 5
$$

- where  $Z(0,1.5) = 0.9792$  is the 1.5-year discount factor on February 17, 2004, obtained from a bootstrap procedure

# Pricing by Monte Carlo Simulations

- We now exploit Feynman Kac formula to evaluate fixed income securities using Monte Carlo simulations.  
- Recall the value of any fixed income security can be computed as

$$
V (r, T) = E _ {t} ^ {*} \left[ e ^ {- \int_ {t} ^ {T} r _ {u} d u} g (r _ {T}, T) \right] \tag {41}
$$

- under the risk neutral process

$$
d r = m ^ {*} (r, t) d t + s (r, t) d W _ {t} ^ {*} \tag {42}
$$

- The idea is to approximate  $V(r, T)$  by its simulated value

$$
\widehat {V} (r, T) = \frac {1}{J} \sum_ {s = 1} ^ {J} e ^ {- \int_ {t} ^ {T} r _ {u} ^ {s} d u} g (r _ {T} ^ {s}, T) \rightarrow E _ {t} ^ {*} \left[ e ^ {- \int_ {t} ^ {T} r _ {u} d u} g (r _ {T}, T) \right] \qquad (4 3)
$$

# Simulation Procedure

- Discretize first the time interval  $[0, T]$  in  $N = T / \Delta t$  intervals of size  $\Delta t$ .  
- Let the initial condition be the current interest rate  $r_0$ . We approximate :

$$
d r \approx r _ {t + \Delta t} - r _ {t}
$$

$$
d t \approx \Delta t
$$

$$
d W ^ {*} \approx \varepsilon_ {t + \Delta t} \sim \mathcal {N} (0, \Delta t)
$$

- to obtain the recursion (Euler discretization)

$$
r _ {t + \Delta t} = r _ {t} + m ^ {*} (r _ {t}, t) \Delta t + s (r _ {t}, t) \varepsilon_ {t + \Delta t}
$$

- Important: Note that  $\varepsilon_{t + \Delta t}$  has variance  $\Delta t$ , and not variance 1. It can be obtained from a Standard Normal  $x_{t + \Delta t} \sim \mathcal{N}(0,1)$  from

$$
\varepsilon_ {t + \Delta t} = \sqrt {\Delta t} \times x _ {t + \Delta t} \sim \mathcal {N} (0, \Delta t)
$$

# Simulating CIR Model

- Consider the CIR model with  $m^{*}(r,t) = \gamma^{*}(\overline{r}^{*} - r)$  and  $s(r,t) = \sqrt{\alpha r}$  
Starting from  $r_0$ , we have

$$
r _ {1} = r _ {0} + \gamma^ {*} (\overline {{r}} ^ {*} - r _ {0}) \Delta t + \sqrt {\alpha r _ {0}} \times \varepsilon_ {1}
$$

$$
r _ {2} = r _ {1} + \gamma^ {*} (\overline {{r}} ^ {*} - r _ {1}) \Delta t + \sqrt {\alpha r _ {1}} \times \varepsilon_ {2}
$$

$$
\begin{array}{c c c} \vdots & \vdots \\ \vdots & \vdots & \end{array}
$$

$$
r _ {i} = r _ {i - 1} + \gamma^ {*} (\overline {{r}} ^ {*} - r _ {i - 1}) \Delta t + \sqrt {\alpha r _ {i - 1}} \times \varepsilon_ {i}
$$

$$
\begin{array}{c c c} \vdots & \vdots \\ \vdots & \vdots \end{array}
$$

$$
r _ {N} = r _ {N - 1} + \gamma^ {*} (\overline {{r}} - r _ {N - 1}) \Delta t + \sqrt {\alpha r _ {N - 1}} \times \varepsilon_ {N}
$$

- We then obtain a run of simulated interest rates.
- Next figure plots one simulated path for interest rates, under the CIR model and the parameter values of CIR.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/52396505f413edc9fbef6cc827c132455c615dedc59d2f0036dcd67141214cf1.jpg)  
A Simulated Path of Interest Rates: CIR Model

# CIR Zero Coupon Bonds by Simulations

- Example: suppose we want to simulate the price of a zero coupon bond.  
- Since  $g\left( {r}_{T}\right)  = 1$  ,the pricing formula (41) tells us:

$$
V (r, t) = E ^ {*} \left[ e ^ {- \int_ {t} ^ {T} r (u) d u} \times 1 \right] = E ^ {*} \left[ e ^ {- \sum_ {i = 0} ^ {N - 1} r _ {i} \Delta t} \right]
$$

- The Monte Carlo simulation approach is:

(a) Repeat the simulation of interest rates  $J$  times, say  $J = 1,000$ ;  
(b) Obtain  $J$  paths of interest rates  $r_0^j, r_1^j, \ldots, r_{N-1}^j$  and hence  $J$  values of the bond (one for each interest rate path)

$$
Z ^ {\mathsf {R u n} j} = e ^ {- \sum_ {i = 0} ^ {N - 1} r _ {i} ^ {j} \times \Delta} \times \$ 1
$$

(c) Compute the value of the zero-coupon bond as the sample average

$$
\widehat {Z} (r, t) \approx E ^ {*} \left[ e ^ {- \sum_ {i = 0} ^ {N - 1} r _ {i} \Delta} \right] = \frac {1}{J} \sum_ {j = 1} ^ {J} Z ^ {\mathrm {R u n} j}
$$

- Given the discount function  $\widehat{Z}(T)$  for every  $T$ , we can compute the value of coupon-bonds.  
- Next figure plots the theoretical CIR prices along with the simulated ones for different J.  
- The risk neutral parameters computed from non-linear least squares are

$$
\gamma^ {*} = 0. 3 8 0 7; \quad \overline {{r}} ^ {*} = 0. 0 7 2; \quad \alpha = 0. 0 5 4 8.
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/c7fd5f51967c0f0e3fec3ef900a54b8335d4b82955eda9a3c5ddd6acbb4c342f.jpg)  
CIR Bond Prices: Exact and Simulated  
Simulated and Exact CIR prices

- Clearly, the good fit of simulated prices with exact prices is due to the high value of  $\gamma$  (mean reversion) and low value of  $\alpha$  (volatility) used in the CIR model.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/1dc905e529ed6c863ed35987fff14450c955c3a35c9c0aa7f112bffa4cb75b1e.jpg)  
Vasicek Bond Prices: Exact and Simulated

- As it can be seen, under Vasicek model, which has a high volatility  $\sigma$ , long-term bonds results difficult to approximate well by Monte Carlo simulations, even with 10000 runs.

# Standard Errors

- To assess how big is the simulation error, we can compute the standard errors - Given the  $J$  prices  $P^j$ ,  $j = 1, \dots, J$ , their standard deviations is

$$
\widehat {\sigma} _ {P} = \sqrt {\frac {1}{J - 1} \sum_ {j = 1} ^ {J} \left(P ^ {j} - \widehat {P}\right) ^ {2}}
$$

where  $\widehat{P}$  is the actual average simulated price:

$$
\widehat {P} = \frac {1}{J} \sum_ {j = 1} ^ {J} P ^ {j}
$$

- Then, the standard error is

$$
\mathrm {S t a n d a r d E r r o r} = s e _ {P} = \frac {\widehat {\sigma} _ {P}}{\sqrt {J}}
$$

- That is, we can say that with  $95 \%$ confidence, the true price lies in the confidence interval

$$
\left[ \widehat {P} - 1. 9 6 \times s e _ {P}, \widehat {P} + 1. 9 6 \times s e _ {P} \right]
$$

- For example, in the Vasicek model, we had

Table 1: MC Simulations - Vasicek  

<table><tr><td>Maturity</td><td>Actual Price</td><td>MC Price [100, 1000, 10000]</td><td>St. Errors [100, 1000, 10000]</td></tr><tr><td>5.35 years</td><td>111.49</td><td>[114.50, 110.74, 111.32]</td><td>[3.28, 0.85, 0.27]</td></tr><tr><td>14.86 years</td><td>119.03</td><td>[130.76, 120.71, 119.96]</td><td>[9.91, 3.63, 0.93]</td></tr><tr><td>26.87 years</td><td>94.66</td><td>[94.04, 95.33, 93.85]</td><td>[9.51, 5.43, 1.57]</td></tr></table>

- The price is closer to the true one as (1) we increase the number of simulations; (2) we decrease the horizon.  
- The standard errors decrease with the number of simulations.

# Application: Pricing Convertible Bonds

- Convertible securities, or "converts," are instruments that allow an investor to convert a fixed rate income investment into pre-specified amounts of the issuing firm's common stock.  
- Typical structures are rather complex, but here we consider a simple case to appreciate how the MC simulation method can be effectively used in this case as well.

— Caveat: Convertibles have a number of "American" options embedded in them.  

- Typically, MC simulations are not suited to deal well with American options, and trees are preferable.  
- However, recently, new methodologies have been discovered to price American options with MC simulations.
- Consider the following structured product
- Issuer's rating: AAA rated (for simplicity, forget about default risk here)  
- Maturity: 5 years;  
- Coupon: 0 (a zero coupon bond);  
Notional: 100;  
- Conversion Option: Call option to convert the bond into stock.

* Type: European  
* Maturity: 3 year  
* Conversion ratio: 1 (one bond for one share)

- How do we go about pricing something like this?
- The convertible bond is a straight (zero coupon) bond + option (to convert):

$$
P _ {C o n v e r t} = Z \left(0, r _ {0}; 5\right) + O p t i o n
$$

- We need to compute the option, and we are done.
- Let  $S_{t}$  be the price of common stock at time  $t$ . Assume  $S_{0} = 70$ .  
- Payoff of the conversion option at time  $T = 3$

$$
\max \left(S _ {T} - Z \left(T, r _ {T}; T + 2\right), 0\right)
$$

What is the difference from standard option?

- The strike price depend on the interest rate!  
- $\Rightarrow$  We cannot apply e.g. Black and Scholes formula.
- Assume stock:
- Pays no dividends;  
- Expected return is constant  $= \mu = 15\%$  
- Volatility is constant  $= {\sigma }_{S} = {30}\%$  
- It is uncorrelated with interest rates.  
- Process for stock is the Black Scholes lognormal process

$$
d S _ {t} = \mu S _ {t} d t + \sigma_ {S} S _ {t} d X _ {2, t}
$$

- The risk-neutral pricing formula is

$$
P _ {O p t i o n} = E ^ {*} \left[ e ^ {- \int_ {0} ^ {T} r _ {t} d t} \max \left(S _ {T} - Z (T, r _ {T}; T + 2), 0\right) \right]
$$

where  $E^{*}$  denotes the expectation under the risk neutral dynamics.

What is the risk neutral process for stocks?

$$
d S _ {t} = r _ {t} S _ {t} d t + \sigma_ {S} S _ {t} d X _ {2, t}
$$

- The risk neutral process for the risk-free rate is

$$
d r _ {t} = \gamma^ {*} (\overline {{r}} ^ {*} - r _ {t}) d t + \sigma d X _ {1, t}
$$

- So, we simulate simultaneously:

$$
r _ {t + \Delta} = r _ {t} + \gamma^ {*} (\bar {r} ^ {*} - r _ {t}) \Delta + \sigma \sqrt {\Delta} x _ {1, t + \Delta}
$$

$$
S _ {t + \Delta} = S _ {t} + r _ {t} S _ {t} \Delta + S _ {t} \sigma_ {S} \sqrt {\Delta} x _ {2, t + \Delta}
$$

- where  $x_{1,t + \Delta} \sim N(0,1)$  and  $x_{2,t + \Delta} \sim N(0,1)$
- Notice that the interest rate enters the drift rate of the stock price!
- For each simulation run  $j$ :
- The cash flows are zero up to time  $T$ .  
- At time  $T$ , given  $r_T^j$ , we can use the Vasicek formula to find

$$
Z \left(r _ {T} ^ {j}, T; T + 2\right) = e ^ {A (T; T + 2) - B (T; T + 2) \times r _ {T} ^ {j}}
$$

where

$$
B (t; T) = \frac {1}{\gamma^ {*}} \big (1 - e ^ {- \gamma^ {*} (T - t)} \big)
$$

- and

$$
A (t; T) = \left(B (t; T) - (T - t)\right) \left(\overline {{r}} ^ {*} - \frac {1}{2 (\gamma^ {*}) ^ {2}} \sigma^ {2}\right) - \frac {\sigma^ {2} B (t ; T) ^ {2}}{4 \gamma^ {*}}
$$

- Thus, the Cash Flow at time  $T$  from the option is

$$
C F _ {T} ^ {j} = \max \left(S _ {T} ^ {j} - Z \left(T, r _ {T} ^ {j}; T + 2\right), 0\right)
$$

- Discount it to today, using the interest rates of this simulation

$$
P _ {O p t i o n} ^ {j} = e ^ {- \sum_ {i = 0} ^ {N - 1} r _ {i} ^ {j} \times \Delta t} C F _ {T} ^ {j}
$$

- The value of the option is

$$
P _ {O p t i o n} = \frac {1}{J} \sum_ {j = 1} ^ {J} P _ {O p t i o n} ^ {j}
$$

-In this case,we obtain

$$
Z \left(0, r _ {0}; 5\right) = 7 9. 8 7 1 3 (\text {f r o m V a s i c e k F o r m u l a})
$$

$$
P _ {O p t i o n} = 1 0. 0 7 2 1 \mathrm {(f r o m S i m u l a t i o n s)}
$$

$$
P _ {C o n v e r t} = 8 9. 9 4 3 4
$$

# Teaching Notes 8.

# Derivative Pricing After the Crisis<sup>1</sup>

# John Heaton

The University of Chicago

Booth School of Business

and NBER

# Introduction

- Recall from our previous discussion that a plain vanilla Forward Rate Agreement is a contract between two counterparties who agree to exchange at  $T_{2}$  the following cash flows

$$
\text {N e t C a s h F l o w a t} T _ {2} = N \Delta \left(\ell \left(T _ {1}\right) - f\right) \tag {1}
$$

- The forward rate  $f$  is determined by no-arbitrage. The following is the strategy that replicates the FRA payoff (with  $N = 1$ ):  
- Decompose the cash flow (1) in its floating and fixed components as follows:

1. Replication of " $\ell(T_1)\Delta$ ":

(a) Go long 1 zero-coupon bond maturing at  $T_{1}$  and reinvest the principal received at  $T_{1}$  at the LIBOR rate  $\ell(T_{1})$  
(b) Go short 1 zero coupon bond maturing at  $T_{2}$

2. We obtain

$$
\text {T o t a l C F} T _ {2} = \underbrace {1 + \ell (T _ {1}) \Delta} _ {\text {f r o m (a)}} - \underbrace {1} _ {\text {f r o m (b)}} = \ell (T _ {1}) \Delta
$$

3. Replication of " $-f\Delta$ "

(a) Go short  $f \Delta$  bonds maturing at  $T_{2}$

$$
\text {T o t a l C F} T _ {2} = - f \Delta
$$

- What is the value of this portfolio at any time  $t < T_1$ ?  
- Denote  $Z^{\ell}(t,T)$  as LIBOR-based zero coupon bond. Then

$$
V _ {t} ^ {F R A} = Z ^ {\ell} (t, T _ {1}) - (1 + f \Delta) Z ^ {\ell} (t, T _ {2}) \qquad \qquad (2)
$$

- The forward rate  $f = f\left( {t,{T}_{1},{T}_{2}}\right)$  at time  $t$  is the value that makes  ${V}_{t}^{FRA} = 0$  .  
- Thus, solving (2) for the forward rate gives:

$$
f ^ {\ell} (t, T _ {1}, T _ {2}) = \frac {1}{\Delta} \left(\frac {Z ^ {\ell} (t , T _ {1})}{Z ^ {\ell} (t , T _ {2})} - 1\right) \tag {3}
$$

- where the superscript  $\ell$  denotes that this is the forward rate implied by the LIBOR-based zero coupon bonds  $Z^{\ell}(t,T_1)$  and  $Z^{\ell}(t,T_2)$ .

# Example 1: January 2, 2007

- The following is a numerical example:
- On January 2nd, 2007 ( $t = 0$ ), the threeand six-months LIBOR rates were  $\ell(0,0.25) = 5.36\%$  and  $\ell(0,0.5) = 5.37\%$ , respectively. Defining  $T_{1} = 0.25$  and  $T_{2} = 0.5$ , this implies

$$
Z ^ {\ell} (0, T _ {1}) = \frac {1}{1 + . 0 5 3 6 \times 0 . 2 5} = 0. 9 8 6 7 7
$$

$$
Z ^ {\ell} (0, T _ {2}) = \frac {1}{1 + 0 . 0 5 3 7 \times 0 . 5} = 0. 9 7 3 8 5 2
$$

- Applying formula (3) we obtain

$$
f ^ {\ell} \left(0, T _ {1}, T _ {2}\right) = 5.3089 \%
$$

- Indeed, on the same day, the mid quoted forward rate for a  $3 \times 6$  FRA was

$$
f ^ {F R A} (0, T _ {1}, T _ {2}) = 5.302 \%,
$$

—which is quite close to the "theoretical value."

# Example 2: January 2, 2009

- The following is another example, for a date after the crisis
- On January 2nd, 2009 ( $t = 0$ ), the threeand six-months LIBOR rates were  $\ell(0,0.25) = 1.4125\%$  and  $\ell(0,0.5) = 1.7525\%$ , respectively. Defining  $T_{1} = 0.25$  and  $T_{2} = 0.5$ , this implies

$$
Z ^ {\ell} (0, T _ {1}) = \frac {1}{1 + . 0 1 4 1 2 5 \times 0 . 2 5} = 0. 9 9 6 4 8
$$

$$
Z ^ {\ell} (0, T _ {2}) = \frac {1}{1 + 0 . 0 1 7 5 2 5 \times 0 . 5} = 0. 9 9 1 3 1
$$

- Applying formula (3) we obtain

$$
f ^ {\ell} (0, T _ {1}, T _ {2}) = 2.086 \%
$$

- In contrast, on the same day, the mid quoted forward rate for a  $3 \times 6$  FRA was

$$
f ^ {F R A} (0, T _ {1}, T _ {2}) = 1.174 \%,
$$

which is much lower than the "theoretical value."

Quoted and LIBOR-based  $3 \times 6$  Forward Rates before the Crisis  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/aebec62e83697536b1e5347793cbf892c3fa8ad965c2e87dda77192c29179969.jpg)  
Data Source: Bloomberg

Quoted and LIBOR-based  $3 \times 6$  Forward Rates after the Crisis  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/3329da8313317160742a56a639cd08b48c5d337b7dceff963f4a4fc3f58c5459.jpg)  
Data Source: Bloomberg

# Forward Rates after the Crisis

- The last figure shows that after the crisi

$$
f ^ {\ell} (t, T _ {1}, T _ {2}) > f ^ {F R A} (t, T _ {1}, T _ {2}) \tag {4}
$$

- for  $T_{1} = t + 3$  month and  $T_{2} = T_{1} + 3$  months.  
- This is a potential arbitrage opportunity. What would be the arbitrage argument?  
- Let  $t = 0$ . We want to borrow at the quoted rate  $f^{FRA}(0, T_1, T_2)$  and lend at the higher  $f^{\ell}(0, T_1, T_2)$ , which is only implicit in the LIBOR rates.  
- We can do so as follows:

(a) Sell one bond  $Z^{\ell}(0,T_{1})$  
(b) Buy  $M = \frac{Z^{\ell}(0, T_{1})}{Z^{\ell}(0, T_{2})}$  bonds maturing at  $T_{2}$  
(c) Enter into the quoted FRA to receive LIBOR and pay the quoted FRA rate, i.e.  $\left[\ell (T_1) - f^{FRA}(0,T_1,T_2)\right]\Delta$  at  $T_{2}$

- At time  $t = 0$  this strategy does not cost anything, as:

$$
\underbrace {Z ^ {\ell} \left(0 , T _ {1}\right)} _ {\mathrm {P r o c e e d s f r o m (a)}} = \underbrace {M Z ^ {\ell} \left(0 , T _ {2}\right)} _ {\mathrm {C o s t s o f (b)}}
$$

(d) At time  $T_{1}$ , the arbitrageur must pay 1 from  $(a)$ , which can be obtained by borrowing at the LIBOR  $\ell(T_{1})$ .  
(e) At time  $T_{2}$  we then have the following cash flows:

$$
\mathrm {P a y L I B O R f r o m} (d): - \left[ 1 + \ell \left(T _ {1}\right) \Delta \right]
$$

$$
\text {R e c e i v e} M \text {f r o m} (b): \quad M
$$

$$
\mathrm {R e c e i v e n e t C F f r o m F R A :} \left[ \ell (T _ {1}) - f ^ {F R A} (0, T _ {1}, T _ {2}) \right] \Delta
$$

- The total cash flow at  $T_{2}$  is then

$$
\text {T o t a l C a s h F l o w a t} T _ {2} = M - \left(1 + f ^ {F R A} \left(0, T _ {1}, T _ {2}\right) \Delta\right)
$$

- Recall that

$$
M = \frac {Z ^ {\ell} (0 , T _ {1})}{Z ^ {\ell} (0 , T _ {2})} = 1 + f ^ {\ell} (0, T _ {1}, T _ {2}) \Delta
$$

- Therefore

$$
\mathrm {T o t a l C F a t} T _ {2} \mathrm {i s :} \left[ f ^ {\ell} (0, T _ {1}, T _ {2}) - f ^ {F R A} (0, T _ {1}, T _ {2}) \right] \Delta > 0
$$

# What Could Go Wrong with the Arbitrage Argument?

- Simply that the profit at  $T_{2}$  is not actually free of risk. In particular:

1. Borrowing and liquidity: At 0 and  $T_{1}$  the arbitrageur needs to borrow. What if it is prevented from doing so?  
2. Counterparty risk 1: At 0 the arbitrageur needs to buy  $M$  LIBOR-based bonds (i.e. deposit cash in LIBOR-based deposits) maturing at time  $T_{2}$ . What if the counterparty fails and does not pay  $M$  at maturity?  
3. Counterparty risk 2: At 0 the arbitrageur needs to enter into a FRA for delivery at  $T_{2}$  of cash flow  $\left[\ell(T_{1}) - f^{FRA}\right] \Delta$ . What if the FRA counterparty fails before  $T_{2}$ ?

- The implication is that even OTC contracts, such as FRAs, require the collateralization of exposure from counterparties.  
- Market participants discount future cash flows under collateralization by using the "safe" Is curve.

# Overnight Index Swaps (Is)

- In a Is, the two counterparties agree to exchange fixed for floating payments, where the floating payment is tied to the cumulative return from an overnight rate  
- Federal funds rate, SOFR in US. Europe: short-term rate (€STR), (formerly Euro OverNight Index Average (EONIA) rate).  
- Given a notional  $N$ , the floating rate payment at time  $T_{i}$  is

$$
C F (T _ {i}) = N \left(\prod_ {j = 1} ^ {n _ {j}} \left(1 + r _ {t _ {j}} \delta\right) - 1\right) \tag {5}
$$

- where  $\delta$  is the daily interval,  $r_t$  is the reference (annualized) overnight rate, and  $n_j$  is the number of days between reset periods.  
- The day count convention is normally Actual/360.  
- In the continuous time limit  $(\delta \to 0)$ , we have that

$$
C F \left(T _ {i}\right) = N \left(e ^ {\int_ {T _ {i - 1}} ^ {T _ {i}} r (u) d u} - 1\right) \tag {6}
$$

- Is with maturity less than 1 year have only one payment at the maturity.  
- Is with longer maturities have normally quarterly payments.

# What is the value of Is?

- The value of Is is the difference between the floating leg and the fixed leg:

$$
V _ {t} ^ {O I S} = V _ {t} ^ {F l o a t i n g} - V _ {t} ^ {F i x e d} \tag {7}
$$

- Floating Leg: At reset dates, and assuming the payment of a principal at maturity of the swap, the value of the floating leg is par.
- Indeed, investing the notional  $N$  in the overnight index daily gives at  $T_{i}$

$$
N \prod_ {j = 1} ^ {n _ {j}} \left(1 + r _ {t _ {j}} \Delta\right) = C F \left(T _ {i}\right) + N
$$

- $\Longrightarrow$  we can replicate the floating payments, plus a residual of notional at maturity  $T_{i}$ , with an investment  $N$  at time 0.
- It follows

$$
V _ {0} ^ {F l o a t i n g} = N
$$

- Fixed leg: Given a proper discount function  $Z^{OIS}\left(0,T_i\right)$ , we obtain

$$
V _ {0} ^ {F i x e d} = N c \Delta \sum_ {i = 1} ^ {n} Z ^ {O I S} (0, T _ {i}) + N Z ^ {O I S} (0, T _ {n}) \qquad \qquad (8)
$$

- The value of the contract at inception is zero,  $V_{0}^{OIS} = 0$ .  
It follows from (7) then that

$$
V _ {0} ^ {O I S} = V _ {0} ^ {F l o a t i n g} - V _ {0} ^ {F i x e d} = 0 \tag {9}
$$

- This equation implies that the swap rate  $c$  can be computed from

$$
1 = c \Delta \sum_ {i = 1} ^ {n} Z ^ {O I S} (0, T _ {i}) + Z ^ {O I S} (0, T _ {n}) \tag {10}
$$

- which gives

$$
c (T _ {n}) = \frac {1}{\Delta} \frac {1 - Z ^ {O I S} (0 , T _ {n})}{\Sigma_ {i = 1} ^ {n} Z ^ {O I S} (0 , T _ {i})} \tag {11}
$$

- where we now emphasize that the coupon rate  $c$  is for a swap with maturity  $T_{n}$ , and thus write  $c(T_{n})$ .

# Is Discount Curve

- Given the Is coupon rates  $c\left( {T}_{i}\right)$  for every maturity  ${T}_{i}$  ,we can bootstrap the Is zero-coupon curve from (9).  
- We obtain the relation:

$$
Z ^ {O I S} \left(0, T _ {i}\right) = \frac {1 - c \left(T _ {i}\right) \Delta \Sigma_ {j = 1} ^ {i - 1} Z ^ {O I S} \left(0 , T _ {j}\right)}{1 + c \left(T _ {i}\right) \Delta} \tag {12}
$$

- recalling, however, that Is with maturity less than or equal to 1 year generally have only one payment.  
- Next Figure shows an example of bootstrapping from Is quotes, on January 2, 2009. Panel A reports the original Is quotes from Bloomberg. Panel B uses the quotes from Panel A along with bootstrap methodology (12) and defines the Is discount function  $Z^{OIS}(0,T)$ .

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/f2fff3fe82ff5896f6ebb041f9b89dd46866c1b1e5d07cf620f7289c021ad4a9.jpg)  
Is Discount Curve on January 2th, 2009

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/91ecd2dcc9960a9a45c5a62b6886f094c20ac678081c2fc8f3e29faaf3e90695.jpg)  
Data Source: Bloomberg

# LIBOR-based Swaps

- As in the previous notes, consider a LIBOR-based fixed-for-floating swap with net payments

$$
\operatorname {S w a p} \mathrm {C F} \text {a t} T _ {i} = N \Delta \left[ \ell \left(T _ {i - 1}\right) - c \right] \tag {13}
$$

- for the periods  $T_{1}, T_{2}, \ldots, T_{n}$  with  $T_{i} = T_{i - 1} + \Delta$ , where  $c$  is called the swap rate.  
- The swap rate  $c$  can then be obtained directly from the FRA quotes.  
- Indeed, consider the net cash flow in (13). The random variation of LIBOR  $\ell(T_{i})$  can be hedged using a FRA with the payoff

$$
\mathsf {F R A C F a t} T _ {i} = N \Delta \left[ f (0, T _ {i - 1}, T _ {i}) - \ell \left(T _ {i - 1}\right) \right] \tag {14}
$$

- Putting these two cash flows together, we obtain

$$
\begin{array}{l} \mathsf {S w a p C F + F R A C F a t} T _ {i} = N \Delta [ \ell (T _ {i - 1}) - c ] + N \Delta [ f (t, T _ {i - 1}, T _ {i}) - \ell (T _ {i - 1}) ] \\ = N \Delta [ f (t, T _ {i - 1}, T _ {i}) - c ] \\ \end{array}
$$

- This net cash flow at  $T_{i}$  is deterministic and known at time  $t$ . Therefore

$$
\mathrm {P V} \text {o f S w a p} + \mathrm {F R A C F} \text {a t} T _ {i} = Z (0, T _ {i}) N \Delta [ f (0, T _ {i - 1}, T _ {i}) - c ] \tag {15}
$$

- Therefore, the value today of the swap is just given by the summation

$$
V _ {0} ^ {S W A P} = \sum_ {i = 1} ^ {n} Z (0, T _ {i}) N \Delta [ f (0, T _ {i - 1}, T _ {i}) - c ] \tag {16}
$$

- The value of a swap at inception of the contract is zero. Thus, from the condition

$$
V _ {0} ^ {S W A P} = 0 \tag {17}
$$

we obtain

$$
\sum_ {i = 1} ^ {n} Z \left(0, T _ {i}\right) f \left(0, T _ {i - 1}, T _ {i}\right) = c \sum_ {i = 1} ^ {n} Z \left(0, T _ {i}\right) \tag {18}
$$

- This formula provides a way to compute the swap rate from the quotes of FRA

$$
c = \frac {\sum_ {i = 1} ^ {n} Z (0 , T _ {i}) f (0 , T _ {i - 1} , T _ {i})}{\sum_ {i = 1} ^ {n} Z (0 , T _ {i})} \tag {19}
$$

- Equivalently, we can re-express this as a weighted average of FRA

$$
c \left(T _ {n}\right) = \sum_ {i = 1} ^ {n} w _ {i} f \left(0, T _ {i - 1}, T _ {i}\right) \quad \text {w h e r e} \quad w _ {i} = \frac {Z \left(0 , T _ {i}\right)}{\sum_ {j = 1} ^ {n} Z \left(0 , T _ {j}\right)} \tag {20}
$$

# Single-Curve Pricing

- What forward rates  $f\left( {0,{T}_{i - 1},{T}_{i}}\right)$  and zero-coupon  $Z\left( {0,{T}_{i}}\right)$  should we use?  
- Because these cash-flow depend on LIBOR and the credit risk of broker-dealers reflects well the LIBOR-rate, before the crisis it was common to compute the LIBOR curve from LIBOR rates and swaps, as discussed in TN 3.  
- The algorithm was

$$
Z ^ {\ell} (0, T _ {n}) = \frac {1 - c \left(T _ {n}\right) \Delta \left(\Sigma_ {j = 1} ^ {n - 1} Z ^ {\ell} \left(0 , T _ {j}\right)\right)}{1 + c \left(T _ {n}\right) \Delta} \tag {21}
$$

- Next figure shows the implied LIBOR zero coupon curve on January 2007
- Panel A shows the implied zero coupon discounts  $Z^{OIS}(0, T)$  and  $Z^{\ell}(0, T)$  from equations (12) and (21), respectively.  
- Panel B plots the continuously compounded rates from Is and LIBOR discount curves. Data are from Bloomberg Inc.

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/d1b645a10822c85bdf5fb9564262b56eee4d26cbd1b03851b0df19a9bb39ba4a.jpg)  
Is and LIBOR Discount Curve on January 2nd, 2007  
Panel A. Is and LIBOR Zero Coupon Curve

Panel B. Is and LIBOR Zero Curve  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/252bc6305142eec0ce54411922090b967ec3944937c9a4144ca5478d7b62cc2e.jpg)  
Data Source: Bloomberg

- However, if we try after the crisis, we obtain the following figure:

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/82a841ee24576e8e446bde3a0d64a051bf4f2445e16995ba27388534689907ff.jpg)  
Is and LIBOR Discount Curve on January 2nd, 2009  
Panel A. Is and LIBOR Zero Coupon Curve

Panel B. Is and LIBOR Zero Curve  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/a4f4057514c0e6f16f4df593afaa435354aaadc8b826da3a5445da8dbd92242a.jpg)  
Data Source: Bloomberg

- which are quite different.

# Double Curve Pricing

- The decoupling of the Is and LIBOR curves is due to the increase in the perceived credit risk of security dealers – which affects LIBOR-based discounting – and the consequent increase in collateralization required for OTC derivative instruments (such as FRA or swaps).  
- The pricing of derivative instruments now have to take into account the new costs and benefits that are implicit in the additional collateral and credit risk.  
- What is the swap pricing methodology in the aftermath of the crisis?  
- In the after-crisis period, we witnessed a change in the collateralization required to discount derivatives payoffs.  
- Consider again the LIBOR based swap discussed in the previous section, which was hedged through a sequence of FRA.  
- Because each FRA is zero at initiation, we obtained that the value of the swap had to satisfy (16), reported here again:

$$
V _ {0} ^ {S W A P} = \sum_ {i = 1} ^ {n} Z (0, T _ {i}) N \Delta [ f (0, T _ {i - 1}, T _ {i}) - c ] \tag {22}
$$

- While this formula is general, the question again is what forward rates and discounts to use.
- As we saw earlier, quoted FRA rates are different from LIBOR-based forward rates after the crisis.
- Because we would be hedging the swap cash flows using a traded (and hence quoted) FRA, after the crisis we have  $f^{FRA}(0, T_{i-1}, T_i)$  are used in formula (22).  
- Similarly, because of the low default risk due to higher collateralization, it is customary to now discount the swap cash flows using the Is discounts.  
- We therefore obtain

$$
V _ {0} ^ {S W A P} = \sum_ {i = 1} ^ {n} Z ^ {O I S} (0, T _ {i}) N \Delta \left[ f ^ {F R A} (t, T _ {i - 1}, T _ {i}) - c \right] \tag {23}
$$

- The swap rate  $c$  is the one that makes the swap equal to zero

$$
V _ {0} ^ {S W A P} = 0
$$

- which leads to the swap rate formula

$$
c (T _ {n}) = \sum_ {i = 1} ^ {n} w _ {i} ^ {O I S} f ^ {F R A} (0, T _ {i - 1}, T _ {i}) \tag {24}
$$

- where now

$$
w _ {i} ^ {O I S} = \frac {Z ^ {O I S} (0 , T _ {i})}{\Sigma_ {j = 1} ^ {n} Z ^ {O I S} (0 , T _ {j})}
$$

# Extracting FRA Rates from Swap Quotes

- Given that in (24) the risk free discount  $Z(0, T)$  is already given by the Is discount, we can use the quoted swap rates to extract the market-implied forward rates  $f^{FRA}(0, T_{i-1}, T_i)$  for maturities for which FRA contracts are not observable.  
In particular, developing (24) we obtain

$$
c (T _ {n}) = \frac {\sum_ {i = 1} ^ {n} Z ^ {O I S} (0 , T _ {i}) f ^ {F R A} (0 , T _ {i - 1} , T _ {i})}{\sum_ {j = 1} ^ {n} Z ^ {O I S} (0 , T _ {j})} \tag {25}
$$

- Therefore, multiplying both sides by  $\sum_{j=1}^{n} Z(0, T_j)$  and isolating  $f^{FRA}(0, T_{n-1}, T_n)$  in the sum on the right, we obtain the recursive formula

$$
f ^ {F R A} (0, T _ {n - 1}, T _ {n}) = c (T _ {n}) + \frac {\sum_ {i = 1} ^ {n - 1} Z ^ {O I S} (0 , T _ {i}) \left[ c (T _ {n}) - f ^ {F R A} (0 , T _ {i - 1} , T _ {i}) \right]}{Z ^ {O I S} (0 , T _ {n})} (2 6)
$$

- As an example, the solid line in the next figure shows the FRA extracted from swap rates on January 2nd, 2009.

FRA Rates and Yields from Swap Quotes on January 2nd, 2009  
![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/b5a0d93dcd72e7d88bd991164632885426e0dbc7f2c1ed5025a9ac51b0fda5aa.jpg)  
Data Source: Bloomberg Inc.

# Extracting the Discount Curve from FRA Rates

- Finally, we can use the FRA rates  $f^{FRA}(0, T_{n-1}, T_n)$  to compute a proper discount curve that "justifies them" from no-arbitrage principles.  
- This can be accomplished by reversing formula (3).  
- I will denote the discount curve  $Z^{FRA}(0, T_i)$ , as it is extracted from FRAs.  
- More explicitly, because for every  $T_{i - 1}$  and  $T_{i}$  we must have

$$
f ^ {F R A} (t, T _ {i - 1}, T _ {i}) = \frac {1}{\Delta} \left(\frac {Z ^ {F R A} (0 , T _ {i - 1})}{Z ^ {F R A} (0 , T _ {i})} - 1\right) \tag {27}
$$

- We can solve this equation for  $Z^{FRA}(0, T_i)$  and obtain the recursive formula

$$
Z ^ {F R A} (0, T _ {i}) = \frac {Z ^ {F R A} (0 , T _ {i - 1})}{1 + f ^ {F R A} (t , T _ {i - 1} , T _ {i}) \Delta} \tag {28}
$$

- Given  $Z^{FRA}(0, T_i)$ , we can extract the yield by using the usual formula

$$
y ^ {F R A} (0, T _ {i}) = \frac {1}{\Delta} \left(\frac {1}{Z ^ {F R A} (0 , T _ {i}) ^ {\Delta / T _ {i}}} - 1\right)
$$

- For illustration, the dotted line in previous figure is yield from the FRAs.

# Summing Up

- The 2008 - 2009 financial crisis profoundly, and likely permanently, changed the way market participant discount the cash flows of derivative instruments.  
- In a nutshell, before the crisis, discount rates were computed through the following sequence:

1. LIBOR curve extracted from LIBOR rates and LIBORswaps (formula 21)

$\hookrightarrow$  2. FRA rates extracted from LIBOR curve (formula 3);  
$\hookrightarrow$  3. OLS curve not really used for derivative pricing (formula 12).

- In contrast, after the crisis, the order of these computations has been inverted:

1. Is curve used to extract a "risk-free" discount curve (formula 12);  
$\hookrightarrow$  2. FRA rates obtained from Is curve and LIBOR-swap quotes (formula 26);  
$\hookrightarrow$  3. LIBOR curve extracted from FRA rates (formula 28).

# Summing Up - 2

- Note that in both cases, before and after crisis, we have

(a) A correspondence between FRA rates and LIBOR curve, and the fact that they are related by the standard formula (3), or (27);  
(b) The LIBOR-curve is extracted from LIBOR-based swap rates.

- The difference between before and after the crisis is that after the crisis the discounting applied to LIBOR-based derivatives is different from the one implied by the LIBOR rates themselves.  
- Similar implications hold for other LIBOR-based derivatives, such as Caps, Floors, and Swaptions.
- The formulas are identical, but their "entries" must be adjusted to take into account the new double-curve pricing  
In essence, we use quoted forwards rather than LIBOR-implied forwards and discounts use the Is curve. (See Veronesi (2016) for details)

- There is massive on-going research trying to figure out the proper adjustments to the costs of collateralization, and credit risk.

# Multi-factor Models

# John Heaton

The University of Chicago

Booth School of Business

and NBER

# Multi-factor models

- We previously showed that one factor is definitely not sufficient to explain the term structure of interest rates.  
- So far, we used a statistical approach to deal with factor neutrality: Compute the sensitivity of bonds to all the factors, and then obtain factor neutrality.  
- Notice that we haven't solved for a bond pricing formula, yet.  
- We now do that by using, again, the no arbitrage principle.  
- Consider two factors  $\phi_t^1$  and  $\phi_t^2$  (think about level and slope!)  
- Assume that for  $i = 1,2$

$$
d \phi_ {i} = m _ {i} (t, \phi_ {i}) + s _ {i} (t, \phi_ {i}) d X _ {i} \tag {1}
$$

- where  $dX_{i}$  and  $dX_{i}$  are two Brownian motions with correlation  $\rho$ : that is, with

$$
E \left[ d X _ {1} d X _ {2} \right] = \rho
$$

- Question: Can we obtain a pricing relation now that we have many "factors"?
- YES: We just need to consider a portfolio with more than 2 securities.
- We go through the same steps (I just sketch the methodology)
- Step 1: Construct a portfolio  $\Pi$  with three zero-coupon bonds:

* For example, with one unit of a short term bond with maturity  $T_{1}$  and  $\Delta_{2}$  and  $\Delta_{3}$  units of longer-term bonds with maturity  $T_{3} > T_{2} > T_{1}$ .  
* Let  $Z_{i}(t, \phi_{1}, \phi_{2})$  denote the three prices of the bonds, as a function of the two factors  $\phi_{1}$  and  $\phi_{2}$ .  
* The value of the portfolio at time  $t$  is then

$$
\Pi (t, \phi_ {1}, \phi_ {2}) = Z _ {1} (t, \phi_ {1}, \phi_ {2}) + \sum_ {i = 2} ^ {3} \Delta_ {i} Z _ {i} (t, \phi_ {1}, \phi_ {2})
$$

- Step 2: Delta Hedge. Choose  $\Delta_{2}$  and  $\Delta_{3}$  to make the portfolio insensitive to variation in  $\phi_{1}$  and  $\phi_{2}$ . That is

$$
\frac {\partial \Pi}{\partial \phi_ {1}} = 0 \quad \mathrm {a n d} \quad \frac {\partial \Pi}{\partial \phi_ {2}} = 0
$$

- This yields

$$
\frac {\partial Z _ {1}}{\partial \phi_ {1}} + \Delta_ {2} \times \frac {\partial Z _ {2}}{\partial \phi_ {1}} + \Delta_ {3} \times \frac {\partial Z _ {3}}{\partial \phi_ {1}} = 0 \tag {2}
$$

$$
\frac {\partial Z _ {1}}{\partial \phi_ {2}} + \Delta_ {2} \times \frac {\partial Z _ {2}}{\partial \phi_ {2}} + \Delta_ {3} \times \frac {\partial Z _ {3}}{\partial \phi_ {2}} = 0 \tag {3}
$$

- This is a system of two equations in two unknowns  $(\Delta_{2}$  and  $\Delta_3)$  that can be solved to obtain the optimal hedge ratios.
- Step 3: Use Ito's Lemma to calculate the time evolution of  $\Pi$ .

* We need the multivariate version of Ito's Lemma
* Ito's Lemma (Multiple Brownian Motions): Let  $V = F(t, \phi_1, \phi_2)$  be a function of time and  $\phi_1$  and  $\phi_2$ . Then,  $V$  satisfies the Stochastic Differential Equation

$$
\begin{array}{l} d V = \frac {\partial F}{\partial t} d t + \frac {\partial F}{\partial \phi_ {1}} d \phi_ {1} + \frac {\partial F}{\partial \phi_ {2}} d \phi_ {2} \tag {4} \\ + \frac {1}{2} \frac {\partial^ {2} F}{\partial \phi_ {1} ^ {2}} s _ {1} ^ {2} d t + \frac {1}{2} \frac {\partial^ {2} F}{\partial \phi_ {2} ^ {2}} s _ {2} ^ {2} d t + \frac {\partial^ {2} F}{\partial \phi_ {1} \partial \phi_ {2}} s _ {1} s _ {2} \rho d t \\ \end{array}
$$

* The evolution of the (hedged) portfolio  $\Pi$  is then

$$
d \Pi_ {t} = \left\{\left(\frac {\partial \Pi}{\partial t}\right) + \frac {1}{2} \left(\frac {\partial^ {2} \Pi}{\partial \phi_ {1} ^ {2}}\right) s _ {1, t} ^ {2} + \frac {1}{2} \left(\frac {\partial^ {2} \Pi}{\partial \phi_ {2} ^ {2}}\right) s _ {2, t} ^ {2} \right\} d t \tag {5}
$$

- Step 4: Impose no arbitrage.

$$
d \Pi = r \Pi d t
$$

* where  $r = R(\phi_1, \phi_2)$  is itself a function of the factors.  
* Substitute  $d\Pi$  on the LHS and  $\Pi$  on the RHS, and obtain

$$
G _ {1} \left(\phi_ {1}, \phi_ {2}, t\right) + \Delta_ {2} \times G _ {2} \left(\phi_ {1}, \phi_ {2}, t\right) + \Delta_ {3} \times G _ {3} \left(\phi_ {1}, \phi_ {2}, t\right) = 0 \tag {6}
$$

* where  $G_{i}(\phi_{1},\phi_{2},t)$  is an ugly function in the Appendix.

- Step 5: Obtain a PDE to be solved.

* From (2), (3) and (6) one obtains that any security  $Z\left( {t,{\phi }_{t}^{1},{\phi }_{t}^{2}}\right)$  must satisfy

$$
r Z = \frac {\partial Z}{\partial t} + \frac {\partial Z}{\partial \phi_ {1}} m _ {1} ^ {*} + \frac {\partial Z}{\partial \phi_ {2}} m _ {2} ^ {*} + \frac {1}{2} \frac {\partial^ {2} Z}{\partial \phi_ {1} ^ {2}} s _ {1} ^ {2} + \frac {1}{2} \frac {\partial^ {2} Z}{\partial \phi_ {2} ^ {2}} s _ {2} ^ {2} + \frac {\partial^ {2} Z}{\partial \phi_ {2} \partial \phi_ {1}} s _ {1} s _ {2} \rho (7)
$$

* where  $m_1^*(t, \phi_1, \phi_2)$  and  $m_2^*(t, \phi_1, \phi_2)$  are two functions of the factors.

- As before, we call the process

$$
d \phi_ {i} = m _ {i} ^ {*} (t, \phi_ {i}) d t + s _ {i} (t, \phi_ {i}) d X _ {i}
$$

- the risk-neutral process for factor  $i$ .  
- Since prices for any security depend only on (7), the risk-neutral processes for factors are the ones relevant for prices.

# Two Factor Hull-White Model

- Consider the two factor risk neutral model

$$
d r = (\theta (t) + u - \gamma r) d t + \sigma_ {1} d X _ {1} \tag {8}
$$

$$
d u = - b u d t + \sigma_ {2} d X _ {2} \tag {9}
$$

- Notice that the drift rate of the interest rate has now an additional component,  $u$ , which moves stochastically according to (9).  
- Suppose that today is  $t = 0$  and that  $r_0 = r$  is the current interest rate and  $u_0 = u$ .  
- The function  $\theta(t)$  is chosen to match the current term structure and it turns out that

$$
\theta (t) = \frac {\partial f (0 , t , t)}{\partial t} + \gamma f (0, t, t) + \frac {\partial \phi (0 , t)}{\partial t} + \gamma \phi (0, t) \tag {10}
$$

with

$$
\phi (0, t) = \frac {1}{2} \sigma_ {1} ^ {2} B (0, t) ^ {2} + \frac {1}{2} \sigma_ {2} ^ {2} C (0, t) ^ {2} + \rho \sigma_ {1} \sigma_ {2} B (0, t) C (0, t)
$$

where

$$
B (t, T) = \frac {1}{\gamma} \big (1 - e ^ {- \gamma (T - t)} \big)
$$

$$
C (t, T) = \frac {1}{\gamma (\gamma - b)} e ^ {- \gamma (T - t)} - \frac {1}{b (\gamma - b)} e ^ {- \gamma b (T - t)} + \frac {1}{\gamma b}
$$

- We can solve the PDE in this case, obtaining the pricing formula for a zero coupon bond at time  $t = 0$  with maturity date  $T$

$$
Z (0, r, u; T) = e ^ {A (0, T) - B (0, T) \times r - C (0, T) \times u}
$$

What about  $A(t;T)$ ?

- Hull. Ch. 22 has a closed form solution for  $A(0,T)$ , which is very complicated.  
- However, when the model is calibrated to current bonds, it is assumed that  $u_{0} = 0$ , so that

$$
A \left(0, t\right) = \log \left(Z _ {M} \left(0, t\right)\right) + B \left(0, t\right) r
$$

Why is a nice model?

- It provides better shapes for the term-structure of volatilities.  
- It still has a closed form solution for options.
- For example, the variance of the changes in yields for a long-term bond (with maturity  $\tau$ ) is

$$
\begin{array}{l} \sigma (t, \tau) ^ {2} = \frac {1}{\tau^ {2}} \left(B (t, t + \tau) ^ {2} \sigma_ {1} ^ {2} + C (t, t + \tau) ^ {2} \sigma_ {2} ^ {2} \right. \\ + B (t, t + \tau) C (t, t + \tau) \sigma_ {1} \sigma_ {2} \rho) \\ \end{array}
$$

- Now we have 5 parameters,  $(\sigma_{1},\sigma_{2},\rho ,\gamma ,b)$ , to calibrate to the term-structure of volatilities.

# Famous Models

1. Affine Models: Let  $\phi = (\phi_1, \ldots, \phi_n)$  be a vector of state-variables, evolving as

$$
d \phi_ {i} = \left(\theta_ {i} - \sum_ {j = 1} ^ {n} \gamma_ {i j} \phi_ {j}\right) d t + \sqrt {\alpha_ {i} + \sum_ {j = 1} ^ {n} \beta_ {i j} \phi_ {j}} d X _ {i}
$$

- The interest rate is assumed to be

$$
r \left(t\right) = \overline {{r}} + \sum_ {j = 1} ^ {n} \kappa_ {i} \phi_ {i} \left(t\right)
$$

- The nice thing is that we have a solution for bond prices given by

$$
Z (t, \phi ; T) = e ^ {A (t, T) - \sum_ {j = 1} ^ {n} B _ {j} (t, T) \times \phi_ {i} (t)}
$$

- The functions  $A(t,T)$  and  $B_{j}(t,T)$  satisfy some Ordinary Differential Equations that are simple enough to be solved quickly numerically.  
- See Duffie and Kan (Mathematical Finance, October 1996) for more details.  
- Many other models are just special cases of this one (but they came earlier!)

2. Fong and Vasicek (1991): They assume a stochastic volatility model

$$
d r = (\eta - \gamma r) d t + \sqrt {v} d X _ {1}
$$

$$
d v = b (\overline {{v}} - v) d t + \sigma \sqrt {v} d X _ {2}
$$

3. Longstaff and Schwartz (1992): They assume. for  $i = 1,2$  :

$$
d \phi_ {i} = (\eta_ {i} - \gamma_ {i} \phi_ {i}) d t + \sqrt {\phi_ {i}} d X _ {i}
$$

and

$$
r \left(t\right) = a \phi_ {1} \left(t\right) + b \phi_ {2} \left(t\right)
$$

4. Brennan and Schwartz (1982): Their model does not belong to the class of affine models: they model the short  $(r)$  and the long-term  $(\ell)$  interest rates

$$
d r = (a _ {1} + b _ {1} (r - \ell)) d t + \sigma_ {1} r d X _ {1}
$$

$$
d \ell = \ell (a _ {2} - b _ {2} r + c _ {2} \ell) d t + \sigma_ {2} \ell d X _ {2}
$$

However, the model may imply infinite interest rates.

# Example: Yield Curve Swaps

- The yield curve swap is a contract where one counterparty pays floating based on one part of the yield curve and the other counterparty also pays floating, but based on another part of the yield curve.  
- For example, Party A may pay the three month LIBOR and Party B pay the 5 year Swap rate (plus/minus some constant rate).  
- The net cash flow is then

$$
C F (t + \Delta) = r (t) - r _ {5} ^ {s w a p} (t)
$$

- Clearly, a one factor model is useless in this case: In fact, the two rates  $r(t)$  and  $r_5^{swap}(t)$  are perfectly correlated, implying that there is no stochastic variation in  $CF$ 's.  
- We can instead fit a two factor model, such as Hull-White, and simulate the cash flow forward.

Question: How do we simulate correlated Brownian motions?

- Suppose we had estimated the HW model.  
- We must then simulate

$$
\begin{array}{l} r (t + 1) = (\theta (t) + u - \gamma r (t)) \Delta + \sigma_ {1} \sqrt {\Delta} \varepsilon_ {1} (t + 1) \\ u (t + 1) = u (t) - b u (t) \Delta + \sigma_ {2} \sqrt {\Delta} \varepsilon_ {2} (t + 1) \\ \end{array}
$$

- One difficulty is that  $\varepsilon_{1}$  and  $\varepsilon_{2}$  are correlated, but typically, software are only able to produce uncorrelated normal draws.  
- However, it is simple to transform uncorrelated random variables into correlated ones.  
- Call  $\varepsilon_1^* (t + 1)$  and  $\varepsilon_2^* (t + 1)$  two independent normally distributed random variables, with mean zero and variance one.

$$
\varepsilon_ {i} ^ {*} (t + 1) \sim \mathcal {N} (0, 1)
$$

Then, define

$$
\varepsilon_ {1} (t + 1) = \varepsilon_ {1} ^ {*} (t + 1)
$$

$$
\varepsilon_ {2} (t + 1) = \rho \varepsilon_ {1} ^ {*} (t + 1) + \sqrt {1 - \rho^ {2}} \varepsilon_ {2} ^ {*} (t + 1)
$$

- Now  $\varepsilon_1(t + 1)$  and  $\varepsilon_2(t + 1)$  are still normal distributions with mean 0 and variance one. But now they have correlation  $\rho$ .  
In fact

$$
E \left[ \varepsilon_ {1} \right] = 0, V a r \left[ \varepsilon_ {1} \right] = 1
$$

$$
E \left[ \varepsilon_ {2} \right] = 0 + 0 = 0
$$

$$
V a r \left[ \varepsilon_ {1} \right] = \rho^ {2} \times 1 + \left(1 - \rho^ {2}\right) \times 1 = 1
$$

$$
\begin{array}{l} C o v (\varepsilon_ {1}, \varepsilon_ {2}) = \rho C o v (\varepsilon_ {1} ^ {*}, \varepsilon_ {1} ^ {*}) + \sqrt {1 - \rho^ {2}} C o v (\varepsilon_ {1} ^ {*}, \varepsilon_ {2} ^ {*}) \\ = \rho \times V a r (\varepsilon_ {1} ^ {*}) + 0 \\ = \rho \\ \end{array}
$$

# Heath-Jarrow-Morton Model

- The HJM model offers a different perspective: Rather than modeling interest rates, let's model forward rates.  
- This, per se, is not a big contribution.  
- However, it is what they found that makes it interesting.  
- In general, when we have one factor the risk-neutral process for zeros is

$$
\frac {d Z (t , T)}{Z (t , T)} = r (t) d t + v (t, T) d X
$$

- where  $r(t)$  is the current instantaneous interest rate, and  $v(t,T)$  is some volatility function.  
- Notice that above  $T$  is fixed: So,  $t$  is moving towards  $T$ .
- Hence, at maturity we must have zero volatility (bond prices become risk-less at the very end), that is

$$
v (t, T) = 0 \mathrm {a s} t \to T
$$

- Now: recall that the forward rate at time  $t$  for an investment between  $T$  and  $T + \tau$  is defined as that interest rate  $f(t, T, T + \tau)$  such that

$$
e ^ {y (t, T) (T - t)} e ^ {f (t, T, T + \tau) \tau} = e ^ {y (t, T + \tau) (T + \tau - t)}
$$

- This implies

$$
f (t, T, T + \tau) = \frac {\ln (Z (t , T)) - \ln (Z (t , T + \tau))}{\tau}
$$

Using Ito's lemma, one finds

$$
\begin{array}{l} d f (t, T, T + \tau) = \frac {v (t , T + \tau) ^ {2} - v (t , T) ^ {2}}{2 \tau} d t \\ + \frac {v (t , T) - v (t , T + \tau)}{\tau} d X \\ \end{array}
$$

- Notice that only the volatility terms enter into this formula.  
- Given the volatility function  $v(t,T)$ , we have a process for the forward rate.
- Now: as  $\tau \to 0$ , we obtain the instantaneous forward rate  $f(t,T) = f(t,T,T)$  (I drop the second "T" from the arguments of the function for simplicity) as

$$
d f (t, T) = v (t, T) v _ {T} (t, T) d t - v _ {T} (t, T) d X \tag {11}
$$

- where

$$
v _ {T} (t, T) = \frac {\partial v (t , T)}{\partial T}
$$

- Equation (11) shows that there is a link between the drift and the volatility of the risk-neutral process of the instantaneous forward rate.
- The only thing we need, then, is the function  $v(t,T)$ , then the process for the forward rate will be fully described!
- Example: A simple but very used parametrization is

$$
v _ {T} (t, T) = - \sigma \times e ^ {- \lambda (T - t)}
$$

- where  $\sigma$  and  $\lambda$  are two constants.

* This implies a decreasing volatility of forward rates. It is similar to Hull-White.

- Therefore:

$$
\begin{array}{l} v (t, T) = v (t, t) + \int_ {t} ^ {T} v _ {T} (t, \tau) d \tau = \int_ {t} ^ {T} - \sigma \times e ^ {- \lambda (\tau - t)} d \tau \\ = \frac {\sigma}{\lambda} \left(e ^ {- \lambda (T - t)} - 1\right) \\ \end{array}
$$

* where I used the condition  $v(t, t) = 0$ .

- The drift of the instantaneous forward rate is then

$$
v (t, T) v _ {T} (t, T) = - \frac {\sigma^ {2}}{\lambda} e ^ {- \lambda (T - t)} (e ^ {- \lambda (T - t)} - 1)
$$

# Extension to Many Factors

- The HJM model is promptly extended to many factors, by defining

$$
d f (t, T) = m (t, T) d t + \sum_ {j = 1} ^ {n} s _ {j} (t, T) d X _ {j}
$$

where

$$
m (t, T) = \sum_ {j} s _ {j} (t, T) \int_ {t} ^ {T} s _ {j} (t, \tau) d \tau
$$

- One interesting approach of the HJM is to link it up to the previous discussion about principal component analysis (see Section 1).
- Since now we have many factors, we can do a principal component analysis (PCA) on forward rates.
- This implies we can obtain the functions:

$$
s _ {j} (t, T) = \beta_ {j} (T)
$$

- where  $\beta_{j}(T)$  are the analogous coefficients of Table 1, but computed using forward rates.  
- Given the " $s_j(t, T)$ " functions, we can compute by no-arbitrage any derivative securities by using the Monte Carlo methodology above.
- This methodology guarantees that forward rates would move over time with characteristics statistically similar to the ones obtained in the past. In addition, the no-arbitrage principle is satisfied!
- Notice that this last point was missing in section 1: It would be incorrect to simulate forward the yields by using the PCA on yields.

* We need a no-arbitrage model to ensure that there are no arbitrage opportunities among the simulated yields.

# Fixed Income Asset Pricing

Final Remarks

John Heaton

The University of Chicago

Booth School of Business

# What Did We Learn?

# SOME BASIC PRINCIPLES:

- Relative Value: No Arbitrage → Relative value → Risk neutral pricing  
- Risk Neutral Pricing? Binomial Trees and MC Simulations
  - Remember: RN pricing = dynamic replication  
Expected Excess Returns? Mixture RN and True parameters

- RN probabilities = Risk adjusted probabilities  
- Market price of risk = risk adjustment.  
- Timevarying  $\rightarrow$  Predictability of bond returns

Models and Data

- Models have parameters and parameters needs Data
- Risk neutral parameters = pricing / hedging  
- Risk natural parameters = forecasting
- Models and Data need each other but sometimes fight
- Each model has pros and cons

E.g. HoLee/BDT models versus Vasicek/CIR models

# What Did We Learn?

# SEVERAL TOOLS:

1. Yield, YTM, Forward Rates: Basic quantities for term structure models.  
2. Duration and Convexity: Sensitivity to interest rate shocks  
3. Principal Component Analysis: Uncover level, slope, and curvature  
4. Factor Neutrality: Extension of duration hedging to changes in level, slope and curvature  
5. Bootstrap, Curve Fitting, etc: How do we handle large amount of data?  
6. Risk Neutral Pricing: Pricing methodology for derivatives  
7. Binomial Trees: Backward method for derivative pricing

$\rightarrow$  e.g. American / MBS

8. Monte Carlo Simulations: Forward method for derivative pricing  
e.g. Path dependent securities  
9. Estimation of Pricing Models Non-linear least squares, OLS, etc.  
10. (Some) Stochastic Calculus: Basis of modern finance

# What Did We Learn?

# SEVERAL MARKETS, DERIVATIVES, STRUCTURED NOTES:

1. U.S. Treasury Market:

Basic reference. One of the largest markets

2. Mortgage Backed Securities:

Very large market, difficult to analyze due to American call options and frictions

3. Swap Market:

Largest derivatives market

4. Derivatives:

FRA, Caps, Floors, Swaptions

5. Structured Notes and Bonds:

Securities with embedded options Floaters, Inverse Floaters, Callable Bonds, etc.

# What Did We Learn?

# SEVERAL MODELS:

1. Vasicek, and CIR:  
2. HoLee, Simple BDT:  
3. BDT Model:  
4. Hull - White Model:  
5. LIBOR - Market Model:  
6. Multifactor models:  
7. Double Curve Pricing:

"Equilibrium" models. Time consistent. Don't fit the term structure exactly.

Mostly binomialtree based models Fit exactly term structure of interest rates

Binomialtree model to also fit term structure of volatility

Extension of Vasicek model to fit the term structure of interest rates

Current standard model for LIBORbased derivatives, e.g. Caps, Floors, Swaptions

Deal with time variation in level, slope, and curvature. Fit the correlations of yields at different horizons

Derivative pricing with multiple curves

# What did we learn?

Comments by Emanuel Derman (from Risk Magazine)

- Former Head of Quantitative Research Goldman Sachs

![](https://cdn-mineru.openxlab.org.cn/result/2025-11-20/ff34cd1a-cf8f-48ef-82fe-87b50e3bff05/36a19f5a88a074777340931b5e8c30b410975e6d57ecbc33e1e0beea2c478f24.jpg)

# 1. There are very few laws

# Derman :

- "Unhappily, there are few unalterable laws of quantitative finance. […] The only universally applicable law is that of approximate similarity, which states that the best estimate of the unknown market value of a security is the price of another security that's closely similar to it."  
- "You need to find (or invent) a model to establish the similarity between two securities by demonstrating the equivalence of their future payouts under a wide range of circumstances"

# This class:

- One of the most important parts of 35130 was to teach a principle:  
- the principle of no arbitrage and dynamic replication.  
- This principle yields a general framework to analyze securities and obtain models.  
- Vasicek, CIR, HoLee, HullWhite, BDT, are derived within the same general framework.  
- The models are needed to establish similarities across securities.

# 2. Suspend disbelief

# Derman :

- "Although all you have is the limited power of this simple law, you must take your model of similarity seriously."  
- "Temporarily, like a fiction reader, you must suspend disbelief in your model. Then, when it's complete, remind yourself that economics and valuation involve the behavior of people, and think hard about what could go wrong."

# This class

- The assignments in 35130 aimed at showing the inherent difficulty to take models to the real world.  
- It is hard to go from model to real world.
- Data do not fit the model perfectly  
- Frictions do not allow us to continuously rebalance the portfolio  
- The parameters may be unstable  
- The model is just wrong, by definition.
- The question is how much wrong

# 3. Don't get too carried away by mathematics

Derman :

- "Mathematics is crucial to financial modeling, but it's not central. It shouldn't obscure the fact that finance and economics aim to be practical. If economics is about anything, it's about the real world."

This class:

- Models are like cars in a race.

You need them for a race;  
But you need to be a good driver too!

- How do you become a good "driver"?
- By learning the models to find where they may fail and why.  
35130 shows the limitation of models, as well as their power.

# 4. The models you learned are the beginning, not the end

# Derman :

- "When I hired people to help value securities, I used to receive resumes from a headhunter who would market her candidates by rattling off mantras such as 'Knows HJM, knows BK, knows VAR, knows extreme value theory. What more could you want?'  
- "I wanted someone who understood that the famous models they had learned are not sacrosanct, that models were not the end point but the starting point."  
"I wanted people who weren't afraid of tinkering with the models they inherited, who were willing to invent their own."  
- "Models aren't holy. You have to overlay known models with heuristics. You have to mess with them every day."

# This class:

- 35130 provided you with a general framework:

How can you improve upon? How can you extend the models to add idiosyncrasies from the real world?  

- From the general principles of no arbitrage and dynamic replication, models can be built up to apply them to the various particular cases and data situations.

# 5. Data has no voice

# Derman :

- "Data alone doesn't tell you anything; you need to think and theorise."  
-Fischer Black once wrote:

I find theory to be far more powerful than data when we're trying to estimate expected return… When I read an empirical paper I usually seek out the theory section and ignore the tables.

- "So, be prepared to have a view, to make a theory."  
- "Data comes from the external world and must confirm or repudiate theories; theories come from you."

# This class:

- I hope 35130 helps you build your own `theories'

However, recall that theories must then be applied to the real world, otherwise they are mute.

# 6. Abandon all hope…

# Derman :

- "Genuinely enthusiastic students sometimes ask what will happen when you find the ultimate model."  
- "On Wall Street, no - one knows what the correct model is, but they go ahead and price and trade anyhow"

# This class:

- Yes! There is no right model!  
- But this does not mean models are not useful.  
- They help you analyze reality, and figure out what type of relations have to hold across securities.

# 7. Models are powerful sales tools

# Derman :

- "One imagines that models are all about arbitrage, and that the right one can find you bargains and make you money."  
- "Sometimes that's true, but models are equally valuable in dealing with clients and customers.  
- "Models are a helpful way of looking at the world."

# Class:

- Absolutely!  
- Consider the pricing of a convertible bond.  
- Using models you obtain prices and strategies that you can then sell to investors to boost their expected return, for instance, or to implement risk management strategies.

# 8. Software is honourable

# Derman :

- "Academics often overemphasise models, but much of the success of a model depends on software engineering."  
- "It's not hard to create a conceptually more advanced model. But how do you use it? You need live market data, historical time series, databases, input screens and calibration."

# This class:

- We hope that 35130 make you aware of
- the necessity of computers to use models  
- the necessity to mix data with computing
- A BDT model is simple so long it has 3 periods. In real life and for practical purposes, you need 200 time steps.
- Computers are just a necessary part of fixed income asset pricing.
- In addition, only by coding up your software you really understand a model and its ability to match up with the data.
- You understand the type of approximations you have to make, and where (and why) it can fail.

# 9. Form matters

# Derman :

- "Many finance professors like to recount with a strange mix of regret and pride how they need to publish in approved journals and in an approved style to get tenure."  
- "When models are used to establish the similarity of securities, to compare rather than predict, then persuasiveness is important."  
- "So, when you build a model, you have to explain it, in words. And until you can, you won't completely understand it."

# This Class:

- True: Even in academic life, writing a new model is only  $\frac{1}{2}$  of the job. The other  $\frac{1}{2}$  is to convince people that it is true.  
- And form matters!

# 10. Between Feynman and Freud

# Derman :

- "What people most need to learn when they come to the practice of quantitative finance is how to overlay their theoretical knowledge with pragmatic common sense."  
- "One must learn how to be neither too concrete nor too abstract, to choose some part of the spectrum between behavioral and quantitative, between science and psychology, between Feynman and Freud."

# This Class:

- 35130 emphasizes applications of models to real world.

We studied Vasicek and BDT, for instance.  
But when and how can we apply them?  
Where can they fail?  
What can go wrong?

- Hopefully, the practical applications we gave you enabled you to obtain the answers to these questions.

# Final Project

# - Final Project:

- Will be available on Canvas starting Saturday May 18 in the morning  
- Once you open it, you will have 7 days (168 hours) to complete the exam and submit via Canvas  
- Complete instructions will be available on Canvas  
- You are to do this in groups of no more than 3 people with discussion limited to your own groups  
- LATEST DUE DATE: 11:59 pm (Chicago Time!) Sunday May 26.